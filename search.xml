<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å¦‚ä½•åœ¨hexoä¸­å®‰è£…nextä¸»é¢˜</title>
    <url>/2024/01/12/%E5%A6%82%E4%BD%95%E5%9C%A8hexo%E4%B8%AD%E5%AE%89%E8%A3%85next%E4%B8%BB%E9%A2%98/</url>
    <content><![CDATA[<h1 id="1-å®‰è£…hexo"><a href="#1-å®‰è£…hexo" class="headerlink" title="1. å®‰è£…hexo"></a>1. å®‰è£…hexo</h1><p>npm install -g hexo-cli</p>
<h1 id="2-ä¸»é¢˜ä¸‹è½½å®‰è£…"><a href="#2-ä¸»é¢˜ä¸‹è½½å®‰è£…" class="headerlink" title="2. ä¸»é¢˜ä¸‹è½½å®‰è£…"></a>2. ä¸»é¢˜ä¸‹è½½å®‰è£…</h1><p>è¿›å…¥å‘½ä»¤è¡Œï¼Œä¸‹è½½ NexT ä¸»é¢˜ï¼Œè¾“å…¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶<code>_config.yml</code>ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">landscape</span></span><br></pre></td></tr></table></figure>

<p>å°† landscape ä¿®æ”¹ä¸º next å³å¯ã€‚</p>
<span id="more"></span>





<h1 id="3-é…ç½®æ–‡ä»¶"><a href="#3-é…ç½®æ–‡ä»¶" class="headerlink" title="3. é…ç½®æ–‡ä»¶"></a>3. é…ç½®æ–‡ä»¶</h1><p>åœ¨ Hexo ä¸­æœ‰<strong>ä¸¤ä»½</strong>ä¸»è¦çš„é…ç½®æ–‡ä»¶ï¼Œå…¶åç§°éƒ½æ˜¯ <strong>_config.yml</strong>ã€‚ å…¶ä¸­ï¼Œä¸€ä»½ä½äºç«™ç‚¹æ ¹ç›®å½•ä¸‹ï¼Œä¸»è¦åŒ…å« Hexo æœ¬èº«çš„ç«™ç‚¹é…ç½®ï¼›å¦ä¸€ä»½ä½äº<strong>ä¸»é¢˜ç›®å½•</strong>ä¸‹ï¼Œè¿™ä»½é…ç½®ç”±ä¸»é¢˜ä½œè€…æä¾›ï¼Œä¸»è¦ç”¨äºé…ç½®ä¸»é¢˜ç›¸å…³çš„é€‰é¡¹ã€‚</p>
<p>ä¸ºäº†æè¿°æ–¹ä¾¿ï¼Œåœ¨ä»¥ä¸‹è¯´æ˜ä¸­ï¼Œå°†å‰è€…ç§°ä¸º <strong>ç«™ç‚¹é…ç½®æ–‡ä»¶</strong>ï¼Œ åè€…ç§°ä¸º <strong>ä¸»é¢˜é…ç½®æ–‡ä»¶</strong>ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">/hexo/_config.yml</span></span><br><span class="line"><span class="string">/hexo/themes/next/_config.yml</span></span><br></pre></td></tr></table></figure>

<h1 id="4-ä¿®æ”¹è¯­è¨€"><a href="#4-ä¿®æ”¹è¯­è¨€" class="headerlink" title="4. ä¿®æ”¹è¯­è¨€"></a>4. ä¿®æ”¹è¯­è¨€</h1><p>æ‰“å¼€ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œæœç´¢ languageï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">author: waterdance</span><br><span class="line">language: zh-Hans</span><br><span class="line">timezone: Asia/Shanghai</span><br></pre></td></tr></table></figure>

<h1 id="5-æ–°å»ºæ ‡ç­¾åŠåˆ†ç±»ç•Œé¢"><a href="#5-æ–°å»ºæ ‡ç­¾åŠåˆ†ç±»ç•Œé¢" class="headerlink" title="5. æ–°å»ºæ ‡ç­¾åŠåˆ†ç±»ç•Œé¢"></a>5. æ–°å»ºæ ‡ç­¾åŠåˆ†ç±»ç•Œé¢</h1><p>æ‰“å¼€ <strong>ä¸»é¢˜é…ç½®æ–‡ä»¶</strong>ï¼Œæœç´¢ menuï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line">  <span class="comment">#tags: /tags/ || tags</span></span><br><span class="line">  <span class="comment">#categories: /categories/ || th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<p>æŠŠ tags å’Œ categories å‰é¢çš„ # åˆ é™¤</p>
<h1 id="6-åˆ‡æ¢ä¸»é¢˜"><a href="#6-åˆ‡æ¢ä¸»é¢˜" class="headerlink" title="6. åˆ‡æ¢ä¸»é¢˜"></a>6. åˆ‡æ¢ä¸»é¢˜</h1><p>åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>/next/_config.yml</code>ä¸­æŸ¥æ‰¾ï¼š<code>scheme</code>ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="comment">#scheme: Gemini</span></span><br><span class="line"><span class="string">é€‰æ‹©ä½ å–œæ¬¢çš„ä¸€ç§æ ·å¼ï¼Œå»æ‰å‰é¢çš„</span> <span class="comment">#ï¼Œå…¶ä»–ä¸»é¢˜å‰åŠ ä¸Š # å³å¯ã€‚</span></span><br></pre></td></tr></table></figure>

<h1 id="7-éšè—ç½‘é¡µåº•éƒ¨-powered-By-Hexo-å¼ºåŠ›é©±åŠ¨"><a href="#7-éšè—ç½‘é¡µåº•éƒ¨-powered-By-Hexo-å¼ºåŠ›é©±åŠ¨" class="headerlink" title="7. éšè—ç½‘é¡µåº•éƒ¨ powered By Hexo &#x2F; å¼ºåŠ›é©±åŠ¨"></a>7. éšè—ç½‘é¡µåº•éƒ¨ powered By Hexo &#x2F; å¼ºåŠ›é©±åŠ¨</h1><p>æ‰“å¼€ themes&#x2F;next&#x2F;layout&#x2F;_partials&#x2F;footer.swig</p>
<p>æ‰¾åˆ°ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">%</span> <span class="string">if</span> <span class="string">theme.footer.powered.enable</span> <span class="string">%</span>&#125;</span><br><span class="line"><span class="string">&lt;div</span> <span class="string">class=&quot;powered-by&quot;&gt;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;&#123;&#123; __(&#x27;footer.powered&#x27;, &#x27;&lt;a class=&quot;theme-link&quot; target=&quot;_blank&quot;&#x27; + nofollow + &#x27; href=&quot;https://hexo.io&quot;&gt;Hexo&lt;/a&gt;&#x27;) &#125;&#125;&#123;% if theme.footer.powered.version %&#125; v&#123;&#123; hexo_env(&#x27;version&#x27;) &#125;&#125;&#123;% endif %&#125;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;&lt;/div&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">endif</span> <span class="string">%</span>&#125;</span><br><span class="line">&#123;<span class="string">%</span> <span class="string">if</span> <span class="string">theme.footer.powered.enable</span> <span class="string">and</span> <span class="string">theme.footer.theme.enable</span> <span class="string">%</span>&#125;</span><br><span class="line"><span class="string">&lt;span</span> <span class="string">class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">endif</span> <span class="string">%</span>&#125;</span><br><span class="line">&#123;<span class="string">%</span> <span class="string">if</span> <span class="string">theme.footer.theme.enable</span> <span class="string">%</span>&#125;</span><br><span class="line"><span class="string">&lt;div</span> <span class="string">class=&quot;theme-info&quot;&gt;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;&#123;&#123; __(&#x27;footer.theme&#x27;) &#125;&#125; â€“ &#123;#</span></span><br><span class="line"><span class="comment">#&#125;&lt;a class=&quot;theme-link&quot; target=&quot;_blank&quot;&#123;&#123; nofollow &#125;&#125; href=&quot;https://theme-next.org&quot;&gt;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;NexT.&#123;&#123; theme.scheme &#125;&#125;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;&lt;/a&gt;&#123;% if theme.footer.theme.version %&#125; v&#123;&#123; version &#125;&#125;&#123;% endif %&#125;&#123;#</span></span><br><span class="line"><span class="comment">#&#125;&lt;/div&gt;</span></span><br><span class="line">&#123;<span class="string">%</span> <span class="string">endif</span> <span class="string">%</span>&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠè¿™æ®µä»£ç é¦–å°¾åˆ†åˆ«åŠ ä¸Šï¼š<code>&lt;!--</code> å’Œ<code>--&gt;</code>ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤ã€‚</p>
<h1 id="8-æ–‡ç« åŠ ä¸Šé˜´å½±"><a href="#8-æ–‡ç« åŠ ä¸Šé˜´å½±" class="headerlink" title="8. æ–‡ç« åŠ ä¸Šé˜´å½±"></a>8. æ–‡ç« åŠ ä¸Šé˜´å½±</h1><p>æ‰“å¼€ &#x2F;themes&#x2F;next&#x2F;source&#x2F;css&#x2F;_custom&#x2F;custom.stylï¼Œæ·»åŠ ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post</span> &#123;</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">60px</span>;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">-webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">203</span>, <span class="number">203</span>, .<span class="number">5</span>);</span><br><span class="line">-moz-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">203</span>, <span class="number">204</span>, .<span class="number">5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9-æµè§ˆé¡µé¢æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦"><a href="#9-æµè§ˆé¡µé¢æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦" class="headerlink" title="9. æµè§ˆé¡µé¢æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦"></a>9. æµè§ˆé¡µé¢æ˜¾ç¤ºå½“å‰æµè§ˆè¿›åº¦</h1><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œæœç´¢å…³é”®å­— <code>scrollpercent</code>ï¼ŒæŠŠ false æ”¹ä¸º trueã€‚</p>
<p><img src="/2024/01/12/%E5%A6%82%E4%BD%95%E5%9C%A8hexo%E4%B8%AD%E5%AE%89%E8%A3%85next%E4%B8%BB%E9%A2%98/image-20240115193347448.png" alt="image-20240115193347448"></p>
<h1 id="10-Local-Searchæœ¬åœ°æœç´¢"><a href="#10-Local-Searchæœ¬åœ°æœç´¢" class="headerlink" title="10. Local Searchæœ¬åœ°æœç´¢"></a>10. Local Searchæœ¬åœ°æœç´¢</h1><p>å®‰è£…æ’ä»¶<code>hexo-generator-searchdb</code>,æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹<code>hexo/_config.yml</code>ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œæ–°å¢ä»¥ä¸‹å†…å®¹åˆ°ä»»æ„ä½ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line"><span class="attr">field:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">format:</span> <span class="string">html</span></span><br><span class="line"><span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure>

<h1 id="11-è®¾ç½®ç½‘ç«™å›¾æ ‡"><a href="#11-è®¾ç½®ç½‘ç«™å›¾æ ‡" class="headerlink" title="11. è®¾ç½®ç½‘ç«™å›¾æ ‡"></a>11. è®¾ç½®ç½‘ç«™å›¾æ ‡</h1><p>åœ¨ EasyIcon ä¸­æ‰¾ä¸€å¼ ï¼ˆ32 * 32ï¼‰çš„ ico å›¾æ ‡ï¼Œæˆ–è€…å»åˆ«çš„ç½‘ç«™ä¸‹è½½æˆ–è€…åˆ¶ä½œï¼Œå¹¶å°†å›¾æ ‡åç§°æ”¹ä¸º favicon.icoï¼Œç„¶åæŠŠå›¾æ ‡æ”¾åœ¨ &#x2F;themes&#x2F;next&#x2F;source&#x2F;images é‡Œï¼Œå¹¶ä¸”ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">Put</span> <span class="string">your</span> <span class="string">favicon.ico</span> <span class="string">into</span> <span class="string">`hexo-site/source/`</span> <span class="string">directory.</span></span><br><span class="line"><span class="attr">favicon:</span> <span class="string">/favicon.ico</span></span><br></pre></td></tr></table></figure>

<h1 id="12-ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„-å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡"><a href="#12-ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„-å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡" class="headerlink" title="12. ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„#å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡"></a>12. ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„#å·çš„æ ‡ç­¾ï¼Œæ”¹ä¸ºå›¾æ ‡</h1><p>ä¿®æ”¹æ¨¡æ¿<code>/themes/next/layout/_macro/post.swig</code></p>
<p>æœç´¢ rel&#x3D;â€œtagâ€&gt;#ï¼Œå°† # æ¢æˆ<code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code></p>
<h1 id="13-æ–‡ç« åˆ†äº«åŠŸèƒ½"><a href="#13-æ–‡ç« åˆ†äº«åŠŸèƒ½" class="headerlink" title="13. æ–‡ç« åˆ†äº«åŠŸèƒ½"></a>13. æ–‡ç« åˆ†äº«åŠŸèƒ½</h1><p>æ‰“å¼€<code>themes/next/_config.yml</code> æœç´¢å…³é”®å­—<code>needmoreshare2</code> ä¿®æ”¹ä¸ºä¸‹é¢è®¾ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">needmoreshare2:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">postbottom:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">default</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">horizontal</span></span><br><span class="line">      <span class="comment">#ä½ç½®</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">bottomCenter</span></span><br><span class="line">      <span class="comment">#å¯åˆ†äº«ç½‘ç«™</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook</span></span><br><span class="line">  <span class="attr">float:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">options:</span></span><br><span class="line">      <span class="attr">iconStyle:</span> <span class="string">default</span></span><br><span class="line">      <span class="attr">boxForm:</span> <span class="string">vertical</span></span><br><span class="line">      <span class="comment">#ä½ç½®</span></span><br><span class="line">      <span class="attr">position:</span> <span class="string">topRight</span></span><br><span class="line">       <span class="comment">#å¯åˆ†äº«ç½‘ç«™</span></span><br><span class="line">      <span class="attr">networks:</span> <span class="string">Weibo,Wechat,Douban,QQZone,Twitter,Facebook</span></span><br></pre></td></tr></table></figure>

<h1 id="14-æ–‡ç« åŠ å¯†è®¿é—®"><a href="#14-æ–‡ç« åŠ å¯†è®¿é—®" class="headerlink" title="14. æ–‡ç« åŠ å¯†è®¿é—®"></a>14. æ–‡ç« åŠ å¯†è®¿é—®</h1><p>æ‰“å¼€<code>themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swig</code>æ–‡ä»¶,æ’å…¥è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(function()&#123;</span><br><span class="line">    if(&#x27;&#123;&#123; page.password &#125;&#125;&#x27;)&#123;</span><br><span class="line">        if (prompt(&#x27;è¯·è¾“å…¥æ–‡ç« å¯†ç &#x27;) !== &#x27;&#123;&#123; page.password &#125;&#125;&#x27;)&#123;</span><br><span class="line">            alert(&#x27;å¯†ç é”™è¯¯ï¼&#x27;);</span><br><span class="line">            history.back();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h1 id="15-å¢åŠ æ–‡ç« å­—æ•°ç»Ÿè®¡åŠé˜…è¯»æ—¶å¸¸åŠŸèƒ½"><a href="#15-å¢åŠ æ–‡ç« å­—æ•°ç»Ÿè®¡åŠé˜…è¯»æ—¶å¸¸åŠŸèƒ½" class="headerlink" title="15. å¢åŠ æ–‡ç« å­—æ•°ç»Ÿè®¡åŠé˜…è¯»æ—¶å¸¸åŠŸèƒ½"></a>15. å¢åŠ æ–‡ç« å­—æ•°ç»Ÿè®¡åŠé˜…è¯»æ—¶å¸¸åŠŸèƒ½</h1><p>å®‰è£…æ’ä»¶<code>hexo-wordcount</code>,æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-wordcount --save</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹<code>themes/next/_config.yml</code>ä¸»é¢˜é…ç½®æ–‡ä»¶ï¼Œæœç´¢å…³é”®å­—<code>post_wordcount</code>,ä¿®æ”¹å¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">post_wordcount:</span><br><span class="line">  item_text: true</span><br><span class="line">  wordcount: true #å•ç¯‡æ–‡ç« å­—æ•°</span><br><span class="line">  min2read: true #å•ç¯‡é˜…è¯»æ—¶é•¿</span><br><span class="line">  totalcount: true #ç«™ç‚¹æ€»å­—æ•°</span><br><span class="line">  separated_meta: true</span><br></pre></td></tr></table></figure>

<h1 id="16-æ–‡ç« ç½®é¡¶åŠŸèƒ½"><a href="#16-æ–‡ç« ç½®é¡¶åŠŸèƒ½" class="headerlink" title="16. æ–‡ç« ç½®é¡¶åŠŸèƒ½"></a>16. æ–‡ç« ç½®é¡¶åŠŸèƒ½</h1><p>ç§»é™¤é»˜è®¤å®‰è£…çš„æ’ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-generator-index --save</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æ–°æ’ä»¶:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-index-pin-top --save</span><br></pre></td></tr></table></figure>

<p>æœ€åç¼–è¾‘æœ‰è¿™éœ€æ±‚çš„ç›¸å…³æ–‡ç« æ—¶ï¼Œåœ¨Front-matterï¼ˆæ–‡ä»¶æœ€ä¸Šæ–¹ä»¥â€”åˆ†éš”çš„åŒºåŸŸï¼‰åŠ ä¸Šä¸€è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">top: true</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ ç½®é¡¶äº†å¤šç¯‡ï¼Œæ€ä¹ˆæ§åˆ¶é¡ºåºå‘¢ï¼Ÿè®¾ç½®topçš„å€¼ï¼ˆå¤§çš„åœ¨å‰é¢ï¼‰ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"># Post a.md</span><br><span class="line">title: a</span><br><span class="line">top: <span class="number">1</span></span><br><span class="line"></span><br><span class="line"># Post b.md</span><br><span class="line">title: b</span><br><span class="line">top: <span class="number">10</span></span><br></pre></td></tr></table></figure>

<p>æ–‡ç«  b ä¾¿ä¼šæ˜¾ç¤ºåœ¨æ–‡ç«  a çš„å‰é¢</p>
<p>è®¾ç½®ç½®é¡¶å›¾æ ‡<br>æ‰“å¼€&#x2F;themes&#x2F;next&#x2F;layout&#x2F;_macro&#x2F;post.swigæ–‡ä»¶ï¼Œåœ¨<code>&lt;div class=&quot;post-meta&quot;&gt;</code>ä¸‹æ–¹ï¼Œæ’å…¥å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% if post.top %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-thumb-tack&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">7D26CD</span>&gt;</span>ç½®é¡¶<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;post-meta-divider&quot;</span>&gt;</span>|<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/12/%E5%A6%82%E4%BD%95%E5%9C%A8hexo%E4%B8%AD%E5%AE%89%E8%A3%85next%E4%B8%BB%E9%A2%98/image-20240115194810928.png" alt="image-20240115194810928"></p>
<h1 id="17-ä¿®æ”¹ã€Read-Moreã€‘æŒ‰é’®æ ·å¼"><a href="#17-ä¿®æ”¹ã€Read-Moreã€‘æŒ‰é’®æ ·å¼" class="headerlink" title="17. ä¿®æ”¹ã€Read Moreã€‘æŒ‰é’®æ ·å¼"></a>17. ä¿®æ”¹ã€Read Moreã€‘æŒ‰é’®æ ·å¼</h1><p>ä¿®æ”¹<code>themes\next\source\css\_custom\custom.styl</code>æ–‡ä»¶ï¼ŒåŠ å…¥è‡ªå®šä¹‰æ ·å¼</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// <span class="selector-attr">[Read More]</span>æŒ‰é’®æ ·å¼</span><br><span class="line"><span class="selector-class">.post-button</span> <span class="selector-class">.btn</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: inset <span class="number">0px</span> <span class="number">0px</span> <span class="number">10px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.35</span>);</span><br><span class="line">    <span class="attribute">border</span>: none <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">transition-property</span>: unset;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.post-button</span> <span class="selector-class">.btn</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgb</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: inset <span class="number">0px</span> <span class="number">0px</span> <span class="number">10px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.35</span>);</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#a166ab</span> <span class="number">0%</span>, <span class="number">#ef4e7b</span> <span class="number">25%</span>, <span class="number">#f37055</span> <span class="number">50%</span>, <span class="number">#ef4e7b</span> <span class="number">75%</span>, <span class="number">#a166ab</span> <span class="number">100%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœå›¾</strong></p>
<p><img src="/2024/01/12/%E5%A6%82%E4%BD%95%E5%9C%A8hexo%E4%B8%AD%E5%AE%89%E8%A3%85next%E4%B8%BB%E9%A2%98/image-20240116143513555.png" alt="image-20240116143513555"></p>
<p><strong>ä¿®æ”¹é˜…è¯»å…¨æ–‡å‰æ˜¾ç¤ºæ–‡å­—æ•°é‡å³ä½ç½®</strong></p>
<p>æ‰“å¼€ <code>themes/next/_config.yml</code>ï¼Œæœç´¢å…³é”®å­— <code>auto_excerpt</code>ï¼Œ ä¿®æ”¹lengthå³å¯ä¿®æ”¹é˜…è¯»å…¨æ–‡å‰æ˜¾ç¤ºæ–‡å­—æ•°é‡</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure>



<h1 id="18-ä¿®æ”¹é“¾æ¥æ–‡å­—æ ·å¼"><a href="#18-ä¿®æ”¹é“¾æ¥æ–‡å­—æ ·å¼" class="headerlink" title="18. ä¿®æ”¹é“¾æ¥æ–‡å­—æ ·å¼"></a>18. ä¿®æ”¹é“¾æ¥æ–‡å­—æ ·å¼</h1><p>æ‰“å¼€<code>themes\next\source\css\_common\components\post\post.styl</code>æ·»åŠ ä»¥ä¸‹ä»£ç :</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">p</span> a&#123;</span><br><span class="line"></span><br><span class="line"> <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line"> <span class="attribute">border-bottom</span>: none;</span><br><span class="line"> <span class="selector-pseudo">&amp;:hover</span> &#123;</span><br><span class="line">   <span class="attribute">color</span>: <span class="number">#ff106c</span>;</span><br><span class="line">   <span class="attribute">text-decoration</span>: underline;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="19-å¤´åƒè®¾ç½®å›¾å½¢ï¼Œåœç•™æ—‹è½¬æ•ˆæœ"><a href="#19-å¤´åƒè®¾ç½®å›¾å½¢ï¼Œåœç•™æ—‹è½¬æ•ˆæœ" class="headerlink" title="19. å¤´åƒè®¾ç½®å›¾å½¢ï¼Œåœç•™æ—‹è½¬æ•ˆæœ"></a>19. å¤´åƒè®¾ç½®å›¾å½¢ï¼Œåœç•™æ—‹è½¬æ•ˆæœ</h1><p>ä¿®æ”¹<code>themes\next\source\css\_common\components\sidebar\sidebar-author.styl</code>,æ–°å¢ä»¥ä¸‹ä»£ç :</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.site-author-image</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">$site</span>-author-image-padding;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="variable">$site</span>-author-image-width;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$site</span>-author-image-height;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$site</span>-author-image-border-width solid <span class="variable">$site</span>-author-image-border-color;</span><br><span class="line">  <span class="comment">//è®¾ç½®åœ†å½¢</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">2s</span> all;</span><br><span class="line">&#125;</span><br><span class="line">   <span class="comment">//æ—‹è½¬</span></span><br><span class="line"><span class="selector-class">.site-author-image</span>:hover&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="20-æ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ-æ–‡ç« è¾¹æ¡†"><a href="#20-æ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ-æ–‡ç« è¾¹æ¡†" class="headerlink" title="20.æ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ(æ–‡ç« è¾¹æ¡†)"></a>20.æ–‡ç« æ·»åŠ é˜´å½±æ•ˆæœ(æ–‡ç« è¾¹æ¡†)</h1><p>æ‰“å¼€<code>themes/next/source/css/_custom/custom.styl</code>æ–‡ä»¶æ·»åŠ :</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">60px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">25px</span>;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">203</span>, <span class="number">203</span>, .<span class="number">5</span>);</span><br><span class="line">  -moz-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">202</span>, <span class="number">203</span>, <span class="number">204</span>, .<span class="number">5</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<h1 id="21-è¿‘æœŸæ–‡ç« "><a href="#21-è¿‘æœŸæ–‡ç« " class="headerlink" title="21. è¿‘æœŸæ–‡ç« "></a>21. è¿‘æœŸæ–‡ç« </h1><p>ä¿®æ”¹<code>themes/next/layout/_macro/sidebar.swig</code> ã€‚æ‰¾åˆ°<code>theme.social</code>æ¿å—ä»£ç ï¼Œåœ¨è¯¥æ¿å—æœ€åçš„endifåéš”ä¸€è¡Œæ·»åŠ å¦‚ä¸‹ä»£ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;# recent posts #&#125;</span><br><span class="line">&#123;% if theme.recent_posts %&#125;</span><br><span class="line">  &lt;div class=&quot;links-of-blogroll motion-element &#123;&#123; &quot;links-of-blogroll-&quot; + theme.recent_posts_layout  &#125;&#125;&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;links-of-blogroll-title&quot;&gt;</span><br><span class="line">      &lt;!-- modify icon to fire by szw --&gt;</span><br><span class="line">      &lt;i class=&quot;fa fa-history fa-&#123;&#123; theme.recent_posts_icon | lower &#125;&#125;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;</span><br><span class="line">      &#123;&#123; theme.recent_posts_title &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;ul class=&quot;links-of-blogroll-list&quot;&gt;</span><br><span class="line">      &#123;% set posts = site.posts.sort(&#x27;-date&#x27;) %&#125;</span><br><span class="line">      &#123;% for post in posts.slice(&#x27;0&#x27;, &#x27;5&#x27;) %&#125;</span><br><span class="line">        &lt;li class=&quot;recent_posts_li&quot;&gt;</span><br><span class="line">          &lt;a href=&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; title=&quot;&#123;&#123; post.title &#125;&#125;&quot; target=&quot;_blank&quot;&gt;&#123;&#123; post.title &#125;&#125;&lt;/a&gt;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">      &#123;% endfor %&#125;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–è¾‘<code>themes/next/source/css/_common/components/sidebar/sidebar-0blogroll.styl</code></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">li</span><span class="selector-class">.recent_posts_li</span> &#123;</span><br><span class="line">    <span class="attribute">text-align</span>: cengter;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">word-break</span>: keep-all;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ <code>themes/next/_config.yml</code>ä¸­æ·»åŠ ä¸‹æ–¹ä»£ç </p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿‘æœŸæ–‡ç« è®¾ç½®</span></span><br><span class="line"><span class="attr">recent_posts_title:</span> <span class="string">è¿‘æœŸæ–‡ç« </span></span><br><span class="line"><span class="attr">recent_posts_layout:</span> <span class="string">block</span></span><br><span class="line"><span class="attr">recent_posts:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>



<h1 id="22-æ–‡ç« æœ«å°¾æ·»åŠ â€œæ–‡æœ¬ç»“æŸâ€æ ‡è®°"><a href="#22-æ–‡ç« æœ«å°¾æ·»åŠ â€œæ–‡æœ¬ç»“æŸâ€æ ‡è®°" class="headerlink" title="22. æ–‡ç« æœ«å°¾æ·»åŠ â€œæ–‡æœ¬ç»“æŸâ€æ ‡è®°"></a>22. æ–‡ç« æœ«å°¾æ·»åŠ â€œæ–‡æœ¬ç»“æŸâ€æ ‡è®°</h1><p>ä¿®æ”¹åœ¨themes&#x2F;next&#x2F;layout&#x2F;_macro&#x2F;post.swigä¸­ï¼Œåœ¨wechat-subscriber.swigä¹‹å‰æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<p>â€”â€”â€”â€”â€”- The End â€”â€”â€”â€”â€”-</p>




<h1 id="23-ä»£ç å—å¤åˆ¶é€‰é¡¹"><a href="#23-ä»£ç å—å¤åˆ¶é€‰é¡¹" class="headerlink" title="23. ä»£ç å—å¤åˆ¶é€‰é¡¹"></a>23. ä»£ç å—å¤åˆ¶é€‰é¡¹</h1><p>Next6 ä¸­è‡ªå¸¦äº†å¤åˆ¶ä»£ç æŒ‰é’®ï¼ŒNext5 éœ€è¦è‡ªå·±æ‰‹åŠ¨é…ç½®ã€‚</p>
<p>æœç´¢ codeblockï¼Œæ‰¾åˆ°å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line"><span class="attr">border_radius:</span> <span class="number">8</span>   <span class="comment"># æŒ‰é’®åœ†æ»‘åº¦</span></span><br><span class="line"><span class="attr">copy_button:</span>  <span class="comment"># è®¾ç½®æ˜¯å¦å¼€å¯ä»£ç å—å¤åˆ¶æŒ‰é’®</span></span><br><span class="line">	<span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">	<span class="attr">show_result:</span> <span class="literal">true</span>  <span class="comment"># æ˜¯å¦æ˜¾ç¤ºå¤åˆ¶æˆåŠŸä¿¡æ¯</span></span><br></pre></td></tr></table></figure>





<h1 id="24-ä¿®æ”¹åŠ è½½ç‰¹æ•ˆ"><a href="#24-ä¿®æ”¹åŠ è½½ç‰¹æ•ˆ" class="headerlink" title="24. ä¿®æ”¹åŠ è½½ç‰¹æ•ˆ"></a>24. ä¿®æ”¹åŠ è½½ç‰¹æ•ˆ</h1><p>ç”±äºç½‘é¡µä¸å¯èƒ½ä¸€ç›´éƒ½ç§’è¿›ï¼Œæ€»ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´çš„ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®é¡¶éƒ¨åŠ è½½æ¡ã€‚Next å·²ç»é›†æˆäº†å¾ˆå¤šåŠ è½½ç‰¹æ•ˆï¼Œå¯ä»¥åœ¨ä¸‹é¢é€‰é¡¹ä¸­åœ¨çº¿è°ƒè¯•æµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p>æœç´¢<code>pace</code>ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¡µé¢é¡¶éƒ¨åŠ è½½æ¡</span></span><br><span class="line"><span class="comment"># Progress bar in the top during page loading.</span></span><br><span class="line"><span class="attr">pace:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment"># Themes list:</span></span><br><span class="line"><span class="comment">#pace-theme-big-counter</span></span><br><span class="line"><span class="comment">#pace-theme-bounce</span></span><br><span class="line"><span class="comment">#pace-theme-barber-shop</span></span><br><span class="line"><span class="comment">#pace-theme-center-atom</span></span><br><span class="line"><span class="comment">#pace-theme-center-circle</span></span><br><span class="line"><span class="comment">#pace-theme-center-radar</span></span><br><span class="line"><span class="comment">#pace-theme-center-simple</span></span><br><span class="line"><span class="comment">#pace-theme-corner-indicator</span></span><br><span class="line"><span class="comment">#pace-theme-fill-left</span></span><br><span class="line"><span class="comment">#pace-theme-flash</span></span><br><span class="line"><span class="comment">#pace-theme-loading-bar</span></span><br><span class="line"><span class="comment">#pace-theme-mac-osx</span></span><br><span class="line"><span class="comment">#pace-theme-minimal</span></span><br><span class="line"><span class="comment"># For example</span></span><br><span class="line"><span class="comment"># pace_theme: pace-theme-center-simple</span></span><br><span class="line"><span class="attr">pace_theme:</span> <span class="string">pace-theme-minimal</span>  <span class="comment">#é»˜è®¤è®¾ç½®ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºä¸Šè¿°ä»»ä½•ä¸€ä¸ª</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®æœåŠ¡-day03-docker2</title>
    <url>/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker2/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>å¾®æœåŠ¡-day03-docker</title>
    <url>/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/</url>
    <content><![CDATA[<p>Linuxç¯å¢ƒæ­å»º</p>
<p><strong>1.å‡†å¤‡Linuxç¯å¢ƒ</strong></p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å‡†å¤‡ä¸€ä¸ªLinuxçš„ç³»ç»Ÿï¼Œæˆæœ¬æœ€ä½çš„æ–¹å¼å°±æ˜¯åœ¨æœ¬åœ°å®‰è£…ä¸€å°è™šæ‹Ÿæœºã€‚ä¸ºäº†ç»Ÿä¸€å­¦ä¹ ç¯å¢ƒï¼Œä¸ç®¡æ˜¯ä½¿ç”¨MacOSè¿˜æ˜¯Windowsç³»ç»Ÿçš„åŒå­¦ï¼Œéƒ½å»ºè®®å®‰è£…ä¸€å°è™šæ‹Ÿæœºã€‚</p>
<p>windowsé‡‡ç”¨VMwareï¼ŒMacåˆ™é‡‡ç”¨Fusion</p>
<p><strong>1.1. å®‰è£…VMware</strong></p>
<p>VMwareæ˜¯ä¸šç•Œæœ€å¥½ç”¨çš„è™šæ‹Ÿæœºè½¯ä»¶ä¹‹ä¸€ã€‚</p>
<p>windowsç‰ˆæœ¬çš„ç½‘ç«™å¦‚ä¸‹ï¼š</p>
<p><strong>[<strong><strong>è¯¥ç±»å‹çš„å†…å®¹æš‚ä¸æ”¯æŒä¸‹è½½</strong></strong>]</strong></p>
<p>Macä¸‹ä¹Ÿæœ‰å¯¹åº”ç‰ˆæœ¬ï¼Œå«åšVMware Fusionï¼š</p>
<p><strong>[<strong><strong>è¯¥ç±»å‹çš„å†…å®¹æš‚ä¸æ”¯æŒä¸‹è½½</strong></strong>]</strong></p>
<p>  ç‰¹åˆ«æ³¨æ„ï¼ŒWindows10ä»¥ä¸Šç‰ˆæœ¬æ“ä½œç³»ç»Ÿéœ€è¦ä¸‹è½½å®‰è£…VMware Workstation Pro16åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œå®‰è£…æ–¹å¼æ­¤å¤„ç•¥ã€‚  </p>
<p>å¦‚æœè‡ªå·±ç”µè„‘ä¸Šå·²ç»æœ‰äº†ä½ç‰ˆæœ¬çš„VMwareï¼Œåˆ™éœ€è¦å…ˆå¸è½½ï¼Œå†é‡æ–°å®‰è£…ã€‚å¸è½½è¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<p>*<em>1.1.1.<strong><strong>å¸è½½æ—§ç‰ˆ</strong></strong>VMware</em>*<strong>ï¼ˆå¯é€‰ï¼‰</strong></p>
<p>é¦–å…ˆï¼Œåœ¨æ§åˆ¶é¢æ¿æ‰¾åˆ°ç¨‹åºå’ŒåŠŸèƒ½é€‰é¡¹ï¼Œæ‰¾åˆ°VMwareï¼Œè¿›è¡Œå¸è½½æ“ä½œï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image002.gif" alt="img"></p>
<p>å¼¹å‡ºç¡®è®¤æ¡†, ç‚¹å‡»â€ä¸‹ä¸€æ­¥â€:</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image004.gif" alt="img"></p>
<p>ä¸‹ä¸€æ­¥ä¹‹å, é€‰æ‹©åˆ é™¤:</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image006.gif" alt="img"></p>
<p>æ¥ä¸‹æ¥ï¼ŒæŒ‰ç…§æç¤ºå®Œæˆå¸è½½æ“ä½œå³å¯ã€‚</p>
<p>å¸è½½å®Œæˆåï¼Œè¿˜éœ€è¦çœ‹çœ‹VMwareçš„å®‰è£…ç›®å½•æ˜¯å¦æœ‰æ—§æ•°æ®ï¼Œä¸€å¹¶æ¸…ç†æ‰ã€‚</p>
<p>æ¯”å¦‚å®‰è£…åœ¨*<em>C</em><em><strong>ç›˜çš„</strong></em>*Program Files(x86)**ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image008.gif" alt="img"></p>
<p>åˆ™éœ€è¦ç›´æ¥åˆ é™¤æ•´ä¸ªVMwareç›®å½•ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image010.gif" alt="img"></p>
<p>æ¥ä¸‹æ¥è¦æ¸…ç†æ³¨å†Œè¡¨ï¼š</p>
<p>é¦–å…ˆï¼ŒæŒ‰ä½Windows + R , åœ¨å¼¹å‡ºæ¡†ä¸­è¾“å…¥ â€œregeditâ€ è°ƒå‡ºæ³¨å†Œè¡¨ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image012.gif" alt="img"></p>
<p>è¿›å…¥æ³¨å†Œè¡¨ç¼–è¾‘å™¨ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image014.gif" alt="img"></p>
<p>æ‰“å¼€<strong>HKEY_CURRENT_USER</strong>æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°<strong>Software</strong>æ–‡ä»¶å¤¹å¹¶æ‰“å¼€</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image016.gif" alt="img"></p>
<p>æ‰¾åˆ°â€œVMware.Incâ€ï¼Œå³é”®åˆ é™¤ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image018.gif" alt="img"></p>
<p>*<em>1.1.2.<strong><strong>å®‰è£…</strong></strong>VMware</em>*</p>
<p>å®‰è£…æ­¥éª¤ç•¥ã€‚ã€‚</p>
<p>å®‰è£…ä»¥åå¯ä»¥å…è´¹è¯•ç”¨ï¼Œå¤§å®¶å¯ä»¥å»å®˜ç½‘è´­ä¹°æ­£ç‰ˆè®¸å¯è¯ï¼Œæˆ–è€…å»ç½‘ä¸Šçœ‹çœ‹æœ‰æ²¡æœ‰å¥½å¿ƒäººèµ é€ä½ ä¸€ä¸ªè®¸å¯è¯ã€‚å¯åŠ¨åçš„ç•Œé¢å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image020.gif" alt="img"></p>
<p>**1.1.3.**<strong>å¸¸è§é”™è¯¯</strong></p>
<p>å¦‚æœVMwareè™šæ‹Ÿæœºè¿è¡ŒæŠ¥é”™ï¼Œä¾‹å¦‚ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image022.gif" alt="img"></p>
<p>è¿™ä¸ªæ˜¯ç”±äºè‹±ç‰¹å°”çš„è™šæ‹ŸåŒ–æŠ€æœ¯, æ²¡æœ‰å¼€å¯, éœ€è¦è¿›å…¥ç³»ç»Ÿçš„BIOSç•Œé¢ , å¼€å¯è‹±ç‰¹å°”çš„è™šæ‹ŸåŒ–æŠ€æœ¯ ; ä¸åŒçš„ç”µè„‘å‹å· , è¿›å…¥BIOSç•Œé¢çš„æ–¹å¼ä¸åŒ, éœ€è¦ç™¾åº¦æŸ¥è¯¢ä¸€ä¸‹è‡ªå·±ç”µè„‘çš„å‹å· , å¦‚ä½•è¿›BIOS ;</p>
<p>windows10ç³»ç»Ÿå¯ä»¥å‚è€ƒ: <a href="https://blog.csdn.net/biu_code/article/details/107504627">https://blog.csdn.net/biu_code/article/details/107504627</a></p>
<p>ä»¥ThinkPadä¸ºä¾‹ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image024.gif" alt="img"></p>
<p>**1.2.**<strong>åˆ›å»ºè™šæ‹Ÿæœº</strong></p>
<p>Centos7æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªLinuxå‘è¡Œç‰ˆæœ¬ï¼Œåœ¨å›½å†…çš„ä½¿ç”¨æ¯”ä¾‹è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚</p>
<p>å¤§å®¶é¦–å…ˆè¦ä¸‹è½½ä¸€ä¸ªCentos7çš„isoæ–‡ä»¶ï¼Œæˆ‘åœ¨èµ„æ–™ä¸­ç»™å¤§å®¶å‡†å¤‡äº†ä¸€ä¸ªminiçš„ç‰ˆæœ¬ï¼Œä½“ç§¯ä¸åˆ°1Gï¼Œæ¨èå¤§å®¶ä½¿ç”¨ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image026.gif" alt="img"></p>
<p>æˆ‘ä»¬åœ¨VMwareã€Šä¸»é¡µã€‹ç•Œé¢ä¸­ç‚¹å‡»ã€Šåˆ›å»ºæ–°çš„è™šæ‹Ÿæœºã€‹æŒ‰é’®ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image028.gif" alt="img"></p>
<p>ç„¶åä¼šå¼¹å‡ºä¸€ä¸ªçª—å£ï¼Œæˆ‘ä»¬ç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image030.gif" alt="img"></p>
<p>ç„¶åé¡µé¢ä¸­é€‰æ‹©ä½ å‡†å¤‡å¥½çš„ISOæ–‡ä»¶ï¼Œç»§ç»­ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image032.gif" alt="img"></p>
<p>ç„¶åå¡«å†™è™šæ‹Ÿæœºçš„åç§°ä»¥åŠè™šæ‹Ÿæœºå°†æ¥ä¿å­˜çš„ä½ç½®ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image034.gif" alt="img"></p>
<p>å†æ¬¡ä¸‹ä¸€æ­¥ï¼Œå¡«å†™è™šæ‹Ÿæœºç£ç›˜å¤§å°ã€‚è¿™é‡Œå»ºè®®ç»™å¤§ä¸€ç‚¹ï¼Œå¦åˆ™å°†æ¥ä¸å¤Ÿç”¨è°ƒæ•´èµ·æ¥éº»çƒ¦ã€‚è€Œä¸”è¿™é‡Œè®¾ç½®å¤§å°å¹¶ä¸æ˜¯ç«‹åˆ»å ç”¨è¿™ä¹ˆå¤šï¼Œè€Œæ˜¯è®¾ç½®ä¸€ä¸ªä¸Šé™ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image036.gif" alt="img"></p>
<p>ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œç„¶åé€‰æ‹©è™šæ‹Ÿæœºç¡¬ä»¶è®¾ç½®ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image038.gif" alt="img"></p>
<p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­è®¾ç½®è™šæ‹Ÿæœºç¡¬ä»¶ï¼Œå»ºè®®CPUç»™åˆ°4æ ¸ï¼Œå†…å­˜ç»™åˆ°8Gï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image040.gif" alt="img"></p>
<p>é…ç½®å®Œæˆåï¼Œç‚¹å‡»å…³é—­ï¼Œå›åˆ°ä¸Šä¸€é¡µé¢ï¼Œç»§ç»­ç‚¹å‡»å®Œæˆï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image042.gif" alt="img"></p>
<p>è™šæ‹Ÿæœºå°±åˆ›å»ºå®Œæ¯•äº†ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image044.gif" alt="img"></p>
<p>*<em>1.3.<strong><strong>å®‰è£…</strong></strong>Centos7</em>*</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯åŠ¨åˆšåˆšåˆ›å»ºçš„è™šæ‹Ÿæœºï¼Œå¼€å§‹å®‰è£…Centos7ç³»ç»Ÿï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image046.gif" alt="img"></p>
<p>å¯åŠ¨åéœ€è¦é€‰æ‹©å®‰è£…èœå•ï¼Œå°†é¼ æ ‡ç§»å…¥é»‘çª—å£ä¸­åï¼Œå°†æ— æ³•å†ä½¿ç”¨é¼ æ ‡ï¼Œéœ€è¦æŒ‰ä¸Šä¸‹é”®é€‰æ‹©èœå•ã€‚é€‰ä¸­Install Centos 7 åæŒ‰ä¸‹å›è½¦ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image048.gif" alt="img"></p>
<p>ç„¶åä¼šæç¤ºæˆ‘ä»¬æŒ‰ä¸‹enteré”®ç»§ç»­ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image050.gif" alt="img"></p>
<p>è¿‡ä¸€ä¼šå„¿åï¼Œä¼šè¿›å…¥è¯­è¨€é€‰æ‹©èœå•ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨é¼ æ ‡é€‰æ‹©ã€‚é€‰æ‹©ä¸­æ–‡-ç®€ä½“ä¸­æ–‡ï¼Œç„¶åç»§ç»­ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image052.gif" alt="img"></p>
<p>æ¥ä¸‹æ¥ï¼Œä¼šè¿›å…¥å®‰è£…é…ç½®é¡µé¢ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image054.gif" alt="img"></p>
<p>é¼ æ ‡å‘ä¸‹æ»šåŠ¨åï¼Œæ‰¾åˆ°ç³»ç»Ÿ-å®‰è£…ä½ç½®é…ç½®ï¼Œç‚¹å‡»ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image056.gif" alt="img"></p>
<p>é€‰æ‹©åˆšåˆšæ·»åŠ çš„ç£ç›˜ï¼Œå¹¶ç‚¹å‡»å®Œæˆï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image058.gif" alt="img"></p>
<p>ç„¶åå›åˆ°é…ç½®é¡µé¢ï¼Œè¿™æ¬¡ç‚¹å‡»ã€Šç½‘ç»œå’Œä¸»æœºåã€‹ï¼š</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image060.gif" alt="img"></p>
<p>åœ¨ç½‘ç»œé¡µé¢åšä¸‹é¢çš„å‡ ä»¶äº‹æƒ…ï¼š</p>
<p>\1.    ä¿®æ”¹ä¸»æœºåä¸ºè‡ªå·±å–œæ¬¢çš„ä¸»æœºåï¼Œä¸è¦å‡ºç°ä¸­æ–‡å’Œç‰¹æ®Šå­—ç¬¦ï¼Œå»ºè®®ç”¨localhost</p>
<p>\2.    ç‚¹å‡»åº”ç”¨</p>
<p>\3.    å°†ç½‘ç»œè¿æ¥æ‰“å¼€</p>
<p>\4.    ç‚¹å‡»é…ç½®ï¼Œè®¾ç½®è¯¦ç»†ç½‘ç»œä¿¡æ¯</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image062.gif" alt="img"></p>
<p>æœ€å¥½ç”¨ä¸€ä¸ªæˆªå›¾è½¯ä»¶ï¼Œè®°ä½ä¸Šå›¾ä¸­çš„ç½‘ç»œè¯¦ç»†ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥çš„é…ç½®è¦å‚è€ƒï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image064.gif" alt="img"></p>
<p>ç‚¹å‡»é…ç½®æŒ‰é’®åï¼Œæˆ‘ä»¬éœ€è¦æŠŠç½‘å¡åœ°å€æ”¹ä¸ºé™æ€IPï¼Œè¿™æ ·å¯ä»¥é¿å…æ¯æ¬¡å¯åŠ¨è™šæ‹ŸæœºIPéƒ½å˜åŒ–ã€‚æ‰€æœ‰é…ç½®ç…§æ¬ä½ è‡ªå·±æˆªå›¾çš„ç½‘ç»œä¿¡æ¯å¡«å†™ï¼Œä¸è¦ç…§æŠ„æˆ‘çš„ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image066.gif" alt="img"></p>
<p>  ä¸Šå›¾ä¸­çš„å››ä¸ªä¿¡æ¯å‚è€ƒä¹‹å‰çš„<strong>ä»¥å¤ªç½‘</strong>**(ens33)**<strong>ç½‘å¡</strong>çš„æˆªå›¾ï¼Œä¸è¦ç…§æ¬æˆ‘çš„æ¥å†™ã€‚  </p>
<p>æœ€åï¼Œç‚¹å‡»å®ŒæˆæŒ‰é’®ï¼š</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image068.gif" alt="img"></p>
<p>å›åˆ°é…ç½®ç•Œé¢åï¼Œç‚¹å‡»å¼€å§‹å®‰è£…ï¼š</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image070.gif" alt="img"></p>
<p>æ¥ä¸‹æ¥éœ€è¦è®¾ç½®rootå¯†ç ï¼š</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image072.gif" alt="img"></p>
<p>å¡«å†™ä½ è¦ä½¿ç”¨çš„rootå¯†ç ï¼Œç„¶åç‚¹å‡»å®Œæˆï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image074.gif" alt="img"></p>
<p>æ¥ä¸‹æ¥ï¼Œè€å¿ƒç­‰å¾…å®‰è£…å³å¯ã€‚</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image076.gif" alt="img"></p>
<p>ç­‰å¾…å®‰è£…å®Œæˆåï¼Œç‚¹å‡»<strong>é‡å¯</strong>ï¼š</p>
<p><img src="file:///C:/Users/waterdance/AppData/Local/Packages/oice_16_974fa576_32c1d314_25f6/AC/Temp/msohtmlclip1/01/clip_image078.gif" alt="img"></p>
<p>è€å¿ƒç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œä¸è¦åšä»»ä½•æ“ä½œï¼Œè™šæ‹Ÿæœºå³å¯å¯åŠ¨å®Œæ¯•ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image080.gif" alt="img"></p>
<p>è¾“å…¥ç”¨æˆ·årootï¼Œç„¶åç‚¹å‡»å›è½¦ï¼Œä¼šè¦æ±‚ä½ è¾“å…¥å¯†ç ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image082.gif" alt="img"></p>
<p>æ­¤æ—¶ä½ è¦è¾“å…¥å¯†ç ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å¯†ç æ˜¯<strong>éšè—</strong>çš„ï¼Œè¾“å…¥äº†ä¹Ÿçœ‹ä¸è§ã€‚æ‰€ä»¥æ”¾å¿ƒè¾“å…¥ï¼Œå®Œæˆåå›è½¦å³å¯ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image084.gif" alt="img"></p>
<p>åªè¦å¯†ç è¾“å…¥æ­£ç¡®ï¼Œå°±å¯ä»¥æ­£å¸¸ç™»å½•ã€‚æ­¤æ—¶å¯ä»¥ç”¨å‘½ä»¤æµ‹è¯•è™šæ‹Ÿæœºç½‘ç»œæ˜¯å¦ç•…é€šï¼š</p>
<p>  Bash   ping  baidu.com  </p>
<p>å¦‚æœçœ‹åˆ°è¿™æ ·çš„ç»“æœä»£è¡¨ç½‘ç»œç•…é€šï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image086.gif" alt="img"></p>
<p>é»˜è®¤pingå‘½ä»¤ä¼šæŒç»­æ‰§è¡Œï¼ŒæŒ‰ä¸‹CTRL + Cåå‘½ä»¤å³å¯åœæ­¢ã€‚</p>
<p>**1.4.**<strong>è®¾ç½®è™šæ‹Ÿæœºå¿«ç…§</strong></p>
<p>åœ¨è™šæ‹Ÿæœºå®‰è£…å®Œæˆåï¼Œæœ€å¥½ç«‹åˆ»è®¾ç½®ä¸€ä¸ªå¿«ç…§ï¼Œè¿™æ ·ä¸€æ—¦å°†æ¥è™šæ‹Ÿæœºå‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿæ¢å¤ã€‚</p>
<p>æˆ‘ä»¬å…ˆåœæ­¢è™šæ‹Ÿæœºï¼Œç‚¹å‡»VMwareé¡¶éƒ¨èœå•ä¸­çš„æš‚åœ<strong>ä¸‹æ‹‰é€‰æ¡†</strong>ï¼Œé€‰æ‹©å…³é—­å®¢æˆ·æœºï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image088.gif" alt="img"></p>
<p>æ¥ç€ï¼Œç‚¹å‡»VMwareèœå•ä¸­çš„ğŸ”§æŒ‰é’®:</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image090.gif" alt="img"></p>
<p>ç„¶ååœ¨å¼¹å‡ºçš„å¿«ç…§ç®¡ç†çª—å£ä¸­ï¼Œç‚¹å‡»<strong>æ‹æ‘„å¿«ç…§</strong>ï¼Œå¡«å†™æ–°çš„å¿«ç…§ä¿¡æ¯ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image092.gif" alt="img"></p>
<p>å¿«ç…§æ‹æ‘„å®Œæˆäº†ï¼è€Œä¸”æˆ‘ä»¬å¯ä»¥åœ¨ä¸åŒé˜¶æ®µæ‹æ‘„å¤šä¸ªä¸åŒå¿«ç…§ä½œä¸ºå¤‡ä»½ï¼Œæ–¹ä¾¿åæœŸæ¢å¤æ•°æ®ã€‚</p>
<p>å‡å¦‚ä»¥åè™šæ‹Ÿæœºæ–‡ä»¶å—æŸï¼Œéœ€è¦æ¢å¤åˆ°åˆè¯†çŠ¶æ€çš„è¯ï¼Œå¯ä»¥é€‰ä¸­è¦æ¢å¤çš„å¿«ç…§ï¼Œç‚¹å‡»è½¬åˆ°å³å¯ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image094.gif" alt="img"></p>
<p><strong>2.SSH****å®¢æˆ·ç«¯</strong></p>
<p>åœ¨VMwareç•Œé¢ä¸­æ“ä½œè™šæ‹Ÿæœºéå¸¸ä¸å‹å¥½ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¨èä½¿ç”¨ä¸“é—¨çš„SSHå®¢æˆ·ç«¯ã€‚å¸‚é¢ä¸Šå¸¸è§çš„æœ‰ï¼š</p>
<p>â€¢     Xshellï¼šä¸ªäººå…è´¹ï¼Œå•†ä¸šæ”¶è´¹ï¼Œä¹‹å‰çˆ†å‡ºè¿‡æœ‰éšè—åé—¨ã€‚ä¸æ¨è</p>
<p>â€¢     Finshellï¼šåŸºç¡€åŠŸèƒ½å…è´¹ï¼Œé«˜çº§åŠŸèƒ½æ”¶è´¹ï¼ŒåŸºäºJavaï¼Œå†…å­˜å ç”¨è¾ƒé«˜ï¼ˆåœ¨1ä¸ªGå·¦å³ï¼‰ã€‚ä¸æ¨è</p>
<p>â€¢     MobarXtermï¼šåŸºç¡€åŠŸèƒ½å…è´¹ã€é«˜çº§åŠŸèƒ½æ”¶è´¹ã€‚å¼€æºã€åŠŸèƒ½å¼ºå¤§ã€å†…å­˜å ç”¨ä½ï¼ˆåªæœ‰10må·¦å³ï¼‰ï¼Œä½†æ˜¯ç•Œé¢ä¸å¤ªæ¼‚äº®ã€‚æ¨èä½¿ç”¨</p>
<p>*<em>2.1.<strong><strong>å®‰è£…</strong></strong>MobarXterm</em>*</p>
<p>è¿™é‡Œæˆ‘ä»¬ä¼šé€‰æ‹©å†…å­˜å ç”¨è¾ƒä½çš„MobarXtermä½œä¸ºSSHå®¢æˆ·ç«¯ï¼Œå…¶å®˜ç½‘åœ°å€ï¼š</p>
<p><strong>[<strong><strong>è¯¥ç±»å‹çš„å†…å®¹æš‚ä¸æ”¯æŒä¸‹è½½</strong></strong>]</strong></p>
<p>å®‰è£…å®Œæˆåç•Œé¢å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image096.gif" alt="img"></p>
<p>ç‚¹å‡»sessionæŒ‰é’®ï¼Œè¿›å…¥ä¼šè¯ç®¡ç†ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image098.gif" alt="img"></p>
<p>åœ¨å¼¹å‡ºçš„sessionç®¡ç†é¡µé¢ä¸­ï¼ŒæŒ‰ç…§ä¸‹å›¾å¡«å†™ä¿¡æ¯å¹¶ä¿å­˜ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image100.gif" alt="img"></p>
<p>ç‚¹å‡»OKåä¼šæç¤ºä½ æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ï¼Œè¯¢é—®ä½ æ˜¯ä¿¡ä»»è¿æ¥çš„æœåŠ¡ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image102.gif" alt="img"></p>
<p>é€‰æ‹©acceptä¹‹åï¼Œä¼šè¯¢é—®ä½ æ˜¯å¦è¦è®°ä½å¯†ç ï¼Œé€‰æ‹©yesï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image104.gif" alt="img"></p>
<p>ç´§æ¥ç€éœ€è¦ä½ è®¾ç½®ä¸€ä¸ªMobarXtermçš„å…¨å±€å¯†ç ç”¨äºåšå¯†ç ç®¡ç†ï¼Œå»ºè®®è®¾ç½®ä¸€ä¸ªä¸è™šæ‹Ÿæœºå¯†ç ä¸åŒçš„ï¼š</p>
<p>è¾“å…¥å¯†ç ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image106.gif" alt="img"></p>
<p>è¾“å…¥æˆåŠŸåï¼Œå°±ä¼šè¿æ¥æˆåŠŸï¼Œå¹¶è¿›å…¥æ“ä½œç•Œé¢äº†ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image108.gif" alt="img"></p>
<p>è¿™é‡Œéœ€è¦åšä¸€äº›åŸºç¡€çš„é…ç½®ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image110.gif" alt="img"></p>
<p>**2.2.**<strong>é…ç½®é»˜è®¤ç¼–è¾‘å™¨</strong></p>
<p>é¦–å…ˆå»ºè®®è®¾ç½®ä¸€ä¸‹é»˜è®¤ç¼–è¾‘å™¨ï¼Œè¿™æ ·æˆ‘ä»¬é€šè¿‡MobarXtermçš„FTPå·¥å…·æ‰“å¼€æ–‡ä»¶æ—¶ä¼šä»¥æŒ‡å®šçš„ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæ–¹ä¾¿ä¿®æ”¹ã€‚æˆ‘è¿™é‡Œé…ç½®çš„æ˜¯vscodeï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image112.gif" alt="img"></p>
<p>**2.3.**<strong>é…ç½®å³é”®ç²˜è´´</strong></p>
<p>å¤åˆ¶ç²˜è´´æ˜¯å¾ˆå¸¸ç”¨çš„é…ç½®ï¼ŒMobarXtermé»˜è®¤å·¦é”®é€‰ä¸­å³<strong>å¤åˆ¶</strong>ï¼Œä½†æ˜¯éœ€è¦é…ç½®å³é”®ç‚¹å‡»ä¸º<strong>ç²˜è´´ï¼š</strong></p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image114.gif" alt="img"></p>
<p>è¿™æ ·ï¼Œå¤åˆ¶å’Œç²˜è´´å¯ä»¥å…¨éƒ¨é€šè¿‡é¼ æ ‡æ“ä½œï¼Œæ— éœ€æŒ‰é”®ã€‚</p>
<p><strong>2.4.SSH****é…ç½®</strong></p>
<p>æ¥ä¸‹æ¥è¿˜æœ‰å‡ ä¸ªsshé…ç½®ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image116.gif" alt="img"></p>
<p>åˆ†åˆ«æ˜¯ï¼š</p>
<p>â€¢     é»˜è®¤çš„ç™»å½•ç”¨æˆ·</p>
<p>â€¢     sshä¿æŒè¿æ¥</p>
<p>â€¢     å–æ¶ˆè¿æ¥æˆåŠŸåçš„æ¬¢è¿banner</p>
<p>*<em>2.5.<strong><strong>å…³é—­</strong></strong>X-Server</em>*<strong>æœåŠ¡</strong></p>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰x-serverçš„éœ€æ±‚ï¼Œå› æ­¤å¯ä»¥é€‰æ‹©ä¸è¦è‡ªå¯åŠ¨ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image118.gif" alt="img"></p>
<p><strong>å®‰è£…****Docker</strong></p>
<p>æœ¬å®‰è£…æ•™ç¨‹å‚è€ƒDockerå®˜æ–¹æ–‡æ¡£ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p>
<p><strong>[<strong><strong>è¯¥ç±»å‹çš„å†…å®¹æš‚ä¸æ”¯æŒä¸‹è½½</strong></strong>]</strong></p>
<p>**1.**<strong>å¸è½½æ—§ç‰ˆ</strong></p>
<p>é¦–å…ˆå¦‚æœç³»ç»Ÿä¸­å·²ç»å­˜åœ¨æ—§çš„Dockerï¼Œåˆ™å…ˆå¸è½½ï¼š</p>
<p>  Shell   yum  remove docker \     docker-client \     docker-client-latest \     docker-common \     docker-latest \     docker-latest-logrotate \     docker-logrotate \     docker-engine  </p>
<p>*<em>2.<strong><strong>é…ç½®</strong></strong>Docker</em><em><strong>çš„</strong></em><em>yum</em>*<strong>åº“</strong></p>
<p>é¦–å…ˆè¦å®‰è£…ä¸€ä¸ªyumå·¥å…·</p>
<p>  Bash   yum  install -y yum-utils  </p>
<p>å®‰è£…æˆåŠŸåï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œé…ç½®Dockerçš„yumæºï¼š</p>
<p>  Bash   yum-config-manager  â€“add-repo <a href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a>  </p>
<p>*<em>3.<strong><strong>å®‰è£…</strong></strong>Docker</em>*</p>
<p>æœ€åï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…Docker</p>
<p>  Bash   yum  install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin  docker-compose-plugin  </p>
<p>**4.**<strong>å¯åŠ¨å’Œæ ¡éªŒ</strong></p>
<p>  Bash   #  å¯åŠ¨Docker   systemctl start docker      # åœæ­¢Docker   systemctl stop docker      # é‡å¯   systemctl restart docker      # è®¾ç½®å¼€æœºè‡ªå¯   systemctl enable docker      # æ‰§è¡Œdocker pså‘½ä»¤ï¼Œå¦‚æœä¸æŠ¥é”™ï¼Œè¯´æ˜å®‰è£…å¯åŠ¨æˆåŠŸ   docker ps  </p>
<p>**5.**<strong>é…ç½®é•œåƒåŠ é€Ÿ</strong></p>
<p>è¿™é‡Œä»¥é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿä¸ºä¾‹ã€‚</p>
<p>**5.1.**<strong>æ³¨å†Œé˜¿é‡Œäº‘è´¦å·</strong></p>
<p>é¦–å…ˆè®¿é—®é˜¿é‡Œäº‘ç½‘ç«™:</p>
<p><a href="https://www.aliyun.com/">https://www.aliyun.com/</a></p>
<p>æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚</p>
<p>**5.2.**<strong>å¼€é€šé•œåƒæœåŠ¡</strong></p>
<p>åœ¨é¦–é¡µçš„äº§å“ä¸­ï¼Œæ‰¾åˆ°é˜¿é‡Œäº‘çš„<strong>å®¹å™¨é•œåƒæœåŠ¡</strong>ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image002-17097250992521.gif" alt="img"></p>
<p>ç‚¹å‡»åè¿›å…¥æ§åˆ¶å°ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image004-17097250992532.gif" alt="img"></p>
<p>é¦–æ¬¡å¯èƒ½éœ€è¦é€‰æ‹©ç«‹åˆ»å¼€é€šï¼Œç„¶åè¿›å…¥æ§åˆ¶å°ã€‚</p>
<p>**5.3.**<strong>é…ç½®é•œåƒåŠ é€Ÿ</strong></p>
<p>æ‰¾åˆ°<strong>é•œåƒå·¥å…·</strong>ä¸‹çš„<strong>é•œåƒåŠ é€Ÿå™¨</strong>ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image006-17097250992534.gif" alt="img"></p>
<p>é¡µé¢å‘ä¸‹æ»šåŠ¨ï¼Œå³å¯æ‰¾åˆ°é…ç½®çš„æ–‡æ¡£è¯´æ˜ï¼š</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-docker/clip_image008-17097250992533.gif" alt="img"></p>
<p>å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<p>  Bash   #  åˆ›å»ºç›®å½•   mkdir -p &#x2F;etc&#x2F;docker      # å¤åˆ¶å†…å®¹ï¼Œæ³¨æ„æŠŠå…¶ä¸­çš„é•œåƒåŠ é€Ÿåœ°å€æ”¹æˆä½ è‡ªå·±çš„   tee &#x2F;etc&#x2F;docker&#x2F;daemon.json &lt;&lt;-â€˜EOFâ€™   {    â€œregistry-mirrorsâ€:  [â€œ<a href="https://xxxx.mirror.aliyuncs.com" ]">https://xxxx.mirror.aliyuncs.com&quot;]</a>   }   EOF      # é‡æ–°åŠ è½½é…ç½®   systemctl daemon-reload      # é‡å¯Docker   systemctl restart docker  </p>
]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®æœåŠ¡-day03-å…¥é—¨1</title>
    <url>/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-%E5%85%A5%E9%97%A81/</url>
    <content><![CDATA[<h1 id="å•ä½“æ¶æ„"><a href="#å•ä½“æ¶æ„" class="headerlink" title="å•ä½“æ¶æ„"></a>å•ä½“æ¶æ„</h1><p><strong>å¾®æœåŠ¡</strong>æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œå®ƒæ˜¯ä»¥ä¸“æ³¨äºå•ä¸€èŒè´£çš„å¾ˆå¤šå°å‹é¡¹ç›®ä¸ºåŸºç¡€ï¼Œç»„åˆå‡ºå¤æ‚çš„å¤§å‹åº”ç”¨ã€‚</p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-%E5%85%A5%E9%97%A81/image-20240306162511735.png" alt="image-20240306162511735"></p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-%E5%85%A5%E9%97%A81/image-20240306162522783.png" alt="image-20240306162522783"></p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-%E5%85%A5%E9%97%A81/image-20240306162530746.png" alt="image-20240306162530746"></p>
<p><img src="/2024/03/06/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day03-%E5%85%A5%E9%97%A81/image-20240306162542431.png" alt="image-20240306162542431"></p>
]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®æœåŠ¡-day02-SpringCloud02</title>
    <url>/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/</url>
    <content><![CDATA[<h1 id="Nacosé…ç½®ç®¡ç†"><a href="#Nacosé…ç½®ç®¡ç†" class="headerlink" title="Nacosé…ç½®ç®¡ç†"></a>Nacosé…ç½®ç®¡ç†</h1><h2 id="ç»Ÿä¸€é…ç½®ç®¡ç†"><a href="#ç»Ÿä¸€é…ç½®ç®¡ç†" class="headerlink" title="ç»Ÿä¸€é…ç½®ç®¡ç†"></a>ç»Ÿä¸€é…ç½®ç®¡ç†</h2><ul>
<li><p>é…ç½®æ›´æ”¹çƒ­æ›´æ–°</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305224009346.png" alt="image-20240305224009346"></p>
</li>
</ul>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305224130659.png" alt="image-20240305224130659"></p>
<p>Data IDçš„å‘½åè§„èŒƒï¼šuserservice-prod.yaml</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305224607825.png" alt="image-20240305224607825"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305224836105.png" alt="image-20240305224836105"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305224845391.png" alt="image-20240305224845391"></p>
<h2 id="å¾®æœåŠ¡é…ç½®æ‹‰å–"><a href="#å¾®æœåŠ¡é…ç½®æ‹‰å–" class="headerlink" title="å¾®æœåŠ¡é…ç½®æ‹‰å–"></a>å¾®æœåŠ¡é…ç½®æ‹‰å–</h2><p>åœ¨æ²¡æœ‰nacosä¹‹å‰ï¼Œé…ç½®è·å–çš„æ­¥éª¤ï¼š</p>
<ol>
<li>é¡¹ç›®å¯åŠ¨</li>
<li>è¯»å–æœ¬åœ°é…ç½®æ–‡ä»¶application.yaml</li>
<li>åˆ›å»ºspringå®¹å™¨</li>
<li>åŠ è½½bean</li>
</ol>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305225022405.png" alt="image-20240305225022405"></p>
<p>åœ¨æœ‰äº†nacosä¹‹åï¼Œé…ç½®çš„è·å–æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li>é¡¹ç›®å¯åŠ¨</li>
<li>å…ˆè¯»å–nacosä¸­é…ç½®æ–‡ä»¶</li>
<li>è¯»å–æœ¬åœ°é…ç½®æ–‡ä»¶application.yaml</li>
<li>åˆ›å»ºspringå®¹å™¨</li>
<li>åŠ è½½bean</li>
</ol>
<p><font color="red">è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå»å“ªå„¿è¯»å–nacosåœ°å€ï¼Œè¯»å–è°ï¼Œä¹‹å‰æˆ‘ä»¬æ˜¯å°†nacosåœ°å€æ”¾åœ¨äº†æœ¬åœ°é…ç½®æ–‡ä»¶application.ymlä¸­ï¼Œä½†æ˜¯ç°åœ¨æ˜¯å…ˆè¯»å–nacosåœ°å€ï¼Œå†è¯»å–æœ¬åœ°é…ç½®æ–‡ä»¶ã€‚</font></p>
<p><font color="red">è§£å†³åŠæ³•ï¼šä¸nacosåœ°å€å’Œé…ç½®æ–‡ä»¶ä¿¡æ¯æ”¾åœ¨bootstrap.yml</font></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305230658657.png" alt="image-20240305230658657"></p>
<ol>
<li><p>å¼•å…¥Nacosçš„é…ç½®ç®¡ç†å®¢æˆ·ç«¯ä¾èµ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--        nacosçš„é…ç½®ç®¡ç†ä¾èµ–--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨userserviceä¸­çš„resourceç›®å½•æ·»åŠ ä¸€ä¸ªbootstrap.ymlæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å¼•å¯¼æ–‡ä»¶ï¼Œä¼˜å…ˆçº§é«˜äºapplication.ymlï¼›</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240305225938225.png" alt="image-20240305225938225"></p>
<p>è¿™ä¸‰è€…å†³å®šäº†nacosçš„data Idã€‚</p>
</li>
</ol>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306003053003.png" alt="image-20240306003053003"></p>
<p><a href="https://blog.csdn.net/CSDN_user096A/article/details/131660704">Nacosæ‹‰å–é…ç½®ä¿¡æ¯å¤±è´¥ï¼Œ@Value exception is java.lang.IlleggalArgumentException: Could not resolve placeholder_could not resolve placeholder â€˜pattern.dateformatâ€™-CSDNåšå®¢</a></p>
<p><font color="red">æœ€å…³é”®çš„ä¸€æ­¥ï¼šæ·»åŠ bootstrapçš„ä¾èµ–é…ç½®</font></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>æ€»ç»“</strong></p>
<p>å°†é…ç½®äº¤ç»™Nacosç®¡ç†çš„æ­¥éª¤</p>
<ol>
<li>åœ¨Nacosä¸­æ·»åŠ é…ç½®æ–‡ä»¶</li>
<li>åœ¨å¾®æœåŠ¡ä¸­å¼•å…¥nacosçš„configä¾èµ–</li>
<li>åœ¨å¾®æœåŠ¡ä¸­æ·»åŠ bootstrap.ymlï¼Œé…ç½®nacosåœ°å€ã€å½“å‰ç¯å¢ƒã€æœåŠ¡åç§°ã€æ–‡ä»¶åç¼€åã€‚è¿™äº›å†³å®šäº†ç¨‹åºå¯åŠ¨æ—¶å»nacosè¯»å–å“ªä¸ªæ–‡ä»¶ã€‚</li>
</ol>
<h2 id="é…ç½®çƒ­æ›´æ–°"><a href="#é…ç½®çƒ­æ›´æ–°" class="headerlink" title="é…ç½®çƒ­æ›´æ–°"></a>é…ç½®çƒ­æ›´æ–°</h2><p>Nacosä¸­çš„é…ç½®æ–‡ä»¶å˜æ›´åï¼Œå¾®æœåŠ¡æ— éœ€é‡å¯å°±å¯ä»¥æ„ŸçŸ¥ã€‚ä¸è¿‡éœ€è¦é€šè¿‡ä¸‹é¢ä¸¤ç§é…ç½®å®ç°ï¼š</p>
<ul>
<li><p>æ–¹å¼ä¸€ï¼šåœ¨@Valueæ³¨å…¥çš„å˜é‡æ‰€åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£@RefreshScope</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306003722529.png" alt="image-20240306003722529"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306010955046.png" alt="image-20240306010955046"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306011007721.png" alt="image-20240306011007721"></p>
</li>
<li><p>æ–¹å¼äºŒï¼šä½¿ç”¨@ConfigurationPropertiesæ³¨è§£ï¼ˆé…ç½®å±æ€§ç±»ä¼šè¯»å–é…ç½®æ–‡ä»¶ä¸­å¯¹åº”é…ç½®çš„å€¼ï¼Œè€Œé…ç½®æ–‡ä»¶ç°åœ¨ä¸ä»…åŒ…æ‹¬æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œè¿˜åŒ…æ‹¬æ³¨å†Œä¸­å¿ƒçš„é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥è¿˜å¯ä»¥è¯»å–åˆ°æ³¨å†Œä¸­å¿ƒçš„é…ç½®ä¿¡æ¯ï¼‰</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306011501579.png" alt="image-20240306011501579"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306011533533.png" alt="image-20240306011533533"></p>
</li>
</ul>
<p><strong>æ€»ç»“</strong></p>
<p>Nacosé…ç½®æ›´æ”¹åï¼Œå¾®æœåŠ¡å¯ä»¥å®ç°çƒ­æ›´æ–°ï¼Œæ–¹å¼ï¼š</p>
<ol>
<li>é€šè¿‡@Valueæ³¨è§£æ³¨å…¥ï¼Œç»“åˆ@RefreshScopeæ¥åˆ·æ–°</li>
<li>é€šè¿‡@ConfigurationPropertiesæ³¨å…¥ï¼Œè‡ªåŠ¨åˆ·æ–°ï¼ˆå»ºè®®ä½¿ç”¨ï¼‰</li>
</ol>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>ä¸æ˜¯æ‰€æœ‰çš„é…ç½®éƒ½é€‚åˆæ”¾åˆ°é…ç½®ä¸­å¿ƒï¼Œç»´æŠ¤èµ·æ¥æ¯”è¾ƒéº»çƒ¦</li>
<li>ä¸å»ºè®®å°†ä¸€äº›å…³é”®å‚æ•°ï¼Œéœ€è¦è¿è¡Œæ—¶è°ƒæ•´çš„å‚æ•°æ”¾åˆ°nacosé…ç½®ä¸­å¿ƒï¼Œä¸€èˆ¬éƒ½æ˜¯è‡ªå®šä¹‰é…ç½®</li>
</ul>
<h2 id="é…ç½®å…±äº«"><a href="#é…ç½®å…±äº«" class="headerlink" title="é…ç½®å…±äº«"></a>é…ç½®å…±äº«</h2><p>å¾®æœåŠ¡çš„é…ç½®å…±äº«ï¼Œæœ‰ä¸€ä¸ªé…ç½®å±æ€§åœ¨ç”Ÿäº§ã€æµ‹è¯•ã€å¼€å‘ä¸­çš„å±æ€§å€¼å‡ä¸€è‡´ã€‚</p>
<p>å¾®æœåŠ¡å¯åŠ¨æ—¶ä¼šä»nacosè¯»å–å¤šä¸ªé…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li>[spring.application.name] - [spring.profile.active].yamlï¼Œä¾‹å¦‚ï¼šuserservice-dev.yaml</li>
<li>[spring.application.name].yamlï¼Œä¾‹å¦‚ï¼šuserservice.yaml</li>
</ul>
<p>æ— è®ºprofileå¦‚ä½•å˜åŒ–ï¼Œ[spring.application.name].yamlè¿™ä¸ªæ–‡ä»¶ä¸€å®šä¼šåŠ è½½ï¼Œå› æ­¤å¤šç¯å¢ƒå…±äº«é…ç½®å¯ä»¥å†™å…¥è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306012118919.png" alt="image-20240306012118919"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306012014949.png" alt="image-20240306012014949"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306012201885.png" alt="image-20240306012201885"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306012817828.png" alt="image-20240306012817828"></p>
<p>å°†8082ç«¯å£çš„æœåŠ¡æ”¹ä¸ºtestç¯å¢ƒ</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306013122441.png" alt="image-20240306013122441"></p>
<p><strong>8081å’Œ8082ç«¯å£çš„é…ç½®ä¿¡æ¯è¯»å–æƒ…å†µ</strong></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306013320250.png" alt="image-20240306013320250"></p>
<p>å¤šç§é…ç½®çš„ä¼˜å…ˆçº§ï¼š</p>
<ul>
<li>æœåŠ¡å-profile.yaml &gt; æœåŠ¡åç§°.yaml &gt; æœ¬åœ°é…ç½®</li>
</ul>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306013557099.png" alt="image-20240306013557099"></p>
<h2 id="æ­å»ºNacosé›†ç¾¤"><a href="#æ­å»ºNacosé›†ç¾¤" class="headerlink" title="æ­å»ºNacosé›†ç¾¤"></a>æ­å»ºNacosé›†ç¾¤</h2><p>Nacosç”Ÿäº§ç¯å¢ƒä¸‹ä¸€å®šè¦éƒ¨ç½²ä¸ºé›†ç¾¤çŠ¶æ€ã€‚</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306013652900.png" alt="image-20240306013652900"></p>
<h1 id="Nacosé›†ç¾¤æ­å»º"><a href="#Nacosé›†ç¾¤æ­å»º" class="headerlink" title="Nacosé›†ç¾¤æ­å»º"></a>Nacosé›†ç¾¤æ­å»º</h1><h1 id="1-é›†ç¾¤ç»“æ„å›¾"><a href="#1-é›†ç¾¤ç»“æ„å›¾" class="headerlink" title="1.é›†ç¾¤ç»“æ„å›¾"></a>1.é›†ç¾¤ç»“æ„å›¾</h1><p>å®˜æ–¹ç»™å‡ºçš„Nacosé›†ç¾¤å›¾ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210409210621117.png" alt="image-20210409210621117"></p>
<p>å…¶ä¸­åŒ…å«3ä¸ªnacosèŠ‚ç‚¹ï¼Œç„¶åä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ä»£ç†3ä¸ªNacosã€‚è¿™é‡Œè´Ÿè½½å‡è¡¡å™¨å¯ä»¥ä½¿ç”¨nginxã€‚</p>
<p>æˆ‘ä»¬è®¡åˆ’çš„é›†ç¾¤ç»“æ„ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210409211355037.png" alt="image-20210409211355037"></p>
<p>ä¸‰ä¸ªnacosèŠ‚ç‚¹çš„åœ°å€ï¼š</p>
<table>
<thead>
<tr>
<th>èŠ‚ç‚¹</th>
<th>ip</th>
<th>port</th>
</tr>
</thead>
<tbody><tr>
<td>nacos1</td>
<td>192.168.150.1</td>
<td>8845</td>
</tr>
<tr>
<td>nacos2</td>
<td>192.168.150.1</td>
<td>8846</td>
</tr>
<tr>
<td>nacos3</td>
<td>192.168.150.1</td>
<td>8847</td>
</tr>
</tbody></table>
<h1 id="2-æ­å»ºé›†ç¾¤"><a href="#2-æ­å»ºé›†ç¾¤" class="headerlink" title="2.æ­å»ºé›†ç¾¤"></a>2.æ­å»ºé›†ç¾¤</h1><p>æ­å»ºé›†ç¾¤çš„åŸºæœ¬æ­¥éª¤ï¼š</p>
<ul>
<li>æ­å»ºæ•°æ®åº“ï¼Œåˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„</li>
<li>ä¸‹è½½nacoså®‰è£…åŒ…</li>
<li>é…ç½®nacos</li>
<li>å¯åŠ¨nacosé›†ç¾¤</li>
<li>nginxåå‘ä»£ç†</li>
</ul>
<h2 id="2-1-åˆå§‹åŒ–æ•°æ®åº“"><a href="#2-1-åˆå§‹åŒ–æ•°æ®åº“" class="headerlink" title="2.1.åˆå§‹åŒ–æ•°æ®åº“"></a>2.1.åˆå§‹åŒ–æ•°æ®åº“</h2><p>Nacosé»˜è®¤æ•°æ®å­˜å‚¨åœ¨å†…åµŒæ•°æ®åº“Derbyä¸­ï¼Œä¸å±äºç”Ÿäº§å¯ç”¨çš„æ•°æ®åº“ã€‚</p>
<p>å®˜æ–¹æ¨èçš„æœ€ä½³å®è·µæ˜¯ä½¿ç”¨å¸¦æœ‰ä¸»ä»çš„é«˜å¯ç”¨æ•°æ®åº“é›†ç¾¤ï¼Œä¸»ä»æ¨¡å¼çš„é«˜å¯ç”¨æ•°æ®åº“å¯ä»¥å‚è€ƒ<strong>ä¼ æ™ºæ•™è‚²</strong>çš„åç»­é«˜æ‰‹è¯¾ç¨‹ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬ä»¥å•ç‚¹çš„æ•°æ®åº“ä¸ºä¾‹æ¥è®²è§£ã€‚</p>
<p>é¦–å…ˆæ–°å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œå‘½åä¸ºnacosï¼Œè€Œåå¯¼å…¥ä¸‹é¢çš„SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç§Ÿæˆ·å­—æ®µ&#x27;</span>,</span><br><span class="line">  `c_desc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `c_use` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `effect` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `type` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `c_schema` text,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = config_info_aggr   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_aggr` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `datum_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;datum_id&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å†…å®¹&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç§Ÿæˆ·å­—æ®µ&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;å¢åŠ ç§Ÿæˆ·å­—æ®µ&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = config_info_beta   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_beta` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `beta_ips` <span class="type">varchar</span>(<span class="number">1024</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;betaIps&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç§Ÿæˆ·å­—æ®µ&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info_beta&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = config_info_tag   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_info_tag` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `tag_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_id&#x27;</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;content&#x27;</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;md5&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  `src_user` text COMMENT <span class="string">&#x27;source user&#x27;</span>,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;source ip&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_info_tag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = config_tags_relation   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `config_tags_relation` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `tag_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_name&#x27;</span>,</span><br><span class="line">  `tag_type` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tag_type&#x27;</span>,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;data_id&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;group_id&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `nid` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`nid`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`),</span><br><span class="line">  KEY `idx_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;config_tag_relation&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = group_capacity   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `group_capacity` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®ID&#x27;</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;Group IDï¼Œç©ºå­—ç¬¦è¡¨ç¤ºæ•´ä¸ªé›†ç¾¤&#x27;</span>,</span><br><span class="line">  `quota` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `usage` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;ä½¿ç”¨é‡&#x27;</span>,</span><br><span class="line">  `max_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `max_aggr_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°ï¼Œï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `max_aggr_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `max_history_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æœ€å¤§å˜æ›´å†å²æ•°é‡&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_group_id` (`group_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;é›†ç¾¤ã€å„Groupå®¹é‡ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = his_config_info   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `his_config_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">64</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `nid` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `data_id` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `group_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `app_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;app_name&#x27;</span>,</span><br><span class="line">  `content` longtext <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `md5` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">  `src_user` text,</span><br><span class="line">  `src_ip` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `op_type` <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç§Ÿæˆ·å­—æ®µ&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`nid`),</span><br><span class="line">  KEY `idx_gmt_create` (`gmt_create`),</span><br><span class="line">  KEY `idx_gmt_modified` (`gmt_modified`),</span><br><span class="line">  KEY `idx_did` (`data_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;å¤šç§Ÿæˆ·æ”¹é€ &#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="comment">/*   æ•°æ®åº“å…¨å = nacos_config   */</span></span><br><span class="line"><span class="comment">/*   è¡¨åç§° = tenant_capacity   */</span></span><br><span class="line"><span class="comment">/******************************************/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tenant_capacity` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®ID&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;Tenant ID&#x27;</span>,</span><br><span class="line">  `quota` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `usage` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;ä½¿ç”¨é‡&#x27;</span>,</span><br><span class="line">  `max_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `max_aggr_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°&#x27;</span>,</span><br><span class="line">  `max_aggr_size` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#x27;</span>,</span><br><span class="line">  `max_history_count` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æœ€å¤§å˜æ›´å†å²æ•°é‡&#x27;</span>,</span><br><span class="line">  `gmt_create` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;ç§Ÿæˆ·å®¹é‡ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tenant_info` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `kp` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;kp&#x27;</span>,</span><br><span class="line">  `tenant_id` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_id&#x27;</span>,</span><br><span class="line">  `tenant_name` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;tenant_name&#x27;</span>,</span><br><span class="line">  `tenant_desc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;tenant_desc&#x27;</span>,</span><br><span class="line">  `create_source` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;create_source&#x27;</span>,</span><br><span class="line">  `gmt_create` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  `gmt_modified` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`),</span><br><span class="line">  KEY `idx_tenant_id` (`tenant_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;tenant_info&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `users` (</span><br><span class="line">	`username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	`password` <span class="type">varchar</span>(<span class="number">500</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`enabled` <span class="type">boolean</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `roles` (</span><br><span class="line">	`username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`role` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	<span class="keyword">UNIQUE</span> INDEX `idx_user_role` (`username` <span class="keyword">ASC</span>, `role` <span class="keyword">ASC</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `permissions` (</span><br><span class="line">    `role` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `resource` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `action` <span class="type">varchar</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">UNIQUE</span> INDEX `uk_role_permission` (`role`,`resource`,`action`) <span class="keyword">USING</span> BTREE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (username, password, enabled) <span class="keyword">VALUES</span> (<span class="string">&#x27;nacos&#x27;</span>, <span class="string">&#x27;$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu&#x27;</span>, <span class="literal">TRUE</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> roles (username, role) <span class="keyword">VALUES</span> (<span class="string">&#x27;nacos&#x27;</span>, <span class="string">&#x27;ROLE_ADMIN&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h2 id="2-2-ä¸‹è½½nacos"><a href="#2-2-ä¸‹è½½nacos" class="headerlink" title="2.2.ä¸‹è½½nacos"></a>2.2.ä¸‹è½½nacos</h2><p>nacosåœ¨GitHubä¸Šæœ‰ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/alibaba/nacos/tags%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%89%E6%8B%A9%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%AC%E4%B8%8B%E8%BD%BD%E3%80%82">https://github.com/alibaba/nacos/tagsï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ç‰ˆæœ¬ä¸‹è½½ã€‚</a></p>
<p>æœ¬ä¾‹ä¸­æ‰ç”¨1.4.1ç‰ˆæœ¬ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210409212119411.png" alt="image-20210409212119411"></p>
<h2 id="2-3-é…ç½®Nacos"><a href="#2-3-é…ç½®Nacos" class="headerlink" title="2.3.é…ç½®Nacos"></a>2.3.é…ç½®Nacos</h2><p>å°†è¿™ä¸ªåŒ…è§£å‹åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ä¸‹ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210402161843337.png" alt="image-20210402161843337"></p>
<p>ç›®å½•è¯´æ˜ï¼š</p>
<ul>
<li>binï¼šå¯åŠ¨è„šæœ¬</li>
<li>confï¼šé…ç½®æ–‡ä»¶</li>
</ul>
<p>è¿›å…¥nacosçš„confç›®å½•ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶cluster.conf.exampleï¼Œé‡å‘½åä¸ºcluster.confï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210409212459292.png" alt="image-20210409212459292"></p>
<p>ç„¶åæ·»åŠ å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">127.0.0.1:8845</span><br><span class="line">127.0.0.1.8846</span><br><span class="line">127.0.0.1.8847</span><br></pre></td></tr></table></figure>



<p>ç„¶åä¿®æ”¹application.propertiesæ–‡ä»¶ï¼Œæ·»åŠ æ•°æ®åº“é…ç½®</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.datasource.platform</span>=<span class="string">mysql</span></span><br><span class="line"></span><br><span class="line"><span class="attr">db.num</span>=<span class="string">1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">db.url.0</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="attr">db.user.0</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">db.password.0</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>



<h2 id="2-4-å¯åŠ¨"><a href="#2-4-å¯åŠ¨" class="headerlink" title="2.4.å¯åŠ¨"></a>2.4.å¯åŠ¨</h2><p>å°†nacosæ–‡ä»¶å¤¹å¤åˆ¶ä¸‰ä»½ï¼Œåˆ†åˆ«å‘½åä¸ºï¼šnacos1ã€nacos2ã€nacos3</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210409213335538.png" alt="image-20210409213335538"> </p>
<p>ç„¶ååˆ†åˆ«ä¿®æ”¹ä¸‰ä¸ªæ–‡ä»¶å¤¹ä¸­çš„application.propertiesï¼Œ</p>
<p>nacos1:</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8845</span></span><br></pre></td></tr></table></figure>

<p>nacos2:</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8846</span></span><br></pre></td></tr></table></figure>

<p>nacos3:</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8847</span></span><br></pre></td></tr></table></figure>



<p>ç„¶ååˆ†åˆ«å¯åŠ¨ä¸‰ä¸ªnacosèŠ‚ç‚¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">startup.cmd</span><br></pre></td></tr></table></figure>



<h2 id="2-5-nginxåå‘ä»£ç†"><a href="#2-5-nginxåå‘ä»£ç†" class="headerlink" title="2.5.nginxåå‘ä»£ç†"></a>2.5.nginxåå‘ä»£ç†</h2><p>æ‰¾åˆ°è¯¾å‰èµ„æ–™æä¾›çš„nginxå®‰è£…åŒ…ï¼š </p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210410103253355.png" alt="image-20210410103253355"> </p>
<p>è§£å‹åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ä¸‹ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20210410103322874.png" alt="image-20210410103322874"> </p>
<p>ä¿®æ”¹conf&#x2F;nginx.confæ–‡ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">upstream</span> nacos-cluster &#123;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">127.0.0.1:8845</span>;</span><br><span class="line">	<span class="attribute">server</span> <span class="number">127.0.0.1:8846</span>;</span><br><span class="line">	<span class="attribute">server</span> <span class="number">127.0.0.1:8847</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /nacos &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://nacos-cluster;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>è€Œååœ¨æµè§ˆå™¨è®¿é—®ï¼š<a href="http://localhost/nacos%E5%8D%B3%E5%8F%AF%E3%80%82">http://localhost/nacoså³å¯ã€‚</a></p>
<p>ä»£ç ä¸­application.ymlæ–‡ä»¶é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:80</span> <span class="comment"># Nacosåœ°å€</span></span><br></pre></td></tr></table></figure>



<h2 id="2-6-ä¼˜åŒ–"><a href="#2-6-ä¼˜åŒ–" class="headerlink" title="2.6.ä¼˜åŒ–"></a>2.6.ä¼˜åŒ–</h2><ul>
<li><p>å®é™…éƒ¨ç½²æ—¶ï¼Œéœ€è¦ç»™åšåå‘ä»£ç†çš„nginxæœåŠ¡å™¨è®¾ç½®ä¸€ä¸ªåŸŸåï¼Œè¿™æ ·åç»­å¦‚æœæœ‰æœåŠ¡å™¨è¿ç§»nacosçš„å®¢æˆ·ç«¯ä¹Ÿæ— éœ€æ›´æ”¹é…ç½®.</p>
</li>
<li><p>Nacosçš„å„ä¸ªèŠ‚ç‚¹åº”è¯¥éƒ¨ç½²åˆ°å¤šä¸ªä¸åŒæœåŠ¡å™¨ï¼Œåšå¥½å®¹ç¾å’Œéš”ç¦»</p>
</li>
</ul>
<h1 id="Feignè¿œç¨‹è°ƒç”¨"><a href="#Feignè¿œç¨‹è°ƒç”¨" class="headerlink" title="Feignè¿œç¨‹è°ƒç”¨"></a>Feignè¿œç¨‹è°ƒç”¨</h1><p>ä»£æ›¿restTemplateè°ƒç”¨</p>
<h2 id="Feignä»£æ›¿RestTemplate"><a href="#Feignä»£æ›¿RestTemplate" class="headerlink" title="Feignä»£æ›¿RestTemplate"></a>Feignä»£æ›¿RestTemplate</h2><p>å…ˆæ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬ä»¥å‰ä½¿ç”¨RestTemplateå‘èµ·è¿œç¨‹è°ƒç”¨çš„ä»£ç ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306114716134.png" alt="image-20240306114716134"></p>
<p>å­˜åœ¨ä¸‹é¢çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä»£ç å¯è¯»æ€§å·®ï¼Œç¼–ç ä½“éªŒä¸ç»Ÿä¸€</li>
<li>å¤æ‚çš„urléš¾ä»¥ç»´æŠ¤</li>
</ul>
<p>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„httpå®¢æˆ·ç«¯ï¼Œå®˜æ–¹åœ°å€ï¼š<a href="https://github.com/OpenFeign/feign">https://github.com/OpenFeign/feign</a></p>
<p>å…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬ä¼˜é›…çš„å®ç°httpè¯·æ±‚çš„å‘é€ï¼Œè§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306114940285.png" alt="image-20240306114940285"></p>
<p>ä½¿ç”¨Feignçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>å¼•å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--        feignå®¢æˆ·ç«¯ä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--åŠ å…¥spring-cloud-loadbalancerä¾èµ–--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨order-serviceçš„å¯åŠ¨ç±»æ·»åŠ æ³¨è§£å¼€å¯Feignçš„åŠŸèƒ½ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306115729311.png" alt="image-20240306115729311"></p>
</li>
<li><p>ç¼–å†™Feignçš„å®¢æˆ·ç«¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.order.clients;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.order.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FeignClient(&quot;userservice&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306120014392.png" alt="image-20240306120014392"></p>
</li>
<li><p>ä¸»è¦æ˜¯åŸºäºSpringMVCçš„æ³¨è§£æ¥å£°æ˜è¿œç¨‹è°ƒç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>è¯·æ±‚åç§°ï¼šuserservice</li>
<li>è¯·æ±‚æ–¹å¼ï¼šGET</li>
<li>è¯·æ±‚è·¯å¾„ï¼š&#x2F;user&#x2F;{id}</li>
<li>è¯·æ±‚å‚æ•°ï¼šLong id</li>
<li>è¿”å›å€¼ç±»å‹ï¼šUser</li>
</ul>
</li>
</ol>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306120656496.png" alt="image-20240306120656496"></p>
<p><font color="red">æ³¨æ„ï¼šæ—©æœŸçš„feignä¾èµ–ä¸­å¼•å…¥äº†ribbonï¼Œä½†æ˜¯æœ€æ–°ç‰ˆçš„feignå·²ç»ä¸ä½¿ç”¨ribbonåšè´Ÿè½½å‡è¡¡äº†ï¼Œæ‰€ä»¥åœ¨pom.xmlæ–‡ä»¶ä¸­è¦åšå¦‚ä¸‹ä¿®æ”¹ï¼š</font></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306123225620.png" alt="image-20240306123225620"></p>
<p>ç”±äºSpringCloud Feignåœ¨Hoxton.M2 RELEASEDç‰ˆæœ¬ä¹‹åä¸å†ä½¿ç”¨Ribbonè€Œæ˜¯ä½¿ç”¨spring-cloud-loadbalancerï¼Œæ‰€ä»¥ä¸å¼•å…¥spring-cloud-loadbalancerä¼šæŠ¥é”™<br><strong>è§£å†³æ–¹æ³•</strong><br>åŠ å…¥spring-cloud-loadbalancerä¾èµ– å¹¶ä¸”åœ¨nacosä¸­æ’é™¤ribbonä¾èµ–ï¼Œä¸ç„¶loadbalanceræ— æ•ˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!--åŠ å…¥spring-cloud-loadbalancerä¾èµ–--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-cloud-loadbalancer&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“</strong></p>
<p>Feignçš„ä½¿ç”¨æ­¥éª¤</p>
<ol>
<li>å¼•å…¥ä¾èµ–</li>
<li>æ·»åŠ @EnableFeignClientsæ³¨è§£</li>
<li>ç¼–å†™FeignClientæ¥å£</li>
<li>ä½¿ç”¨FeignClientä¸­å®šä¹‰çš„æ–¹æ³•ä»£æ›¿RestTemplate</li>
</ol>
<h2 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h2><p>Feginè¿è¡Œè‡ªå®šä¹‰é…ç½®æ¥è¦†ç›–é»˜è®¤é…ç½®ï¼Œå¯ä»¥ä¿®æ”¹çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>ä½œç”¨</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>feign.Logger.Level</td>
<td>ä¿®æ”¹æ—¥å¿—çº§åˆ«</td>
<td>åŒ…å«å››ç§ä¸åŒçš„çº§åˆ«ï¼šNONEã€BASICã€HEADERSã€FULL</td>
</tr>
<tr>
<td>fegin.codec.Decoder</td>
<td>å“åº”ç»“æœçš„è§£æå™¨</td>
<td>httpè¿œç¨‹è°ƒç”¨çš„ç»“æœåšè§£æï¼Œä¾‹å¦‚è§£æjsonå­—ç¬¦ä¸²åšjavaå¯¹è±¡</td>
</tr>
<tr>
<td>feign.codec.Encoder</td>
<td>è¯·æ±‚å‚æ•°ç¼–ç </td>
<td>å°†è¯·æ±‚å‚æ•°ç¼–ç ï¼Œä¾¿äºé€šè¿‡httpè¯·æ±‚å‘é€</td>
</tr>
<tr>
<td>feign.Contract</td>
<td>æ”¯æŒçš„æ³¨è§£æ ¼å¼</td>
<td>é»˜è®¤æ˜¯SpringMVCçš„æ³¨è§£</td>
</tr>
<tr>
<td>feign.Retryer</td>
<td>å¤±è´¥é‡è¯•æœºåˆ¶</td>
<td>è¯·æ±‚å¤±è´¥çš„é‡è¯•æœºåˆ¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰ï¼Œä¸è¿‡ä¼šä½¿ç”¨Ribbonçš„é‡è¯•</td>
</tr>
</tbody></table>
<p>ä¸€èˆ¬æˆ‘ä»¬éœ€è¦é…ç½®çš„å°±æ˜¯æ—¥å¿—çº§åˆ«ã€‚</p>
<p>é…ç½®Feignæ—¥å¿—æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<p>æ–¹å¼ä¸€ï¼šé…ç½®æ–‡ä»¶æ–¹å¼</p>
<ol>
<li><p>å…¨å±€ç”Ÿæ•ˆï¼ˆé’ˆå¯¹ä¸€åˆ‡è®¿é—®çš„å¾®æœåŠ¡éƒ½ç”Ÿæ•ˆï¼‰ï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306125024026.png" alt="image-20240306125024026"></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">logger-level:</span> <span class="string">FULL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å±€éƒ¨ç”Ÿæ•ˆï¼š</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306125038151.png" alt="image-20240306125038151"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306125316960.png" alt="image-20240306125316960"></p>
</li>
</ol>
<p>æ–¹å¼äºŒï¼šjavaä»£ç æ–¹å¼ï¼Œéœ€è¦å…ˆå£°æ˜ä¸€ä¸ªBeanï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.order.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> feign.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultFeignConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Logger.Level <span class="title function_">logLevel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Logger.Level.BASIC;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œåå¦‚æœæ˜¯å…¨å±€é…ç½®ï¼Œåˆ™æŠŠå®ƒæ”¾åˆ°@EnableFeignClientè¿™ä¸ªæ³¨è§£ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EnableFeignClients(defaultConfiguration = DefaultFeignConfiguration.class)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306125910273.png" alt="image-20240306125910273"></p>
<p>å¦‚æœæ˜¯å±€éƒ¨é…ç½®ï¼Œåˆ™æŠŠä»–æ”¾åˆ°FeignClientæ¥å£çš„@FeignClientè¿™ä¸ªæ³¨è§£ä¸­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;userservice&quot;,configuration = FeignClientProperties.FeignClientConfiguration.class)</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306130216664.png" alt="image-20240306130216664"></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>Feignçš„æ—¥å¿—é…ç½®</p>
<ol>
<li>æ–¹å¼ä¸€æ˜¯é…ç½®æ–‡ä»¶ï¼Œfeign.client.config.xxx.LoggerLevel<ol>
<li>å¦‚æœxxxæ˜¯defaultåˆ™ä»£è¡¨å…¨å±€</li>
<li>å¦‚æœxxxæ˜¯æœåŠ¡åç§°ï¼Œä¾‹å¦‚userserviceåˆ™ä»£è¡¨æŸæœåŠ¡</li>
</ol>
</li>
<li>æ–¹å¼äºŒæ˜¯Javaä»£ç é…ç½®Logger.Levelè¿™ä¸ªBean<ol>
<li>å¦‚æœåœ¨@EnableFeignClientsæ³¨è§£å£°æ˜åˆ™ä»£è¡¨å…¨å±€</li>
<li>å¦‚æœåœ¨@FeignClientæ³¨è§£ä¸­å£°æ˜åˆ™ä»£è¡¨æŸæœåŠ¡</li>
</ol>
</li>
</ol>
<h2 id="Feignä½¿ç”¨ä¼˜åŒ–"><a href="#Feignä½¿ç”¨ä¼˜åŒ–" class="headerlink" title="Feignä½¿ç”¨ä¼˜åŒ–"></a>Feignä½¿ç”¨ä¼˜åŒ–</h2><p>Feignåº•å±‚çš„å®¢æˆ·ç«¯å®ç°ï¼šï¼ˆæŠŠæˆ‘ä»¬çš„å£°æ˜å˜æˆhttpè¯·æ±‚ï¼Œæœ€ç»ˆå‘httpè¯·æ±‚è¿˜æ˜¯ä¼šç”¨åˆ°åˆ«çš„å®¢æˆ·ç«¯ï¼Œé»˜è®¤ç”¨çš„æ˜¯URLConnectionï¼‰</p>
<ul>
<li>URLConnectionï¼šé»˜è®¤å®ç°ï¼Œä¸æ”¯æŒè¿æ¥æ± </li>
<li>Apache HttpClientï¼šæ”¯æŒè¿æ¥æ± </li>
<li>OKHttpï¼šæ”¯æŒè¿æ¥æ± </li>
</ul>
<p>ä¸é€‚ç”¨è¿æ¥æ± ï¼Œé‚£ä¹ˆæ¯æ¬¡è¯·æ±‚éƒ½è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œèµ„æºæ¶ˆè€—æŒºå¤šã€‚</p>
<p>å› æ­¤ä¼˜åŒ–Feignçš„æ€§èƒ½ä¸»è¦åŒ…æ‹¬ï¼š</p>
<ol>
<li>ä½¿ç”¨è¿æ¥æ± ä»£æ›¿é»˜è®¤çš„URLConnection</li>
<li>æ—¥å¿—çº§åˆ«ï¼Œæœ€å¥½ç”¨basicæˆ–none</li>
</ol>
<p>Feignæ·»åŠ HttpClientçš„æ”¯æŒï¼š</p>
<p>å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.openfeign<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>feign-httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>é…ç½®è¿æ¥æ± ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">default:</span> <span class="comment"># defaultå…¨å±€çš„é…ç½®</span></span><br><span class="line">        <span class="attr">logger-level:</span> <span class="string">BASIC</span> <span class="comment"># æ—¥å¿—çº§åˆ«ï¼ŒBASICå°±æ˜¯åŸºæœ¬çš„è¯·æ±‚å’Œå“åº”ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">httpclient:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment"># å¼€å¯feignå¯¹HttpClientçš„æ”¯æŒ</span></span><br><span class="line">    <span class="attr">max-connections:</span> <span class="number">200</span> <span class="comment"># æœ€å¤§çš„è¿æ¥æ•°</span></span><br><span class="line">    <span class="attr">max-connections-per-route:</span> <span class="number">50</span> <span class="comment"># æ¯ä¸ªè·¯å¾„çš„æœ€å¤§è¿æ¥æ•°</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306131850349.png" alt="image-20240306131850349"></p>
<h2 id="æœ€ä½³å®è·µåˆ†æ"><a href="#æœ€ä½³å®è·µåˆ†æ" class="headerlink" title="æœ€ä½³å®è·µåˆ†æ"></a>æœ€ä½³å®è·µåˆ†æ</h2><p>ä¼ä¸šåœ¨ä¸æ–­è¸©å‘ä¸­æ€»ç»“çš„æœ€ä½³å®éªŒæ–¹å¼ã€‚</p>
<p>æ–¹å¼ä¸€ï¼ˆç»§æ‰¿ï¼‰ï¼šç»™æ¶ˆè´¹è€…çš„FeignClientå’Œæä¾›è€…çš„controllerå®šä¹‰ç»Ÿä¸€çš„çˆ¶æ¥å£ä½œä¸ºæ ‡å‡†ã€‚</p>
<blockquote>
<p>åœ¨Spring Cloudä¸­ï¼Œä½¿ç”¨Feignä½œä¸ºå£°æ˜å¼çš„HTTPå®¢æˆ·ç«¯æ¥è°ƒç”¨è¿œç¨‹æœåŠ¡æ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„è®¾è®¡æ¨¡å¼æ˜¯å®šä¹‰ä¸€ä¸ªå…¬å…±çš„æ¥å£ï¼Œç„¶ååœ¨æœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰å’ŒæœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ä¹‹é—´å…±äº«è¿™ä¸ªæ¥å£ã€‚æœåŠ¡æä¾›è€…å®ç°è¿™ä¸ªæ¥å£ï¼Œè€ŒæœåŠ¡æ¶ˆè´¹è€…é€šè¿‡Feign Clientä½¿ç”¨è¿™ä¸ªæ¥å£å‘èµ·è¿œç¨‹è°ƒç”¨ã€‚</p>
<p>å½“ä½ æåˆ°â€œçˆ¶æ¥å£å‚æ•°åˆ—è¡¨ä¸­çš„æ˜ å°„ä¸ä¼šè¢«ç»§æ‰¿â€ï¼Œè¿™é‡Œçš„â€œæ˜ å°„â€æŒ‡çš„æ˜¯ä½¿ç”¨Spring MVCæ³¨è§£ï¼ˆå¦‚<code>@RequestMapping</code>ã€<code>@GetMapping</code>ç­‰ï¼‰æ¥æ˜ å°„HTTPè¯·æ±‚è·¯å¾„åŠå…¶å‚æ•°çš„é…ç½®ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œçˆ¶æ¥å£å®šä¹‰äº†ä¸€ç³»åˆ—çš„æ–¹æ³•å’Œç›¸åº”çš„æ˜ å°„æ³¨è§£ï¼Œæ—¨åœ¨ä¸ºæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…æä¾›ä¸€ä¸ªç»Ÿä¸€çš„APIå¥‘çº¦ã€‚</p>
<p>ç¼ºç‚¹æ˜¯ï¼Œå°½ç®¡æœåŠ¡æ¶ˆè´¹è€…å’ŒæœåŠ¡æä¾›è€…éƒ½ç»§æ‰¿äº†è¿™ä¸ªçˆ¶æ¥å£ï¼Œä½¿å¾—æœåŠ¡çš„æ–¹æ³•ç­¾åä¿æŒä¸€è‡´ï¼Œä½†æ˜¯ç»§æ‰¿è‡ªçˆ¶æ¥å£çš„æ–¹æ³•åœ¨å­æ¥å£ï¼ˆå®ç°ç±»ï¼‰ä¸­å¹¶ä¸ä¼šè‡ªåŠ¨ç»§æ‰¿å…¶æ˜ å°„æ³¨è§£ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿æœåŠ¡æ¶ˆè´¹è€…å’ŒæœåŠ¡æä¾›è€…éƒ½å®ç°äº†ç›¸åŒçš„æ–¹æ³•ï¼ŒæœåŠ¡æä¾›è€…è¿˜æ˜¯éœ€è¦æ˜¾å¼åœ°åœ¨å…¶æ§åˆ¶å™¨ï¼ˆControllerï¼‰æ–¹æ³•ä¸Šé‡æ–°å£°æ˜è¿™äº›æ˜ å°„æ³¨è§£ï¼Œä»¥ç¡®ä¿Springèƒ½å¤Ÿæ­£ç¡®åœ°å°†HTTPè¯·æ±‚æ˜ å°„åˆ°ç›¸åº”çš„æ–¹æ³•ä¸Šã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹çš„å…·ä½“å½±å“æ˜¯ï¼š</p>
<ol>
<li><strong>ä»£ç å†—ä½™</strong>ï¼šæœåŠ¡æä¾›è€…éœ€è¦åœ¨æ§åˆ¶å™¨ä¸­é‡å¤å£°æ˜è·¯å¾„å’Œå‚æ•°æ˜ å°„ï¼Œå³ä½¿è¿™äº›å·²ç»åœ¨å…±äº«çš„æ¥å£ä¸­å®šä¹‰è¿‡ã€‚</li>
<li><strong>ç»´æŠ¤æˆæœ¬æé«˜</strong>ï¼šå¦‚æœå…±äº«æ¥å£çš„å®šä¹‰å‘ç”Ÿå˜åŒ–ï¼ŒæœåŠ¡æä¾›è€…éœ€è¦æ‰‹åŠ¨æ›´æ–°æ§åˆ¶å™¨ä¸­çš„æ˜ å°„æ³¨è§£ï¼Œè¿™å¢åŠ äº†ç»´æŠ¤çš„å¤æ‚æ€§å’Œå‡ºé”™çš„é£é™©ã€‚</li>
</ol>
</blockquote>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306150829020.png" alt="image-20240306150829020"></p>
<p>æ–¹å¼äºŒï¼ˆæŠ½å–ï¼‰ï¼šå°†FeignClientæŠ½å–ä¸ºç‹¬ç«‹æ¨¡å—ï¼Œå¹¶ä¸”å°†æ¥å£ç›¸å…³çš„POJOï¼Œé»˜è®¤çš„Feigné…ç½®éƒ½æ”¾åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œæä¾›ç»™æ‰€æœ‰æ¶ˆè´¹è€…ä½¿ç”¨ã€‚</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306151345971.png" alt="image-20240306151345971"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306151409095.png" alt="image-20240306151409095"></p>
<h2 id="å®ç°Feignæœ€ä½³å®è·µ"><a href="#å®ç°Feignæœ€ä½³å®è·µ" class="headerlink" title="å®ç°Feignæœ€ä½³å®è·µ"></a>å®ç°Feignæœ€ä½³å®è·µ</h2><p>å®ç°æœ€ä½³å®è·µæ–¹å¼äºŒçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>é¦–å…ˆåˆ›å»ºä¸€ä¸ªmoduleï¼Œå‘½åä¸ºfeign-apiï¼Œç„¶åå¼•å…¥feignçš„starterä¾èµ–</li>
<li>å°†order-serviceä¸­ç¼–å†™çš„UserClientã€Userã€DefaultFeignConfigurationéƒ½å¤åˆ¶åˆ°feign-apié¡¹ç›®ä¸­</li>
<li>åœ¨order-serviceä¸­å¼•å…¥feign-apiçš„ä¾èµ–</li>
<li>ä¿®æ”¹order-serviceä¸­çš„æ‰€æœ‰ä¸ä¸Šè¿°ä¸‰ä¸ªç»„ä»¶æœ‰å…³çš„importéƒ¨åˆ†ï¼Œæ”¹æˆå¯¼å…¥feign-apiä¸­çš„åŒ…</li>
<li>é‡å¯æµ‹è¯•</li>
</ol>
<p>å½“å®šä¹‰çš„FeignClientä¸åœ¨SpringBootApplicationçš„æ‰«æåŒ…èŒƒå›´æ—¶ï¼Œè¿™äº›FeignClientæ— æ³•ä½¿ç”¨ã€‚æœ‰ä¸¤ç§æ–¹å¼è§£å†³ï¼š</p>
<p>æ–¹å¼ä¸€ï¼šæŒ‡å®šFeignClientæ‰€åœ¨åŒ…</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306153035072.png" alt="image-20240306153035072"></p>
<p>æ–¹å¼äºŒï¼šæŒ‡å®šFeignClientå­—èŠ‚ç ï¼ˆä¸ªäººæ¨èï¼‰</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306153042951.png" alt="image-20240306153042951"></p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306154309373.png" alt="image-20240306154309373"></p>
<h1 id="GatewayæœåŠ¡ç½‘å…³"><a href="#GatewayæœåŠ¡ç½‘å…³" class="headerlink" title="GatewayæœåŠ¡ç½‘å…³"></a>GatewayæœåŠ¡ç½‘å…³</h1><p>å¾®æœåŠ¡å†…éƒ¨è°ƒç”¨ä½¿ç”¨Feignå³å¯ï¼Œä½†æ˜¯å¤–éƒ¨è°ƒç”¨è¦ä½¿ç”¨ç½‘å…³èº«ä»½è®¤è¯ï¼Œç¡®ä¿å®‰å…¨ã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦ç½‘å…³ï¼Ÿ</p>
<p>ç½‘å…³åŠŸèƒ½ï¼š</p>
<ul>
<li>èº«ä»½è®¤è¯å’Œæƒé™æ ¡éªŒ</li>
<li>æœåŠ¡è·¯ç”±ã€è´Ÿè½½å‡è¡¡</li>
<li>è¯·æ±‚é™æµ</li>
</ul>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306154754436.png" alt="image-20240306154754436"></p>
<p>åœ¨SpringCloudä¸­ç½‘å…³çš„å®ç°åŒ…æ‹¬ä¸¤ç§ï¼š</p>
<ul>
<li>gateway</li>
<li>zuul</li>
</ul>
<p>Zuulæ˜¯åŸºäºServletçš„å®ç°ï¼Œå±äºé˜»å¡å¼ç¼–ç¨‹ã€‚è€ŒSpringCloudGatewayåˆ™æ˜¯åŸºäºSpring5ä¸­æä¾›çš„WebFluxï¼Œå±äºæ˜¯å“åº”å¼ç¼–ç¨‹çš„å®ç°ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<p><img src="/2024/03/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day02-SpringCloud02/image-20240306154943029.png" alt="image-20240306154943029"></p>
<h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><p>æ­å»ºç½‘å…³æœåŠ¡çš„æ­¥éª¤ï¼š</p>
<ol>
<li><p>åˆ›å»ºæ–°çš„moduleï¼Œå¼•å…¥SpringCloudGatewayçš„ä¾èµ–å’Œnacosçš„æœåŠ¡å‘ç°ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-ribbon<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™è·¯ç”±é…ç½®åŠnacosåœ°å€</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">10010</span> <span class="comment"># ç½‘å…³ç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">gateway</span> <span class="comment"># æœåŠ¡åç§°</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment"># nacosåœ°å€</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span> <span class="comment"># ç½‘å…³è·¯ç”±é…ç½®</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">user-service</span> <span class="comment"># è·¯ç”±idï¼Œè‡ªå®šä¹‰ï¼Œåªè¦å”¯ä¸€å³å¯</span></span><br><span class="line">          <span class="comment"># url: http:127.0.0.1:8081 # è·¯ç”±çš„ç›®æ ‡åœ°å€ httpå°±æ˜¯å›ºå®šåœ°å€</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://userservice</span> <span class="comment"># è·¯ç”±çš„ç›®æ ‡åœ°å€ lbå°±æ˜¯è´Ÿè½½å‡è¡¡ã€‚åé¢è·ŸæœåŠ¡åç§°</span></span><br><span class="line">          <span class="attr">predicates:</span> <span class="comment"># è·¯ç”±æ–­è¨€ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­è¯·æ±‚æ˜¯å¦ç¬¦åˆè·¯ç”±è§„åˆ™çš„æ¡ä»¶</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/user/**</span> <span class="comment"># è¿™ä¸ªæ˜¯æŒ‰ç…§è·¯å¾„åŒ¹é…ï¼Œåªè¦ä»¥/user/å¼€å¤´å°±ç¬¦åˆè¦æ±‚</span></span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
  </entry>
  <entry>
    <title>å¾®æœåŠ¡-day01-SpringCloud01</title>
    <url>/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/</url>
    <content><![CDATA[<h1 id="è®¤è¯†å¾®æœåŠ¡"><a href="#è®¤è¯†å¾®æœåŠ¡" class="headerlink" title="è®¤è¯†å¾®æœåŠ¡"></a>è®¤è¯†å¾®æœåŠ¡</h1><p><strong>å•ä½“æ¶æ„</strong></p>
<p><strong>å•ä½“æ¶æ„</strong>ï¼šå°†ä¸šåŠ¡çš„æ‰€æœ‰åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼€å‘ï¼Œæ‰“åŒ…æˆä¸€ä¸ªåŒ…éƒ¨ç½²ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li><p>æ¶æ„ç®€å•</p>
</li>
<li><p>éƒ¨ç½²æˆæœ¬ä½</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304222010702.png" alt="image-20240304222010702"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304222021542.png" alt="image-20240304222021542"></p>
</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>è€¦åˆåº¦é«˜</li>
</ul>
<p><strong>åˆ†å¸ƒå¼æ¶æ„</strong></p>
<p><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šæ ¹æ®ä¸šåŠ¡åŠŸèƒ½å¯¹ç³»ç»Ÿè¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ªä¸šåŠ¡æ¨¡å—ä½œä¸ºç‹¬ç«‹é¡¹ç›®å¼€å‘ï¼Œç§°ä¸ºä¸€ä¸ªæœåŠ¡ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>é™ä½æœåŠ¡è€¦åˆ</li>
<li>æœ‰åˆ©äºæœåŠ¡å‡çº§æ‹“å±•</li>
</ul>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304222326798.png" alt="image-20240304222326798"></p>
<p><strong>æœåŠ¡æ²»ç†</strong></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304222345181.png" alt="image-20240304222345181"></p>
<p>å•ä½“æœåŠ¡æ—¶ï¼Œå„ä¸ªæ¨¡å—ä¹‹é—´æ˜¯å¯ä»¥ç›´æ¥è°ƒç”¨ä»£ç çš„ï¼Œä½†æ˜¯åˆ†å¸ƒå¼æ¶æ„ä¹‹åï¼Œä¸åŒæ¨¡å—ä¹‹é—´çš„ä»£ç æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨çš„ã€‚</p>
<p>åˆ†å¸ƒå¼æ¶æ„è¦è€ƒè™‘çš„é—®é¢˜ï¼š</p>
<ul>
<li>æœåŠ¡æ‹†åˆ†ç²’åº¦å¦‚ä½•ï¼Ÿ</li>
<li>æœåŠ¡é›†ç¾¤åœ°å€å¦‚ä½•ç»´æŠ¤ï¼Ÿ</li>
<li>æœåŠ¡ä¹‹é—´å¦‚ä½•å®ç°è¿œç¨‹è°ƒç”¨ï¼Ÿ</li>
<li>æœåŠ¡å¥åº·çŠ¶æ€å¦‚ä½•æ„ŸçŸ¥ï¼Ÿ</li>
</ul>
<p><strong>å¾®æœåŠ¡</strong></p>
<p>å¾®æœåŠ¡æ˜¯ä¸€ç§ç»è¿‡è‰¯å¥½æ¶æ„è®¾è®¡çš„<strong>åˆ†å¸ƒå¼</strong>æ¶æ„æ–¹æ¡ˆï¼Œå¾®æœåŠ¡æ¶æ„ç‰¹å¾ï¼š</p>
<ul>
<li>å•ä¸€èŒè´£ï¼šå¾®æœåŠ¡æ‹†åˆ†åŠ›åº¦æ›´å°ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯¹åº”å”¯ä¸€çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œåšåˆ°å•ä¸€èŒè´£ï¼Œé¿å…é‡å¤å¼€å‘</li>
<li>é¢å‘æœåŠ¡ï¼šå¾®æœåŠ¡å¯¹å¤–æš´éœ²ä¸šåŠ¡æ¥å£</li>
<li>è‡ªæ²»ï¼šå›¢é˜Ÿç‹¬ç«‹ã€æŠ€æœ¯ç‹¬ç«‹ã€æ•°æ®ç‹¬ç«‹ã€éƒ¨ç½²ç‹¬ç«‹</li>
<li>éš”ç¦»æ€§å¼ºï¼šæœåŠ¡è°ƒç”¨åšå¥½éš”ç¦»ã€å®¹é”™ã€é™çº§ï¼Œé¿å…å‡ºç°çº§è”é—®é¢˜</li>
</ul>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304223012163.png" alt="image-20240304223012163"></p>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>å•ä½“æ¶æ„ç‰¹ç‚¹ï¼Ÿ</p>
<ul>
<li>ç®€å•æ–¹ä¾¿ï¼Œé«˜åº¦è€¦åˆï¼Œæ‰©å±•æ€§å·®ï¼Œé€‚åˆå°å‹é¡¹ç›®ã€‚ä¾‹å¦‚ï¼šå­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</li>
</ul>
<p>åˆ†å¸ƒå¼æ¶æ„ç‰¹ç‚¹ï¼Ÿ</p>
<ul>
<li>æ¾è€¦åˆï¼Œæ‰©å±•æ€§å¥½ï¼Œä½†æ¶æ„å¤æ‚ï¼Œéš¾åº¦å¤§ã€‚é€‚åˆå¤§å‹äº’è”ç½‘é¡¹ç›®ï¼Œä¾‹å¦‚ï¼šäº¬ä¸œã€æ·˜å®</li>
</ul>
<p>å¾®æœåŠ¡ï¼šä¸€ç§è‰¯å¥½çš„åˆ†å¸ƒå¼æ¶æ„æ–¹æ¡ˆ</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ‹†åˆ†ç²’åº¦æ›´å°ã€æœåŠ¡æ›´ç‹¬ç«‹ã€è€¦åˆåº¦æ›´ä½</li>
<li>ç¼ºç‚¹ï¼šæ¶æ„éå¸¸å¤æ‚ï¼Œè¿ç»´ã€ç›‘æ§ã€éƒ¨ç½²éš¾åº¦æé«˜</li>
</ul>
<h2 id="å¾®æœåŠ¡ç»“æ„"><a href="#å¾®æœåŠ¡ç»“æ„" class="headerlink" title="å¾®æœåŠ¡ç»“æ„"></a><strong>å¾®æœåŠ¡ç»“æ„</strong></h2><p>å¾®æœåŠ¡è¿™ç§æ–¹æ¡ˆéœ€è¦æŠ€æœ¯æ¡†æ¶æ¥è½åœ°ï¼Œå…¨çƒçš„äº’è”ç½‘å…¬å¸éƒ½åœ¨ç§¯æå°è¯•è‡ªå·±çš„å¾®æœåŠ¡è½åœ°æŠ€æœ¯ã€‚åœ¨å›½å†…æœ€çŸ¥åçš„å°±æ˜¯SpringCloudå’Œé˜¿é‡Œå·´å·´çš„Dubboã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304223338889.png" alt="image-20240304223338889"></p>
<h2 id="å¾®æœåŠ¡æŠ€æœ¯å¯¹æ¯”"><a href="#å¾®æœåŠ¡æŠ€æœ¯å¯¹æ¯”" class="headerlink" title="å¾®æœåŠ¡æŠ€æœ¯å¯¹æ¯”"></a><strong>å¾®æœåŠ¡æŠ€æœ¯å¯¹æ¯”</strong></h2><table>
<thead>
<tr>
<th></th>
<th>Dubbo</th>
<th>SpringCloud</th>
<th>SpringCloudAlibaba</th>
</tr>
</thead>
<tbody><tr>
<td><strong>æ³¨å†Œä¸­å¿ƒ</strong></td>
<td>zookeeperã€Redis</td>
<td>Eurekaã€Consul</td>
<td>Nacosã€Eureka</td>
</tr>
<tr>
<td><strong>æœåŠ¡è¿œç¨‹è°ƒç”¨</strong></td>
<td>Dubboåè®®</td>
<td>Feign(httpåè®®)</td>
<td>Dubboã€Feign</td>
</tr>
<tr>
<td><strong>é…ç½®ä¸­å¿ƒ</strong></td>
<td>æ— </td>
<td>SpringCloudConfig</td>
<td>SpringCloudConfigã€Nacos</td>
</tr>
<tr>
<td><strong>æœåŠ¡ç½‘å…³</strong></td>
<td>æ— </td>
<td>SpringCloudGatewayã€Zuul</td>
<td>SpringCloudGatewayã€Zuul</td>
</tr>
<tr>
<td><strong>æœåŠ¡ç›‘æ§å’Œä¿æŠ¤</strong></td>
<td>dubbo-adminï¼ŒåŠŸèƒ½å¼±</td>
<td>Hystrix</td>
<td>Sentinel</td>
</tr>
</tbody></table>
<h2 id="ä¼ä¸šéœ€æ±‚"><a href="#ä¼ä¸šéœ€æ±‚" class="headerlink" title="ä¼ä¸šéœ€æ±‚"></a><strong>ä¼ä¸šéœ€æ±‚</strong></h2><p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304224025830.png" alt="image-20240304224025830"></p>
<h2 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h2><ul>
<li><p>SpringCloudæ˜¯ç›®å‰å›½å†…ä½¿ç”¨æœ€å¹¿æ³›çš„å¾®æœåŠ¡æ¡†æ¶ã€‚å®˜ç½‘åœ°å€ï¼š<a href="https://spring.io/projects/spring-cloud%E3%80%82">https://spring.io/projects/spring-cloudã€‚</a></p>
</li>
<li><p>SpringCloudé›†æˆäº†å„ç§å¾®æœåŠ¡åŠŸèƒ½ç»„ä»¶ï¼Œå¹¶åŸºäºSpringBootå®ç°äº†è¿™äº›ç»„ä»¶çš„è‡ªåŠ¨è£…é…ï¼Œä»è€Œæä¾›äº†è‰¯å¥½çš„å¼€ç®±å³ç”¨ä½“éªŒï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304224755309.png" alt="image-20240304224755309"></p>
</li>
</ul>
<h3 id="è®¤è¯†å¾®æœåŠ¡-1"><a href="#è®¤è¯†å¾®æœåŠ¡-1" class="headerlink" title="è®¤è¯†å¾®æœåŠ¡"></a>è®¤è¯†å¾®æœåŠ¡</h3><p>SpringCloudä¸SpringBootçš„ç‰ˆæœ¬å…¼å®¹å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240304224900377.png" alt="image-20240304224900377"></p>
<p>æˆ‘ä»¬è¯¾å ‚ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯Hoxton.SR10ï¼Œå› æ­¤å¯¹åº”çš„SpringBootç‰ˆæœ¬æ˜¯2.3.xç‰ˆæœ¬ã€‚</p>
<h1 id="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„æ¡ˆä¾‹"><a href="#åˆ†å¸ƒå¼æœåŠ¡æ¶æ„æ¡ˆä¾‹" class="headerlink" title="åˆ†å¸ƒå¼æœåŠ¡æ¶æ„æ¡ˆä¾‹"></a>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„æ¡ˆä¾‹</h1><h2 id="æœåŠ¡æ‹†åˆ†åŠè¿œç¨‹è°ƒç”¨"><a href="#æœåŠ¡æ‹†åˆ†åŠè¿œç¨‹è°ƒç”¨" class="headerlink" title="æœåŠ¡æ‹†åˆ†åŠè¿œç¨‹è°ƒç”¨"></a>æœåŠ¡æ‹†åˆ†åŠè¿œç¨‹è°ƒç”¨</h2><p>éœ€æ±‚æ˜¯æŸ¥è¯¢è®¢å•ï¼ŒåŒæ—¶ä¹Ÿè¦è·å–ç”¨æˆ·å’Œå•†å“å…³è”ä¿¡æ¯ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305110043023.png" alt="image-20240305110043023"></p>
<p><strong>æœåŠ¡æ‹†åˆ†æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ol>
<li>ä¸åŒå¾®æœåŠ¡ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡</li>
<li>å¾®æœåŠ¡æ•°æ®ç‹¬ç«‹ï¼Œä¸è¦è®¿é—®å…¶ä»–å¾®æœåŠ¡çš„æ•°æ®åº“</li>
<li>å¾®æœåŠ¡å¯ä»¥å°†è‡ªå·±çš„ä¸šåŠ¡æš´éœ²ä¸ºå€Ÿå£ï¼Œä¾›å…¶ä»–å¾®æœåŠ¡ä½¿ç”¨</li>
</ol>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305110236577.png" alt="o"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305125822645.png" alt="l"></p>
<p>è¿™è¾¹cloud_userå’Œcloud_orderåˆ†åˆ«å­˜æ”¾äº†å…·ä½“çš„è¡¨å†…å®¹</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305130639108.png" alt="image-20240305130639108"></p>
<p>Cloud_orderæ•°æ®åº“å’Œè¡¨ç»“æ„</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Navicat Premium Data Transfer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Source Server         : local</span></span><br><span class="line"><span class="comment"> Source Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Source Server Version : 50622</span></span><br><span class="line"><span class="comment"> Source Host           : localhost:3306</span></span><br><span class="line"><span class="comment"> Source Schema         : heima</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Target Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Target Server Version : 50622</span></span><br><span class="line"><span class="comment"> File Encoding         : 65001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Date: 01/04/2021 14:57:18</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> cloud_order ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for tb_order</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `tb_order`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_order`  (</span><br><span class="line">                             `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;è®¢å•id&#x27;</span>,</span><br><span class="line">                             `user_id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">                             `name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å•†å“åç§°&#x27;</span>,</span><br><span class="line">                             `price` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å•†å“ä»·æ ¼&#x27;</span>,</span><br><span class="line">                             `num` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;å•†å“æ•°é‡&#x27;</span>,</span><br><span class="line">                             <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">                             <span class="keyword">UNIQUE</span> INDEX `username`(`name`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">109</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> Compact;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of tb_order</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">101</span>, <span class="number">1</span>, <span class="string">&#x27;Apple è‹¹æœ iPhone 12 &#x27;</span>, <span class="number">699900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">102</span>, <span class="number">2</span>, <span class="string">&#x27;é›…è¿ª yadea æ–°å›½æ ‡ç”µåŠ¨è½¦&#x27;</span>, <span class="number">209900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">103</span>, <span class="number">3</span>, <span class="string">&#x27;éª†é©¼ï¼ˆCAMELï¼‰ä¼‘é—²è¿åŠ¨é‹å¥³&#x27;</span>, <span class="number">43900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">104</span>, <span class="number">4</span>, <span class="string">&#x27;å°ç±³10 åŒæ¨¡5G éªé¾™865&#x27;</span>, <span class="number">359900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">105</span>, <span class="number">5</span>, <span class="string">&#x27;OPPO Reno3 Pro åŒæ¨¡5G è§†é¢‘åŒé˜²æŠ–&#x27;</span>, <span class="number">299900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">106</span>, <span class="number">6</span>, <span class="string">&#x27;ç¾çš„ï¼ˆMidea) æ–°èƒ½æ•ˆ å†·é™æ˜ŸII &#x27;</span>, <span class="number">544900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">107</span>, <span class="number">2</span>, <span class="string">&#x27;è¥¿æ˜Š/SIHOO äººä½“å·¥å­¦ç”µè„‘æ¤…å­&#x27;</span>, <span class="number">79900</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_order` <span class="keyword">VALUES</span> (<span class="number">108</span>, <span class="number">3</span>, <span class="string">&#x27;æ¢µç­ï¼ˆFAMDBANNï¼‰ä¼‘é—²ç”·é‹&#x27;</span>, <span class="number">31900</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>Cloud_useræ•°æ®åº“å’Œå¯¹åº”è¡¨ç»“æ„</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> Navicat Premium Data Transfer</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Source Server         : local</span></span><br><span class="line"><span class="comment"> Source Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Source Server Version : 50622</span></span><br><span class="line"><span class="comment"> Source Host           : localhost:3306</span></span><br><span class="line"><span class="comment"> Source Schema         : heima</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Target Server Type    : MySQL</span></span><br><span class="line"><span class="comment"> Target Server Version : 50622</span></span><br><span class="line"><span class="comment"> File Encoding         : 65001</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> Date: 01/04/2021 14:57:18</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">create database <span class="keyword">if</span> not exists cloud_user;</span><br><span class="line"></span><br><span class="line">SET NAMES utf8mb4;</span><br><span class="line"><span class="type">SET</span> <span class="variable">FOREIGN_KEY_CHECKS</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Table structure <span class="keyword">for</span> tb_user</span><br><span class="line">-- ----------------------------</span><br><span class="line">DROP TABLE IF EXISTS `tb_user`;</span><br><span class="line">CREATE TABLE `tb_user`  (</span><br><span class="line">                            `id` bigint(<span class="number">20</span>) NOT NULL AUTO_INCREMENT,</span><br><span class="line">                            `username` varchar(<span class="number">100</span>) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT <span class="string">&#x27;æ”¶ä»¶äºº&#x27;</span>,</span><br><span class="line">                            `address` varchar(<span class="number">255</span>) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL COMMENT <span class="string">&#x27;åœ°å€&#x27;</span>,</span><br><span class="line">                            PRIMARY <span class="title function_">KEY</span> <span class="params">(`id`)</span> USING BTREE,</span><br><span class="line">                            UNIQUE INDEX `username`(`username`) USING BTREE</span><br><span class="line">) ENGINE = <span class="type">InnoDB</span> <span class="variable">AUTO_INCREMENT</span> <span class="operator">=</span> <span class="number">109</span> <span class="type">CHARACTER</span> <span class="variable">SET</span> <span class="operator">=</span> <span class="type">utf8</span> <span class="variable">COLLATE</span> <span class="operator">=</span> <span class="type">utf8_general_ci</span> <span class="variable">ROW_FORMAT</span> <span class="operator">=</span> Compact;</span><br><span class="line"></span><br><span class="line">-- ----------------------------</span><br><span class="line">-- Records of tb_user</span><br><span class="line">-- ----------------------------</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">1</span>, <span class="string">&#x27;æŸ³å²©&#x27;</span>, <span class="string">&#x27;æ¹–å—çœè¡¡é˜³å¸‚&#x27;</span>);</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">2</span>, <span class="string">&#x27;æ–‡äºŒç‹—&#x27;</span>, <span class="string">&#x27;é™•è¥¿çœè¥¿å®‰å¸‚&#x27;</span>);</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">3</span>, <span class="string">&#x27;åæ²‰é±¼&#x27;</span>, <span class="string">&#x27;æ¹–åŒ—çœåå °å¸‚&#x27;</span>);</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">4</span>, <span class="string">&#x27;å¼ å¿…æ²‰&#x27;</span>, <span class="string">&#x27;å¤©æ´¥å¸‚&#x27;</span>);</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">5</span>, <span class="string">&#x27;éƒ‘çˆ½çˆ½&#x27;</span>, <span class="string">&#x27;è¾½å®çœæ²ˆé˜³å¸‚å¤§ä¸œåŒº&#x27;</span>);</span><br><span class="line">INSERT INTO `tb_user` VALUES (<span class="number">6</span>, <span class="string">&#x27;èŒƒå…µå…µ&#x27;</span>, <span class="string">&#x27;å±±ä¸œçœé’å²›å¸‚&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">SET</span> <span class="variable">FOREIGN_KEY_CHECKS</span> <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<p>æ€»ç»“ï¼š</p>
<ol>
<li>å¾®æœåŠ¡éœ€è¦æ ¹æ®ä¸šåŠ¡æ¨¡å—æ‹†åˆ†ï¼Œåšåˆ°å•ä¸€èŒè´£ï¼Œä¸è¦é‡å¤å¼€å‘ç›¸åŒä¸šåŠ¡</li>
<li>å¾®æœåŠ¡å¯ä»¥å°†ä¸šåŠ¡æš´éœ²ä¸ºæ¥å£ï¼Œä¾›å…¶ä»–å¾®æœåŠ¡ä½¿ç”¨</li>
<li>ä¸åŒå¾®æœåŠ¡éƒ½åº”è¯¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“</li>
</ol>
<h2 id="æ¡ˆä¾‹ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•åŠŸèƒ½"><a href="#æ¡ˆä¾‹ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•åŠŸèƒ½" class="headerlink" title="æ¡ˆä¾‹ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•åŠŸèƒ½"></a>æ¡ˆä¾‹ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•åŠŸèƒ½</h2><p>éœ€æ±‚ï¼šæ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•çš„åŒæ—¶ï¼ŒæŠŠè®¢å•æ‰€å±çš„ç”¨æˆ·ä¿¡æ¯ä¸€èµ·è¿”å›</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305131615122.png" alt="image-20240305131615122"></p>
<p><font color="red">æˆ‘ä»¬ä»æµè§ˆå™¨å¯ä»¥è®¿é—®ä¸åŒæ¨¡å—ï¼Œé‚£åŒä¸€ä¸ªæ¨¡å—èƒ½ä¸èƒ½ç”¨ç±»ä¼¼çš„æ–¹å¼è®¿é—®å¦ä¸€ä¸ªæ¨¡å—ï¼Œè·å–éœ€è¦çš„æ•°æ®å‘¢ï¼Ÿ</font></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305131727010.png" alt="image-20240305131727010"></p>
<p>è¦æƒ³å®ç°è·¨æœåŠ¡è¿œç¨‹è°ƒç”¨ï¼Œå…¶å®æ˜¯å‘é€Httpè¯·æ±‚ï¼Œé¦–å…ˆè¦å‘Springå®¹å™¨æ³¨å…¥RestTemplateå¯¹è±¡ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305132430060.png" alt="image-20240305132430060"></p>
<p>åˆ©ç”¨ResTemplateå¯¹è±¡ä¸­çš„getForObjectæ–¹æ³•ï¼Œå‘Šè¯‰è¯¥å¯¹è±¡è¯·æ±‚çš„æµè§ˆè·¯å¾„å’Œè¿”å›çš„æ•°æ®çš„æ•°æ®ç±»å‹ã€‚ä¿®æ”¹order-serviceä¸­çš„OrderServiceçš„queryOrderByIdæ–¹æ³•ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305132532322.png" alt="image-20240305132532322"></p>
<p>æ€»ç»“ï¼š</p>
<ol>
<li>å¾®æœåŠ¡è°ƒç”¨æ–¹å¼<ul>
<li>åŸºäºRestTemplateå‘èµ·çš„httpè¯·æ±‚å®ç°è¿œç¨‹è°ƒç”¨</li>
<li>httpè¯·æ±‚åšè¿œç¨‹è°ƒç”¨æ˜¯ä¸è¯­è¨€æ— å…³çš„è°ƒç”¨ï¼Œåªè¦çŸ¥é“å¯¹æ–¹çš„ipã€ç«¯å£ã€æ¥å£è·¯å¾„ã€è¯·æ±‚å‚æ•°å³å¯ã€‚</li>
</ul>
</li>
</ol>
<h1 id="Eureka"><a href="#Eureka" class="headerlink" title="Eureka"></a>Eureka</h1><h2 id="æä¾›è€…ä¸æ¶ˆè´¹è€…"><a href="#æä¾›è€…ä¸æ¶ˆè´¹è€…" class="headerlink" title="æä¾›è€…ä¸æ¶ˆè´¹è€…"></a>æä¾›è€…ä¸æ¶ˆè´¹è€…</h2><ul>
<li>æœåŠ¡æä¾›è€…ï¼šä¸€æ¬¡ä¸šåŠ¡ä¸­ï¼Œè¢«å…¶ä»–å¾®æœåŠ¡è°ƒç”¨çš„æœåŠ¡ã€‚ï¼ˆæä¾›æ¥å£ç»™å…¶ä»–å¾®æœåŠ¡ï¼‰</li>
<li>æœåŠ¡æ¶ˆè´¹è€…ï¼šä¸€æ¬¡ä¸šåŠ¡ä¸­ï¼Œè°ƒç”¨å…¶ä»–å¾®æœåŠ¡çš„æœåŠ¡ã€‚ï¼ˆè°ƒç”¨å…¶ä»–å¾®æœåŠ¡æä¾›çš„æ¥å£ï¼‰</li>
<li>æä¾›è€…å’Œæ¶ˆè´¹è€…è§’è‰²å…¶å®æ˜¯<strong>ç›¸å¯¹</strong>çš„</li>
</ul>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305132830113.png" alt="image-20240305132830113"></p>
<p>æ€è€ƒï¼šæœåŠ¡Aè°ƒç”¨äº†æœåŠ¡Bï¼ŒæœåŠ¡Bè°ƒç”¨äº†æœåŠ¡Cï¼Œé‚£ä¹ˆæœåŠ¡Bæ˜¯ä»€ä¹ˆè§’è‰²å‘¢ï¼Ÿ</p>
<p><font color="red">ä¸€ä¸ªæœåŠ¡æ—¢å¯ä»¥æ˜¯æä¾›è€…ä¹Ÿå¯ä»¥æ˜¯æ¶ˆè´¹è€…ã€‚</font></p>
<h2 id="è¿œç¨‹è°ƒç”¨çš„é—®é¢˜"><a href="#è¿œç¨‹è°ƒç”¨çš„é—®é¢˜" class="headerlink" title="è¿œç¨‹è°ƒç”¨çš„é—®é¢˜"></a>è¿œç¨‹è°ƒç”¨çš„é—®é¢˜</h2><p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305133142579-17096167028611.png" alt="image-20240305133142579"></p>
<p>æ¶ˆè´¹è€…å‘æä¾›è€…è¯·æ±‚æœåŠ¡æ—¶ï¼Œè¯·æ±‚åœ°å€æ˜¯ç¡¬ç¼–ç çš„æ–¹å¼ã€‚</p>
<ol>
<li><p>å¯¹äºç»´æŠ¤è¯·æ±‚åœ°å€å¾ˆå›°éš¾ã€‚</p>
</li>
<li><p>ä¸ºäº†åº”å¯¹é«˜å¹¶å‘ï¼ŒuseræœåŠ¡å¯èƒ½ä¼šéƒ¨ç½²ä¸ºå¤šå®ä¾‹ï¼Œå½¢æˆä¸€ä¸ªé›†ç¾¤ï¼Œè¿™ä¸ªæ—¶å€™ç¡¬ç¼–ç è¯¥å†™è°çš„åœ°å€å‘¢ï¼Ÿ</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305133409858.png" alt="image-20240305133409858"></p>
</li>
</ol>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<p>æœåŠ¡æ¶ˆè´¹è€…è¯¥å¦‚ä½•è·å–æœåŠ¡æä¾›è€…çš„åœ°å€ä¿¡æ¯ï¼Ÿ</p>
<ul>
<li>æœåŠ¡æä¾›è€…å¯åŠ¨æ—¶å‘eurekaæ³¨å†Œè‡ªå·±çš„ä¿¡æ¯</li>
<li>eurekaä¿å­˜è¿™äº›ä¿¡æ¯</li>
<li>æ¶ˆè´¹è€…æ ¹æ®æœåŠ¡åç§°å‘eurekaæ‹‰å–æä¾›è€…ä¿¡æ¯</li>
</ul>
<p>å¦‚æœæœ‰å¤šä¸ªæœåŠ¡æä¾›è€…ï¼Œæ¶ˆè´¹è€…è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
<ul>
<li>æœåŠ¡æ¶ˆè´¹è€…åˆ©ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»æœåŠ¡åˆ—è¡¨ä¸­æŒ‘é€‰ä¸€ä¸ª</li>
</ul>
<p>æ¶ˆè´¹è€…å¦‚ä½•å¾—çŸ¥æœåŠ¡æä¾›è€…çš„å¥åº·çŠ¶æ€ï¼Ÿ</p>
<ul>
<li>æœåŠ¡æä¾›è€…æ¯éš”30ç§’å‘EurekaServerå‘é€å¿ƒè·³è¯·æ±‚ï¼ŒæŠ¥å‘Šå¥åº·çŠ¶æ€</li>
<li>eurekaä¼šæ›´æ–°è®°å½•æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¿ƒè·³ä¸æ­£å¸¸ä¼šè¢«å‰”é™¤</li>
<li>æ¶ˆè´¹è€…å°±å¯ä»¥æ‹‰å–åˆ°æœ€æ–°çš„æ¶ˆæ¯</li>
</ul>
<h2 id="eurekaåŸç†"><a href="#eurekaåŸç†" class="headerlink" title="eurekaåŸç†"></a>eurekaåŸç†</h2><p>eureka-serverï¼šæ³¨å†Œä¸­å¿ƒï¼ˆè®°å½•å’Œç®¡ç†å¾®æœåŠ¡ï¼‰</p>
<p>eureka-clientï¼šå®¢æˆ·ç«¯</p>
<ol>
<li><p>åªè¦æ˜¯eurekaçš„å®¢æˆ·ç«¯ï¼Œæ¯ä¸€ä¸ªæœåŠ¡å¯åŠ¨æ—¶éƒ½ä¼šå‘eureka-serveræ³¨å†ŒæœåŠ¡ä¿¡æ¯ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305133643568.png" alt="image-20240305133643568"></p>
</li>
<li><p>æœåŠ¡æ¶ˆè´¹è€…ä¼šå»æ‹‰å–æœåŠ¡user-serviceçš„ä¿¡æ¯ï¼Œåˆ©ç”¨è´Ÿè½½å‡è¡¡çš„æ–¹å¼ä»ä¸­é€‰æ‹©ä¸€ä¸ªé“¾æ¥è¿œç¨‹è°ƒç”¨æœåŠ¡æä¾›è€…æä¾›çš„æ–¹æ³•ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305134002828.png" alt="image-20240305134002828"></p>
</li>
<li><p>æœåŠ¡æä¾›è€…æ¯éš”30ç§’ä¼šå‘æ³¨å†Œä¸­å¿ƒä¸­æ›´æ–°æœåŠ¡ä¿¡æ¯</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305134036204.png" alt="image-20240305134036204"></p>
</li>
</ol>
<p><strong>æ€»ç»“ï¼š</strong></p>
<p>åœ¨Eurekaæ¶æ„ä¸­ï¼Œå¾®æœåŠ¡è§’è‰²æœ‰ä¸¤ç±»ï¼š</p>
<ul>
<li>EurekaServerï¼šæœåŠ¡ç«¯ï¼Œæ³¨å†Œä¸­å¿ƒ<ul>
<li>è®°å½•æœåŠ¡ä¿¡æ¯</li>
<li>å¿ƒè·³ç›‘æ§</li>
</ul>
</li>
<li>EurekaClientï¼šå®¢æˆ·ç«¯<ul>
<li>Providerï¼šæœåŠ¡æä¾›è€…ï¼Œä¾‹å¦‚æ¡ˆä¾‹ä¸­çš„user-service<ul>
<li>æ³¨å†Œè‡ªå·±çš„ä¿¡æ¯åˆ°EurekaServer</li>
<li>æ¯éš”30ç§’å‘EurekaServerå‘é€å¿ƒè·³</li>
</ul>
</li>
<li>Consumerï¼šæœåŠ¡æ¶ˆè´¹è€…ï¼Œä¾‹å¦‚æ¡ˆä¾‹ä¸­çš„order-service<ul>
<li>æ ¹æ®æœåŠ¡åç§°ä»EurekaServerä¸­æ‹‰å»æœåŠ¡åˆ—è¡¨</li>
<li>åŸºäºæœåŠ¡åˆ—è¡¨åšè´Ÿè½½å‡è¡¡ï¼Œé€‰ä¸­ä¸€ä¸ªå¾®æœåŠ¡åå‘èµ·è¿œç¨‹è°ƒç”¨</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="æ­å»ºEurekaService"><a href="#æ­å»ºEurekaService" class="headerlink" title="æ­å»ºEurekaService"></a>æ­å»ºEurekaService</h2><p><strong>åŠ¨æ‰‹å®è·µ</strong></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305134609345.png" alt="image-20240305134609345"></p>
<p>æ­å»ºEurekaServeræœåŠ¡æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>åˆ›å»ºé¡¹ç›®ï¼Œå¼•å…¥spring-cloud-starter-netflix-eureka-serverçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ @EnableEurekaServeræ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.server.EnableEurekaServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EurekaApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(EurekaApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ application.ymlæ–‡ä»¶ï¼Œç¼–å†™ä¸‹é¢çš„é…ç½®ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">10086</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eurekaserver</span> <span class="comment"># eurekaçš„æœåŠ¡åç§°</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span> <span class="comment"># eurekaçš„åœ°å€ä¿¡æ¯</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:10086/eureka/</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p><font color="red">eurekaä¹Ÿæ˜¯å¾®æœåŠ¡ï¼Œå®ƒå¯åŠ¨æ—¶ä¼šå°†è‡ªå·±æ³¨å†Œåˆ°eurekaä¸Šã€‚å¤šä¸ªeurekaé›†ç¾¤ä¼šç›¸äº’äº¤æµã€‚</font></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305144137305.png" alt="image-20240305144137305"></p>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ol>
<li>æ­å»ºEurekaServer<ul>
<li>å¼•å…¥eureka-serverä¾èµ–</li>
<li>æ·»åŠ @EnableEurekaServeræ³¨è§£</li>
<li>åœ¨application.ymlä¸­é…ç½®eurekaåœ°å€</li>
</ul>
</li>
</ol>
<h2 id="æœåŠ¡æ³¨å†Œ"><a href="#æœåŠ¡æ³¨å†Œ" class="headerlink" title="æœåŠ¡æ³¨å†Œ"></a>æœåŠ¡æ³¨å†Œ</h2><p>å°†user-serviceæœåŠ¡æ³¨å†Œåˆ°EurekaServeræ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>åœ¨user-serviceé¡¹ç›®ä¸­å¼•å…¥spring-cloud-starter-netflix-eureka-clientçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨application.ymlæ–‡ä»¶ï¼Œç¼–å†™ä¸‹é¢çš„é…ç½®</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">userservice</span> <span class="comment"># eurekaçš„æœåŠ¡åç§°</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span> <span class="comment"># eurekaçš„åœ°å€ä¿¡æ¯</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:10086/eureka/</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å°†user-serviceå¤šæ¬¡å¯åŠ¨ï¼Œæ¨¡æ‹Ÿå¤šå®ä¾‹éƒ¨ç½²ï¼Œä½†ä¸ºäº†é¿å…ç«¯å£å†²çªï¼Œéœ€è¦ä¿®æ”¹ç«¯å£è®¾ç½®ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305150330649.png" alt="image-20240305150330649"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305150617320.png" alt="image-20240305150617320"></p>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ol>
<li>æœåŠ¡æ³¨å†Œ</li>
</ol>
<ul>
<li>å¼•å…¥eureka-clientä¾èµ–</li>
<li>åœ¨application.ymlä¸­é…ç½®eurekaåœ°å€</li>
</ul>
<ol start="2">
<li>æ— è®ºæ˜¯æ¶ˆè´¹è€…è¿˜æ˜¯æä¾›è€…ï¼Œå¼•å…¥eureka-clientä¾èµ–ï¼ŒçŸ¥é“eurekaåœ°å€åï¼Œéƒ½å¯ä»¥å®ŒæˆæœåŠ¡æ³¨å†Œã€‚</li>
</ol>
<h2 id="æœåŠ¡å‘ç°"><a href="#æœåŠ¡å‘ç°" class="headerlink" title="æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°</h2><p>æœåŠ¡æ‹‰å–æ˜¯åŸºäºæœåŠ¡åç§°è·å–æœåŠ¡åˆ—è¡¨ï¼Œç„¶åå¯¹åˆ—è¡¨æœåŠ¡åšè´Ÿè½½å‡è¡¡ã€‚</p>
<ol>
<li><p>ä¿®æ”¹OrderServiceçš„ä»£ç ï¼Œä¿®æ”¹è®¿é—®çš„urlè·¯å¾„ï¼Œç”¨æœåŠ¡åä»£æ›¿ipã€ç«¯å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://userservice/user/&quot;</span> + order.getUserId();</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨order-serviceé¡¹ç›®çš„å¯åŠ¨OrderApplicationä¸­çš„RestTemplateæ·»åŠ <strong>è´Ÿè½½å‡è¡¡</strong>æ³¨é‡Šï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span></span><br><span class="line"><span class="keyword">public</span> RestTempalte <span class="title function_">restTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li><p>æ­å»ºEurekaServer</p>
<ul>
<li>å¼•å…¥eureka-serverä¾èµ–</li>
<li>æ·»åŠ @EnableEurekaServeræ³¨è§£</li>
<li>åœ¨application.ymlä¸­é…ç½®eurekaåœ°å€</li>
</ul>
</li>
<li><p>æœåŠ¡æ³¨å†Œ</p>
<ul>
<li>å¼•å…¥eureka-clientä¾èµ–</li>
<li>åœ¨application.ymlä¸­é…ç½®eurekaåœ°å€</li>
</ul>
</li>
<li><p>æœåŠ¡å‘ç°</p>
<ul>
<li>å¼•å…¥eureka-clientä¾èµ–</li>
<li>åœ¨application.ymlä¸­é…ç½®eurekaåœ°å€</li>
<li>ç»™RestTemplateæ·»åŠ @LoadBalancedæ³¨è§£</li>
<li>ç”¨æœåŠ¡æä¾›è€…æä¾›çš„æœåŠ¡è¿œç¨‹åç§°è¿œç¨‹è°ƒç”¨</li>
</ul>
</li>
</ol>
<h1 id="Ribbonè´Ÿè½½å‡è¡¡"><a href="#Ribbonè´Ÿè½½å‡è¡¡" class="headerlink" title="Ribbonè´Ÿè½½å‡è¡¡"></a>Ribbonè´Ÿè½½å‡è¡¡</h1><p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305152722949.png" alt="image-20240305152722949"></p>
<h2 id="è´Ÿè½½å‡è¡¡åŸç†"><a href="#è´Ÿè½½å‡è¡¡åŸç†" class="headerlink" title="è´Ÿè½½å‡è¡¡åŸç†"></a>è´Ÿè½½å‡è¡¡åŸç†</h2><p><font color="red">@LoadBalancedæ ‡è®°restTemplateå‘èµ·çš„è¯·æ±‚ä¼šè¢«ribbonæ‹¦æˆªã€‚</font></p>
<p>å½“è¯·æ±‚è¿›å…¥ribbonæ—¶ï¼Œä¼šè¢«LoadBalanceInterceptorè´Ÿè½½å‡è¡¡æ‹¦æˆªå™¨æ‹¦æˆªï¼Œæ‹¦æˆªä¹‹åå¾—åˆ°è¯·æ±‚ä¸­çš„æœåŠ¡åç§°ï¼Œå³userserviceï¼Œå¹¶å°†å…¶äº¤ç»™RibbonLoadBalanceClientï¼Œå®ƒä¼šå°†æœåŠ¡idäº¤ç»™DynamicServerListLoadBalancerï¼Œå®ƒå›å»eureka-serverä¸­æ‹‰å»æœåŠ¡åˆ—è¡¨ï¼Œå¹¶ä»IRuleä¸­æ‰§è¡ŒæœåŠ¡è´Ÿè½½å‡è¡¡å¹¶è¿”å›æŸä¸ªæœåŠ¡ï¼Œæœ€ç»ˆå‘é€urlã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305154036947.png" alt="image-20240305154036947"></p>
<h2 id="è´Ÿè½½å‡è¡¡ç­–ç•¥"><a href="#è´Ÿè½½å‡è¡¡ç­–ç•¥" class="headerlink" title="è´Ÿè½½å‡è¡¡ç­–ç•¥"></a>è´Ÿè½½å‡è¡¡ç­–ç•¥</h2><p>Ribbonçš„è´Ÿè½½å‡è¡¡è§„åˆ™æ˜¯ä¸€ä¸ªå«åšIRuleçš„æ¥å£æ¥å®šä¹‰çš„ï¼Œæ¯ä¸€ä¸ªå­æ¥å£å¤šæ˜¯ä¸€ç§è§„åˆ™ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305154210711.png" alt="image-20240305154210711"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305154229387.png" alt="image-20240305154229387"></p>
<p>é€šè¿‡å®šä¹‰IRuleå®ç°å¯ä»¥ä¿®æ”¹è´Ÿè½½å‡è¡¡è§„åˆ™ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li><p>ä»£ç æ–¹å¼ï¼šåœ¨order-serviceä¸­çš„OrderApplicationç±»ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªæ–°çš„Ruleï¼šï¼ˆä¸Šè¿°æ˜¯å…¨å±€é…ç½®ï¼Œè¡¨ç¤ºè®¿é—®ä»»ä½•æœåŠ¡æ—¶å‡æ‰§è¡ŒåŒç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> IRule <span class="title function_">randomRule</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RandomRule</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®æ–‡ä»¶æ–¹å¼ï¼šåœ¨order-serviceçš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ æ–°çš„é…ç½®ä¹Ÿå¯ä»¥ä¿®æ”¹è§„åˆ™ï¼šï¼ˆä¸Šè¿°æ˜¯é’ˆå¯¹userserviceæœåŠ¡å•ç‹¬è®¾ç½®çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼‰</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">userservice:</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalanceRuleClassName:</span> <span class="string">com.netflex.loadbalancer.RandomRule</span> <span class="comment"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="headerlink" title="æ‡’åŠ è½½"></a>æ‡’åŠ è½½</h2><p>Ribboné»˜è®¤æ˜¯é‡‡ç”¨æ‡’åŠ è½½ï¼Œå³ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ä¼šå»åˆ›å»ºLoadBalanceClientï¼Œè¯·æ±‚æ—¶é—´è¾ƒé•¿ã€‚</p>
<p>è€Œé¥¥é¥¿åŠ è½½åˆ™ä¼šåœ¨é¡¹ç›®å¯åŠ¨æ—¶åˆ›å»ºï¼Œé™ä½ç¬¬ä¸€æ¬¡è®¿é—®çš„è€—æ—¶ï¼Œé€šè¿‡ä¸‹é¢é…ç½®å¼€å¯é¥¥é¥¿åŠ è½½ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ribbon:</span><br><span class="line">  eager-load:</span><br><span class="line">    enabled: <span class="literal">true</span> # å¼€å¯é¥¥é¥¿åŠ è½½</span><br><span class="line">    clients: </span><br><span class="line">      - userservice # æŒ‡å®šå¯¹userserviceè¿™ä¸ªæœåŠ¡é¥¥é¥¿åŠ è½½</span><br><span class="line">      # - xxx</span><br></pre></td></tr></table></figure>





<p><strong>æ€»ç»“</strong></p>
<ol>
<li>Ribbonè´Ÿè½½å‡è¡¡è§„åˆ™<ul>
<li>è§„åˆ™æ¥å£æ—¶IRule</li>
<li>é»˜è®¤å®ç°æ˜¯ZoneAvoidanceRuleï¼Œæ ¹æ®zoneé€‰æ‹©æœåŠ¡åˆ—è¡¨ï¼Œç„¶åè½®è¯¢</li>
</ul>
</li>
<li>è´Ÿè½½å‡è¡¡è‡ªå®šä¹‰æ–¹å¼<ul>
<li>ä»£ç æ–¹å¼ï¼šé…ç½®çµæ´»ï¼Œä½†ä¿®æ”¹æ—¶éœ€è¦é‡æ–°æ‰“åŒ…å‘å¸ƒ</li>
<li>é…ç½®æ–¹å¼ï¼šç›´è§‚ã€æ–¹ä¾¿ï¼Œæ— éœ€é‡æ–°æ‰“åŒ…å‘å¸ƒï¼Œä½†æ— æ³•åšåˆ°å…¨å±€é…ç½®</li>
</ul>
</li>
<li>é¥¥é¥¿åŠ è½½<ul>
<li>å¼€å¯é¥¥é¥¿åŠ è½½</li>
<li>æŒ‡å®šé¥¥é¥¿åŠ è½½çš„å¾®æœåŠ¡åç§°</li>
</ul>
</li>
</ol>
<h1 id="Nacos"><a href="#Nacos" class="headerlink" title="Nacos"></a>Nacos</h1><h2 id="è®¤è¯†å’Œå®‰è£…Nacos"><a href="#è®¤è¯†å’Œå®‰è£…Nacos" class="headerlink" title="è®¤è¯†å’Œå®‰è£…Nacos"></a>è®¤è¯†å’Œå®‰è£…Nacos</h2><p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305161140438.png" alt="image-20240305161140438"></p>
<p>å¼€å‘é˜¶æ®µé‡‡ç”¨å•æœºå®‰è£…å³å¯ã€‚</p>
<h2 id="1-1-ä¸‹è½½å®‰è£…åŒ…"><a href="#1-1-ä¸‹è½½å®‰è£…åŒ…" class="headerlink" title="1.1.ä¸‹è½½å®‰è£…åŒ…"></a>1.1.ä¸‹è½½å®‰è£…åŒ…</h2><p>åœ¨Nacosçš„GitHubé¡µé¢ï¼Œæä¾›æœ‰ä¸‹è½½é“¾æ¥ï¼Œå¯ä»¥ä¸‹è½½ç¼–è¯‘å¥½çš„NacosæœåŠ¡ç«¯æˆ–è€…æºä»£ç ï¼š</p>
<p>GitHubä¸»é¡µï¼š<a href="https://github.com/alibaba/nacos">https://github.com/alibaba/nacos</a></p>
<p>GitHubçš„Releaseä¸‹è½½é¡µï¼š<a href="https://github.com/alibaba/nacos/releases">https://github.com/alibaba/nacos/releases</a></p>
<p>å¦‚å›¾ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402161102887.png" alt="image-20210402161102887"></p>
<p>æœ¬è¯¾ç¨‹é‡‡ç”¨1.4.1.ç‰ˆæœ¬çš„Nacosï¼Œè¯¾å‰èµ„æ–™å·²ç»å‡†å¤‡äº†å®‰è£…åŒ…ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402161130261.png" alt="image-20210402161130261"></p>
<p>windowsç‰ˆæœ¬ä½¿ç”¨<code>nacos-server-1.4.1.zip</code>åŒ…å³å¯ã€‚</p>
<h2 id="1-2-è§£å‹"><a href="#1-2-è§£å‹" class="headerlink" title="1.2.è§£å‹"></a>1.2.è§£å‹</h2><p>å°†è¿™ä¸ªåŒ…è§£å‹åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ä¸‹ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402161843337.png" alt="image-20210402161843337"></p>
<p>ç›®å½•è¯´æ˜ï¼š</p>
<ul>
<li>binï¼šå¯åŠ¨è„šæœ¬</li>
<li>confï¼šé…ç½®æ–‡ä»¶</li>
</ul>
<h2 id="1-3-ç«¯å£é…ç½®"><a href="#1-3-ç«¯å£é…ç½®" class="headerlink" title="1.3.ç«¯å£é…ç½®"></a>1.3.ç«¯å£é…ç½®</h2><p>Nacosçš„é»˜è®¤ç«¯å£æ˜¯8848ï¼Œå¦‚æœä½ ç”µè„‘ä¸Šçš„å…¶å®ƒè¿›ç¨‹å ç”¨äº†8848ç«¯å£ï¼Œè¯·å…ˆå°è¯•å…³é—­è¯¥è¿›ç¨‹ã€‚</p>
<p><strong>å¦‚æœæ— æ³•å…³é—­å ç”¨8848ç«¯å£çš„è¿›ç¨‹</strong>ï¼Œä¹Ÿå¯ä»¥è¿›å…¥nacosçš„confç›®å½•ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162008280.png" alt="image-20210402162008280"></p>
<p>ä¿®æ”¹å…¶ä¸­çš„å†…å®¹ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162251093.png" alt="image-20210402162251093"></p>
<h2 id="1-4-å¯åŠ¨"><a href="#1-4-å¯åŠ¨" class="headerlink" title="1.4.å¯åŠ¨"></a>1.4.å¯åŠ¨</h2><p>å¯åŠ¨éå¸¸ç®€å•ï¼Œè¿›å…¥binç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162350977.png" alt="image-20210402162350977"></p>
<p>ç„¶åæ‰§è¡Œå‘½ä»¤å³å¯ï¼š</p>
<ul>
<li><p>windowså‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">startup.cmd -m standalone</span><br></pre></td></tr></table></figure></li>
</ul>
<p>æ‰§è¡Œåçš„æ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162526774.png" alt="image-20210402162526774"></p>
<h2 id="1-5-è®¿é—®"><a href="#1-5-è®¿é—®" class="headerlink" title="1.5.è®¿é—®"></a>1.5.è®¿é—®</h2><p>åœ¨æµè§ˆå™¨è¾“å…¥åœ°å€ï¼š<a href="http://127.0.0.1:8848/nacos%E5%8D%B3%E5%8F%AF%EF%BC%9A">http://127.0.0.1:8848/nacoså³å¯ï¼š</a></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162630427.png" alt="image-20210402162630427"></p>
<p>é»˜è®¤çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯nacosï¼Œè¿›å…¥åï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20210402162709515.png" alt="image-20210402162709515"></p>
<h2 id="Nacoså¿«é€Ÿå…¥é—¨"><a href="#Nacoså¿«é€Ÿå…¥é—¨" class="headerlink" title="Nacoså¿«é€Ÿå…¥é—¨"></a>Nacoså¿«é€Ÿå…¥é—¨</h2><ol>
<li><p>åœ¨cloud-demoçˆ¶å·¥ç¨‹ä¸­æ·»åŠ spring-cloud-alibabaçš„ç®¡ç†ä¾èµ–ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.5.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨é‡Šæ‰order-serviceå’Œuser-serviceä¸­åŸæœ‰çš„eurekaä¾èµ–ã€‚</p>
</li>
<li><p>æ·»åŠ nacosçš„å®¢æˆ·ç«¯ä¾èµ–ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- nacoså®¢æˆ·ç«¯ä¾èµ–åŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹user-service&amp;order-serviceä¸­çš„application.ymlæ–‡ä»¶ï¼Œæ³¨é‡Šæ‰eurekaåœ°å€ï¼Œæ·»åŠ nacosåœ°å€ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305163148480.png" alt="image-20240305163148480"></p>
</li>
<li><p>å¯åŠ¨å¹¶æµ‹è¯•</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305163846124.png" alt="image-20240305163846124"></p>
</li>
</ol>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li>NacosæœåŠ¡æ­å»º<ol>
<li>ä¸‹è½½å®‰è£…åŒ…</li>
<li>è§£å‹</li>
<li>åœ¨binç›®å½•ä¸‹è¿è¡ŒæŒ‡ä»¤ï¼šstartup.cmd -m standalone</li>
</ol>
</li>
<li>NacosæœåŠ¡æ³¨å†Œæˆ–å‘ç°<ol>
<li>å¼•å…¥nacos.discoveryä¾èµ–</li>
<li>é…ç½®nacosåœ°å€spring.cloud.nacos.server-addr</li>
</ol>
</li>
</ol>
<h2 id="NacosæœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹"><a href="#NacosæœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹" class="headerlink" title="NacosæœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹"></a>NacosæœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹</h2><p>æ‰€æœ‰å®ä¾‹æ”¾åœ¨ä¸€ä¸ªæœºæˆ¿ï¼Œå¦‚æœæœºæˆ¿å®•æœºï¼Œæ•´ä¸ªæœåŠ¡éƒ½åœäº†ã€‚</p>
<p><font color="red">åŒåœ¨ä¸€ä¸ªæœºæˆ¿çš„å¤šä¸ªå®ä¾‹ä½œä¸ºä¸€ä¸ªé›†ç¾¤ã€‚</font></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305164414812.png" alt="image-20240305164414812"></p>
<p>æœåŠ¡è°ƒç”¨å°½å¯èƒ½é€‰æ‹©æœ¬åœ°é›†ç¾¤çš„æœåŠ¡ï¼Œè·¨é›†ç¾¤è°ƒç”¨å»¶è¿Ÿè¾ƒé«˜ã€‚</p>
<p>æœ¬åœ°é›†ç¾¤ä¸å¯è®¿é—®æ—¶ï¼Œå†å»è®¿é—®å…¶ä»–é›†ç¾¤ã€‚</p>
<p> <img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305164535787.png" alt="image-20240305164535787"></p>
<p>é…ç½®æœåŠ¡é›†ç¾¤å±æ€§ï¼š</p>
<ol>
<li><p>ä¿®æ”¹application.ymlï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">cloud:</span></span><br><span class="line">		<span class="attr">nacos:</span></span><br><span class="line">			<span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment"># nacos æœåŠ¡å™¨åœ°å€</span></span><br><span class="line">			<span class="attr">discovery:</span></span><br><span class="line">				<span class="attr">cluster-name:</span> <span class="string">HZ</span> <span class="comment">#é…ç½®é›†ç¾¤åç§°ï¼Œä¹Ÿå°±æ˜¯æœºæˆ¿ä½ç½®ï¼Œä¾‹å¦‚ï¼šHZï¼Œæ­å·  </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨Nacosæ§åˆ¶å°å¯ä»¥çœ‹åˆ°é›†ç¾¤å˜åŒ–ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305165037959.png" alt="image-20240305165037959"></p>
</li>
</ol>
<p><strong>æ€»ç»“</strong>ï¼š</p>
<ol>
<li>NacosæœåŠ¡åˆ†çº§å­˜å‚¨æ¨¡å‹<ol>
<li>ä¸€çº§æ˜¯æœåŠ¡ï¼Œä¾‹å¦‚userservice</li>
<li>äºŒçº§æ˜¯é›†ç¾¤ï¼Œä¾‹å¦‚æ­å·æˆ–ä¸Šæµ·</li>
<li>ä¸‰çº§æ˜¯å®ä¾‹ï¼Œä¾‹å¦‚æ­å·æœºæˆ¿çš„æŸå°éƒ¨ç½²äº†userserviceçš„æœåŠ¡å™¨</li>
</ol>
</li>
<li>å¦‚ä½•è®¾ç½®å®ä¾‹çš„é›†ç¾¤å±æ€§<ol>
<li>ä¿®æ”¹application.ymlæ–‡ä»¶ï¼Œæ·»åŠ spring.cloud.nacos.discovery.cluster-nameå±æ€§å³å¯</li>
</ol>
</li>
</ol>
<h2 id="NacosRuleè´Ÿè½½å‡è¡¡"><a href="#NacosRuleè´Ÿè½½å‡è¡¡" class="headerlink" title="NacosRuleè´Ÿè½½å‡è¡¡"></a>NacosRuleè´Ÿè½½å‡è¡¡</h2><p>æˆ‘ä»¬ä¿®æ”¹user-serviceé…ç½®ï¼Œè¾¾åˆ°ä»¥ä¸‹çš„æ•ˆæœï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305202406876.png" alt="image-20240305202406876"></p>
<p><strong>ä¿®æ”¹é›†ç¾¤è´Ÿè½½å‡è¡¡</strong></p>
<ol>
<li><p>ä¿®æ”¹order-serviceä¸­çš„application.ymlï¼Œè®¾ç½®é›†ç¾¤ä¸ºHZï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">    <span class="attr">cloud:</span></span><br><span class="line">        <span class="attr">nacos:</span></span><br><span class="line">            <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#nacosæœåŠ¡ç«¯åœ°å€</span></span><br><span class="line">			<span class="attr">discovery:</span></span><br><span class="line">				<span class="attr">cluster-name:</span> <span class="string">HZ</span> <span class="comment">#é…ç½®é›†ç¾¤åç§°ï¼Œä¹Ÿå°±æ˜¯æœºæˆ¿ä½ç½®</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç„¶ååœ¨order-serviceä¸­è®¾ç½®è´Ÿè½½å‡è¡¡çš„IRuleä¸ºNacosRuleï¼Œè¿™ä¸ªè§„åˆ™ä¼˜å…ˆå¯»æ‰¾ä¸è‡ªå·±åŒé›†ç¾¤çš„æœåŠ¡ï¼Œåœ¨æœ¬åœ°é›†ç¾¤ä¸­çš„å¤šä¸ªæœåŠ¡ä¸­é€‰æ‹©éšæœºæ–¹å¼è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼š</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305211206181.png" alt="image-20240305211206181"></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">userservice:</span></span><br><span class="line">	<span class="attr">ribbon:</span></span><br><span class="line">		<span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.alibaba.cloud.nacos.ribbon.NacosRule</span> <span class="comment"># è´Ÿè½½å‡è¡¡è§„åˆ™</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨æ„å°†user-serviceçš„æƒé‡éƒ½è®¾ç½®ä¸º1</p>
</li>
</ol>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li>NacosRuleè´Ÿè½½å‡è¡¡ç­–ç•¥<ol>
<li>ä¼˜å…ˆé€‰æ‹©åŒé›†ç¾¤æœåŠ¡å®ä¾‹åˆ—è¡¨</li>
<li>æœ¬åœ°é›†ç¾¤æ‰¾ä¸åˆ°æä¾›è€…ï¼Œæ‰å»å…¶ä»–é›†ç¾¤å¯»æ‰¾ï¼Œå¹¶ä¸”ä¼šæŠ¥è­¦å‘Š</li>
<li>ç¡®å®šäº†å¯ç”¨å®ä¾‹åˆ—è¡¨åï¼Œå†é‡‡ç”¨éšæœºè´Ÿè½½æŒ‘é€‰å®ä¾‹</li>
</ol>
</li>
</ol>
<h2 id="NacosæœåŠ¡å®ä¾‹çš„æƒé‡è®¾ç½®"><a href="#NacosæœåŠ¡å®ä¾‹çš„æƒé‡è®¾ç½®" class="headerlink" title="NacosæœåŠ¡å®ä¾‹çš„æƒé‡è®¾ç½®"></a>NacosæœåŠ¡å®ä¾‹çš„æƒé‡è®¾ç½®</h2><p>å®é™…éƒ¨ç½²ä¸­ä¼šå‡ºç°çš„åœºæ™¯ï¼š</p>
<ul>
<li>æœåŠ¡å™¨è®¾å¤‡æ€§èƒ½æœ‰å·®å¼‚ï¼Œéƒ¨åˆ†å®ä¾‹æ‰€åœ¨æœºå™¨æ€§èƒ½è¾ƒå¥½ï¼Œå¦ä¸€äº›è¾ƒå·®ï¼Œæˆ‘ä»¬å¸Œæœ›æ€§èƒ½å¥½çš„æœºå™¨æ‰¿æ‹…æ›´å¤šçš„ç”¨æˆ·è¯·æ±‚</li>
<li>Nacosæä¾›äº†æƒé‡é…ç½®æ¥æ§åˆ¶è®¿é—®é¢‘ç‡ï¼Œæƒé‡è¶Šå¤§åˆ™è®¿é—®è¯„ç‡è¶Šé«˜</li>
</ul>
<ol>
<li><p>åœ¨Nacosæ§åˆ¶å°å¯ä»¥è®¾ç½®å®ä¾‹çš„æƒé‡å€¼ï¼Œé¦–å…ˆé€‰ä¸­å®ä¾‹åé¢çš„ç¼–è¾‘æŒ‰é’®</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305210956184.png" alt="image-20240305210956184"></p>
</li>
<li><p>å°†æƒé‡è®¾ç½®ä¸º0.1ï¼Œæµ‹è¯•å¯ä»¥å‘ç°8081è¢«è®¿é—®åˆ°çš„é¢‘ç‡å¤§å¤§é™ä½</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305211103036.png" alt="image-20240305211103036"></p>
</li>
</ol>
<p>æƒé‡è®¾è®¡ï¼Œå¯ä»¥è®©æ–°ç‰ˆæœ¬çš„æœåŠ¡æƒé‡ä»å°ä¸æ–­å¢åŠ ï¼Œå…ˆè®©å°éƒ¨åˆ†ç”¨æˆ·æµ‹è¯•æ–°ç‰ˆæœ¬ï¼Œæ²¡é—®é¢˜å†å‡çº§æƒé‡ã€‚</p>
<p><strong>æ€»ç»“</strong></p>
<p>å®ä¾‹çš„æƒé‡æ§åˆ¶</p>
<ol>
<li>Nacosæ§åˆ¶å°å¯ä»¥è®¾ç½®å®ä¾‹çš„æƒé‡å€¼ï¼Œ0~1ä¹‹é—´</li>
<li>åŒé›†ç¾¤å†…çš„å¤šä¸ªå®ä¾‹ï¼Œæƒé‡è¶Šé«˜è¢«è®¿é—®çš„æ¦‚ç‡è¶Šé«˜</li>
<li>æƒé‡è®¾ç½®ä¸º0åˆ™å®Œå…¨ä¸ä¼šè¢«è®¿é—®</li>
</ol>
<h2 id="Nacosç¯å¢ƒéš”ç¦»"><a href="#Nacosç¯å¢ƒéš”ç¦»" class="headerlink" title="Nacosç¯å¢ƒéš”ç¦»"></a>Nacosç¯å¢ƒéš”ç¦»</h2><p><strong>ç¯å¢ƒéš”ç¦» - namespace</strong></p>
<p>nacosä¸ä»…æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œè¿˜æ˜¯æ•°æ®ä¸­å¿ƒï¼Œä¸ºäº†æ•°æ®çš„ç®¡ç†ï¼Œä»–ä¼šåšç¯å¢ƒéš”ç¦»ã€‚</p>
<p>Nacosä¸­æœåŠ¡å­˜å‚¨å’Œæ•°æ®å­˜å‚¨çš„æœ€å¤–å±‚éƒ½æ˜¯ä¸€ä¸ªåä¸ºnamespaceçš„ä¸œè¥¿ï¼Œç”¨æ¥åšæœ€å¤–å±‚éš”ç¦»ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305211640168.png" alt="image-20240305211640168"></p>
<p>åœ¨Nacosæ§åˆ¶å°å¯ä»¥åˆ›å»ºnamespaceï¼Œç”¨æ¥éš”ç¦»ä¸åŒç¯å¢ƒ</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212005285.png" alt="image-20240305212005285"></p>
<p> <img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212128956.png" alt="image-20240305212128956"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212136338.png" alt="image-20240305212136338"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212142930.png" alt="image-20240305212142930"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212443910.png" alt="image-20240305212443910"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212423014.png" alt="image-20240305212423014"></p>
<p>è¦æƒ³æœåŠ¡å¯ä»¥è¿è¡Œï¼Œè¦å°†å…¶æ”¾åœ¨ç›¸åŒç›®å½•ä¸‹ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212619177.png" alt="image-20240305212619177"></p>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li>Nacosç¯å¢ƒéš”ç¦»<ol>
<li>namespaceç”¨æ¥åšç¯å¢ƒéš”ç¦»</li>
<li>æ¯ä¸ªnamespaceéƒ½æœ‰å”¯ä¸€id</li>
<li>ä¸åŒnamespaceä¸‹çš„æœåŠ¡ä¸å¯è§</li>
</ol>
</li>
</ol>
<h2 id="Nacoså’ŒEurekaçš„å¯¹æ¯”"><a href="#Nacoså’ŒEurekaçš„å¯¹æ¯”" class="headerlink" title="Nacoså’ŒEurekaçš„å¯¹æ¯”"></a>Nacoså’ŒEurekaçš„å¯¹æ¯”</h2><p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305212953635.png" alt="image-20240305212953635"></p>
<p>åœ¨nacosä¸­ï¼Œå®ä¾‹åˆ†ä¸ºä¸´æ—¶å®ä¾‹å’Œéä¸´æ—¶å®ä¾‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å®ä¾‹éƒ½æ˜¯ä¸´æ—¶å®ä¾‹ï¼Œå…¶ä¸­ä¸´æ—¶å®ä¾‹å¦‚ä¸‹æ‰€ç¤º</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305213236381.png" alt="image-20240305213236381"></p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305213330438.png" alt="image-20240305213330438"></p>
<p>ä¸´æ—¶å®ä¾‹çš„å¿ƒè·³æ£€æµ‹å¤±è´¥åˆ™ç›´æ¥åˆ é™¤æ³¨å†Œã€‚</p>
<p>éä¸´æ—¶å®ä¾‹ï¼Œnacosä¼šä¸»åŠ¨è¯¢é—®ã€‚å¦‚æœéä¸´æ—¶å®ä¾‹ä¸å¥åº·äº†ï¼Œä¸ä¼šå°†å…¶ä»æ³¨å†Œä¸­å¿ƒä¸­ç§»é™¤ï¼Œè€Œæ˜¯å°†å…¶æ ‡è®°ä¸ºä¸å¥åº·ã€‚ç­‰å¾…å…¶å›å¤å¥åº·ã€‚</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305213427089.png" alt="image-20240305213427089"></p>
<p>nacoså‘ç°æœ‰æœåŠ¡æŒ‚äº†ï¼Œä¼šå‘æ¶ˆè´¹è€…ä¸»åŠ¨æ¨é€å˜æ›´æ¶ˆæ¯push</p>
<p><img src="/2024/03/04/%E5%BE%AE%E6%9C%8D%E5%8A%A1-day01-SpringCloud01/image-20240305213558721.png" alt="image-20240305213558721"></p>
<p><strong>ä¸´æ—¶å®ä¾‹å’Œéä¸´æ—¶å®ä¾‹</strong></p>
<p>æœåŠ¡æ³¨å†Œåˆ°Nacosæ—¶ï¼Œå¯ä»¥é€‰æ‹©æ³¨å†Œä¸ºä¸´æ—¶æˆ–éä¸´æ—¶å®ä¾‹ï¼Œé€šè¿‡ä¸‹é¢çš„é…ç½®æ¥è®¾ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">cloud:</span></span><br><span class="line">		<span class="attr">nacos:</span></span><br><span class="line">			<span class="attr">discovery:</span></span><br><span class="line">				<span class="attr">ephemeral:</span> <span class="literal">false</span> <span class="comment">#è®¾ç½®ä¸ºéä¸´æ—¶å®ä¾‹</span></span><br></pre></td></tr></table></figure>



<p><strong>æ€»ç»“</strong></p>
<p>Nacosä¸eurekaçš„å…±åŒç‚¹</p>
<ol>
<li>éƒ½æ”¯æŒæœåŠ¡æ³¨å†Œå’ŒæœåŠ¡æ‹‰å–</li>
<li>éƒ½æ”¯æŒæœåŠ¡æä¾›è€…å¿ƒè·³æ–¹å¼åšå¥åº·æ£€æµ‹</li>
</ol>
<p>Nacosä¸Eurekaçš„åŒºåˆ«</p>
<ol>
<li>Nacosæ”¯æŒæœåŠ¡ç«¯ä¸»åŠ¨æ£€æµ‹æä¾›è€…çŠ¶æ€ï¼šä¸´æ—¶å®ä¾‹é‡‡ç”¨å¿ƒè·³æ¨¡å¼ï¼Œéä¸´æ—¶å®ä¾‹é‡‡ç”¨ä¸»åŠ¨æ£€æµ‹æ¨¡å¼</li>
<li>ä¸´æ—¶å®ä¾‹å¿ƒè·³ä¸æ­£å¸¸ä¼šè¢«æå‡ºï¼Œéä¸´æ—¶å®ä¾‹åˆ™ä¸ä¼šè¢«å‰”é™¤</li>
<li>Nacosæ”¯æŒæœåŠ¡åˆ—è¡¨å˜æ›´çš„æ¶ˆæ¯æ¨é€æ¨¡å¼ï¼ŒæœåŠ¡åˆ—è¡¨æ›´æ–°æ›´åŠæ—¶</li>
<li>Nacosé›†ç¾¤é»˜è®¤é‡‡ç”¨APæ–¹å¼ï¼Œå½“é›†ç¾¤ä¸­å­˜åœ¨éä¸´æ—¶å®ä¾‹æ—¶ï¼Œé‡‡ç”¨CPæ¨¡å¼ï¼›Eurekaé»˜è®¤é‡‡ç”¨APæ¨¡å¼ã€‚</li>
</ol>
]]></content>
      <categories>
        <category>å¾®æœåŠ¡</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day12-æ•°æ®ç»Ÿè®¡</title>
    <url>/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/</url>
    <content><![CDATA[<h1 id="æ•°æ®æŠ¥è¡¨"><a href="#æ•°æ®æŠ¥è¡¨" class="headerlink" title="æ•°æ®æŠ¥è¡¨"></a>æ•°æ®æŠ¥è¡¨</h1><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304185718012.png" alt="image-20240304185718012"></p>
<h1 id="å·¥ä½œå°"><a href="#å·¥ä½œå°" class="headerlink" title="å·¥ä½œå°"></a>å·¥ä½œå°</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p> å·¥ä½œå°æ˜¯ç³»ç»Ÿè¿è¥çš„æ•°æ®çœ‹æ¿ï¼Œ å¹¶æä¾›å¿«æ·æ“ä½œå…¥å£ï¼Œå¯ä»¥æœ‰æ•ˆæé«˜å•†å®¶çš„å·¥ä½œæ•ˆç‡ã€‚</p>
<p>å·¥ä½œå°å±•ç¤ºçš„æ•°æ®ï¼š</p>
<ul>
<li>è¿›å…¥æ•°æ®</li>
<li>è®¢å•ç®¡ç†</li>
<li>èœå“æ€»è§ˆ</li>
<li>å¥—é¤æ€»è§ˆ</li>
<li>è®¢å•ä¿¡æ¯</li>
</ul>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304190903243.png" alt="image-20240304190903243"></p>
<p>åè¯è§£é‡Šï¼š</p>
<ul>
<li>è¥ä¸šé¢ï¼šå·²å®Œæˆè®¢å•çš„æ€»é‡‘é¢</li>
<li>æœ‰æ•ˆè®¢å•ï¼šå·²å®Œæˆè®¢å•çš„æ•°é‡</li>
<li>è®¢å•å®Œæˆç‡ï¼šæœ‰æ•ˆè®¢å•æ•°&#x2F;æ€»è®¢å•æ•° * 100%</li>
<li>å¹³å‡å®¢å•ä»·ï¼šè¥ä¸šé¢&#x2F;æœ‰æ•ˆè®¢å•æ•°</li>
<li>æ–°å¢ç”¨æˆ·ï¼šæ–°å¢ç”¨æˆ·çš„æ•°é‡</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li>ä»Šæ—¥æ•°æ®æ¥å£</li>
<li>è®¢å•ç®¡ç†æ¥å£</li>
<li>èœå“æ€»è§ˆæ¥å£</li>
<li>å¥—é¤æ€»è§ˆæ¥å£</li>
<li>è®¢å•æœç´¢ï¼ˆå·²å®Œæˆï¼‰</li>
<li>å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡ï¼ˆå·²å®Œæˆï¼‰</li>
</ul>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304191802637.png" alt="image-20240304191802637"></p>
<p><strong>ä»Šæ—¥æ•°æ®çš„æ¥å£è®¾è®¡ï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304191959537.png" alt="image-20240304191959537"></p>
<p><strong>è®¢å•ç®¡ç†çš„æ¥å£è®¾è®¡ï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304192054014.png" alt="image-20240304192054014"></p>
<p><strong>èœå“æ€»è§ˆçš„æ¥å£è®¾è®¡ï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304192132813.png" alt="image-20240304192132813"></p>
<p><strong>å¥—é¤æ€»è§ˆçš„æ¥å£è®¾è®¡ï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304192154803.png" alt="image-20240304192154803"></p>
<h2 id="ä»£ç å¯¼å…¥"><a href="#ä»£ç å¯¼å…¥" class="headerlink" title="ä»£ç å¯¼å…¥"></a>ä»£ç å¯¼å…¥</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304192915915.png" alt="image-20240304192915915"></p>
<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304192930839.png" alt="image-20240304192930839"></p>
<h2 id="Apache-POI"><a href="#Apache-POI" class="headerlink" title="Apache POI"></a>Apache POI</h2><p>Apache POIæ˜¯ä¸€ä¸ªå¤„ç†Miscrosoft Officeå„ç§æ–‡ä»¶æ ¼å¼çš„å¼€æºé¡¹ç›®ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨POIåœ¨Javaç¨‹åºä¸­å¯¹Miscrosoft Officeå„ç§æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒPOIéƒ½æ˜¯æ“ä½œExcelæ–‡ä»¶ã€‚</p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304194119767.png" alt="image-20240304194119767"></p>
<p>Apache POIçš„åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>é“¶è¡Œç½‘é“¶ç³»ç»Ÿå¯¼å‡ºäº¤æ˜“æ˜ç»†</li>
<li>å„ç§ä¸šåŠ¡ç³»ç»Ÿå¯¼å‡ºExcelæŠ¥è¡¨</li>
<li>æ‰¹é‡å¯¼å…¥ä¸šåŠ¡æ•°æ®</li>
</ul>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304194154240.png" alt="image-20240304194154240"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304194228057.png" alt="image-20240304194228057"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304194246336.png" alt="image-20240304194246336"></p>
<h2 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>Apache POIçš„mavenåæ ‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- poi --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;poi&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;poi&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™æ¡ˆä¾‹ä»£ç ï¼š</p>
<p><strong>å†™å…¥excelæ–‡ä»¶å†…å®¹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨POIæ“ä½œExcelæ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">POITest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡POIåˆ›å»ºExcelæ–‡ä»¶å¹¶ä¸”å†™å…¥æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶</span></span><br><span class="line">        <span class="type">XSSFWorkbook</span> <span class="variable">excel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line">        <span class="comment">//åœ¨Excelæ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªsheeté¡µ</span></span><br><span class="line">        <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.createSheet(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">        <span class="comment">//åœ¨Sheetä¸­åˆ›å»ºè¡Œå¯¹è±¡,rownumç¼–å·ä»0å¼€å§‹</span></span><br><span class="line">        <span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºå•å…ƒæ ¼ï¼Œç»™æ–‡ä»¶å†™å…¥å†…å®¹</span></span><br><span class="line">        row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;å§“å&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;åŸå¸‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°è¡Œ</span></span><br><span class="line">        row = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">        row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;å´åº·æƒ &quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;æ­å·&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°è¡Œ</span></span><br><span class="line">        row = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">        row.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;é™ˆæ¢¦å©·&quot;</span>);</span><br><span class="line">        row.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;ä¸Šæµ·&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡è¾“å‡ºæµå°†å†…å­˜ä¸­çš„excelæ–‡ä»¶å†™å…¥åˆ°ç£ç›˜</span></span><br><span class="line">        <span class="type">FileOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:\\info.xlsx&quot;</span>));</span><br><span class="line">        excel.write(out);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        out.close();</span><br><span class="line">        excel.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        write();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¯»å–excelæ–‡ä»¶å†…å®¹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨POIæ“ä½œExcelæ–‡ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">POITest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡POIè¯»å–Excelæ–‡ä»¶ä¸­çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">read</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">FileInputStream</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;E:\\info.xlsx&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯»å–ç£ç›˜ä¸Šå·²ç»å­˜åœ¨çš„excelæ–‡ä»¶ï¼Œå¹¶å°†å…¶å°è£…ä¸ºexcel</span></span><br><span class="line">        <span class="type">XSSFWorkbook</span> <span class="variable">excel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(file);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¯»å–excelæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªsheeté¡µ</span></span><br><span class="line">        <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.getSheetAt(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–Sheeté¡µä¸­æœ€åä¸€è¡Œçš„è¡Œå·</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">lastRowNum</span> <span class="operator">=</span> sheet.getLastRowNum();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;=  lastRowNum; i++) &#123;</span><br><span class="line">            <span class="comment">//è·å–ç¬¬ä¸€è¡Œ</span></span><br><span class="line">            <span class="type">XSSFRow</span> <span class="variable">row</span> <span class="operator">=</span> sheet.getRow(i);</span><br><span class="line">            <span class="comment">//è·å¾—å•å…ƒæ ¼</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">cellValue1</span> <span class="operator">=</span> row.getCell(<span class="number">1</span>).getStringCellValue();</span><br><span class="line">            <span class="type">String</span> <span class="variable">cellValue2</span> <span class="operator">=</span> row.getCell(<span class="number">2</span>).getStringCellValue();</span><br><span class="line">            System.out.println(cellValue1 + <span class="string">&quot; &quot;</span> +  cellValue2);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        excel.close();</span><br><span class="line">        file.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="å¯¼å‡ºè¿è¥æ•°æ®ExcelæŠ¥è¡¨"><a href="#å¯¼å‡ºè¿è¥æ•°æ®ExcelæŠ¥è¡¨" class="headerlink" title="å¯¼å‡ºè¿è¥æ•°æ®ExcelæŠ¥è¡¨"></a>å¯¼å‡ºè¿è¥æ•°æ®ExcelæŠ¥è¡¨</h2><h3 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304201916592.png" alt="image-20240304201916592"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304202038081.png" alt="image-20240304202038081"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¯¼å‡ºExcelå½¢å¼çš„æŠ¥è¡¨æ–‡ä»¶</li>
<li>å¯¼å‡ºæœ€è¿‘30å¤©çš„è¿è¥æ•°æ®ï¼ˆé€šè¿‡è¾“å‡ºæµå‘å®¢æˆ·ç«¯å†™å‡ºæ–‡ä»¶ï¼‰</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304202329131.png" alt="image-20240304202329131"></p>
<p>æ³¨æ„ï¼šå½“å‰æ¥å£æ˜¯æ²¡æœ‰è¿”å›æ•°æ®çš„ï¼Œå› ä¸ºæŠ¥è¡¨å¯¼å‡ºåŠŸèƒ½æœ¬è´¨ä¸Šæ˜¯æ–‡ä»¶ä¸‹è½½ï¼ŒæœåŠ¡ç«¯ä¼šé€šè¿‡è¾“å‡ºæµå°†Excelæ–‡ä»¶ä¸‹è½½åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚</p>
<h3 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h3><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304202458088.png" alt="image-20240304202458088"></p>
<p>å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>è®¾è®¡Excelæ¨¡æ¿æ–‡ä»¶ï¼ˆåŒ…å«äº†å„ç§åˆå¹¶å•å…ƒæ ¼å’ŒèƒŒæ™¯é¢œè‰²ï¼‰</li>
<li>æŸ¥è¯¢è¿‘30å¤©çš„è¿è¥æ•°æ®</li>
<li>å°†æŸ¥è¯¢åˆ°çš„è¿è¥æ•°æ®å†™å…¥åˆ°æ¨¡æ¿æ–‡ä»¶</li>
<li>é€šè¿‡è¾“å‡ºæµå°†Excelæ–‡ä»¶ä¸‹è½½åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨</li>
</ol>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304202855053.png" alt="image-20240304202855053"></p>
<p><strong>ReportController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å‡ºè¿è¥æ•°æ®æŠ¥è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å¯¼å‡ºè¿è¥æ•°æ®æŠ¥è¡¨&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/export&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">export</span><span class="params">(HttpServletResponse response)</span>&#123;</span><br><span class="line">    reportService.exportBusinessData(response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å‡ºè¿è¥æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">exportBusinessData</span><span class="params">(HttpServletResponse response)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ReportServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯¼å‡ºè¿è¥æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">exportBusinessData</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//1. æŸ¥è¯¢æ•°æ®åº“ï¼Œè·å–è¥ä¸šæ•°æ® -- æŸ¥è¯¢æœ€è¿‘30å¤©çš„è¿è¥æ•°æ®</span></span><br><span class="line">    <span class="type">LocalDate</span> <span class="variable">dateBegin</span> <span class="operator">=</span> LocalDate.now().minusDays(<span class="number">30</span>);</span><br><span class="line">    <span class="type">LocalDate</span> <span class="variable">dateEnd</span> <span class="operator">=</span> LocalDate.now().minusDays(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(dateBegin, LocalTime.MIN);</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(dateBegin, LocalTime.MAX);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥è¯¢æ¦‚è§ˆæ•°æ®</span></span><br><span class="line">    <span class="type">BusinessDataVO</span> <span class="variable">businessData</span> <span class="operator">=</span> workspaceService.getBusinessData(beginTime, endTime);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. é€šè¿‡POIå°†æ•°æ®å†™å…¥åˆ°Excelæ–‡ä»¶ä¸­</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader().getResourceAsStream(<span class="string">&quot;template/è¿è¥æ•°æ®æŠ¥è¡¨æ¨¡æ¿&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŸºäºæ¨¡æ¿æ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ–°çš„excelæ–‡ä»¶</span></span><br><span class="line">    <span class="type">XSSFWorkbook</span> <span class="variable">excel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>(in);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. é€šè¿‡è¾“å‡ºæµå°†Excelæ–‡ä»¶ä¸‹è½½è‡³å®¢æˆ·ç«¯æµè§ˆå™¨</span></span><br><span class="line">    <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> excel.getSheet(<span class="string">&quot;Sheet1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¡«å……æ•°æ® -- æ—¶é—´</span></span><br><span class="line">    sheet.getRow(<span class="number">1</span>).getCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;æ—¶é—´ï¼š&quot;</span> + dateBegin + <span class="string">&quot;è‡³&quot;</span> + dateEnd);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¡«å……æ•°æ® -- è¥ä¸šé¢ | è®¢å•å®Œæˆç‡ | æ–°å¢ç”¨æˆ·æ•°</span></span><br><span class="line">    sheet.getRow(<span class="number">3</span>).getCell(<span class="number">2</span>).setCellValue(businessData.getTurnover());</span><br><span class="line">    sheet.getRow(<span class="number">3</span>).getCell(<span class="number">4</span>).setCellValue(businessData.getOrderCompletionRate());</span><br><span class="line">    sheet.getRow(<span class="number">3</span>).getCell(<span class="number">6</span>).setCellValue(businessData.getNewUsers());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¡«å……æ•°æ® -- æœ‰æ•ˆè®¢å•æ•° | å¹³å‡å®¢å•ä»·</span></span><br><span class="line">    sheet.getRow(<span class="number">4</span>).getCell(<span class="number">2</span>).setCellValue(businessData.getValidOrderCount());</span><br><span class="line">    sheet.getRow(<span class="number">4</span>).getCell(<span class="number">4</span>).setCellValue(businessData.getUnitPrice());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¡«å……æ˜ç»†æ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">30</span>; i++) &#123;</span><br><span class="line">        <span class="type">LocalDate</span> <span class="variable">date</span> <span class="operator">=</span> dateBegin.plusDays(i);</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢æŸä¸€å¤©çš„è¥ä¸šæ•°æ®</span></span><br><span class="line">        <span class="type">BusinessDataVO</span> <span class="variable">businessDataVO</span> <span class="operator">=</span> workspaceService.getBusinessData(LocalDateTime.of(date, LocalTime.MIN), LocalDateTime.of(date, LocalTime.MAX));</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">1</span>).setCellValue(date.toString());</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">2</span>).setCellValue(businessDataVO.getTurnover());</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">3</span>).setCellValue(businessDataVO.getValidOrderCount());</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">4</span>).setCellValue(businessDataVO.getOrderCompletionRate());</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">5</span>).setCellValue(businessDataVO.getUnitPrice());</span><br><span class="line">        sheet.getRow(<span class="number">7</span> + i).getCell(<span class="number">6</span>).setCellValue(businessDataVO.getNewUsers());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡è¾“å‡ºæµå¯¹è±¡ä¸‹è½½æ•°æ®åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨</span></span><br><span class="line">    <span class="type">ServletOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">    excel.write(out);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">    out.close();</span><br><span class="line">    excel.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h3><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day12-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/image-20240304210743824.png" alt="image-20240304210743824"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day11-æ•°æ®ç»Ÿè®¡,å›¾å½¢æŠ¥è¡¨</title>
    <url>/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/</url>
    <content><![CDATA[<h1 id="æ•°æ®ç»Ÿè®¡"><a href="#æ•°æ®ç»Ÿè®¡" class="headerlink" title="æ•°æ®ç»Ÿè®¡"></a>æ•°æ®ç»Ÿè®¡</h1><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304011805226.png" alt="image-20240304011805226"></p>
<h1 id="Apache-ECharts"><a href="#Apache-ECharts" class="headerlink" title="Apache ECharts"></a>Apache ECharts</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Apache EChartsæ˜¯ä¸€æ¬¾åŸºäºJavascriptçš„æ•°æ®å¯è§†åŒ–å›¾æ ‡ï¼Œæä¾›ç›´è§‚ã€ç”ŸåŠ¨ã€å¯äº¤äº’ï¼Œå¯ä¸ªæ€§åŒ–å®šåˆ¶çš„æ•°æ®å¯è§†åŒ–å›¾è¡¨ã€‚</p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://echarts.apache.org/zh/index.html">https://echarts.apache.org/zh/index.html</a></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304012202089.png" alt="image-20240304012202089"></p>
<p>æ•ˆæœå±•ç¤ºï¼š</p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304012218649.png" alt="image-20240304012218649"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304012224570.png" alt="image-20240304012224570"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304012344585.png" alt="image-20240304012344585"></p>
<h2 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>Apache Echartså®˜æ–¹æä¾›çš„å¿«é€Ÿå…¥é—¨ï¼š<a href="https://echarts.apache.org/handbook/zh/get-started/">https://echarts.apache.org/handbook/zh/get-started/</a></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304012540268.png" alt="image-20240304012540268"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304013108917.png" alt="image-20240304013108917"></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304014538199.png" alt="image-20240304014538199"></p>
<p>æ€»ç»“ï¼šä½¿ç”¨Echartsï¼Œé‡ç‚¹åœ¨äºç ”ç©¶å½“å‰å›¾è¡¨æ‰€éœ€çš„æ•°æ®æ ¼å¼ã€‚é€šå¸¸æ˜¯éœ€è¦åç«¯æä¾›ç¬¦åˆæ ¼å¼è¦æ±‚çš„åŠ¨æ€æ•°æ®ï¼Œç„¶åå“åº”ç»™å‰ç«¯æ¥å±•ç¤ºå›¾è¡¨ã€‚</p>
<h1 id="è¥ä¸šé¢ç»Ÿè®¡"><a href="#è¥ä¸šé¢ç»Ÿè®¡" class="headerlink" title="è¥ä¸šé¢ç»Ÿè®¡"></a>è¥ä¸šé¢ç»Ÿè®¡</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304014833202.png" alt="image-20240304014833202"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>è¥ä¸šé¢æŒ‡çš„æ˜¯è®¢å•çŠ¶æ€å·²å®Œæˆçš„è®¢å•é‡‘é¢æ€»è®¡ã€‚</li>
<li>åŸºäºå¯è§†åŒ–æŠ¥è¡¨çš„æŠ˜çº¿å›¾å±•ç¤ºè¥ä¸šé¢æ•°æ®ï¼Œxè½´ä¸ºæ—¥æœŸï¼ŒYè½´ä¸ºè¥ä¸šé¢</li>
<li>æ ¹æ®æ—¶é—´é€‰æ‹©åŒºé—´ï¼Œå±•ç¤ºæ¯å¤©çš„è¥ä¸šé¢æ•°æ®</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong>ï¼š</p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304112249920.png" alt="image-20240304112249920"></p>
<h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p>æ ¹æ®æ¥å£å®šä¹‰è®¾è®¡å¯¹åº”çš„VOï¼š</p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304112754173.png" alt="image-20240304112754173"></p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ReportController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•°æ®ç»Ÿè®¡ç›¸å…³æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/report&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æ•°æ®ç»Ÿè®¡ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ReportService reportService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¥ä¸šé¢ç»Ÿè®¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/turnoverStatistics&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è¥ä¸šé¢ç»Ÿè®¡&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;TurnoverReportVO&gt; <span class="title function_">turnoverStatistics</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate begin,</span></span><br><span class="line"><span class="params">        <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate end)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;è¥ä¸šé¢æ•°æ®ç»Ÿè®¡ï¼š&#123;&#125;ï¼Œ&#123;&#125;&quot;</span>,begin,end);</span><br><span class="line">        <span class="type">TurnoverReportVO</span>  <span class="variable">turnoverReportVO</span> <span class="operator">=</span> reportService.getTurnoverStatistics(begin,end);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(turnoverReportVO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.vo.TurnoverReportVO;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ReportService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è¥ä¸šé¢æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    TurnoverReportVO <span class="title function_">getTurnoverStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ReportService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è¥ä¸šé¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> TurnoverReportVO <span class="title function_">getTurnoverStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">        <span class="comment">//å½“å‰é›†åˆç”¨äºå­˜æ”¾ä»beginåˆ°endèŒƒå›´å†…çš„æ¯å¤©çš„æ—¥æœŸ</span></span><br><span class="line">        List&lt;LocalDate&gt; dateList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        dateList.add(begin);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        åœ¨Javaä¸­ï¼Œå¯¹äºæ—¥æœŸå¯¹è±¡ï¼ˆå¦‚LocalDateã€LocalDateTimeç­‰ï¼‰ï¼Œå½“ä½ å°†å®ƒæ·»åŠ åˆ°åˆ—è¡¨ï¼ˆå¦‚dateListï¼‰æ—¶ï¼Œå®é™…ä¸Šæ·»åŠ çš„æ˜¯ä¸€ä¸ªå¼•ç”¨åˆ°è¯¥æ—¥æœŸå¯¹è±¡çš„å¼•ç”¨ã€‚ä½†æ˜¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒLocalDateå’ŒLocalDateTimeè¿™æ ·çš„æ—¥æœŸæ—¶é—´ç±»æ˜¯ä¸å¯å˜çš„ã€‚è¿™æ„å‘³ç€ï¼Œä¸€æ—¦ä¸€ä¸ªLocalDateå®ä¾‹è¢«åˆ›å»ºï¼Œå®ƒçš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚å¦‚æœä½ è°ƒç”¨å®ƒçš„plusDaysæ–¹æ³•ï¼ˆæˆ–å…¶ä»–ä»»ä½•ä¿®æ”¹æ—¥æœŸæ—¶é—´çš„æ–¹æ³•ï¼‰ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªæ–°çš„LocalDateå®ä¾‹ï¼Œè€ŒåŸå§‹çš„å®ä¾‹ä¿æŒä¸å˜ã€‚</span></span><br><span class="line"><span class="comment">//        å› æ­¤ï¼Œåœ¨ä½ çš„ä»£ç ç‰‡æ®µä¸­ï¼Œæ¯æ¬¡å¾ªç¯æ—¶è°ƒç”¨begin.plusDays(1)ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„LocalDateå¯¹è±¡ï¼Œå¹¶ä¸”æ›´æ–°beginå˜é‡å¼•ç”¨è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚ç„¶åï¼Œä½ å°†è¿™ä¸ªæ–°çš„å¯¹è±¡æ·»åŠ åˆ°dateListä¸­ã€‚æ‰€ä»¥ï¼Œå°½ç®¡beginå˜é‡æœ¬èº«æ˜¯ä¸€ä¸ªå¼•ç”¨å˜é‡ï¼Œä½†ç”±äºLocalDateçš„ä¸å¯å˜æ€§ï¼Œä½ å®é™…ä¸Šæ¯æ¬¡éƒ½åœ¨å‘åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ã€ä¸åŒçš„LocalDateå¯¹è±¡ã€‚</span></span><br><span class="line">        <span class="keyword">while</span> (!begin.equals(end)) &#123;</span><br><span class="line">            <span class="comment">//æ—¥æœŸè®¡ç®—ï¼Œè®¡ç®—æŒ‡å®šæ—¥æœŸçš„åä¸€å¤©å¯¹åº”çš„æ—¥æœŸ</span></span><br><span class="line">            begin = begin.plusDays(<span class="number">1</span>);</span><br><span class="line">            dateList.add(begin);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;Double&gt; turnoverList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (LocalDate date : dateList) &#123;</span><br><span class="line">            <span class="comment">//æŸ¥è¯¢dateæ—¥æœŸå¯¹åº”çš„è¥ä¸šé¢æ•°æ®ï¼Œè¥ä¸šé¢æ˜¯æŒ‡ï¼šçŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€çš„è®¢å•é‡‘é¢åˆè®¡</span></span><br><span class="line">            <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MIN);</span><br><span class="line">            <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MAX);</span><br><span class="line"></span><br><span class="line">            <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">            map.put(<span class="string">&quot;begin&quot;</span>,beginTime);</span><br><span class="line">            map.put(<span class="string">&quot;end&quot;</span>,endTime);</span><br><span class="line">            map.put(<span class="string">&quot;status&quot;</span>, Orders.COMPLETED);</span><br><span class="line">            <span class="type">Double</span> <span class="variable">turnover</span> <span class="operator">=</span> orderMapper.sumByMap(map);</span><br><span class="line">            turnover = turnover == <span class="literal">null</span> ? <span class="number">0.0</span> : turnover;</span><br><span class="line">            turnoverList.add(turnover);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°è£…è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> TurnoverReportVO</span><br><span class="line">            .builder()</span><br><span class="line">            .dateList(StringUtils.join(dateList, <span class="string">&#x27;,&#x27;</span>)) <span class="comment">//listä¸­æ¯ä¸ªå…ƒç´ å–å‡ºæ¥ï¼Œè½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">            .turnoverList(StringUtils.join(turnoverList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>orderMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åŠ¨æ€æ¡ä»¶æ¥ç»Ÿè®¡è¥ä¸šé¢æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">Double <span class="title function_">sumByMap</span><span class="params">(Map map)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>orderMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;sumByMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Double&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.Map&quot;</span>&gt;</span></span><br><span class="line">    select sum(amount) from orders</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;begin != null&quot;</span>&gt;</span>and order_time <span class="symbol">&amp;gt;</span> #&#123;begin&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;end != null&quot;</span>&gt;</span>and order_time <span class="symbol">&amp;lt;</span> #&#123;end&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span>and status = #&#123;status&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304130559620.png" alt="image-20240304130559620"></p>
<h1 id="ç”¨æˆ·ç»Ÿè®¡"><a href="#ç”¨æˆ·ç»Ÿè®¡" class="headerlink" title="ç”¨æˆ·ç»Ÿè®¡"></a>ç”¨æˆ·ç»Ÿè®¡</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-2"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-2" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304130744657.png" alt="image-20240304130744657"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>åŸºäºå¯è§†åŒ–æŠ¥è¡¨çš„æŠ˜çº¿å›¾æ¥å±•ç¤ºç”¨æˆ·æ•°æ®ï¼Œxè½´ä¸ºæ—¥æœŸï¼ŒYè½´ä¸ºç”¨æˆ·æ•°</li>
<li>æ ¹æ®æ—¶é—´é€‰æ‹©åŒºé—´ï¼Œå±•ç¤ºæ¯å¤©çš„ç”¨æˆ·æ€»é‡å’Œæ–°å¢ç”¨æˆ·é‡æ•°æ®</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304133851944.png" alt="image-20240304133851944"></p>
<h2 id="ä»£ç å¼€å‘-1"><a href="#ä»£ç å¼€å‘-1" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ReportController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç»Ÿè®¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/userStatistics&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;ç”¨æˆ·ç»Ÿè®¡&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;UserReportVO&gt; <span class="title function_">userStatistics</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate begin,</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate end)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;ç”¨æˆ·æ•°æ®ç»Ÿè®¡ï¼š&#123;&#125;&quot;</span>,begin,end);</span><br><span class="line">    <span class="type">UserReportVO</span> <span class="variable">userReportVO</span> <span class="operator">=</span> reportService.getUserStatistics(begin,end);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.success(userReportVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„ç”¨æˆ·æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">UserReportVO <span class="title function_">getUserStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ReportServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„ç”¨æˆ·æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> UserReportVO <span class="title function_">getUserStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">//å­˜æ”¾åœ¨beginå’Œendä¹‹é—´çš„æ¯å¤©å¯¹åº”çš„æ—¥æœŸ</span></span><br><span class="line">    List&lt;LocalDate&gt; dateList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    dateList.add(begin);</span><br><span class="line">    <span class="keyword">while</span> (!begin.equals(end)) &#123;</span><br><span class="line">        <span class="comment">//æ—¥æœŸè®¡ç®—ï¼Œè®¡ç®—æŒ‡å®šæ—¥æœŸçš„åä¸€å¤©å¯¹åº”çš„æ—¥æœŸ</span></span><br><span class="line">        begin = begin.plusDays(<span class="number">1</span>);</span><br><span class="line">        dateList.add(begin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­˜æ”¾æ¯å¤©çš„æ–°å¢ç”¨æˆ·æ•°é‡</span></span><br><span class="line">    <span class="comment">//select count(id) from user where create_time &lt; ? and create_time &gt; ?</span></span><br><span class="line">    List&lt;Integer&gt; newUserList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//å­˜æ”¾æ¯å¤©çš„æ€»ç”¨æˆ·æ•°é‡</span></span><br><span class="line">    <span class="comment">//select count(id) from user where create_time &lt; ?</span></span><br><span class="line">    List&lt;Integer&gt; totalUserList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (LocalDate date : dateList) &#123;</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢dateæ—¥æœŸå¯¹åº”çš„è¥ä¸šé¢æ•°æ®ï¼Œè¥ä¸šé¢æ˜¯æŒ‡ï¼šçŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€çš„è®¢å•é‡‘é¢åˆè®¡</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MIN);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MAX);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;end&quot;</span>,endTime);</span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">totalUser</span> <span class="operator">=</span> userMapper.countByMap(map);</span><br><span class="line">        totalUserList.add(totalUser);</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;begin&quot;</span>,beginTime);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">newUser</span> <span class="operator">=</span> userMapper.countByMap(map);</span><br><span class="line">        newUserList.add(newUser);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> UserReportVO.builder()</span><br><span class="line">        .dateList(StringUtils.join(dateList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .newUserList(StringUtils.join(newUserList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .totalUserList(StringUtils.join(totalUserList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åŠ¨æ€æ¡ä»¶ç»Ÿè®¡ç”¨æˆ·æ•°é‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">Integer <span class="title function_">countByMap</span><span class="params">(Map map)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>UserMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;countByMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Integer&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.Map&quot;</span>&gt;</span></span><br><span class="line">    select count(id) from user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;begin != null&quot;</span>&gt;</span></span><br><span class="line">            and create_time <span class="symbol">&amp;gt;</span> #&#123;begin&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;end != null&quot;</span>&gt;</span></span><br><span class="line">            and create_time <span class="symbol">&amp;lt;</span> #&#123;end&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304143222436.png" alt="image-20240304143222436"></p>
<h1 id="è®¢å•ç»Ÿè®¡"><a href="#è®¢å•ç»Ÿè®¡" class="headerlink" title="è®¢å•ç»Ÿè®¡"></a>è®¢å•ç»Ÿè®¡</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-3"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-3" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304143650130.png" alt="image-20240304143650130"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>æœ‰æ•ˆè®¢å•æŒ‡çš„æ˜¯çŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€çš„è®¢å•</li>
<li>åŸºäºå¯è§†åŒ–æŠ¥è¡¨çš„æŠ˜çº¿å›¾å±•ç¤ºè®¢å•æ•°æ®ï¼Œxè½´ä¸ºæ—¥æœŸï¼ŒYè½´ä¸ºè®¢å•æ•°é‡</li>
<li>æ ¹æ®æ—¶é—´é€‰æ‹©åŒºé—´ï¼Œå±•ç¤ºæ¯å¤©çš„è®¢å•æ€»æ•°å’Œæœ‰æ•ˆè®¢å•æ•°</li>
<li>å±•ç¤ºæ‰€é€‰æ—¶é—´åŒºé—´å†…çš„æœ‰æ•ˆè®¢å•æ•°ã€æ€»è®¢å•æ•°ã€è®¢å•å®Œæˆç‡ &#x3D; æœ‰æ•ˆè®¢å•æ•° &#x2F;æ€»è®¢å•æ•° * 100 %</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong>ï¼š</p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304144203906.png" alt="image-20240304144203906"></p>
<h2 id="ä»£ç å¼€å‘-2"><a href="#ä»£ç å¼€å‘-2" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304144517287.png" alt="image-20240304144517287"></p>
<p><strong>ReportController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è®¢å•æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/odersStatistics&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;è®¢å•ç»Ÿè®¡&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;OrderReportVO&gt; <span class="title function_">orderStatistics</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate begin,</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate end)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;è®¢å•æ•°æ®ç»Ÿè®¡ï¼š&#123;&#125;,&#123;&#125;&quot;</span>,begin,end);</span><br><span class="line">    <span class="type">OrderReportVO</span> <span class="variable">orderReportVO</span> <span class="operator">=</span> reportService.getOrderStatistics(begin,end);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.success(orderReportVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è®¢å•æ•°æ®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> OrderReportVO <span class="title function_">getOrderStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="comment">//å­˜æ”¾åœ¨beginå’Œendä¹‹é—´çš„æ¯å¤©å¯¹åº”çš„æ—¥æœŸ</span></span><br><span class="line">    List&lt;LocalDate&gt; dateList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    dateList.add(begin);</span><br><span class="line">    <span class="keyword">while</span> (!begin.equals(end)) &#123;</span><br><span class="line">        <span class="comment">//æ—¥æœŸè®¡ç®—ï¼Œè®¡ç®—æŒ‡å®šæ—¥æœŸçš„åä¸€å¤©å¯¹åº”çš„æ—¥æœŸ</span></span><br><span class="line">        begin = begin.plusDays(<span class="number">1</span>);</span><br><span class="line">        dateList.add(begin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; orderCountList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    List&lt;Integer&gt; validOrderCountList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éå†dateListé›†åˆ,æŸ¥è¯¢æ¯å¤©çš„æœ‰æ•ˆè®¢å•æ•°å’Œè®¢å•æ€»æ•°</span></span><br><span class="line">    <span class="keyword">for</span> (LocalDate date : dateList) &#123;</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢dateæ—¥æœŸå¯¹åº”çš„è¥ä¸šé¢æ•°æ®ï¼Œè¥ä¸šé¢æ˜¯æŒ‡ï¼šçŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€çš„è®¢å•é‡‘é¢åˆè®¡</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MIN);</span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(date, LocalTime.MAX);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŸ¥è¯¢æ¯å¤©çš„è®¢å•æ€»æ•° select count(id) from orders where order_time &gt; ? and order_time &lt; ?</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">orderCount</span> <span class="operator">=</span> getOrderCount(beginTime, endTime, <span class="literal">null</span>);</span><br><span class="line">        orderCountList.add(orderCount);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŸ¥è¯¢æ¯å¤©çš„æœ‰æ•ˆè®¢å•æ•° select count(id) from orders where order_time &gt; ? and order_time &lt; ? and status = ?</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">validOrderCount</span> <span class="operator">=</span> getOrderCount(beginTime, endTime, Orders.COMPLETED);</span><br><span class="line">        validOrderCountList.add(validOrderCount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¡ç®—æ—¶é—´åŒºé—´å†…çš„è®¢å•æ€»æ•°é‡</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">totalOrderCount</span> <span class="operator">=</span> orderCountList.stream().reduce(Integer::sum).get();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¡ç®—æ—¶é—´åŒºé—´å†…çš„æœ‰æ•ˆè®¢å•æ•°é‡</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">validOrderCount</span> <span class="operator">=</span> validOrderCountList.stream().reduce(Integer::sum).get();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¡ç®—è®¢å•å®Œæˆç‡</span></span><br><span class="line">    <span class="type">Double</span> <span class="variable">orderCompletionRate</span> <span class="operator">=</span> <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">if</span> (totalOrderCount != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//è®¡ç®—è®¢å•å®Œæˆç‡</span></span><br><span class="line">        orderCompletionRate = validOrderCount.doubleValue() / totalOrderCount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">OrderReportVO</span> <span class="variable">orderReportVO</span> <span class="operator">=</span> OrderReportVO.builder()</span><br><span class="line">        .dateList(StringUtils.join(dateList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .orderCountList(StringUtils.join(orderCountList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .validOrderCountList(StringUtils.join(validOrderCountList, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">        .totalOrderCount(totalOrderCount)</span><br><span class="line">        .validOrderCount(validOrderCount)</span><br><span class="line">        .orderCompletionRate(orderCompletionRate)</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> orderReportVO;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®æ¡ä»¶ç»Ÿè®¡è®¢å•æ•°é‡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Integer <span class="title function_">getOrderCount</span><span class="params">(LocalDateTime begin, LocalDateTime end, Integer status)</span> &#123;</span><br><span class="line">    <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    map.put(<span class="string">&quot;begin&quot;</span>, begin);</span><br><span class="line">    map.put(<span class="string">&quot;end&quot;</span>, end);</span><br><span class="line">    map.put(<span class="string">&quot;status&quot;</span>, status);</span><br><span class="line"></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">integer</span> <span class="operator">=</span> orderMapper.countByMap(map);</span><br><span class="line">    <span class="keyword">return</span> integer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„è®¢å•æ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">OrderReportVO <span class="title function_">getOrderStatistics</span><span class="params">(LocalDate begin, LocalDate end)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>OrderMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åŠ¨æ€æ¡ä»¶ç»Ÿè®¡è®¢å•æ•°é‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">Integer <span class="title function_">countByMap</span><span class="params">(Map map)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>OrderMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;countByMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Integer&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.Map&quot;</span>&gt;</span></span><br><span class="line">    select count(id) from orders</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;begin != null&quot;</span>&gt;</span>and order_time <span class="symbol">&amp;gt;</span> #&#123;begin&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;end != null&quot;</span>&gt;</span>and order_time <span class="symbol">&amp;lt;</span> #&#123;end&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span>and status = #&#123;status&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304152249706.png" alt="image-20240304152249706"></p>
<h1 id="é”€é‡æ’åTop10"><a href="#é”€é‡æ’åTop10" class="headerlink" title="é”€é‡æ’åTop10"></a>é”€é‡æ’åTop10</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-4"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-4" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304153058597.png" alt="image-20240304153058597"></p>
<p><strong>ä¸šåŠ¡è§„åˆ™ï¼š</strong></p>
<ul>
<li>æ ¹æ®æ—¶é—´é€‰æ‹©åŒºé—´ï¼Œå±•ç¤ºé”€é‡å‰10çš„å•†å“ï¼ˆåŒ…æ‹¬èœå“å’Œå¥—é¤ï¼‰</li>
<li>åŸºäºå¯è§†åŒ–æŠ¥è¡¨çš„æŸ±çŠ¶å›¾é™åºå±•ç¤ºå•†å“é”€é‡</li>
<li>æ­¤å¤„çš„é”€é‡ä¸ºå•†å“é”€å”®çš„ä»½æ•°</li>
</ul>
<p><strong>æ¥å£è®¾è®¡ï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304154130097.png" alt="image-20240304154130097"></p>
<p><strong>æ ¹æ®é”€é‡æ’åæ¥å£çš„è¿”å›ç»“æœè®¾è®¡VOï¼š</strong></p>
<p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304154259462.png" alt="image-20240304154259462"></p>
<h2 id="ä»£ç å¼€å‘-3"><a href="#ä»£ç å¼€å‘-3" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡èœå“å’Œå¥—é¤çš„TOP10é”€å”®æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/top10&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;é”€é‡TOP10&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;SalesTop10ReportVO&gt; <span class="title function_">top10</span><span class="params">(</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate begin,</span></span><br><span class="line"><span class="params">    <span class="meta">@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;)</span> LocalDate end)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;é”€é‡æ’åtop10ï¼š&#123;&#125;,&#123;&#125;&quot;</span>,begin,end);</span><br><span class="line"></span><br><span class="line">    <span class="type">SalesTop10ReportVO</span> <span class="variable">salesTop10ReportVO</span> <span class="operator">=</span>  reportService.getSalesTop10(begin,end);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.success(salesTop10ReportVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ReportService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„é”€é‡æ’åtop10</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">SalesTop10ReportVO <span class="title function_">getSalesTop10</span><span class="params">(LocalDate begin, LocalDate end)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ReportServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„é”€é‡æ’åtop10</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SalesTop10ReportVO <span class="title function_">getSalesTop10</span><span class="params">(LocalDate begin, LocalDate end)</span> &#123;</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">beginTime</span> <span class="operator">=</span> LocalDateTime.of(begin, LocalTime.MIN);</span><br><span class="line">    <span class="type">LocalDateTime</span> <span class="variable">endTime</span> <span class="operator">=</span> LocalDateTime.of(end, LocalTime.MAX);</span><br><span class="line"></span><br><span class="line">    List&lt;GoodsSalesDTO&gt; salesTop = orderMapper.getSalesTop(beginTime, endTime);</span><br><span class="line"></span><br><span class="line">    List&lt;String&gt; names = salesTop.stream().map(GoodsSalesDTO::getName).collect(Collectors.toList());</span><br><span class="line">    <span class="type">String</span> <span class="variable">nameList</span> <span class="operator">=</span> StringUtils.join(names, <span class="string">&quot;,&quot;</span>);</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; numbers = salesTop.stream().map(GoodsSalesDTO::getNumber).collect(Collectors.toList());</span><br><span class="line">    <span class="type">String</span> <span class="variable">numberList</span> <span class="operator">=</span> StringUtils.join(numbers, <span class="string">&quot;,&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> SalesTop10ReportVO.builder()</span><br><span class="line">        .nameList(nameList)</span><br><span class="line">        .numberList(numberList)</span><br><span class="line">        .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æŒ‡å®šæ—¶é—´åŒºé—´å†…çš„é”€é‡æ’åå‰10</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> begin</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">List&lt;GoodsSalesDTO&gt; <span class="title function_">getSalesTop</span><span class="params">(LocalDateTime begin,LocalDateTime end)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>OrderMapper.xml</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;select id=<span class="string">&quot;getSalesTop&quot;</span> resultType=<span class="string">&quot;com.sky.dto.GoodsSalesDTO&quot;</span>&gt;</span><br><span class="line">    select od.name, sum(od.number) as number</span><br><span class="line">    from sky_take_out.order_detail od,</span><br><span class="line">sky_take_out.orders o</span><br><span class="line">    &lt;where&gt;</span><br><span class="line">    od.order_id = o.id</span><br><span class="line">    and o.status = <span class="number">5</span></span><br><span class="line">    &lt;<span class="keyword">if</span> test=<span class="string">&quot;begin!= null&quot;</span>&gt;and o.order_time &amp;gt; #&#123;begin&#125;&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">if</span> test=<span class="string">&quot;end != null&quot;</span>&gt;and o.order_time &amp;lt; #&#123;end&#125;&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;/where&gt;</span><br><span class="line">            group by od.name</span><br><span class="line">            order by number desc</span><br><span class="line">            limit <span class="number">0</span>,<span class="number">10</span>;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-3"><a href="#åŠŸèƒ½æµ‹è¯•-3" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/04/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day11-%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1-%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/image-20240304162246940.png" alt="image-20240304162246940"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day10-è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†ã€æ¥å•æé†’å’Œå®¢æˆ·å‚¬å•</title>
    <url>/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/</url>
    <content><![CDATA[<h1 id="è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†"><a href="#è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†" class="headerlink" title="è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†"></a>è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†</h1><p><strong>æ”¯ä»˜è¶…æ—¶çš„è®¢å•å¦‚ä½•å¤„ç†ï¼Ÿ</strong></p>
<p>è®¢å•è¶…æ—¶å°±å–æ¶ˆã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303132610198.png" alt="image-20240303132610198"></p>
<p><strong>æ´¾é€ä¸­çš„è®¢å•ä¸€ç›´ä¸ç‚¹å‡»å®Œæˆå¦‚ä½•å¤„ç†ï¼Ÿ</strong></p>
<p>å®šæ—¶å¤„ç†è®¢å•ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303132616206.png" alt="image-20240303132616206"></p>
<h1 id="æ¥å•æé†’å’Œå®¢æˆ·å‚¬å•"><a href="#æ¥å•æé†’å’Œå®¢æˆ·å‚¬å•" class="headerlink" title="æ¥å•æé†’å’Œå®¢æˆ·å‚¬å•"></a>æ¥å•æé†’å’Œå®¢æˆ·å‚¬å•</h1><p>ç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼Œå•†å®¶è¦è¿›è¡Œè¯­éŸ³æ’­æŠ¥ï¼Œæé†’å•†å®¶æ¥å•ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303132645635.png" alt="image-20240303132645635"></p>
<p>ç”¨æˆ·æ”¯ä»˜å®Œè®¢å•äº†ï¼Œå•†å®¶è¿˜æœªå‘å•ï¼Œç”¨æˆ·å¯ä»¥å‚¬å•ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303132711971.png" alt="image-20240303132711971"></p>
<h1 id="Spring-Task"><a href="#Spring-Task" class="headerlink" title="Spring Task"></a>Spring Task</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Spring Taskæ˜¯springæ¡†æ¶æä¾›çš„ä»»åŠ¡è°ƒåº¦å·¥å…·ï¼Œå¯ä»¥æŒ‰ç…§çº¦å®šçš„æ—¶é—´è‡ªåŠ¨æ‰§è¡ŒæŸä¸ªä»»åŠ¡é€»è¾‘ã€‚</p>
<p>å®šæ—¶ï¼šå®šæ—¶ä»»åŠ¡æ¡†æ¶</p>
<p>ä½œç”¨ï¼šå®šæ—¶è‡ªåŠ¨æ‰§è¡ŒæŸæ®µJavaä»£ç </p>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><p>ä¿¡ç”¨å¡æ¯æ—¥è¿˜æ¬¾æé†’</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303133816397.png" alt="image-20240303133816397"></p>
</li>
<li><p>é“¶è¡Œè´·æ¬¾æ¯æœˆè¿˜æ¬¾æé†’</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303133902653.png" alt="image-20240303133902653"></p>
</li>
<li><p>ç«è½¦ç¥¨å”®ç¥¨ç³»ç»Ÿå¤„ç†æœªæ”¯ä»˜è®¢å•</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303133925421.png" alt="image-20240303133925421"></p>
</li>
<li><p>å…¥èŒçºªå¿µæ—¥ä¸ºç”¨æˆ·å‘é€é€šçŸ¥</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303134035423.png" alt="image-20240303134035423"></p>
</li>
<li><p><font color="red">åªè¦æ˜¯éœ€è¦å®šæ—¶å¤„ç†çš„åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨Spring Task</font></p>
</li>
</ul>
<p><strong>å¯åŠ¨ç±»åŠ ä¸Šæ³¨è§£@EnableCaching</strong></p>
<p><strong>task.MyTask</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTask</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®šæ—¶ä»»åŠ¡ æ¯éš”5ç§’è§¦å‘ä¸€æ¬¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0/5 * * * * ?&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">executeTask</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å®šæ—¶ä»»åŠ¡å¼€å§‹æ‰§è¡Œï¼š&#123;&#125;&quot;</span>,<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303164947876.png" alt="image-20240303164947876"></p>
<h2 id="cronè¡¨è¾¾å¼"><a href="#cronè¡¨è¾¾å¼" class="headerlink" title="cronè¡¨è¾¾å¼"></a>cronè¡¨è¾¾å¼</h2><p>cronè¡¨è¾¾å¼å…¶å®å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡cronè¡¨è¾¾å¼å¯ä»¥å®šä¹‰ä»»åŠ¡è§¦å‘çš„äº‹ä»¶</p>
<p>æ„æˆè§„åˆ™ï¼šåˆ†æˆ6æˆ–7ä¸ªåŸŸï¼Œç”±ç©ºæ ¼åˆ†éš”å¼€ï¼Œæ¯ä¸ªåŸŸä»£è¡¨ä¸€ä¸ªå«ä¹‰</p>
<p>æ¯ä¸ªåŸŸçš„å«ä¹‰åˆ†åˆ«ä¸ºï¼šç§’ã€åˆ†é’Ÿã€å°æ—¶ã€æ—¥ã€æœˆã€å‘¨ã€å¹´ï¼ˆå¯é€‰ï¼‰</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303165813217.png" alt="image-20240303165813217"></p>
<p>cronè¡¨è¾¾å¼åœ¨çº¿ç”Ÿæˆå™¨ï¼š<a href="https://cron.qqe2.com/">https://cron.qqe2.com/</a></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303165922769.png" alt="image-20240303165922769"></p>
<h2 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>Spring Taskä½¿ç”¨æ­¥éª¤ï¼š</p>
<ol>
<li>å¯¼å…¥mavenåæ ‡spring-contextï¼ˆå·²å­˜åœ¨ï¼‰</li>
<li>å¯åŠ¨ç±»æ·»åŠ æ³¨é‡Š@EnableSchedulingå¼€å¯ä»»åŠ¡è°ƒåº¦</li>
<li>è‡ªå®šä¹‰å®šæ—¶ä»»åŠ¡ç±»</li>
</ol>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303170731276.png" alt="image-20240303170731276"></p>
<h1 id="è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†-1"><a href="#è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†-1" class="headerlink" title="è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†"></a>è®¢å•çŠ¶æ€å®šæ—¶å¤„ç†</h1><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><p>ç”¨æˆ·ä¸‹å•åå¯èƒ½å­˜åœ¨çš„æƒ…å†µï¼š</p>
<ul>
<li><p>ä¸‹å•åæœªæ”¯ä»˜ï¼Œè®¢å•ä¸€ç›´å¤„äºâ€œ<font color="red">å¾…æ”¯ä»˜</font>â€çŠ¶æ€ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303171518762.png" alt="image-20240303171518762"></p>
</li>
<li><p>ç”¨æˆ·æ”¶è´§åç®¡ç†ç«¯æœªç‚¹å‡»å®ŒæˆæŒ‰é’®ï¼Œè®¢å•ä¸€ç›´å¤„äºâ€œ<font color="red">æ´¾é€ä¸­</font>â€çŠ¶æ€ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303171509233.png" alt="image-20240303171509233"></p>
</li>
</ul>
<p>å¯¹äºä¸Šé¢ä¸¤ç§æƒ…å†µéœ€è¦é€šè¿‡<font color="red">å®šæ—¶ä»»åŠ¡</font>æ¥ä¿®æ”¹è®¢å•çŠ¶æ€ï¼Œå…·ä½“é€»è¾‘ä¸ºï¼š</p>
<ul>
<li>é€šè¿‡å®šæ—¶ä»»åŠ¡<strong>æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</strong>æ˜¯å¦å­˜åœ¨æ”¯ä»˜è¶…æ—¶è®¢å•ï¼ˆä¸‹å•åè¶…è¿‡15åˆ†é’Ÿä»æœªæ”¯ä»˜åˆ™åˆ¤å®šä¸ºæ”¯ä»˜è¶…æ—¶è®¢å•ï¼‰ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºâ€œå·²å–æ¶ˆâ€ã€‚</li>
<li>é€šè¿‡å®šæ—¶ä»»åŠ¡<strong>æ¯å¤©å‡Œæ™¨ä¸€ç‚¹æ£€æŸ¥ä¸€æ¬¡</strong>æ˜¯å¦å­˜åœ¨â€œæ´¾é€ä¸­â€çš„è®¢å•ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºâ€œå·²å®Œæˆâ€ã€‚</li>
</ul>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.task;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Orders;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.OrderMapper;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šæ—¶ä»»åŠ¡ç±»ï¼Œå®šæ—¶å¤„ç†è®¢å•çŠ¶æ€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderTask</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†è¶…æ—¶è®¢å•çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//    @Scheduled(cron = &quot;0 * * * * ?&quot;) //æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;1/5 * * * * ?&quot;)</span> <span class="comment">//æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processTimeOutOrder</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å®šæ—¶å¤„ç†è¶…æ—¶è®¢å•ï¼š&#123;&#125;&quot;</span>, LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> LocalDateTime.now().minusMinutes(<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//select * from orders where status == ? and order_time  &lt; (å½“å‰æ—¶é—´ - 15åˆ†é’Ÿ)</span></span><br><span class="line">        List&lt;Orders&gt; ordersList = orderMapper.getByStatusAndOrderTimeLT(Orders.PENDING_PAYMENT, time);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(ordersList != <span class="literal">null</span> &amp;&amp; ordersList.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Orders orders : ordersList) &#123;</span><br><span class="line">                orders.setStatus(Orders.CANCELLED);</span><br><span class="line">                orders.setCancelReason(<span class="string">&quot;è®¢å•è¶…æ—¶ï¼Œè‡ªåŠ¨å–æ¶ˆ&quot;</span>);</span><br><span class="line">                orders.setCancelTime(LocalDateTime.now());</span><br><span class="line">                orderMapper.update(orders);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†ä¸€ç›´å¤„äºæ´¾é€ä¸­çŠ¶æ€çš„è®¢å•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//    @Scheduled(cron = &quot;0 0 1 * * ?&quot;) //æ¯å¤©å‡Œæ™¨1ç‚¹è§¦å‘ä¸€æ¬¡</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0/5 * * * * ?&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processDeliveryOrder</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å®šæ—¶å¤„ç†å¤„äºæ´¾é€ä¸­çš„è®¢å•ï¼š&#123;&#125;&quot;</span>,LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">time</span> <span class="operator">=</span> LocalDateTime.now().minusMinutes(<span class="number">60</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Orders&gt; ordersList = orderMapper.getByStatusAndOrderTimeLT(Orders.DELIVERY_IN_PROGRESS, time);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(ordersList != <span class="literal">null</span> &amp;&amp; ordersList.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Orders orders : ordersList) &#123;</span><br><span class="line">                orders.setStatus(Orders.COMPLETED);</span><br><span class="line">                orderMapper.update(orders);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>ç•¥</p>
<h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><h2 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>WebSocketæ˜¯åŸºäºTCPçš„ä¸€ç§æ–°çš„<font color="red">ç½‘ç»œåè®®</font>ã€‚å®ƒå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡â€”â€”æµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±å¯ä»¥åˆ›å»º<font color="red">æŒä¹…æ€§</font>çš„é“¾æ¥ï¼Œå¹¶è¿›è¡Œ<font color="red">åŒå‘</font>ä¼ è¾“ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303210949025.png" alt="image-20240303210949025"></p>
<p>HTTPåè®®ï¼Œå·¦ä¾§Clientï¼Œå³ä¾§Serverã€‚</p>
<p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„äº¤äº’è¿‡ç¨‹åŸºäºHTTPï¼šå®¢æˆ·ç«¯Clientå‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œä¼šè¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œæ¥ç€ç»™å®¢æˆ·ç«¯responseã€‚è¿™ç§äº¤äº’æ–¹å¼ç§°ä¸º<strong>è¯·æ±‚-å“åº”æ¨¡å¼</strong>ï¼Œæ˜¯<strong>çŸ­è¿æ¥</strong>ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303212623145.png" alt="image-20240303212623145"></p>
<p>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€Handshakeï¼ŒæœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯Acknowledgementï¼Œæ­¤åäºŒè€…å»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å‡å¯ä»¥å‘é€æ¶ˆæ¯ã€‚ï¼ˆç±»æ¯”äºç°å®æ‰“ç”µè¯ï¼‰ï¼Œæ˜¯<strong>é•¿è¿æ¥</strong>ã€‚</p>
<p><strong>HTTPåè®®å’ŒWebSocketåè®®å¯¹æ¯”ï¼š</strong></p>
<ul>
<li>HTTPæ˜¯<font color="red">çŸ­è¿æ¥</font></li>
<li>WebSocketæ˜¯<font color="red">é•¿è¿æ¥</font></li>
<li>HTTPé€šä¿¡æ˜¯<font color="red">å•å‘</font>çš„ï¼ŒåŸºäºè¯·æ±‚å“åº”æ¨¡å¼</li>
<li>WebSocketæ”¯æŒ<font color="red">åŒå‘</font>é€šä¿¡</li>
<li>HTTPå’ŒWebSocketåº•å±‚éƒ½æ˜¯TCPé“¾æ¥</li>
</ul>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><p>è§†é¢‘å¼¹å¹•</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303211712257.png" alt="image-20240303211712257"></p>
</li>
<li><p>ç½‘é¡µèŠå¤©</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303211749684.png" alt="image-20240303211749684"></p>
</li>
<li><p>ä½“è‚²å®å†µæ›´æ–°</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303211811583.png" alt="image-20240303211811583"></p>
</li>
<li><p>è‚¡ç¥¨åŸºé‡‘æŠ¥ä»·å®æ—¶æ›´æ–°</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303211851380.png" alt="image-20240303211851380"></p>
</li>
</ul>
<h2 id="å…¥é—¨æ¡ˆä¾‹-1"><a href="#å…¥é—¨æ¡ˆä¾‹-1" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>ç›´æ¥ä½¿ç”¨websocket.htmlé¡µé¢ä½œä¸ºWebSocketå®¢æˆ·ç«¯</li>
<li>å¯¼å…¥WebSocketçš„mavenåæ ‡</li>
<li>å¯¼å…¥WebSocketæœåŠ¡ç«¯ç»„ä»¶WebSocketServerï¼Œç”¨äºå’Œå®¢æˆ·ç«¯é€šä¿¡</li>
<li>å¯¼å…¥é…ç½®ç±»WebSocketConfigurationï¼Œæ³¨å†ŒWebSocketçš„æœåŠ¡ç«¯ç»„ä»¶</li>
<li>å¯¼å…¥å®šæ—¶ä»»åŠ¡ç±»WebSocketTaskï¼Œå®šæ—¶å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®</li>
</ol>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303212557934.png" alt="image-20240303212557934"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303212612276.png" alt="image-20240303212612276"></p>
<p><strong>å¯¼å…¥mavenåæ ‡</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>WebSocketConfiguration</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.server.standard.ServerEndpointExporter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * WebSocketé…ç½®ç±»ï¼Œç”¨äºæ³¨å†ŒWebSocketçš„Bean</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ServerEndpointExporter <span class="title function_">serverEndpointExporter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServerEndpointExporter</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>WebSocketServer</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.websocket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.OnClose;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.OnMessage;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.OnOpen;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.Session;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.PathParam;</span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * WebSocketæœåŠ¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ServerEndpoint(&quot;/ws/&#123;sid&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketServer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­˜æ”¾ä¼šè¯å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Session&gt; sessionMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnOpen</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onOpen</span><span class="params">(Session session, <span class="meta">@PathParam(&quot;sid&quot;)</span> String sid)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å®¢æˆ·ç«¯ï¼š&quot;</span> + sid + <span class="string">&quot;å»ºç«‹è¿æ¥&quot;</span>);</span><br><span class="line">        sessionMap.put(sid, session);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnMessage</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(String message, <span class="meta">@PathParam(&quot;sid&quot;)</span> String sid)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯ï¼š&quot;</span> + sid + <span class="string">&quot;çš„ä¿¡æ¯:&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sid</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@OnClose</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClose</span><span class="params">(<span class="meta">@PathParam(&quot;sid&quot;)</span> String sid)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿æ¥æ–­å¼€:&quot;</span> + sid);</span><br><span class="line">        sessionMap.remove(sid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¾¤å‘</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendToAllClient</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        Collection&lt;Session&gt; sessions = sessionMap.values();</span><br><span class="line">        <span class="keyword">for</span> (Session session : sessions) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">//æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span></span><br><span class="line">                session.getBasicRemote().sendText(message);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <strong>WebSocketTask</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.task;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.websocket.WebSocketServer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSocketTask</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WebSocketServer webSocketServer;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡WebSocketæ¯éš”5ç§’å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Scheduled(cron = &quot;0/5 * * * * ?&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessageToClient</span><span class="params">()</span> &#123;</span><br><span class="line">        webSocketServer.sendToAllClient(<span class="string">&quot;è¿™æ˜¯æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼š&quot;</span> + DateTimeFormatter.ofPattern(<span class="string">&quot;HH:mm:ss&quot;</span>).format(LocalDateTime.now()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ¥å•æé†’"><a href="#æ¥å•æé†’" class="headerlink" title="æ¥å•æé†’"></a>æ¥å•æé†’</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p>ç”¨æˆ·ä¸‹å•å¹¶ä¸”æ”¯ä»˜æˆåŠŸåï¼Œéœ€è¦ç¬¬ä¸€æ—¶é—´é€šçŸ¥å¤–å–å•†å®¶ï¼Œé€šçŸ¥çš„å½¢å¼æœ‰å¦‚ä¸‹ä¸¤ç§ï¼š</p>
<ul>
<li>è¯­éŸ³æ’­æ”¾</li>
<li>å¼¹å‡ºæç¤ºæ¡†</li>
</ul>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303220126521.png" alt="image-20240303220126521"></p>
<p><strong>è®¾è®¡ï¼š</strong></p>
<ul>
<li><p>é€šè¿‡WebSocketå®ç°ç®¡ç†ç«¯é¡µé¢å’ŒæœåŠ¡ç«¯ä¿æŒé•¿è¿æ¥çŠ¶æ€</p>
<p>å·²ç»å®Œæˆäº†ï¼Œæˆ‘ä»¬å®Œæˆäº†WebSocketServerç±»ï¼Œå¹¶å°†ä»–ä½œä¸ºBeanå¯¹è±¡æ³¨å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œå®ƒä¸€ç›´ç›‘å¬ç€å¯¹åº”çš„&#x2F;ws&#x2F;{sid}æ¥å£ã€‚è¯·æ±‚æ˜¯å…ˆè¯·æ±‚åˆ°nginxï¼Œå†ç”±nginxåå‘ä»£ç†è½¬å‘åˆ°åç«¯ï¼ˆæˆ‘ä»¬éœ€è¦æå‰åœ¨nginxä¸­é…ç½®æ–‡ä»¶ï¼‰ã€‚</p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303233558871.png" alt="image-20240303233558871"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303233616675.png" alt="image-20240303233616675"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303234106056.png" alt="image-20240303234106056"></p>
</li>
<li><p>å½“ç”¨æˆ·æ”¯ä»˜åï¼Œè°ƒç”¨WebSocketçš„ç›¸å…³APIå®ç°æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯</p>
</li>
<li><p>å®¢æˆ·ç«¯æµè§ˆå™¨è§£ææœåŠ¡ç«¯æ¨é€çš„æ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯æ¥å•æé†’è¿˜æ˜¯å®¢æˆ·å‚¬å•ï¼Œè¿›è¡Œç›¸åº”çš„æ¶ˆæ¯æç¤ºå’Œè¯­éŸ³æ’­æŠ¥</p>
</li>
<li><p>çº¦å®šæœåŠ¡ç«¯å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨çš„æ•°æ®æ ¼å¼ä¸ºJSONï¼Œå­—æ®µåŒ…æ‹¬ï¼štypeï¼ŒorderIdï¼Œcontent</p>
<ul>
<li>typeä¸ºæ¶ˆæ¯ç±»å‹ï¼Œ1ä¸ºæ¥å•æé†’ 2ä¸ºå®¢æˆ·å‚¬å•</li>
<li>orderIdä¸ºè®¢å•id</li>
<li>contentä¸ºæ¶ˆæ¯å†…å®¹</li>
</ul>
</li>
</ul>
<h2 id="ä»£ç å¼€å‘-1"><a href="#ä»£ç å¼€å‘-1" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ä¿®æ”¹paySuccess</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paySuccess</span><span class="params">(String outTradeNo)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getByNumber(outTradeNo);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®è®¢å•idæ›´æ–°è®¢å•çš„çŠ¶æ€ã€æ”¯ä»˜æ–¹å¼ã€æ”¯ä»˜çŠ¶æ€ã€ç»“è´¦æ—¶é—´</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> Orders.builder()</span><br><span class="line">        .id(ordersDB.getId())</span><br><span class="line">        .status(Orders.TO_BE_CONFIRMED)</span><br><span class="line">        .payStatus(Orders.PAID)</span><br><span class="line">        .checkoutTime(LocalDateTime.now())</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    orderMapper.update(orders);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡websocketå‘å®¢æˆ·ç«¯æµè§ˆå™¨æ¨é€æ¶ˆæ¯ type orderId content</span></span><br><span class="line">    <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    map.put(<span class="string">&quot;type&quot;</span>,<span class="number">1</span>);  <span class="comment">//1. è¡¨ç¤ºæ¥å•æé†’ï¼Œ 2. è¡¨ç¤ºå®¢æˆ·å‚¬å•</span></span><br><span class="line">    map.put(<span class="string">&quot;orderId&quot;</span>,ordersDB.getId());</span><br><span class="line">    map.put(<span class="string">&quot;content&quot;</span>,<span class="string">&quot;è®¢å•å·ï¼š&quot;</span> + outTradeNo);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(map);</span><br><span class="line">    webSocketServer.sendToAllClient(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303235101847.png" alt="image-20240303235101847"></p>
<p><strong>åç«¯ä¿®æ”¹å›è°ƒåœ°å€</strong></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303235212549.png" alt="image-20240303235212549"></p>
<p><strong>åç«¯å¯åŠ¨ç¨‹åºï¼Œå‰ç«¯ç™»å½•</strong></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303235416549.png" alt="image-20240303235416549"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240303235429278.png" alt="image-20240303235429278"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304000557187.png" alt="image-20240304000557187"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304000441664.png" alt="image-20240304000441664"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304000426919.png" alt="image-20240304000426919"></p>
<h1 id="å®¢æˆ·å‚¬å•"><a href="#å®¢æˆ·å‚¬å•" class="headerlink" title="å®¢æˆ·å‚¬å•"></a>å®¢æˆ·å‚¬å•</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304000636439.png" alt="image-20240304000636439"></p>
<p>è®¾è®¡ï¼š</p>
<ul>
<li>é€šè¿‡WebSocketå®ç°ç®¡ç†ç«¯é¡µé¢å’ŒæœåŠ¡ç«¯ä¿æŒé•¿è¿æ¥çŠ¶æ€</li>
<li>å½“ç”¨æˆ·ç‚¹å‡»å‚¬å•æŒ‰é’®åï¼Œè°ƒç”¨WebSocketçš„ç›¸å…³APIå®ç°æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯</li>
<li>å®¢æˆ·ç«¯æµè§ˆå™¨è§£ææœåŠ¡ç«¯æ¨é€çš„æ¶ˆæ¯ï¼Œåˆ¤æ–­æ˜¯æ¥å•æé†’è¿˜æ˜¯å®¢æˆ·å‚¬å•ï¼Œè¿›è¡Œç›¸åº”çš„æ¶ˆæ¯æç¤ºå’Œè¯­éŸ³æ’­æŠ¥</li>
<li>çº¦å®šæœåŠ¡ç«¯å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨çš„æ•°æ®æ ¼å¼ä¸ºJSONï¼Œå­—æ®µåŒ…æ‹¬ï¼štypeï¼ŒorderIdï¼Œcontent<ul>
<li>typeä¸ºæ¶ˆæ¯ç±»å‹ï¼Œ1ä¸ºæ¥å•æé†’ 2ä¸ºå®¢æˆ·å‚¬å•</li>
<li>orderIdä¸ºè®¢å•id</li>
<li>contentä¸ºæ¶ˆæ¯å†…å®¹</li>
</ul>
</li>
</ul>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304000906366.png" alt="image-20240304000906366"></p>
<h2 id="ä»£ç å¼€å‘-2"><a href="#ä»£ç å¼€å‘-2" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>user.OrderController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¢æˆ·å‚¬å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å®¢æˆ·å‚¬å•&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/reminder/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">reminder</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span>&#123;</span><br><span class="line">    orderService.reminder(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderService</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¢æˆ·å‚¬å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">reminder</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>OrderServiceImpl</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¢æˆ·å‚¬å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reminder</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¡éªŒè®¢å•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”çŠ¶æ€ä¸º4</span></span><br><span class="line">    <span class="keyword">if</span> (ordersDB == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_STATUS_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    map.put(<span class="string">&quot;type&quot;</span>,<span class="number">2</span>); <span class="comment">//1.æ¥å•æé†’ 2.å®¢æˆ·å‚¬å•</span></span><br><span class="line">    map.put(<span class="string">&quot;orderId&quot;</span>,id);</span><br><span class="line">    map.put(<span class="string">&quot;content&quot;</span>,<span class="string">&quot;è®¢å•å·ï¼š&quot;</span> + ordersDB.getNumber());</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> JSON.toJSONString(map);</span><br><span class="line"></span><br><span class="line">    webSocketServer.sendToAllClient(json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304001814377.png" alt="image-20240304001814377"></p>
<p><img src="/2024/03/03/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day10-%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81%E5%AE%9A%E6%97%B6%E5%A4%84%E7%90%86%E3%80%81%E6%9D%A5%E5%8D%95%E6%8F%90%E9%86%92%E5%92%8C%E5%AE%A2%E6%88%B7%E5%82%AC%E5%8D%95/image-20240304001825301.png" alt="image-20240304001825301"></p>
<p>å½“ç”¨æˆ·ç«¯ç‚¹å‡»å‚¬å•æŒ‰é’®ï¼Œå®ƒä¼šå…ˆå‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¯·æ±‚åˆ°Controlleræ–¹æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é€šè¿‡webSocketServerå‘ç®¡ç†ç«¯æ¨é€æ¶ˆæ¯ï¼Œåœ¨ç®¡ç†ç«¯å°±ä¼šæ˜¾ç¤ºè¯¥æ¶ˆæ¯ã€‚</p>
<p>åŸç†ï¼šç½‘é¡µçš„ç®¡ç†ç«¯å‰ç«¯é¡µé¢å‘æœåŠ¡å™¨åç«¯å‘èµ·äº†websocketè¯·æ±‚ï¼Œå»ºç«‹é•¿è¿æ¥ï¼Œæ¥ç€å°ç¨‹åºçš„å®¢æˆ·ç«¯ç‚¹å‡»å‚¬å•æŒ‰é’®ï¼Œå‘æˆ‘ä»¬åç«¯çš„æœåŠ¡å™¨å¯¹åº”æ–¹æ³•å‘èµ·è¯·æ±‚ï¼Œè¯¥æ–¹æ³•æ‰§è¡Œæ—¶ä¼šè°ƒç”¨websocketç›¸å…³æ–¹æ³•ï¼Œå‘ç®¡ç†ç«¯å‘é€ä¿¡æ¯ã€‚</p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day09-ç”¨æˆ·ç«¯å†å²è®¢å•æ¨¡å—ã€å•†å®¶ç«¯è®¢å•ç®¡ç†æ¨¡å—</title>
    <url>/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/</url>
    <content><![CDATA[<h1 id="ç”¨æˆ·ç«¯å†å²è®¢å•æ¨¡å—"><a href="#ç”¨æˆ·ç«¯å†å²è®¢å•æ¨¡å—" class="headerlink" title="ç”¨æˆ·ç«¯å†å²è®¢å•æ¨¡å—"></a>ç”¨æˆ·ç«¯å†å²è®¢å•æ¨¡å—</h1><h2 id="1-æŸ¥è¯¢å†å²è®¢å•"><a href="#1-æŸ¥è¯¢å†å²è®¢å•" class="headerlink" title="1. æŸ¥è¯¢å†å²è®¢å•"></a>1. æŸ¥è¯¢å†å²è®¢å•</h2><h3 id="1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128092537535.png" alt="image-20221128092537535"></p>
<p>ä¸šåŠ¡è§„åˆ™</p>
<ul>
<li>åˆ†é¡µæŸ¥è¯¢å†å²è®¢å•</li>
<li>å¯ä»¥æ ¹æ®è®¢å•çŠ¶æ€æŸ¥è¯¢</li>
<li>å±•ç¤ºè®¢å•æ•°æ®æ—¶ï¼Œéœ€è¦å±•ç¤ºçš„æ•°æ®åŒ…æ‹¬ï¼šä¸‹å•æ—¶é—´ã€è®¢å•çŠ¶æ€ã€è®¢å•é‡‘é¢ã€è®¢å•æ˜ç»†ï¼ˆå•†å“åç§°ã€å›¾ç‰‡ï¼‰</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128103222657.png" alt="image-20221128103222657"></p>
<h3 id="1-2-ä»£ç å®ç°"><a href="#1-2-ä»£ç å®ç°" class="headerlink" title="1.2 ä»£ç å®ç°"></a>1.2 ä»£ç å®ç°</h3><h4 id="1-2-1-user-OrderController"><a href="#1-2-1-user-OrderController" class="headerlink" title="1.2.1 user&#x2F;OrderController"></a>1.2.1 user&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å†å²è®¢å•æŸ¥è¯¢</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageSize</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> status   è®¢å•çŠ¶æ€ 1å¾…ä»˜æ¬¾ 2å¾…æ¥å• 3å·²æ¥å• 4æ´¾é€ä¸­ 5å·²å®Œæˆ 6å·²å–æ¶ˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/historyOrders&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å†å²è®¢å•æŸ¥è¯¢&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">page</span><span class="params">(<span class="type">int</span> page, <span class="type">int</span> pageSize, Integer status)</span> &#123;</span><br><span class="line">    <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> orderService.pageQuery4User(page, pageSize, status);</span><br><span class="line">    <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2-OrderService"><a href="#1-2-2-OrderService" class="headerlink" title="1.2.2 OrderService"></a>1.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ç«¯è®¢å•åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pageSize</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">PageResult <span class="title function_">pageQuery4User</span><span class="params">(<span class="type">int</span> page, <span class="type">int</span> pageSize, Integer status)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-3-OrderServiceImpl"><a href="#1-2-3-OrderServiceImpl" class="headerlink" title="1.2.3 OrderServiceImpl"></a>1.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç«¯è®¢å•åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageNum</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> PageResult <span class="title function_">pageQuery4User</span><span class="params">(<span class="type">int</span> pageNum, <span class="type">int</span> pageSize, Integer status)</span> &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®åˆ†é¡µ</span></span><br><span class="line">        PageHelper.startPage(pageNum, pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="type">OrdersPageQueryDTO</span> <span class="variable">ordersPageQueryDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrdersPageQueryDTO</span>();</span><br><span class="line">        ordersPageQueryDTO.setUserId(BaseContext.getCurrentId());</span><br><span class="line">        ordersPageQueryDTO.setStatus(status);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ†é¡µæ¡ä»¶æŸ¥è¯¢</span></span><br><span class="line">        Page&lt;Orders&gt; page = orderMapper.pageQuery(ordersPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        List&lt;OrderVO&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥è¯¢å‡ºè®¢å•æ˜ç»†ï¼Œå¹¶å°è£…å…¥OrderVOè¿›è¡Œå“åº”</span></span><br><span class="line">        <span class="keyword">if</span> (page != <span class="literal">null</span> &amp;&amp; page.getTotal() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Orders orders : page) &#123;</span><br><span class="line">                <span class="type">Long</span> <span class="variable">orderId</span> <span class="operator">=</span> orders.getId();<span class="comment">// è®¢å•id</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// æŸ¥è¯¢è®¢å•æ˜ç»†</span></span><br><span class="line">                List&lt;OrderDetail&gt; orderDetails = orderDetailMapper.getByOrderId(orderId);</span><br><span class="line"></span><br><span class="line">                <span class="type">OrderVO</span> <span class="variable">orderVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderVO</span>();</span><br><span class="line">                BeanUtils.copyProperties(orders, orderVO);</span><br><span class="line">                orderVO.setOrderDetailList(orderDetails);</span><br><span class="line"></span><br><span class="line">                list.add(orderVO);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>(page.getTotal(), list);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-4-OrderMapper"><a href="#1-2-4-OrderMapper" class="headerlink" title="1.2.4 OrderMapper"></a>1.2.4 OrderMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ†é¡µæ¡ä»¶æŸ¥è¯¢å¹¶æŒ‰ä¸‹å•æ—¶é—´æ’åº</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersPageQueryDTO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Page&lt;Orders&gt; <span class="title function_">pageQuery</span><span class="params">(OrdersPageQueryDTO ordersPageQueryDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-5-OrderMapper-xml"><a href="#1-2-5-OrderMapper-xml" class="headerlink" title="1.2.5 OrderMapper.xml"></a>1.2.5 OrderMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;pageQuery&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Orders&quot;</span>&gt;</span></span><br><span class="line">       select * from orders</span><br><span class="line">       <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;number != null and number!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">               and number like concat(&#x27;%&#x27;,#&#123;number&#125;,&#x27;%&#x27;)</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;phone != null and phone!=&#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">               and phone like concat(&#x27;%&#x27;,#&#123;phone&#125;,&#x27;%&#x27;)</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userId != null&quot;</span>&gt;</span></span><br><span class="line">               and user_id = #&#123;userId&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span></span><br><span class="line">               and status = #&#123;status&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;beginTime != null&quot;</span>&gt;</span></span><br><span class="line">               and order_time <span class="symbol">&amp;gt;</span>= #&#123;beginTime&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;endTime != null&quot;</span>&gt;</span></span><br><span class="line">               and order_time <span class="symbol">&amp;lt;</span>= #&#123;endTime&#125;</span><br><span class="line">           <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">       order by order_time desc</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-6-OrderDetailMapper"><a href="#1-2-6-OrderDetailMapper" class="headerlink" title="1.2.6 OrderDetailMapper"></a>1.2.6 OrderDetailMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®è®¢å•idæŸ¥è¯¢è®¢å•æ˜ç»†</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> orderId</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from order_detail where order_id = #&#123;orderId&#125;&quot;)</span></span><br><span class="line">List&lt;OrderDetail&gt; <span class="title function_">getByOrderId</span><span class="params">(Long orderId)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-åŠŸèƒ½æµ‹è¯•"><a href="#1-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="1.3 åŠŸèƒ½æµ‹è¯•"></a>1.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="2-æŸ¥è¯¢è®¢å•è¯¦æƒ…"><a href="#2-æŸ¥è¯¢è®¢å•è¯¦æƒ…" class="headerlink" title="2. æŸ¥è¯¢è®¢å•è¯¦æƒ…"></a>2. æŸ¥è¯¢è®¢å•è¯¦æƒ…</h2><h3 id="2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128102144294.png" alt="image-20221128102144294"></p>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128142142811.png" alt="image-20221128142142811"></p>
<h3 id="2-2-ä»£ç å®ç°"><a href="#2-2-ä»£ç å®ç°" class="headerlink" title="2.2 ä»£ç å®ç°"></a>2.2 ä»£ç å®ç°</h3><h4 id="2-2-1-user-OrderController"><a href="#2-2-1-user-OrderController" class="headerlink" title="2.2.1 user&#x2F;OrderController"></a>2.2.1 user&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è®¢å•è¯¦æƒ…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/orderDetail/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢è®¢å•è¯¦æƒ…&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;OrderVO&gt; <span class="title function_">details</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">    <span class="type">OrderVO</span> <span class="variable">orderVO</span> <span class="operator">=</span> orderService.details(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success(orderVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-OrderService"><a href="#2-2-2-OrderService" class="headerlink" title="2.2.2 OrderService"></a>2.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è®¢å•è¯¦æƒ…</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">OrderVO <span class="title function_">details</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-OrderServiceImpl"><a href="#2-2-3-OrderServiceImpl" class="headerlink" title="2.2.3 OrderServiceImpl"></a>2.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è®¢å•è¯¦æƒ…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> OrderVO <span class="title function_">details</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> orderMapper.getById(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢è¯¥è®¢å•å¯¹åº”çš„èœå“/å¥—é¤æ˜ç»†</span></span><br><span class="line">    List&lt;OrderDetail&gt; orderDetailList = orderDetailMapper.getByOrderId(orders.getId());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è¯¥è®¢å•åŠå…¶è¯¦æƒ…å°è£…åˆ°OrderVOå¹¶è¿”å›</span></span><br><span class="line">    <span class="type">OrderVO</span> <span class="variable">orderVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderVO</span>();</span><br><span class="line">    BeanUtils.copyProperties(orders, orderVO);</span><br><span class="line">    orderVO.setOrderDetailList(orderDetailList);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> orderVO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-OrderMapper"><a href="#2-2-4-OrderMapper" class="headerlink" title="2.2.4 OrderMapper"></a>2.2.4 OrderMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from orders where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">Orders <span class="title function_">getById</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-åŠŸèƒ½æµ‹è¯•"><a href="#2-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="2.3 åŠŸèƒ½æµ‹è¯•"></a>2.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="3-å–æ¶ˆè®¢å•"><a href="#3-å–æ¶ˆè®¢å•" class="headerlink" title="3. å–æ¶ˆè®¢å•"></a>3. å–æ¶ˆè®¢å•</h2><h3 id="3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128145444268.png" alt="image-20221128145444268"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¾…æ”¯ä»˜å’Œå¾…æ¥å•çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å¯ç›´æ¥å–æ¶ˆè®¢å•</li>
<li>å•†å®¶å·²æ¥å•çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å–æ¶ˆè®¢å•éœ€ç”µè¯æ²Ÿé€šå•†å®¶</li>
<li>æ´¾é€ä¸­çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å–æ¶ˆè®¢å•éœ€ç”µè¯æ²Ÿé€šå•†å®¶</li>
<li>å¦‚æœåœ¨å¾…æ¥å•çŠ¶æ€ä¸‹å–æ¶ˆè®¢å•ï¼Œéœ€è¦ç»™ç”¨æˆ·é€€æ¬¾</li>
<li>å–æ¶ˆè®¢å•åéœ€è¦å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸ºâ€œå·²å–æ¶ˆâ€</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128164410852.png" alt="image-20221128164410852"></p>
<h3 id="3-2-ä»£ç å®ç°"><a href="#3-2-ä»£ç å®ç°" class="headerlink" title="3.2 ä»£ç å®ç°"></a>3.2 ä»£ç å®ç°</h3><h4 id="3-2-1-user-OrderController"><a href="#3-2-1-user-OrderController" class="headerlink" title="3.2.1 user&#x2F;OrderController"></a>3.2.1 user&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/cancel/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å–æ¶ˆè®¢å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">cancel</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    orderService.userCancelById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-OrderService"><a href="#3-2-2-OrderService" class="headerlink" title="3.2.2 OrderService"></a>3.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">userCancelById</span><span class="params">(Long id)</span> <span class="keyword">throws</span> Exception;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3-OrderServiceImpl"><a href="#3-2-3-OrderServiceImpl" class="headerlink" title="3.2.3 OrderServiceImpl"></a>3.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ç”¨æˆ·å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">userCancelById</span><span class="params">(Long id)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(id);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// æ ¡éªŒè®¢å•æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">       <span class="keyword">if</span> (ordersDB == <span class="literal">null</span>) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_NOT_FOUND);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//è®¢å•çŠ¶æ€ 1å¾…ä»˜æ¬¾ 2å¾…æ¥å• 3å·²æ¥å• 4æ´¾é€ä¸­ 5å·²å®Œæˆ 6å·²å–æ¶ˆ</span></span><br><span class="line">       <span class="keyword">if</span> (ordersDB.getStatus() &gt; <span class="number">2</span>) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_STATUS_ERROR);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">       orders.setId(ordersDB.getId());</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è®¢å•å¤„äºå¾…æ¥å•çŠ¶æ€ä¸‹å–æ¶ˆï¼Œéœ€è¦è¿›è¡Œé€€æ¬¾</span></span><br><span class="line">       <span class="keyword">if</span> (ordersDB.getStatus().equals(Orders.TO_BE_CONFIRMED)) &#123;</span><br><span class="line">           <span class="comment">//è°ƒç”¨å¾®ä¿¡æ”¯ä»˜é€€æ¬¾æ¥å£</span></span><br><span class="line">           weChatPayUtil.refund(</span><br><span class="line">                   ordersDB.getNumber(), <span class="comment">//å•†æˆ·è®¢å•å·</span></span><br><span class="line">                   ordersDB.getNumber(), <span class="comment">//å•†æˆ·é€€æ¬¾å•å·</span></span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>),<span class="comment">//é€€æ¬¾é‡‘é¢ï¼Œå•ä½ å…ƒ</span></span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>));<span class="comment">//åŸè®¢å•é‡‘é¢</span></span><br><span class="line"></span><br><span class="line">           <span class="comment">//æ”¯ä»˜çŠ¶æ€ä¿®æ”¹ä¸º é€€æ¬¾</span></span><br><span class="line">           orders.setPayStatus(Orders.REFUND);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// æ›´æ–°è®¢å•çŠ¶æ€ã€å–æ¶ˆåŸå› ã€å–æ¶ˆæ—¶é—´</span></span><br><span class="line">       orders.setStatus(Orders.CANCELLED);</span><br><span class="line">       orders.setCancelReason(<span class="string">&quot;ç”¨æˆ·å–æ¶ˆ&quot;</span>);</span><br><span class="line">       orders.setCancelTime(LocalDateTime.now());</span><br><span class="line">       orderMapper.update(orders);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-åŠŸèƒ½æµ‹è¯•"><a href="#3-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="3.3 åŠŸèƒ½æµ‹è¯•"></a>3.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="4-å†æ¥ä¸€å•"><a href="#4-å†æ¥ä¸€å•" class="headerlink" title="4. å†æ¥ä¸€å•"></a>4. å†æ¥ä¸€å•</h2><h3 id="4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128173238656.png" alt="image-20221128173238656"></p>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221128173350467.png" alt="image-20221128173350467"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å†æ¥ä¸€å•å°±æ˜¯å°†åŸè®¢å•ä¸­çš„å•†å“é‡æ–°åŠ å…¥åˆ°è´­ç‰©è½¦ä¸­</li>
</ul>
<h3 id="4-2-ä»£ç å®ç°"><a href="#4-2-ä»£ç å®ç°" class="headerlink" title="4.2 ä»£ç å®ç°"></a>4.2 ä»£ç å®ç°</h3><h4 id="4-2-1-user-OrderController"><a href="#4-2-1-user-OrderController" class="headerlink" title="4.2.1 user&#x2F;OrderController"></a>4.2.1 user&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å†æ¥ä¸€å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/repetition/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å†æ¥ä¸€å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">repetition</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">    orderService.repetition(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-OrderService"><a href="#4-2-2-OrderService" class="headerlink" title="4.2.2 OrderService"></a>4.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å†æ¥ä¸€å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">repetition</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-OrderServiceImpl"><a href="#4-2-3-OrderServiceImpl" class="headerlink" title="4.2.3 OrderServiceImpl"></a>4.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * å†æ¥ä¸€å•</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">repetition</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">       <span class="comment">// æŸ¥è¯¢å½“å‰ç”¨æˆ·id</span></span><br><span class="line">       <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line"></span><br><span class="line">       <span class="comment">// æ ¹æ®è®¢å•idæŸ¥è¯¢å½“å‰è®¢å•è¯¦æƒ…</span></span><br><span class="line">       List&lt;OrderDetail&gt; orderDetailList = orderDetailMapper.getByOrderId(id);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// å°†è®¢å•è¯¦æƒ…å¯¹è±¡è½¬æ¢ä¸ºè´­ç‰©è½¦å¯¹è±¡</span></span><br><span class="line">       List&lt;ShoppingCart&gt; shoppingCartList = orderDetailList.stream().map(x -&gt; &#123;</span><br><span class="line">           <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line"></span><br><span class="line">           <span class="comment">// å°†åŸè®¢å•è¯¦æƒ…é‡Œé¢çš„èœå“ä¿¡æ¯é‡æ–°å¤åˆ¶åˆ°è´­ç‰©è½¦å¯¹è±¡ä¸­</span></span><br><span class="line">           BeanUtils.copyProperties(x, shoppingCart, <span class="string">&quot;id&quot;</span>);</span><br><span class="line">           shoppingCart.setUserId(userId);</span><br><span class="line">           shoppingCart.setCreateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> shoppingCart;</span><br><span class="line">       &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">       <span class="comment">// å°†è´­ç‰©è½¦å¯¹è±¡æ‰¹é‡æ·»åŠ åˆ°æ•°æ®åº“</span></span><br><span class="line">       shoppingCartMapper.insertBatch(shoppingCartList);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4-ShoppingCartMapper"><a href="#4-2-4-ShoppingCartMapper" class="headerlink" title="4.2.4 ShoppingCartMapper"></a>4.2.4 ShoppingCartMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰¹é‡æ’å…¥è´­ç‰©è½¦æ•°æ®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> shoppingCartList</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insertBatch</span><span class="params">(List&lt;ShoppingCart&gt; shoppingCartList)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-5-ShoppingCartMapper-xml"><a href="#4-2-5-ShoppingCartMapper-xml" class="headerlink" title="4.2.5 ShoppingCartMapper.xml"></a>4.2.5 ShoppingCartMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">        insert into shopping_cart</span><br><span class="line">        (name, image, user_id, dish_id, setmeal_id, dish_flavor, number, amount, create_time)</span><br><span class="line">        values</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;shoppingCartList&quot;</span> <span class="attr">item</span>=<span class="string">&quot;sc&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">            (#&#123;sc.name&#125;,#&#123;sc.image&#125;,#&#123;sc.userId&#125;,#&#123;sc.dishId&#125;,#&#123;sc.setmealId&#125;,#&#123;sc.dishFlavor&#125;,#&#123;sc.number&#125;,#&#123;sc.amount&#125;,#&#123;sc.createTime&#125;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-åŠŸèƒ½æµ‹è¯•"><a href="#4-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="4.3 åŠŸèƒ½æµ‹è¯•"></a>4.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h1 id="å•†å®¶ç«¯è®¢å•ç®¡ç†æ¨¡å—"><a href="#å•†å®¶ç«¯è®¢å•ç®¡ç†æ¨¡å—" class="headerlink" title="å•†å®¶ç«¯è®¢å•ç®¡ç†æ¨¡å—"></a>å•†å®¶ç«¯è®¢å•ç®¡ç†æ¨¡å—</h1><h2 id="1-è®¢å•æœç´¢"><a href="#1-è®¢å•æœç´¢" class="headerlink" title="1. è®¢å•æœç´¢"></a>1. è®¢å•æœç´¢</h2><h3 id="1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129092023177.png" alt="image-20221129092023177"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129114035570.png" alt="image-20221129114035570"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129114054664.png" alt="image-20221129114054664"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129114116492.png" alt="image-20221129114116492"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129114132956.png" alt="image-20221129114132956"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129114151055.png" alt="image-20221129114151055"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>è¾“å…¥è®¢å•å·&#x2F;æ‰‹æœºå·è¿›è¡Œæœç´¢ï¼Œæ”¯æŒæ¨¡ç³Šæœç´¢</li>
<li>æ ¹æ®è®¢å•çŠ¶æ€è¿›è¡Œç­›é€‰</li>
<li>ä¸‹å•æ—¶é—´è¿›è¡Œæ—¶é—´ç­›é€‰</li>
<li>æœç´¢å†…å®¹ä¸ºç©ºï¼Œæç¤ºæœªæ‰¾åˆ°ç›¸å…³è®¢å•</li>
<li>æœç´¢ç»“æœé¡µï¼Œå±•ç¤ºåŒ…å«æœç´¢å…³é”®è¯çš„å†…å®¹</li>
<li>åˆ†é¡µå±•ç¤ºæœç´¢åˆ°çš„è®¢å•æ•°æ®</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129092552620.png" alt="image-20221129092552620"></p>
<h3 id="1-2-ä»£ç å®ç°-1"><a href="#1-2-ä»£ç å®ç°-1" class="headerlink" title="1.2 ä»£ç å®ç°"></a>1.2 ä»£ç å®ç°</h3><h4 id="1-2-1-admin-OrderController"><a href="#1-2-1-admin-OrderController" class="headerlink" title="1.2.1 admin&#x2F;OrderController"></a>1.2.1 admin&#x2F;OrderController</h4><p>åœ¨adminåŒ…ä¸‹åˆ›å»ºOrderController</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¢å•ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController(&quot;adminOrderController&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/order&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è®¢å•ç®¡ç†æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æœç´¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/conditionSearch&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è®¢å•æœç´¢&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">conditionSearch</span><span class="params">(OrdersPageQueryDTO ordersPageQueryDTO)</span> &#123;</span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> orderService.conditionSearch(ordersPageQueryDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2-OrderService-1"><a href="#1-2-2-OrderService-1" class="headerlink" title="1.2.2 OrderService"></a>1.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¡ä»¶æœç´¢è®¢å•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersPageQueryDTO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">PageResult <span class="title function_">conditionSearch</span><span class="params">(OrdersPageQueryDTO ordersPageQueryDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-3-OrderServiceImpl-1"><a href="#1-2-3-OrderServiceImpl-1" class="headerlink" title="1.2.3 OrderServiceImpl"></a>1.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¢å•æœç´¢</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersPageQueryDTO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> PageResult <span class="title function_">conditionSearch</span><span class="params">(OrdersPageQueryDTO ordersPageQueryDTO)</span> &#123;</span><br><span class="line">    PageHelper.startPage(ordersPageQueryDTO.getPage(), ordersPageQueryDTO.getPageSize());</span><br><span class="line"></span><br><span class="line">    Page&lt;Orders&gt; page = orderMapper.pageQuery(ordersPageQueryDTO);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éƒ¨åˆ†è®¢å•çŠ¶æ€ï¼Œéœ€è¦é¢å¤–è¿”å›è®¢å•èœå“ä¿¡æ¯ï¼Œå°†Ordersè½¬åŒ–ä¸ºOrderVO</span></span><br><span class="line">    List&lt;OrderVO&gt; orderVOList = getOrderVOList(page);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>(page.getTotal(), orderVOList);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> List&lt;OrderVO&gt; <span class="title function_">getOrderVOList</span><span class="params">(Page&lt;Orders&gt; page)</span> &#123;</span><br><span class="line">    <span class="comment">// éœ€è¦è¿”å›è®¢å•èœå“ä¿¡æ¯ï¼Œè‡ªå®šä¹‰OrderVOå“åº”ç»“æœ</span></span><br><span class="line">    List&lt;OrderVO&gt; orderVOList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    List&lt;Orders&gt; ordersList = page.getResult();</span><br><span class="line">    <span class="keyword">if</span> (!CollectionUtils.isEmpty(ordersList)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Orders orders : ordersList) &#123;</span><br><span class="line">            <span class="comment">// å°†å…±åŒå­—æ®µå¤åˆ¶åˆ°OrderVO</span></span><br><span class="line">            <span class="type">OrderVO</span> <span class="variable">orderVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderVO</span>();</span><br><span class="line">            BeanUtils.copyProperties(orders, orderVO);</span><br><span class="line">            <span class="type">String</span> <span class="variable">orderDishes</span> <span class="operator">=</span> getOrderDishesStr(orders);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†è®¢å•èœå“ä¿¡æ¯å°è£…åˆ°orderVOä¸­ï¼Œå¹¶æ·»åŠ åˆ°orderVOList</span></span><br><span class="line">            orderVO.setOrderDishes(orderDishes);</span><br><span class="line">            orderVOList.add(orderVO);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> orderVOList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®è®¢å•idè·å–èœå“ä¿¡æ¯å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> orders</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> String <span class="title function_">getOrderDishesStr</span><span class="params">(Orders orders)</span> &#123;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢è®¢å•èœå“è¯¦æƒ…ä¿¡æ¯ï¼ˆè®¢å•ä¸­çš„èœå“å’Œæ•°é‡ï¼‰</span></span><br><span class="line">    List&lt;OrderDetail&gt; orderDetailList = orderDetailMapper.getByOrderId(orders.getId());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æ¯ä¸€æ¡è®¢å•èœå“ä¿¡æ¯æ‹¼æ¥ä¸ºå­—ç¬¦ä¸²ï¼ˆæ ¼å¼ï¼šå®«ä¿é¸¡ä¸*3ï¼›ï¼‰</span></span><br><span class="line">    List&lt;String&gt; orderDishList = orderDetailList.stream().map(x -&gt; &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">orderDish</span> <span class="operator">=</span> x.getName() + <span class="string">&quot;*&quot;</span> + x.getNumber() + <span class="string">&quot;;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> orderDish;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†è¯¥è®¢å•å¯¹åº”çš„æ‰€æœ‰èœå“ä¿¡æ¯æ‹¼æ¥åœ¨ä¸€èµ·</span></span><br><span class="line">    <span class="keyword">return</span> String.join(<span class="string">&quot;&quot;</span>, orderDishList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-åŠŸèƒ½æµ‹è¯•-1"><a href="#1-3-åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="1.3 åŠŸèƒ½æµ‹è¯•"></a>1.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="2-å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡"><a href="#2-å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡" class="headerlink" title="2. å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡"></a>2. å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡</h2><h3 id="2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129095804419.png" alt="image-20221129095804419"></p>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129095912896.png" alt="image-20221129095912896"></p>
<h3 id="2-2-ä»£ç å®ç°-1"><a href="#2-2-ä»£ç å®ç°-1" class="headerlink" title="2.2 ä»£ç å®ç°"></a>2.2 ä»£ç å®ç°</h3><h4 id="2-2-1-admin-OrderController"><a href="#2-2-1-admin-OrderController" class="headerlink" title="2.2.1 admin&#x2F;OrderController"></a>2.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/statistics&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;OrderStatisticsVO&gt; <span class="title function_">statistics</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">OrderStatisticsVO</span> <span class="variable">orderStatisticsVO</span> <span class="operator">=</span> orderService.statistics();</span><br><span class="line">    <span class="keyword">return</span> Result.success(orderStatisticsVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-OrderService-1"><a href="#2-2-2-OrderService-1" class="headerlink" title="2.2.2 OrderService"></a>2.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">OrderStatisticsVO <span class="title function_">statistics</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-OrderServiceImpl-1"><a href="#2-2-3-OrderServiceImpl-1" class="headerlink" title="2.2.3 OrderServiceImpl"></a>2.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å„ä¸ªçŠ¶æ€çš„è®¢å•æ•°é‡ç»Ÿè®¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> OrderStatisticsVO <span class="title function_">statistics</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®çŠ¶æ€ï¼Œåˆ†åˆ«æŸ¥è¯¢å‡ºå¾…æ¥å•ã€å¾…æ´¾é€ã€æ´¾é€ä¸­çš„è®¢å•æ•°é‡</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">toBeConfirmed</span> <span class="operator">=</span> orderMapper.countStatus(Orders.TO_BE_CONFIRMED);</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">confirmed</span> <span class="operator">=</span> orderMapper.countStatus(Orders.CONFIRMED);</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">deliveryInProgress</span> <span class="operator">=</span> orderMapper.countStatus(Orders.DELIVERY_IN_PROGRESS);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†æŸ¥è¯¢å‡ºçš„æ•°æ®å°è£…åˆ°orderStatisticsVOä¸­å“åº”</span></span><br><span class="line">    <span class="type">OrderStatisticsVO</span> <span class="variable">orderStatisticsVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderStatisticsVO</span>();</span><br><span class="line">    orderStatisticsVO.setToBeConfirmed(toBeConfirmed);</span><br><span class="line">    orderStatisticsVO.setConfirmed(confirmed);</span><br><span class="line">    orderStatisticsVO.setDeliveryInProgress(deliveryInProgress);</span><br><span class="line">    <span class="keyword">return</span> orderStatisticsVO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-OrderMapper-1"><a href="#2-2-4-OrderMapper-1" class="headerlink" title="2.2.4 OrderMapper"></a>2.2.4 OrderMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ¹æ®çŠ¶æ€ç»Ÿè®¡è®¢å•æ•°é‡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Select(&quot;select count(id) from orders where status = #&#123;status&#125;&quot;)</span></span><br><span class="line">Integer <span class="title function_">countStatus</span><span class="params">(Integer status)</span>;</span><br></pre></td></tr></table></figure>



<h3 id="2-3-åŠŸèƒ½æµ‹è¯•-1"><a href="#2-3-åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="2.3 åŠŸèƒ½æµ‹è¯•"></a>2.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="3-æŸ¥è¯¢è®¢å•è¯¦æƒ…"><a href="#3-æŸ¥è¯¢è®¢å•è¯¦æƒ…" class="headerlink" title="3. æŸ¥è¯¢è®¢å•è¯¦æƒ…"></a>3. æŸ¥è¯¢è®¢å•è¯¦æƒ…</h2><h3 id="3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129101712084.png" alt="image-20221129101712084"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>è®¢å•è¯¦æƒ…é¡µé¢éœ€è¦å±•ç¤ºè®¢å•åŸºæœ¬ä¿¡æ¯ï¼ˆçŠ¶æ€ã€è®¢å•å·ã€ä¸‹å•æ—¶é—´ã€æ”¶è´§äººã€ç”µè¯ã€æ”¶è´§åœ°å€ã€é‡‘é¢ç­‰ï¼‰</li>
<li>è®¢å•è¯¦æƒ…é¡µé¢éœ€è¦å±•ç¤ºè®¢å•æ˜ç»†æ•°æ®ï¼ˆå•†å“åç§°ã€æ•°é‡ã€å•ä»·ï¼‰</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129101035374.png" alt="image-20221129101035374"></p>
<h3 id="3-2-ä»£ç å®ç°-1"><a href="#3-2-ä»£ç å®ç°-1" class="headerlink" title="3.2 ä»£ç å®ç°"></a>3.2 ä»£ç å®ç°</h3><h4 id="3-2-1-admin-OrderController"><a href="#3-2-1-admin-OrderController" class="headerlink" title="3.2.1 admin&#x2F;OrderController"></a>3.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è®¢å•è¯¦æƒ…</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/details/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢è®¢å•è¯¦æƒ…&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;OrderVO&gt; <span class="title function_">details</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">    <span class="type">OrderVO</span> <span class="variable">orderVO</span> <span class="operator">=</span> orderService.details(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success(orderVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-åŠŸèƒ½æµ‹è¯•-1"><a href="#3-3-åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="3.3 åŠŸèƒ½æµ‹è¯•"></a>3.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="4-æ¥å•"><a href="#4-æ¥å•" class="headerlink" title="4. æ¥å•"></a>4. æ¥å•</h2><h3 id="4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129105142623.png" alt="image-20221129105142623"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129105116285.png" alt="image-20221129105116285"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å•†å®¶æ¥å•å…¶å®å°±æ˜¯å°†è®¢å•çš„çŠ¶æ€ä¿®æ”¹ä¸ºâ€œå·²æ¥å•â€</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129105313172.png" alt="image-20221129105313172"></p>
<h3 id="4-2-ä»£ç å®ç°-1"><a href="#4-2-ä»£ç å®ç°-1" class="headerlink" title="4.2 ä»£ç å®ç°"></a>4.2 ä»£ç å®ç°</h3><h4 id="4-2-1-admin-OrderController"><a href="#4-2-1-admin-OrderController" class="headerlink" title="4.2.1 admin&#x2F;OrderController"></a>4.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¥å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/confirm&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ¥å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">confirm</span><span class="params">(<span class="meta">@RequestBody</span> OrdersConfirmDTO ordersConfirmDTO)</span> &#123;</span><br><span class="line">    orderService.confirm(ordersConfirmDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-OrderService-1"><a href="#4-2-2-OrderService-1" class="headerlink" title="4.2.2 OrderService"></a>4.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¥å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersConfirmDTO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(OrdersConfirmDTO ordersConfirmDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-OrderServiceImpl-1"><a href="#4-2-3-OrderServiceImpl-1" class="headerlink" title="4.2.3 OrderServiceImpl"></a>4.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¥å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersConfirmDTO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(OrdersConfirmDTO ordersConfirmDTO)</span> &#123;</span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> Orders.builder()</span><br><span class="line">            .id(ordersConfirmDTO.getId())</span><br><span class="line">            .status(Orders.CONFIRMED)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    orderMapper.update(orders);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-3-åŠŸèƒ½æµ‹è¯•-1"><a href="#4-3-åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="4.3 åŠŸèƒ½æµ‹è¯•"></a>4.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="5-æ‹’å•"><a href="#5-æ‹’å•" class="headerlink" title="5. æ‹’å•"></a>5. æ‹’å•</h2><h3 id="5-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#5-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="5.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>5.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129110358976.png" alt="image-20221129110358976"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129110428390.png" alt="image-20221129110428390"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å•†å®¶æ‹’å•å…¶å®å°±æ˜¯å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸ºâ€œå·²å–æ¶ˆâ€</li>
<li>åªæœ‰è®¢å•å¤„äºâ€œå¾…æ¥å•â€çŠ¶æ€æ—¶å¯ä»¥æ‰§è¡Œæ‹’å•æ“ä½œ</li>
<li>å•†å®¶æ‹’å•æ—¶éœ€è¦æŒ‡å®šæ‹’å•åŸå› </li>
<li>å•†å®¶æ‹’å•æ—¶ï¼Œå¦‚æœç”¨æˆ·å·²ç»å®Œæˆäº†æ”¯ä»˜ï¼Œéœ€è¦ä¸ºç”¨æˆ·é€€æ¬¾</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129110725031.png" alt="image-20221129110725031"></p>
<h3 id="5-2-ä»£ç å®ç°"><a href="#5-2-ä»£ç å®ç°" class="headerlink" title="5.2 ä»£ç å®ç°"></a>5.2 ä»£ç å®ç°</h3><h4 id="5-2-1-admin-OrderController"><a href="#5-2-1-admin-OrderController" class="headerlink" title="5.2.1 admin&#x2F;OrderController"></a>5.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹’å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/rejection&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ‹’å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">rejection</span><span class="params">(<span class="meta">@RequestBody</span> OrdersRejectionDTO ordersRejectionDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    orderService.rejection(ordersRejectionDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-2-OrderService"><a href="#5-2-2-OrderService" class="headerlink" title="5.2.2 OrderService"></a>5.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹’å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersRejectionDTO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">rejection</span><span class="params">(OrdersRejectionDTO ordersRejectionDTO)</span> <span class="keyword">throws</span> Exception;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-3-OrderServiceImpl"><a href="#5-2-3-OrderServiceImpl" class="headerlink" title="5.2.3 OrderServiceImpl"></a>5.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ‹’å•</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> ordersRejectionDTO</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rejection</span><span class="params">(OrdersRejectionDTO ordersRejectionDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(ordersRejectionDTO.getId());</span><br><span class="line"></span><br><span class="line">       <span class="comment">// è®¢å•åªæœ‰å­˜åœ¨ä¸”çŠ¶æ€ä¸º2ï¼ˆå¾…æ¥å•ï¼‰æ‰å¯ä»¥æ‹’å•</span></span><br><span class="line">       <span class="keyword">if</span> (ordersDB == <span class="literal">null</span> || !ordersDB.getStatus().equals(Orders.TO_BE_CONFIRMED)) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_STATUS_ERROR);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//æ”¯ä»˜çŠ¶æ€</span></span><br><span class="line">       <span class="type">Integer</span> <span class="variable">payStatus</span> <span class="operator">=</span> ordersDB.getPayStatus();</span><br><span class="line">       <span class="keyword">if</span> (payStatus == Orders.PAID) &#123;</span><br><span class="line">           <span class="comment">//ç”¨æˆ·å·²æ”¯ä»˜ï¼Œéœ€è¦é€€æ¬¾</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">refund</span> <span class="operator">=</span> weChatPayUtil.refund(</span><br><span class="line">                   ordersDB.getNumber(),</span><br><span class="line">                   ordersDB.getNumber(),</span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>),</span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>));</span><br><span class="line">           log.info(<span class="string">&quot;ç”³è¯·é€€æ¬¾ï¼š&#123;&#125;&quot;</span>, refund);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// æ‹’å•éœ€è¦é€€æ¬¾ï¼Œæ ¹æ®è®¢å•idæ›´æ–°è®¢å•çŠ¶æ€ã€æ‹’å•åŸå› ã€å–æ¶ˆæ—¶é—´</span></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">       orders.setId(ordersDB.getId());</span><br><span class="line">       orders.setStatus(Orders.CANCELLED);</span><br><span class="line">       orders.setRejectionReason(ordersRejectionDTO.getRejectionReason());</span><br><span class="line">       orders.setCancelTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">       orderMapper.update(orders);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-åŠŸèƒ½æµ‹è¯•"><a href="#5-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="5.3 åŠŸèƒ½æµ‹è¯•"></a>5.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="6-å–æ¶ˆè®¢å•"><a href="#6-å–æ¶ˆè®¢å•" class="headerlink" title="6. å–æ¶ˆè®¢å•"></a>6. å–æ¶ˆè®¢å•</h2><h3 id="6-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#6-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="6.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>6.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129111402099.png" alt="image-20221129111402099"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å–æ¶ˆè®¢å•å…¶å®å°±æ˜¯å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸ºâ€œå·²å–æ¶ˆâ€</li>
<li>å•†å®¶å–æ¶ˆè®¢å•æ—¶éœ€è¦æŒ‡å®šå–æ¶ˆåŸå› </li>
<li>å•†å®¶å–æ¶ˆè®¢å•æ—¶ï¼Œå¦‚æœç”¨æˆ·å·²ç»å®Œæˆäº†æ”¯ä»˜ï¼Œéœ€è¦ä¸ºç”¨æˆ·é€€æ¬¾</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129112201836.png" alt="image-20221129112201836"></p>
<h3 id="6-2-ä»£ç å®ç°"><a href="#6-2-ä»£ç å®ç°" class="headerlink" title="6.2 ä»£ç å®ç°"></a>6.2 ä»£ç å®ç°</h3><h4 id="6-2-1-admin-OrderController"><a href="#6-2-1-admin-OrderController" class="headerlink" title="6.2.1 admin&#x2F;OrderController"></a>6.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/cancel&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å–æ¶ˆè®¢å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">cancel</span><span class="params">(<span class="meta">@RequestBody</span> OrdersCancelDTO ordersCancelDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    orderService.cancel(ordersCancelDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-2-OrderService"><a href="#6-2-2-OrderService" class="headerlink" title="6.2.2 OrderService"></a>6.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•†å®¶å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ordersCancelDTO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">(OrdersCancelDTO ordersCancelDTO)</span> <span class="keyword">throws</span> Exception;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-3-OrderServiceImpl"><a href="#6-2-3-OrderServiceImpl" class="headerlink" title="6.2.3 OrderServiceImpl"></a>6.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * å–æ¶ˆè®¢å•</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> ordersCancelDTO</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancel</span><span class="params">(OrdersCancelDTO ordersCancelDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(ordersCancelDTO.getId());</span><br><span class="line"></span><br><span class="line">       <span class="comment">//æ”¯ä»˜çŠ¶æ€</span></span><br><span class="line">       <span class="type">Integer</span> <span class="variable">payStatus</span> <span class="operator">=</span> ordersDB.getPayStatus();</span><br><span class="line">       <span class="keyword">if</span> (payStatus == <span class="number">1</span>) &#123;</span><br><span class="line">           <span class="comment">//ç”¨æˆ·å·²æ”¯ä»˜ï¼Œéœ€è¦é€€æ¬¾</span></span><br><span class="line">           <span class="type">String</span> <span class="variable">refund</span> <span class="operator">=</span> weChatPayUtil.refund(</span><br><span class="line">                   ordersDB.getNumber(),</span><br><span class="line">                   ordersDB.getNumber(),</span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>),</span><br><span class="line">                   <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>));</span><br><span class="line">           log.info(<span class="string">&quot;ç”³è¯·é€€æ¬¾ï¼š&#123;&#125;&quot;</span>, refund);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// ç®¡ç†ç«¯å–æ¶ˆè®¢å•éœ€è¦é€€æ¬¾ï¼Œæ ¹æ®è®¢å•idæ›´æ–°è®¢å•çŠ¶æ€ã€å–æ¶ˆåŸå› ã€å–æ¶ˆæ—¶é—´</span></span><br><span class="line">       <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">       orders.setId(ordersCancelDTO.getId());</span><br><span class="line">       orders.setStatus(Orders.CANCELLED);</span><br><span class="line">       orders.setCancelReason(ordersCancelDTO.getCancelReason());</span><br><span class="line">       orders.setCancelTime(LocalDateTime.now());</span><br><span class="line">       orderMapper.update(orders);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-åŠŸèƒ½æµ‹è¯•"><a href="#6-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="6.3 åŠŸèƒ½æµ‹è¯•"></a>6.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="7-æ´¾é€è®¢å•"><a href="#7-æ´¾é€è®¢å•" class="headerlink" title="7. æ´¾é€è®¢å•"></a>7. æ´¾é€è®¢å•</h2><h3 id="7-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#7-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="7.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>7.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129113257201.png" alt="image-20221129113257201"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>æ´¾é€è®¢å•å…¶å®å°±æ˜¯å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸ºâ€œæ´¾é€ä¸­â€</li>
<li>åªæœ‰çŠ¶æ€ä¸ºâ€œå¾…æ´¾é€â€çš„è®¢å•å¯ä»¥æ‰§è¡Œæ´¾é€è®¢å•æ“ä½œ</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129113449124.png" alt="image-20221129113449124"></p>
<h3 id="7-2-ä»£ç å®ç°"><a href="#7-2-ä»£ç å®ç°" class="headerlink" title="7.2 ä»£ç å®ç°"></a>7.2 ä»£ç å®ç°</h3><h4 id="7-2-1-admin-OrderController"><a href="#7-2-1-admin-OrderController" class="headerlink" title="7.2.1 admin&#x2F;OrderController"></a>7.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ´¾é€è®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/delivery/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ´¾é€è®¢å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">delivery</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">    orderService.delivery(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-2-OrderService"><a href="#7-2-2-OrderService" class="headerlink" title="7.2.2 OrderService"></a>7.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ´¾é€è®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">delivery</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="7-2-3-OrderServiceImpl"><a href="#7-2-3-OrderServiceImpl" class="headerlink" title="7.2.3 OrderServiceImpl"></a>7.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ´¾é€è®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delivery</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¡éªŒè®¢å•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”çŠ¶æ€ä¸º3</span></span><br><span class="line">    <span class="keyword">if</span> (ordersDB == <span class="literal">null</span> || !ordersDB.getStatus().equals(Orders.CONFIRMED)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_STATUS_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">    orders.setId(ordersDB.getId());</span><br><span class="line">    <span class="comment">// æ›´æ–°è®¢å•çŠ¶æ€,çŠ¶æ€è½¬ä¸ºæ´¾é€ä¸­</span></span><br><span class="line">    orders.setStatus(Orders.DELIVERY_IN_PROGRESS);</span><br><span class="line"></span><br><span class="line">    orderMapper.update(orders);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-åŠŸèƒ½æµ‹è¯•"><a href="#7-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="7.3 åŠŸèƒ½æµ‹è¯•"></a>7.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="8-å®Œæˆè®¢å•"><a href="#8-å®Œæˆè®¢å•" class="headerlink" title="8. å®Œæˆè®¢å•"></a>8. å®Œæˆè®¢å•</h2><h3 id="8-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#8-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="8.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>8.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129112554051.png" alt="image-20221129112554051"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å®Œæˆè®¢å•å…¶å®å°±æ˜¯å°†è®¢å•çŠ¶æ€ä¿®æ”¹ä¸ºâ€œå·²å®Œæˆâ€</li>
<li>åªæœ‰çŠ¶æ€ä¸ºâ€œæ´¾é€ä¸­â€çš„è®¢å•å¯ä»¥æ‰§è¡Œè®¢å•å®Œæˆæ“ä½œ</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼šå‚è§æ¥å£æ–‡æ¡£</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221129113622784.png" alt="image-20221129113622784"></p>
<h3 id="8-2-ä»£ç å®ç°"><a href="#8-2-ä»£ç å®ç°" class="headerlink" title="8.2 ä»£ç å®ç°"></a>8.2 ä»£ç å®ç°</h3><h4 id="8-2-1-admin-OrderController"><a href="#8-2-1-admin-OrderController" class="headerlink" title="8.2.1 admin&#x2F;OrderController"></a>8.2.1 admin&#x2F;OrderController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®Œæˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/complete/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å®Œæˆè®¢å•&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">complete</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">    orderService.complete(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-2-OrderService"><a href="#8-2-2-OrderService" class="headerlink" title="8.2.2 OrderService"></a>8.2.2 OrderService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®Œæˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">complete</span><span class="params">(Long id)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="8-2-3-OrderServiceImpl"><a href="#8-2-3-OrderServiceImpl" class="headerlink" title="8.2.3 OrderServiceImpl"></a>8.2.3 OrderServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®Œæˆè®¢å•</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">complete</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•</span></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getById(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¡éªŒè®¢å•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”çŠ¶æ€ä¸º4</span></span><br><span class="line">    <span class="keyword">if</span> (ordersDB == <span class="literal">null</span> || !ordersDB.getStatus().equals(Orders.DELIVERY_IN_PROGRESS)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(MessageConstant.ORDER_STATUS_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">    orders.setId(ordersDB.getId());</span><br><span class="line">    <span class="comment">// æ›´æ–°è®¢å•çŠ¶æ€,çŠ¶æ€è½¬ä¸ºå®Œæˆ</span></span><br><span class="line">    orders.setStatus(Orders.COMPLETED);</span><br><span class="line">    orders.setDeliveryTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">    orderMapper.update(orders);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-3-åŠŸèƒ½æµ‹è¯•"><a href="#8-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="8.3 åŠŸèƒ½æµ‹è¯•"></a>8.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h1 id="æ ¡éªŒæ”¶è´§åœ°å€æ˜¯å¦è¶…å‡ºé…é€èŒƒå›´"><a href="#æ ¡éªŒæ”¶è´§åœ°å€æ˜¯å¦è¶…å‡ºé…é€èŒƒå›´" class="headerlink" title="æ ¡éªŒæ”¶è´§åœ°å€æ˜¯å¦è¶…å‡ºé…é€èŒƒå›´"></a>æ ¡éªŒæ”¶è´§åœ°å€æ˜¯å¦è¶…å‡ºé…é€èŒƒå›´</h1><h2 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h2><p>æ³¨å†Œè´¦å·ï¼š<a href="https://passport.baidu.com/v2/?reg&tt=1671699340600&overseas=&gid=CF954C2-A3D2-417F-9FE6-B0F249ED7E33&tpl=pp&u=https://lbsyun.baidu.com/index.php?title=%E9%A6%96%E9%A1%B5">https://passport.baidu.com/v2/?reg&amp;tt=1671699340600&amp;overseas=&amp;gid=CF954C2-A3D2-417F-9FE6-B0F249ED7E33&amp;tpl=pp&amp;u=https%3A%2F%2Flbsyun.baidu.com%2Findex.php%3Ftitle%3D%E9%A6%96%E9%A1%B5</a></p>
<p>ç™»å½•ç™¾åº¦åœ°å›¾å¼€æ”¾å¹³å°ï¼š<a href="https://lbsyun.baidu.com/">https://lbsyun.baidu.com/</a></p>
<p>è¿›å…¥æ§åˆ¶å°ï¼Œåˆ›å»ºåº”ç”¨ï¼Œè·å–AKï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221222170049729.png" alt="image-20221222170049729"></p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221222170256927.png" alt="image-20221222170256927"></p>
<p>ç›¸å…³æ¥å£:</p>
<p><a href="https://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-geocoding">https://lbsyun.baidu.com/index.php?title=webapi/guide/webservice-geocoding</a></p>
<p><a href="https://lbsyun.baidu.com/index.php?title=webapi/directionlite-v1">https://lbsyun.baidu.com/index.php?title=webapi/directionlite-v1</a></p>
<h2 id="2-ä»£ç å¼€å‘"><a href="#2-ä»£ç å¼€å‘" class="headerlink" title="2. ä»£ç å¼€å‘"></a>2. ä»£ç å¼€å‘</h2><h3 id="2-1-application-yml"><a href="#2-1-application-yml" class="headerlink" title="2.1 application.yml"></a>2.1 application.yml</h3><p>é…ç½®å¤–å–å•†å®¶åº—é“ºåœ°å€å’Œç™¾åº¦åœ°å›¾çš„AKï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221222170819582.png" alt="image-20221222170819582"></p>
<h3 id="2-2-OrderServiceImpl"><a href="#2-2-OrderServiceImpl" class="headerlink" title="2.2 OrderServiceImpl"></a>2.2 OrderServiceImpl</h3><p>æ”¹é€ OrderServiceImplï¼Œæ³¨å…¥ä¸Šé¢çš„é…ç½®é¡¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;sky.shop.address&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String shopAddress;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;sky.baidu.ak&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String ak;</span><br></pre></td></tr></table></figure>

<p>åœ¨OrderServiceImplä¸­æä¾›æ ¡éªŒæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ£€æŸ¥å®¢æˆ·çš„æ”¶è´§åœ°å€æ˜¯å¦è¶…å‡ºé…é€èŒƒå›´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> address</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkOutOfRange</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;address&quot;</span>,shopAddress);</span><br><span class="line">        map.put(<span class="string">&quot;output&quot;</span>,<span class="string">&quot;json&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;ak&quot;</span>,ak);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–åº—é“ºçš„ç»çº¬åº¦åæ ‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopCoordinate</span> <span class="operator">=</span> HttpClientUtil.doGet(<span class="string">&quot;https://api.map.baidu.com/geocoding/v3&quot;</span>, map);</span><br><span class="line"></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> JSON.parseObject(shopCoordinate);</span><br><span class="line">        <span class="keyword">if</span>(!jsonObject.getString(<span class="string">&quot;status&quot;</span>).equals(<span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(<span class="string">&quot;åº—é“ºåœ°å€è§£æå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ•°æ®è§£æ</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">location</span> <span class="operator">=</span> jsonObject.getJSONObject(<span class="string">&quot;result&quot;</span>).getJSONObject(<span class="string">&quot;location&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">lat</span> <span class="operator">=</span> location.getString(<span class="string">&quot;lat&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">lng</span> <span class="operator">=</span> location.getString(<span class="string">&quot;lng&quot;</span>);</span><br><span class="line">        <span class="comment">//åº—é“ºç»çº¬åº¦åæ ‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">shopLngLat</span> <span class="operator">=</span> lat + <span class="string">&quot;,&quot;</span> + lng;</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;address&quot;</span>,address);</span><br><span class="line">        <span class="comment">//è·å–ç”¨æˆ·æ”¶è´§åœ°å€çš„ç»çº¬åº¦åæ ‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userCoordinate</span> <span class="operator">=</span> HttpClientUtil.doGet(<span class="string">&quot;https://api.map.baidu.com/geocoding/v3&quot;</span>, map);</span><br><span class="line"></span><br><span class="line">        jsonObject = JSON.parseObject(userCoordinate);</span><br><span class="line">        <span class="keyword">if</span>(!jsonObject.getString(<span class="string">&quot;status&quot;</span>).equals(<span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(<span class="string">&quot;æ”¶è´§åœ°å€è§£æå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ•°æ®è§£æ</span></span><br><span class="line">        location = jsonObject.getJSONObject(<span class="string">&quot;result&quot;</span>).getJSONObject(<span class="string">&quot;location&quot;</span>);</span><br><span class="line">        lat = location.getString(<span class="string">&quot;lat&quot;</span>);</span><br><span class="line">        lng = location.getString(<span class="string">&quot;lng&quot;</span>);</span><br><span class="line">        <span class="comment">//ç”¨æˆ·æ”¶è´§åœ°å€ç»çº¬åº¦åæ ‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userLngLat</span> <span class="operator">=</span> lat + <span class="string">&quot;,&quot;</span> + lng;</span><br><span class="line"></span><br><span class="line">        map.put(<span class="string">&quot;origin&quot;</span>,shopLngLat);</span><br><span class="line">        map.put(<span class="string">&quot;destination&quot;</span>,userLngLat);</span><br><span class="line">        map.put(<span class="string">&quot;steps_info&quot;</span>,<span class="string">&quot;0&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·¯çº¿è§„åˆ’</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> HttpClientUtil.doGet(<span class="string">&quot;https://api.map.baidu.com/directionlite/v1/driving&quot;</span>, map);</span><br><span class="line"></span><br><span class="line">        jsonObject = JSON.parseObject(json);</span><br><span class="line">        <span class="keyword">if</span>(!jsonObject.getString(<span class="string">&quot;status&quot;</span>).equals(<span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(<span class="string">&quot;é…é€è·¯çº¿è§„åˆ’å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ•°æ®è§£æ</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">result</span> <span class="operator">=</span> jsonObject.getJSONObject(<span class="string">&quot;result&quot;</span>);</span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">jsonArray</span> <span class="operator">=</span> (JSONArray) result.get(<span class="string">&quot;routes&quot;</span>);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">distance</span> <span class="operator">=</span> (Integer) ((JSONObject) jsonArray.get(<span class="number">0</span>)).get(<span class="string">&quot;distance&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(distance &gt; <span class="number">5000</span>)&#123;</span><br><span class="line">            <span class="comment">//é…é€è·ç¦»è¶…è¿‡5000ç±³</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(<span class="string">&quot;è¶…å‡ºé…é€èŒƒå›´&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨OrderServiceImplçš„submitOrderæ–¹æ³•ä¸­è°ƒç”¨ä¸Šé¢çš„æ ¡éªŒæ–¹æ³•ï¼š</p>
<p><img src="/2024/03/02/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day09-%E7%94%A8%E6%88%B7%E7%AB%AF%E5%8E%86%E5%8F%B2%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97%E3%80%81%E5%95%86%E5%AE%B6%E7%AB%AF%E8%AE%A2%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97/image-20221222171444981-170937784053635.png" alt="image-20221222171444981"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day08-ç”¨æˆ·ä¸‹å•ã€è®¢å•æ”¯ä»˜</title>
    <url>/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/</url>
    <content><![CDATA[<h1 id="ç”¨æˆ·ä¸‹å•"><a href="#ç”¨æˆ·ä¸‹å•" class="headerlink" title="ç”¨æˆ·ä¸‹å•"></a>ç”¨æˆ·ä¸‹å•</h1><p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301164352182.png" alt="image-20240301164352182"></p>
<h1 id="å¯¼å…¥åœ°å€ç°¿åŠŸèƒ½ä»£ç "><a href="#å¯¼å…¥åœ°å€ç°¿åŠŸèƒ½ä»£ç " class="headerlink" title="å¯¼å…¥åœ°å€ç°¿åŠŸèƒ½ä»£ç "></a>å¯¼å…¥åœ°å€ç°¿åŠŸèƒ½ä»£ç </h1><p>ä»æŠ€æœ¯å±‚é¢æ¥è¯´å°±æ˜¯å•è¡¨çš„å¢åˆ æ”¹æŸ¥ï¼Œè¿™å—ä»£ç ä¸å†ç¼–å†™ï¼Œç›´æ¥å¯¼å…¥å³å¯ã€‚</p>
<h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p>ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªåœ°å€ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤åœ°å€ã€‚å¯ä»¥æ–°å¢æ”¶è´§åœ°å€ï¼Œç¼–è¾‘æ”¶è´§åœ°å€ï¼Œåˆ é™¤æ”¶è´§åœ°å€ã€‚</p>
<p><strong>äº§å“åŸå‹:</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301164838336.png" alt="image-20240301164838336"></p>
<ul>
<li>æŸ¥è¯¢åœ°å€åˆ—è¡¨</li>
<li>æ–°å¢æ”¶è´§åœ°å€</li>
<li>ä¿®æ”¹æ”¶è´§åœ°å€ï¼ˆ1.æ ¹æ®ä¸»é”®æŠŠåŸå…ˆçš„åœ°å€æ”¶è´§ä¿¡æ¯æŸ¥å‡ºæ¥ï¼Œç”¨äºé¡µé¢å›å†™ 2. ä¿®æ”¹å†…å®¹ï¼‰</li>
<li>åˆ é™¤æ”¶è´§åœ°å€</li>
<li>è®¾ç½®é»˜è®¤åœ°å€</li>
<li>æŸ¥è¯¢é»˜è®¤åœ°å€</li>
</ul>
<p><strong>æ¥å£è®¾è®¡ï¼š</strong></p>
<ul>
<li>æ–°å¢åœ°å€</li>
<li>æŸ¥è¯¢å½“å‰ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰åœ°å€ä¿¡æ¯</li>
<li>æŸ¥è¯¢é»˜è®¤åœ°å€</li>
<li>æ ¹æ®idä¿®æ”¹åœ°å€</li>
<li>æ ¹æ®idåˆ é™¤åœ°å€</li>
<li>æ ¹æ®idæŸ¥è¯¢åœ°å€</li>
<li>è®¾ç½®é»˜è®¤åœ°å€</li>
</ul>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301165444509.png" alt="image-20240301165444509"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301212740075.png" alt="image-20240301212740075"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301212750229.png" alt="image-20240301212750229"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301212814494.png" alt="image-20240301212814494"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301212933217.png" alt="image-20240301212933217"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301213033647.png" alt="image-20240301213033647"></p>
<p><strong>æ•°æ®åº“è®¾è®¡ï¼ˆaddress_bookè¡¨ï¼‰</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301213223486.png" alt="image-20240301213223486"></p>
<h2 id="ä»£ç å¯¼å…¥"><a href="#ä»£ç å¯¼å…¥" class="headerlink" title="ä»£ç å¯¼å…¥"></a>ä»£ç å¯¼å…¥</h2><p>å¯¼å…¥è¯¾ç¨‹èµ„æ–™ä¸­çš„åœ°å€ç°¿æ¨¡å—åŠŸèƒ½ä»£ç </p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301214000482.png" alt="image-20240301214000482"></p>
<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301215743474.png" alt="image-20240301215743474"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301215758660.png" alt="image-20240301215758660"></p>
<h1 id="ç”¨æˆ·ä¸‹å•-1"><a href="#ç”¨æˆ·ä¸‹å•-1" class="headerlink" title="ç”¨æˆ·ä¸‹å•"></a>ç”¨æˆ·ä¸‹å•</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p>ç”¨æˆ·ä¸‹å•ä¸šåŠ¡è¯´æ˜ï¼š</p>
<p>åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ˜¯é€šè¿‡ä¸‹å•çš„æ–¹å¼é€šçŸ¥å•†å®¶ï¼Œç”¨æˆ·å·²ç»è´­ä¹°äº†å•†å“ï¼Œéœ€è¦å•†å®¶è¿›è¡Œå¤‡è´§å’Œå‘è´§ã€‚</p>
<p>ç”¨æˆ·ä¸‹å•åä¼šäº§ç”Ÿè®¢å•ç›¸å…³æ•°æ®ï¼Œè®¢å•æ•°æ®éœ€è¦èƒ½å¤Ÿä½“ç°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301220047378.png" alt="image-20240301220047378"></p>
<ul>
<li>ç”¨æˆ·è´­ä¹°äº†å“ªäº›å•†å“ï¼Œæ¯ä¸ªå•†å“æ•°é‡æ˜¯å¤šå°‘ï¼Ÿï¼ˆç”¨æˆ·è´­ç‰©è½¦ï¼‰</li>
<li>è®¢å•æ€»é‡‘é¢æ˜¯å¤šå°‘ï¼Ÿï¼ˆé¤ç›’è´¹ï¼š1å…ƒ&#x2F;ä¸€ä¸ªèœå“ï¼Œé…é€è´¹ï¼šå›ºå®š6å…ƒï¼‰</li>
<li>æ”¶è´§åœ°å€æ˜¯å“ªï¼Ÿï¼ˆåœ°å€ç°¿è¡¨ï¼‰</li>
<li>å“ªä¸ªç”¨æˆ·ä¸‹çš„å•ï¼Ÿï¼ˆåœ°å€ç°¿è¡¨ï¼‰</li>
<li>ç”¨æˆ·æ‰‹æœºå·æ˜¯å¤šå°‘ï¼Ÿï¼ˆåœ°å€ç°¿è¡¨ï¼‰</li>
</ul>
<p><strong>ç”¨æˆ·ç‚¹é¤ä¸šåŠ¡æµç¨‹ï¼š</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301222617161.png" alt="image-20240301222617161"></p>
<p>æ¥å£è®¾è®¡ï¼ˆåˆ†æï¼‰ï¼š</p>
<ul>
<li><p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
</li>
<li><p>è¯·æ±‚è·¯å¾„ï¼š&#x2F;user&#x2F;order&#x2F;submit</p>
</li>
<li><p>å‚æ•°ï¼š</p>
<ul>
<li>åœ°å€ç°¿id</li>
<li>é…é€çŠ¶æ€ï¼ˆç«‹å³é€å‡ºã€é€‰æ‹©é€å‡ºæ—¶é—´ï¼‰</li>
<li>æ‰“åŒ…è´¹</li>
<li>æ€»é‡‘é¢</li>
<li>å¤‡æ³¨</li>
<li>é¤å…·æ•°é‡</li>
</ul>
</li>
</ul>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301222801169.png" alt="image-20240301222801169"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301223059603.png" alt="image-20240301223059603"></p>
<p>è¿”å›æ•°æ®ï¼š</p>
<ul>
<li>ä¸‹å•æ—¶é—´</li>
<li>è®¢å•æ€»é‡‘é¢</li>
<li>è®¢å•å·</li>
<li>è®¢å•id</li>
</ul>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301223435368.png" alt="image-20240301223435368"></p>
<p><strong>æ•°æ®è¡¨è®¾è®¡</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301224540874.png" alt="image-20240301224540874"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301224551523.png" alt="image-20240301224551523"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301225121299.png" alt="image-20240301225121299"></p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>æ ¹æ®ç”¨æˆ·ä¸‹å•æ¥å£çš„å‚æ•°è®¾è®¡DTO</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301233219545.png" alt="image-20240301233219545"></p>
<p><strong>æ ¹æ®ç”¨æˆ·ä¸‹å•æ¥å£çš„è¿”å›ç»“æœè®¾è®¡VO</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240301233254551.png" alt="image-20240301233254551"></p>
<p><strong>user.OrderController</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.OrdersSubmitDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.OrderSubmitVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController(&quot;userOrderController&quot;)</span> <span class="comment">//ç»™è¿™ä¸ªç±»çš„Beanå¯¹è±¡èµ·åˆ«åï¼Œé˜²æ­¢å…¶ä»–åŒ…å†…åŒåç±»å£°æ˜æˆBeanå˜é‡</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/order&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;ç”¨æˆ·ç«¯è®¢å•ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ä¸‹å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersSubmitDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/submit&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ç”¨æˆ·ä¸‹å•&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;OrderSubmitVO&gt; <span class="title function_">submit</span><span class="params">(<span class="meta">@RequestBody</span> OrdersSubmitDTO ordersSubmitDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;ç”¨æˆ·ä¸‹å•ï¼šå‚æ•°ä¸ºï¼š&#123;&#125;&quot;</span>,ordersSubmitDTO);</span><br><span class="line">        <span class="type">OrderSubmitVO</span> <span class="variable">orderSubmitVO</span> <span class="operator">=</span> orderService.submitOrder(ordersSubmitDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success(orderSubmitVO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>orderserviceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.OrdersSubmitDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.OrderSubmitVO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ä¸‹å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersSubmitDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    OrderSubmitVO <span class="title function_">submitOrder</span><span class="params">(OrdersSubmitDTO ordersSubmitDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderDetailMapper orderDetailMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AddressBookMapper addressBookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ä¸‹å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersSubmitDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> OrderSubmitVO <span class="title function_">submitOrder</span><span class="params">(OrdersSubmitDTO ordersSubmitDTO)</span> &#123;</span><br><span class="line">        <span class="comment">//å¤„ç†å„ç§ä¸šåŠ¡å¼‚å¸¸(åœ°å€ç°¿ä¸ºç©ºã€è´­ç‰©è½¦æ•°æ®ä¸ºç©ºï¼‰</span></span><br><span class="line">        <span class="type">AddressBook</span> <span class="variable">addressBook</span> <span class="operator">=</span> addressBookMapper.getById(ordersSubmitDTO.getAddressBookId());</span><br><span class="line">        <span class="keyword">if</span>(addressBook == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//æŠ›å‡ºä¸šåŠ¡å¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AddressBookBusinessException</span>(MessageConstant.ADDRESS_BOOK_IS_NULL);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„è´­ç‰©è½¦æ•°æ®</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line">        shoppingCart.setUserId(userId);</span><br><span class="line">        List&lt;ShoppingCart&gt; shoppingCartList = shoppingCartMapper.list(shoppingCart);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(shoppingCartList == <span class="literal">null</span> || shoppingCartList.size() == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ShoppingCartBusinessException</span>(MessageConstant.SHOPPING_CART_IS_NULL);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘è®¢å•è¡¨æ’å…¥1æ¡æ•°æ®</span></span><br><span class="line">        <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Orders</span>();</span><br><span class="line">        BeanUtils.copyProperties(ordersSubmitDTO, orders);</span><br><span class="line">        orders.setOrderTime(LocalDateTime.now());</span><br><span class="line">        orders.setPayStatus(Orders.UN_PAID);</span><br><span class="line">        orders.setStatus(Orders.PENDING_PAYMENT);</span><br><span class="line">        orders.setNumber(String.valueOf(System.currentTimeMillis()));</span><br><span class="line">        orders.setPhone(addressBook.getPhone());</span><br><span class="line">        orders.setConsignee(addressBook.getConsignee());</span><br><span class="line">        orders.setUserId(userId);</span><br><span class="line">        orderMapper.insert(orders);</span><br><span class="line"></span><br><span class="line">        List&lt;OrderDetail&gt; orderDetailList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘è®¢å•æ˜ç»†è¡¨æ’å…¥næ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (ShoppingCart cart : shoppingCartList) &#123;</span><br><span class="line">            <span class="type">OrderDetail</span> <span class="variable">orderDetail</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OrderDetail</span>();</span><br><span class="line">            BeanUtils.copyProperties(cart,orderDetail);</span><br><span class="line">            orderDetail.setOrderId(orders.getId()); <span class="comment">//è®¾ç½®å½“å‰è®¢å•æ˜ç»†å…³è”çš„è®¢å•ID</span></span><br><span class="line">            orderDetailList.add(orderDetail);</span><br><span class="line">        &#125;</span><br><span class="line">        orderDetailMapper.insertBatch(orderDetailList);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¸…ç©ºå½“å‰ç”¨æˆ·çš„è´­ç‰©è½¦æ•°æ®</span></span><br><span class="line">        shoppingCartMapper.deleteByUserId(userId);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°è£…VOè¿”å›ç»“æœ</span></span><br><span class="line">        <span class="type">OrderSubmitVO</span> <span class="variable">orderSubmitVO</span> <span class="operator">=</span> OrderSubmitVO.builder()</span><br><span class="line">            .id(orders.getId())</span><br><span class="line">            .orderTime(orders.getOrderTime())</span><br><span class="line">            .orderNumber(orders.getNumber())</span><br><span class="line">            .orderAmount(orders.getAmount())</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> orderSubmitVO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderDetailMapper</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.OrderDetail;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderDetailMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ’å…¥è®¢å•æ˜ç»†æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderDetailList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insertBatch</span><span class="params">(List&lt;OrderDetail&gt; orderDetailList)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>OrderMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.OrderMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span> = <span class="string">&quot;insert&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">        insert into orders (number, status, user_id, address_book_id, order_time, checkout_time, pay_method, pay_status, amount, remark, phone, address, user_name, consignee, cancel_reason, rejection_reason, cancel_time, estimated_delivery_time, delivery_status, delivery_time, pack_amount, tableware_number, tableware_status) VALUES</span><br><span class="line">            (#&#123;number&#125;, #&#123;status&#125;, #&#123;userId&#125;, #&#123;addressBookId&#125;, #&#123;orderTime&#125;, #&#123;checkoutTime&#125;, #&#123;payMethod&#125;, #&#123;payStatus&#125;, #&#123;amount&#125;, #&#123;remark&#125;, #&#123;phone&#125;, #&#123;address&#125;, #&#123;userName&#125;, #&#123;consignee&#125;, #&#123;cancelReason&#125;, #&#123;rejectionReason&#125;, #&#123;cancelTime&#125;, #&#123;estimatedDeliveryTime&#125;, #&#123;deliveryStatus&#125;, #&#123;deliveryTime&#125;, #&#123;packAmount&#125;, #&#123;tablewareNumber&#125;, #&#123;tablewareStatus&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>OrderDetailMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.OrderDetail;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderDetailMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ’å…¥è®¢å•æ˜ç»†æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderDetailList</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insertBatch</span><span class="params">(List&lt;OrderDetail&gt; orderDetailList)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>OrderDetailMapper.xml</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.sky.mapper.OrderDetailMapper&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert id=<span class="string">&quot;insertBatch&quot;</span>&gt;</span><br><span class="line">        insert into <span class="title function_">order_detail</span> <span class="params">(name, image, order_id, dish_id, setmeal_id, dish_flavor, amount)</span> VALUES</span><br><span class="line">        &lt;foreach collection=<span class="string">&quot;orderDetailList&quot;</span> separator=<span class="string">&quot;,&quot;</span> item=<span class="string">&quot;od&quot;</span>&gt;</span><br><span class="line">            (#&#123;od.name&#125;, #&#123;od.image&#125;, #&#123;od.orderId&#125;, #&#123;od.dishId&#125;, #&#123;od.setmealId&#125;, #&#123;od.dishFlavor&#125;, #&#123;od.amount&#125;)</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302004333856.png" alt="image-20240302004333856"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302004348098.png" alt="image-20240302004348098"></p>
<h1 id="è®¢å•æ”¯ä»˜"><a href="#è®¢å•æ”¯ä»˜" class="headerlink" title="è®¢å•æ”¯ä»˜"></a>è®¢å•æ”¯ä»˜</h1><h2 id="å¾®ä¿¡æ”¯ä»˜ä»‹ç»"><a href="#å¾®ä¿¡æ”¯ä»˜ä»‹ç»" class="headerlink" title="å¾®ä¿¡æ”¯ä»˜ä»‹ç»"></a>å¾®ä¿¡æ”¯ä»˜ä»‹ç»</h2><p>è¦å®ç°å¾®ä¿¡æ”¯ä»˜ï¼Œè¦æ³¨å†Œå¾®ä¿¡æ”¯ä»˜çš„å•†æˆ·å·ï¼Œæ³¨å†Œå•†æˆ·å·æ˜¯æœ‰è¦æ±‚çš„ï¼Œæ¯”å¦‚è¯´å¿…é¡»è¦æœ‰ä¸€å®¶ä¼ä¸šï¼Œå¹¶ä¸”éœ€è¦æœ‰æ­£è§„çš„ä¼ä¸šè¥ä¸šæ‰§ç…§ã€‚åªæœ‰å…·å¤‡è¿™äº›èµ„è´¨ï¼Œæ‰èƒ½æ³¨å†Œå•†æˆ·å·ï¼Œæ‰èƒ½å¼€é€šæ”¯ä»˜æƒé™ã€‚</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302005600308.png" alt="image-20240302005600308"></p>
<p><strong>å¾®ä¿¡æ”¯ä»˜æ¥å…¥æµç¨‹ï¼š</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302010033959.png" alt="image-20240302010033959"></p>
<p><strong>å¾®ä¿¡å°ç¨‹åºæ”¯ä»˜æ—¶åºå›¾</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302010600013.png" alt="image-20240302010600013"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302010735321.png" alt="image-20240302010735321"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302011129869.png" alt="image-20240302011129869"></p>
<p>JSAPä¸‹å•ï¼šå•†æˆ·ç³»ç»Ÿè°ƒç”¨è¯¥æ¥å£åœ¨å¾®ä¿¡æ”¯ä»˜æœåŠ¡åå°ç”Ÿæˆé¢„æ”¯ä»˜äº¤æ˜“å•</p>
<p>é€‚ç”¨å¯¹è±¡ï¼šç›´è¿å•†æˆ·</p>
<p>è¯·æ±‚URLï¼š<a href="https://api/mch.weixin.qq.com/v3/pay/transactions/jsapi">https://api/mch.weixin.qq.com/v3/pay/transactions/jsapi</a></p>
<p>è¯·æ±‚æ–¹å¼ï¼šPOST</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302011421383.png" alt="image-20240302011421383"></p>
<p>å¾®ä¿¡å°ç¨‹åºè°ƒèµ·æ”¯ä»˜ï¼šé€šè¿‡JSAPIä¸‹å•æ¥å£è·å–åˆ°å‘èµ·æ”¯ä»˜çš„å¿…è¦å‚æ•°prepay_idï¼Œç„¶åä½¿ç”¨å¾®ä¿¡æ”¯ä»˜æä¾›çš„å°ç¨‹åºæ–¹æ³•wx.requestPaymentè°ƒç”¨å°ç¨‹åºæ”¯ä»˜</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302011805064.png" alt="image-20240302011805064"></p>
<h2 id="å¾®ä¿¡æ”¯ä»˜å‡†å¤‡å·¥ä½œ"><a href="#å¾®ä¿¡æ”¯ä»˜å‡†å¤‡å·¥ä½œ" class="headerlink" title="å¾®ä¿¡æ”¯ä»˜å‡†å¤‡å·¥ä½œ"></a>å¾®ä¿¡æ”¯ä»˜å‡†å¤‡å·¥ä½œ</h2><p>è·å–å¾®ä¿¡æ”¯ä»˜å¹³å°è¯ä¹¦ã€å•†æˆ·ç§é’¥æ–‡ä»¶</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302012338158.png" alt="image-20240302012338158"></p>
<p><strong>è·å–ä¸´æ—¶åŸŸåï¼šæ”¯ä»˜æˆåŠŸåå¾®ä¿¡æœåŠ¡é€šè¿‡è¯¥åŸŸåå›è°ƒæˆ‘ä»¬çš„ç¨‹åº</strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302012549593.png" alt="image-20240302012549593"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302014347118.png" alt="image-20240302014347118"></p>
<h1 id="å¯¼å…¥åŠŸèƒ½ä»£ç "><a href="#å¯¼å…¥åŠŸèƒ½ä»£ç " class="headerlink" title="å¯¼å…¥åŠŸèƒ½ä»£ç "></a>å¯¼å…¥åŠŸèƒ½ä»£ç </h1><p>é…ç½®å¾®ä¿¡æ”¯ä»˜ç›¸å…³ä¿¡æ¯</p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302125724453.png" alt="image-20240302125724453"></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302131956590.png" alt="image-20240302131956590"></p>
<p><strong>OrderControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ”¯ä»˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersPaymentDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/payment&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;è®¢å•æ”¯ä»˜&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;OrderPaymentVO&gt; <span class="title function_">payment</span><span class="params">(<span class="meta">@RequestBody</span> OrdersPaymentDTO ordersPaymentDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    log.info(<span class="string">&quot;è®¢å•æ”¯ä»˜ï¼š&#123;&#125;&quot;</span>, ordersPaymentDTO);</span><br><span class="line">    <span class="type">OrderPaymentVO</span> <span class="variable">orderPaymentVO</span> <span class="operator">=</span> orderService.payment(ordersPaymentDTO);</span><br><span class="line">    log.info(<span class="string">&quot;ç”Ÿæˆé¢„æ”¯ä»˜äº¤æ˜“å•ï¼š&#123;&#125;&quot;</span>, orderPaymentVO);</span><br><span class="line">    <span class="keyword">return</span> Result.success(orderPaymentVO);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OrderSerivceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ”¯ä»˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersPaymentDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">OrderPaymentVO <span class="title function_">payment</span><span class="params">(OrdersPaymentDTO ordersPaymentDTO)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯ä»˜æˆåŠŸï¼Œä¿®æ”¹è®¢å•çŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outTradeNo</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">paySuccess</span><span class="params">(String outTradeNo)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>OrderServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderDetailMapper orderDetailMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AddressBookMapper addressBookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WeChatPayUtil weChatPayUtil;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ”¯ä»˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersPaymentDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> OrderPaymentVO <span class="title function_">payment</span><span class="params">(OrdersPaymentDTO ordersPaymentDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// å½“å‰ç™»å½•ç”¨æˆ·id</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.getById(userId);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¥å£ï¼Œç”Ÿæˆé¢„æ”¯ä»˜äº¤æ˜“å•</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> weChatPayUtil.pay(</span><br><span class="line">            ordersPaymentDTO.getOrderNumber(), <span class="comment">//å•†æˆ·è®¢å•å·</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="number">0.01</span>), <span class="comment">//æ”¯ä»˜é‡‘é¢ï¼Œå•ä½ å…ƒ</span></span><br><span class="line">            <span class="string">&quot;è‹ç©¹å¤–å–è®¢å•&quot;</span>, <span class="comment">//å•†å“æè¿°</span></span><br><span class="line">            user.getOpenid() <span class="comment">//å¾®ä¿¡ç”¨æˆ·çš„openid</span></span><br><span class="line">        );</span><br><span class="line"><span class="comment">//        JSONObject jsonObject = new JSONObject();</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (jsonObject.getString(<span class="string">&quot;code&quot;</span>) != <span class="literal">null</span> &amp;&amp; jsonObject.getString(<span class="string">&quot;code&quot;</span>).equals(<span class="string">&quot;ORDERPAID&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">OrderBusinessException</span>(<span class="string">&quot;è¯¥è®¢å•å·²æ”¯ä»˜&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">OrderPaymentVO</span> <span class="variable">vo</span> <span class="operator">=</span> jsonObject.toJavaObject(OrderPaymentVO.class);</span><br><span class="line">        vo.setPackageStr(jsonObject.getString(<span class="string">&quot;package&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> vo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ”¯ä»˜æˆåŠŸï¼Œä¿®æ”¹è®¢å•çŠ¶æ€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outTradeNo</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">paySuccess</span><span class="params">(String outTradeNo)</span> &#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•</span></span><br><span class="line">        <span class="type">Orders</span> <span class="variable">ordersDB</span> <span class="operator">=</span> orderMapper.getByNumber(outTradeNo);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ¹æ®è®¢å•idæ›´æ–°è®¢å•çš„çŠ¶æ€ã€æ”¯ä»˜æ–¹å¼ã€æ”¯ä»˜çŠ¶æ€ã€ç»“è´¦æ—¶é—´</span></span><br><span class="line">        <span class="type">Orders</span> <span class="variable">orders</span> <span class="operator">=</span> Orders.builder()</span><br><span class="line">            .id(ordersDB.getId())</span><br><span class="line">            .status(Orders.TO_BE_CONFIRMED)</span><br><span class="line">            .payStatus(Orders.PAID)</span><br><span class="line">            .checkoutTime(LocalDateTime.now())</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        orderMapper.update(orders);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>OrderMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Orders;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥è®¢å•æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orders</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Orders orders)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderNumber</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from orders where number = #&#123;orderNumber&#125;&quot;)</span></span><br><span class="line">    Orders <span class="title function_">getByNumber</span><span class="params">(String orderNumber)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹è®¢å•ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orders</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Orders orders)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>orderMapper.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.OrderMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.sky.entity.Orders&quot;</span>&gt;</span></span><br><span class="line">        update orders</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;cancelReason != null and cancelReason!=&#x27;&#x27; &quot;</span>&gt;</span></span><br><span class="line">                cancel_reason=#&#123;cancelReason&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;rejectionReason != null and rejectionReason!=&#x27;&#x27; &quot;</span>&gt;</span></span><br><span class="line">                rejection_reason=#&#123;rejectionReason&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;cancelTime != null&quot;</span>&gt;</span></span><br><span class="line">                cancel_time=#&#123;cancelTime&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;payStatus != null&quot;</span>&gt;</span></span><br><span class="line">                pay_status=#&#123;payStatus&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;payMethod != null&quot;</span>&gt;</span></span><br><span class="line">                pay_method=#&#123;payMethod&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;checkoutTime != null&quot;</span>&gt;</span></span><br><span class="line">                checkout_time=#&#123;checkoutTime&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span></span><br><span class="line">                status = #&#123;status&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;deliveryTime != null&quot;</span>&gt;</span></span><br><span class="line">                delivery_time = #&#123;deliveryTime&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="é˜…è¯»è®¢å•æ”¯ä»˜åŠŸèƒ½ä»£ç "><a href="#é˜…è¯»è®¢å•æ”¯ä»˜åŠŸèƒ½ä»£ç " class="headerlink" title="é˜…è¯»è®¢å•æ”¯ä»˜åŠŸèƒ½ä»£ç "></a>é˜…è¯»è®¢å•æ”¯ä»˜åŠŸèƒ½ä»£ç </h2><p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302134848276.png" alt="image-20240302134848276"></p>
<p><strong>å› ä¸ºä¸ªäººæ²¡æœ‰ä¼ä¸šç‰ˆå°ç¨‹åºï¼Œæ²¡æœ‰å¯¹åº”çš„ç‰ˆæœ¬å·å’Œèµ„æ ¼è¯ä¹¦ï¼Œæ‰€ä»¥å¦‚ä¸‹ä¿®æ”¹ä»£ç </strong></p>
<p>ä¿®æ”¹<strong>OrderServiceImpl</strong>ç±»çš„paymentæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">OrderService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderDetailMapper orderDetailMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AddressBookMapper addressBookMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WeChatPayUtil weChatPayUtil;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Orders orders;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¢å•æ”¯ä»˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ordersPaymentDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> OrderPaymentVO <span class="title function_">payment</span><span class="params">(OrdersPaymentDTO ordersPaymentDTO)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// å½“å‰ç™»å½•ç”¨æˆ·id</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.getById(userId);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        //è°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¥å£ï¼Œç”Ÿæˆé¢„æ”¯ä»˜äº¤æ˜“å•</span></span><br><span class="line"><span class="comment">//        JSONObject jsonObject = weChatPayUtil.pay(</span></span><br><span class="line"><span class="comment">//            ordersPaymentDTO.getOrderNumber(), //å•†æˆ·è®¢å•å·</span></span><br><span class="line"><span class="comment">//            new BigDecimal(0.01), //æ”¯ä»˜é‡‘é¢ï¼Œå•ä½ å…ƒ</span></span><br><span class="line"><span class="comment">//            &quot;è‹ç©¹å¤–å–è®¢å•&quot;, //å•†å“æè¿°</span></span><br><span class="line"><span class="comment">//            user.getOpenid() //å¾®ä¿¡ç”¨æˆ·çš„openid</span></span><br><span class="line"><span class="comment">//        );</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//        if (jsonObject.getString(&quot;code&quot;) != null &amp;&amp; jsonObject.getString(&quot;code&quot;).equals(&quot;ORDERPAID&quot;)) &#123;</span></span><br><span class="line"><span class="comment">//            throw new OrderBusinessException(&quot;è¯¥è®¢å•å·²æ”¯ä»˜&quot;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line"></span><br><span class="line">        jsonObject.put(<span class="string">&quot;code&quot;</span>, <span class="string">&quot;ORDERPAID&quot;</span>);</span><br><span class="line">        <span class="type">OrderPaymentVO</span> <span class="variable">vo</span> <span class="operator">=</span> jsonObject.toJavaObject(OrderPaymentVO.class);</span><br><span class="line">        vo.setPackageStr(jsonObject.getString(<span class="string">&quot;package&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸ºæ›¿ä»£å¾®ä¿¡æ”¯ä»˜æˆåŠŸåçš„æ•°æ®åº“è®¢å•çŠ¶æ€æ›´æ–°ï¼Œå¤šå®šä¹‰ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">OrderPaidStatus</span> <span class="operator">=</span> Orders.PAID; <span class="comment">//æ”¯ä»˜çŠ¶æ€ï¼Œå·²æ”¯ä»˜</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">OrderStatus</span> <span class="operator">=</span> Orders.TO_BE_CONFIRMED;  <span class="comment">//è®¢å•çŠ¶æ€ï¼Œå¾…æ¥å•</span></span><br><span class="line">        <span class="comment">//å‘ç°æ²¡æœ‰å°†æ”¯ä»˜æ—¶é—´ check_outå±æ€§èµ‹å€¼ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæ›´æ–°</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">check_out_time</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        orderMapper.updateStatus(OrderStatus, OrderPaidStatus, check_out_time, orders.getId());</span><br><span class="line">        <span class="keyword">return</span> vo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹orderMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Orders;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨äºæ›¿æ¢å¾®ä¿¡æ”¯ä»˜æ›´æ–°æ•°æ®åº“çŠ¶æ€çš„é—®é¢˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderStatus</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orderPaidStatus</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Update(&quot;update orders set status = #&#123;orderStatus&#125;,pay_status = #&#123;orderPaidStatus&#125; ,checkout_time = #&#123;check_out_time&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateStatus</span><span class="params">(Integer orderStatus, Integer orderPaidStatus, LocalDateTime check_out_time, Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹å‰ç«¯ä»£ç </strong></p>
<p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302145505722.png" alt="image-20240302145505722"></p>
<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/03/01/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day08-%E7%94%A8%E6%88%B7%E4%B8%8B%E5%8D%95%E3%80%81%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98/image-20240302151443363.png" alt="image-20240302151443363"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day07-ç¼“å­˜å•†å“ã€è´­ç‰©è½¦</title>
    <url>/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/</url>
    <content><![CDATA[<h1 id="éœ€æ±‚åŸå› "><a href="#éœ€æ±‚åŸå› " class="headerlink" title="éœ€æ±‚åŸå› "></a>éœ€æ±‚åŸå› </h1><p>é€šè¿‡å°ç¨‹åºå¯ä»¥å±•ç¤ºèœå“å’Œå¥—é¤æ•°æ®ï¼Œè¿™äº›éƒ½æ˜¯å­˜å‚¨åœ¨åŒä¸€ä¸ªæ•°æ®åº“å½“ä¸­ï¼Œå¦‚æœåœ¨æŸä¸ªæ—¶é—´æ®µå†…ï¼Œæœ‰å¤§é‡çš„ç”¨æˆ·æ¥ç‚¹é¤ï¼Œå°±ä¼šé¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“ï¼Œæ•°æ®åº“çš„è®¿é—®å‹åŠ›ç›¸å¯¹æ¥è¯´æ¯”è¾ƒå¤§ï¼Œé€ æˆæ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ä¸‹é™ï¼Œç”¨æˆ·ä½¿ç”¨ä½“éªŒä¸æ˜¯å¾ˆå¥½ï¼Œç›´è§‚çš„ä½“éªŒæ˜¯ç‚¹å‡»æŸä¸ªåˆ†ç±»ä¹‹åè¦ç»è¿‡å‡ ç§’é’Ÿæ‰èƒ½æ˜¾ç¤ºå¯¹åº”æ•°æ®ã€‚</p>
<p><strong>è§£å†³åŠæ³•</strong>ï¼šä½¿ç”¨ç¼“å­˜æ¥è§£å†³ï¼Œéœ€è¦æŠŠå•†å“æ•°æ®ç¼“å­˜è‡³rediså½“ä¸­ã€‚è¿™ä¼šå¤§å¤§æé«˜ç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p><strong>è´­ç‰©è½¦ç›¸å…³åŠŸèƒ½ï¼Œç‚¹å‡»+å·ï¼Œå°†å•†å“æ·»åŠ åˆ°è´­ç‰©è½¦ã€‚</strong></p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240229144150227.png" alt="image-20240229144150227"></p>
<h1 id="ç¼“å­˜èœå“"><a href="#ç¼“å­˜èœå“" class="headerlink" title="ç¼“å­˜èœå“"></a>ç¼“å­˜èœå“</h1><h2 id="é—®é¢˜è¯´æ˜"><a href="#é—®é¢˜è¯´æ˜" class="headerlink" title="é—®é¢˜è¯´æ˜"></a>é—®é¢˜è¯´æ˜</h2><p>ä»ç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½åˆ†æé—®é¢˜ï¼Œç„¶åé€šè¿‡ç¼“å­˜çš„æ–¹å¼æé«˜ç³»ç»Ÿçš„æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<ol>
<li>æ˜¯ä¸æ˜¯æ‰€æœ‰å•†å“éƒ½è¦ç¼“å­˜ï¼Ÿ</li>
<li>å•†å“ç¼“å­˜çš„ç²’åº¦å¦‚ä½•ï¼Ÿ</li>
</ol>
<p>ç”¨æˆ·ç«¯å°ç¨‹åºå±•ç¤ºçš„èœå“æ•°æ®éƒ½æ˜¯é€šè¿‡æŸ¥è¯¢æ•°æ®åº“è·å¾—ï¼Œå¦‚æœç”¨æˆ·ç«¯è®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ•°æ®åº“è®¿é—®å‹åŠ›éšä¹‹å¢å¤§ã€‚ç³»ç»ŸæŸ¥è¯¢çš„ç“¶é¢ˆæ˜¯æ•°æ®åº“æŸ¥è¯¢ã€‚</p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240229151909242.png" alt="image-20240229151909242"></p>
<p>ç»“æœï¼šç³»ç»Ÿå“åº”æ…¢ã€ç”¨æˆ·ä½“éªŒå·®</p>
<h2 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h2><p>é€šè¿‡Redisæ¥ç¼“å­˜èœå“æ•°æ®ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢æ“ä½œã€‚</p>
<p>Redisæ˜¯åŸºäºå†…å­˜è®¿é—®æ•°æ®çš„ï¼Œæ•°æ®åº“æ˜¯ç£ç›˜IOæ“ä½œã€‚</p>
<p>å†…å­˜æ“ä½œç›¸å¯¹äºç£ç›˜æ“ä½œæ€§èƒ½è¾ƒé«˜ã€‚</p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240229221904137.png" alt="image-20240229221904137"></p>
<p><strong>ç¼“å­˜é€»è¾‘åˆ†æï¼š</strong></p>
<ul>
<li><p>æ¯ä¸ªåˆ†ç±»çš„èœå“ä¿å­˜ä¸€ä»½ç¼“å­˜æ•°æ®ï¼ˆkeyï¼šåˆ†ç±»IDï¼Œvalueï¼šåˆ†ç±»ä¸‹å…·ä½“çš„èœå“æ•°æ®ï¼Œä½¿ç”¨stringå­—ç¬¦ä¸²ä¿å­˜ï¼Œå³ä¾§çš„èœå“åœ¨javaä¸­ç”¨listè¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åºåˆ—åŒ–ï¼Œè½¬æˆredisçš„å­—ç¬¦ä¸²ï¼‰</p>
</li>
<li><p>æ•°æ®åº“ä¸­èœå“æ•°æ®æœ‰å˜æ›´æ—¶æ¸…ç†ç¼“å­˜æ•°æ®ã€‚ï¼ˆåœ¨å•†å®¶ç«¯æ”¹äº†æ•°æ®ï¼Œè¦æ¸…ç†ç¼“å­˜ï¼Œä¸ç„¶æ•°æ®æ²¡æœ‰æ›´æ–°ï¼‰</p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240229222637493.png" alt="image-20240229222637493"></p>
</li>
</ul>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240229223752062.png" alt="image-20240229223752062"></p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>user.dishcontroller</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController(&quot;userDishController&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;Cç«¯-èœå“æµè§ˆæ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;DishVO&gt;&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span> &#123;</span><br><span class="line">        <span class="comment">//æ„é€ redisä¸­çš„keyï¼Œè§„åˆ™ï¼šdish_åˆ†ç±»id</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;dish_&quot;</span> + categoryId;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æŸ¥è¯¢redisä¸­æ˜¯å¦å­˜åœ¨èœå“æ•°æ®</span></span><br><span class="line">        List&lt;DishVO&gt; list = (List&lt;DishVO&gt;) redisTemplate.opsForValue().get(key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (list != <span class="literal">null</span> &amp;&amp; list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœå­˜åœ¨ï¼Œç›´æ¥è¿”å›ï¼Œæ— éœ€æŸ¥è¯¢æ•°æ®åº“</span></span><br><span class="line">            <span class="keyword">return</span> Result.success(list);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dish</span>();</span><br><span class="line">        dish.setCategoryId(categoryId);</span><br><span class="line">        dish.setStatus(StatusConstant.ENABLE);<span class="comment">//æŸ¥è¯¢èµ·å”®ä¸­çš„èœå“</span></span><br><span class="line"></span><br><span class="line">        list = dishService.listWithFlavor(dish);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œå°†æŸ¥è¯¢åˆ°çš„æ•°æ®æ”¾åˆ°redisä¸­</span></span><br><span class="line">        redisTemplate.opsForValue().set(key, list);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ç®¡ç†ç«¯æ¥å£DishControllerçš„ç›¸å…³æ–¹æ³•ï¼ŒåŠ å…¥æ¸…ç†ç¼“å­˜çš„é€»è¾‘ï¼Œéœ€è¦æ”¹é€ çš„æ–¹æ³•ï¼š</p>
<ul>
<li>æ–°å¢èœå“</li>
<li>ä¿®æ”¹èœå“</li>
<li>æ‰¹é‡åˆ é™¤èœå“</li>
<li>èµ·å”®ã€åœå”®èœå“</li>
</ul>
<p><strong>admin.dishcontroller</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢èœå“</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–°å¢èœå“æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> DishDTO dishDTO)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–°å¢èœå“ï¼š&#123;&#125;&quot;</span>, dishDTO);</span><br><span class="line">        dishService.saveWithFlavor(dishDTO);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¸…ç†ç¼“å­˜æ•°æ®</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&quot;dish_&quot;</span> + dishDTO.getCategoryId();</span><br><span class="line">        redisTemplate.delete(key);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;èœå“åˆ†é¡µæŸ¥è¯¢æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">page</span><span class="params">(DishPageQueryDTO dishPageQueryDTO)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;èœå“åˆ†é¡µæŸ¥è¯¢:&#123;&#125;&quot;</span>, dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> dishService.pageQuery(dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èœå“æ‰¹é‡åˆ é™¤æ¥å£</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;èœå“æ‰¹é‡åˆ é™¤æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;èœå“æ‰¹é‡åˆ é™¤ï¼š&#123;&#125;&quot;</span>, ids);</span><br><span class="line">        dishService.deleteBatch(ids);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†æ‰€æœ‰çš„èœå“ç¼“å­˜æ•°æ®æ¸…ç†æ‰ï¼Œæ‰€æœ‰ä»¥dish_ä¸‹åˆ’çº¿å¼€å¤´çš„key</span></span><br><span class="line">        cleanCache(<span class="string">&quot;dish_*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢èœå“&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;DishVO&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ ¹æ®idæŸ¥è¯¢èœå“ï¼š&#123;&#125;&quot;</span>,id);</span><br><span class="line">        <span class="type">DishVO</span> <span class="variable">dishVO</span> <span class="operator">=</span> dishService.getByIdWithFlavor(id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(dishVO);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ä¿®æ”¹èœå“æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> DishDTO dishDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;ä¿®æ”¹èœå“:&#123;&#125;&quot;</span>,dishDTO);</span><br><span class="line">        dishService.updateWithFlavor(dishDTO);</span><br><span class="line"></span><br><span class="line">        cleanCache(<span class="string">&quot;dish_*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;Dish&gt;&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“:&#123;&#125;&quot;</span>,categoryId);</span><br><span class="line">        List&lt;Dish&gt; list = dishService.list(categoryId);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">cleanCache</span><span class="params">(String pattern)</span>&#123;</span><br><span class="line">        <span class="comment">//å°†æ‰€æœ‰çš„èœå“ç¼“å­˜æ•°æ®æ¸…ç†æ‰ï¼Œæ‰€æœ‰ä»¥dish_ä¸‹åˆ’çº¿å¼€å¤´çš„key</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">keys</span> <span class="operator">=</span> redisTemplate.keys(pattern);</span><br><span class="line">        redisTemplate.delete(keys);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><h1 id="ç¼“å­˜å¥—é¤-Spring-Cache"><a href="#ç¼“å­˜å¥—é¤-Spring-Cache" class="headerlink" title="ç¼“å­˜å¥—é¤_Spring Cache"></a>ç¼“å­˜å¥—é¤_Spring Cache</h1><p>æ–°çš„æŠ€æœ¯ï¼ˆspring-cacheï¼‰ï¼Œç”±springæä¾›çš„æŠ€æœ¯ã€‚</p>
<h2 id="Spring-Cache"><a href="#Spring-Cache" class="headerlink" title="Spring Cache"></a>Spring Cache</h2><p>ä½¿ç”¨å®ƒå¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ä»£ç ï¼Œæä¾›äº†æ³¨è§£ï¼Œè¦æ“ä½œç¼“å­˜æ•°æ®ï¼Œåªè¦åœ¨æ–¹æ³•ä¸ŠåŠ å…¥å®ƒæä¾›çš„æ³¨è§£å°±å¯ä»¥ã€‚è¿™ç§ä½¿ç”¨æ–¹å¼ç±»ä¼¼äºäº‹åŠ¡ç®¡ç†ã€‚</p>
<p>Spring Cacheæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå®ç°äº†åŸºäºæ³¨è§£çš„ç¼“å­˜åŠŸèƒ½ï¼Œåªéœ€è¦ç®€å•åœ°åŠ ä¸€ä¸ªæ³¨è§£ï¼Œå°±èƒ½å®ç°ç¼“å­˜åŠŸèƒ½ã€‚</p>
<p>Spring Cacheæä¾›äº†ä¸€å±‚æŠ½è±¡ï¼Œåº•å±‚å¯ä»¥åˆ‡æ¢ä¸åŒçš„ç¼“å­˜å®ç°ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>EHCache</li>
<li>Caffeine</li>
<li>Redis</li>
</ul>
<p><strong>å¯¼å…¥mavenåæ ‡</strong>ï¼ˆä¸åŒç¼“å­˜å¯¹åº”ä¸åŒåæ ‡ï¼Œç”¨rediså°±å¯¼å…¥redisåæ ‡ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- redisåæ ‡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¸¸ç”¨æ³¨è§£ï¼š</p>
<table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>@EnableCaching</td>
<td>å¼€å¯ç¼“å­˜æ³¨è§£åŠŸèƒ½ï¼Œé€šå¸¸åŠ åœ¨å¯åŠ¨ç±»ä¸Š</td>
</tr>
<tr>
<td>@Cacheable</td>
<td>åœ¨æ–¹æ³•æ‰§è¡Œå‰å…ˆæŸ¥è¯¢ç¼“å­˜ä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæœ‰æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜æ•°æ®ï¼›å¦‚æœæ²¡æœ‰ç¼“å­˜æ•°æ®ï¼Œè°ƒç”¨æ–¹æ³•å¹¶å°†æ–¹æ³•è¿”å›å€¼æ”¾åˆ°ç¼“å­˜ä¸­</td>
</tr>
<tr>
<td>@CachePut</td>
<td>å°†æ–¹æ³•çš„è¿”å›å€¼æ”¾åˆ°ç¼“å­˜ä¸­</td>
</tr>
<tr>
<td>@CacheEvict</td>
<td>å°†ä¸€æ¡æˆ–å¤šæ¡æ•°æ®ä»ç¼“å­˜ä¸­åˆ é™¤</td>
</tr>
</tbody></table>
<h2 id="å®ç°æ€è·¯-1"><a href="#å®ç°æ€è·¯-1" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h2><ol>
<li><p>åœ¨å¯åŠ¨ç±»åŠ ä¸Š@EnableCachingæ³¨è§£ï¼Œå¼€å¯ç¼“å­˜æ³¨è§£åŠŸèƒ½ã€‚</p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301112330973.png" alt="image-20240301112330973"></p>
</li>
<li><p>ä½¿ç”¨@CachePutæ³¨è§£ï¼Œå°†å¯¹åº”æ–¹æ³•çš„è¿”å›å€¼æ”¾å…¥redisç¼“å­˜ä¸­ã€‚</p>
<p>è¯¥è¿”å›å€¼çš„é”®ï¼Œå¯ä»¥ç”±#user.idæˆ–#result.idå†³å®šã€‚</p>
<p><strong>UserControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="comment">//    @CachePut(cacheNames = &quot;userCache&quot;,key = &quot;#user.id&quot;) //å¦‚æœä½¿ç”¨spring Cacheç¼“å­˜æ•°æ®ï¼Œkeyçš„ç”Ÿæˆï¼šuserCache::2,</span></span><br><span class="line"><span class="comment">//    @CachePut(cacheNames = &quot;userCache&quot;,key = &quot;#result.id&quot;) //å¯¹è±¡å¯¼èˆª</span></span><br><span class="line"><span class="comment">//    @CachePut(cacheNames = &quot;userCache&quot;,key = &quot;#p0.id&quot;) //æ‹¿åˆ°å½“å‰æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment">//    @CachePut(cacheNames = &quot;userCache&quot;,key = &quot;#a0.id&quot;) //æ‹¿åˆ°å½“å‰æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="meta">@CachePut(cacheNames = &quot;userCache&quot;,key = &quot;#root.args[0].id&quot;)</span> <span class="comment">//æ‹¿åˆ°å½“å‰æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    <span class="comment">//æ’å…¥æ•°æ®æ—¶è¦å°†æ•°æ®æ”¾åˆ°ç¼“å­˜ä¸­</span></span><br><span class="line">    userMapper.insert(user);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨@Cacheableæ³¨è§£ï¼Œå¦‚æœæŸ¥åˆ°æ•°æ®ï¼Œä¼šæŠŠå®ƒç›´æ¥æ”¾åˆ°ç¼“å­˜ä¸­ã€‚</p>
<p>ï¼ˆSpring Cacheåº•å±‚æ˜¯åŸºäºä»£ç†æŠ€æœ¯ï¼Œå³åŠ å…¥æ³¨è§£ä¹‹åï¼ŒSpring Cacheä¼šä¸ºå½“å‰çš„controlleråˆ›å»ºä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨è¯·æ±‚æ–¹æ³•å‰æ˜¯å…ˆè¿›å…¥ä»£ç†å¯¹è±¡ï¼Œè€Œåœ¨ä»£ç†å¯¹è±¡ä¸­æŸ¥è¯¢redisï¼‰</p>
<p><strong>UserControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Cacheable(cacheNames = &quot;userCache&quot;,key=&quot;#id&quot;)</span>  <span class="comment">//keyçš„ç”Ÿæˆ userCache::id</span></span><br><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">getById</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.getById(id);</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨@CacheEvictæ³¨è§£ï¼Œæ–¹æ³•ç»“æŸå®Œä¹‹åä¼šåˆ é™¤ç¼“å­˜ä¸­çš„å•æ¡æ•°æ®æˆ–å…¨éƒ¨æ•°æ®</p>
<p><strong>UserControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;userCache&quot;,key=&quot;#id&quot;)</span></span><br><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>&#123;</span><br><span class="line">    userMapper.deleteById(id);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;userCache&quot;,allEntries = true)</span> <span class="comment">//åˆ é™¤redisç¼“å­˜ä¸­userCacheä¸‹çš„æ‰€æœ‰é”®å€¼å¯¹</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/delAll&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span>&#123;</span><br><span class="line">    userMapper.deleteAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="ä»£ç å¼€å‘-1"><a href="#ä»£ç å¼€å‘-1" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><h3 id="å®ç°æ€è·¯-2"><a href="#å®ç°æ€è·¯-2" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h3><p>å…·ä½“å®ç°æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¼å…¥Spring Cacheå’ŒRedisç›¸å…³çš„mavenåæ ‡</li>
<li>åœ¨å¯åŠ¨ç±»ä¸ŠåŠ å…¥@EnableCachingæ³¨è§£ï¼Œå¼€å¯ç¼“å­˜æ³¨è§£åŠŸèƒ½</li>
<li>åœ¨ç”¨æˆ·ç«¯æ¥å£SetmealControllerçš„listæ–¹æ³•ä¸ŠåŠ å…¥@Cacheableæ³¨è§£</li>
<li>åœ¨ç®¡ç†ç«¯æ¥å£SetmealControllerçš„saveã€deleteã€updateã€startOrStopç­‰æ–¹æ³•ä¸ŠåŠ å…¥CacheEvitæ³¨è§£</li>
</ul>
<p><strong>æ£€æŸ¥pomæ–‡ä»¶</strong></p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301132623493.png" alt="image-20240301132623493"></p>
<p><strong>å¼€å¯ç¼“å­˜åŠŸèƒ½</strong></p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301132649067.png" alt="image-20240301132649067"></p>
<p><strong>ä¿®æ”¹user&#x2F;setmealcontrollerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¡ä»¶æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢å¥—é¤&quot;)</span></span><br><span class="line"><span class="meta">@Cacheable(cacheNames = &quot;setmealCache&quot;, key = &quot;#categoryId&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;Setmeal&gt;&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span> &#123;</span><br><span class="line">    <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Setmeal</span>();</span><br><span class="line">    setmeal.setCategoryId(categoryId);</span><br><span class="line">    setmeal.setStatus(StatusConstant.ENABLE);</span><br><span class="line"></span><br><span class="line">    List&lt;Setmeal&gt; list = setmealService.list(setmeal);</span><br><span class="line">    <span class="keyword">return</span> Result.success(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301132834586.png" alt="image-20240301132834586"></p>
<p><strong>ä¿®æ”¹admin&#x2F;setmealcontrollerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;setmealCache&quot;, key = &quot;#setmealDTO.categoryId&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢å¥—é¤æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SetmealDTO setmealDTO)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;æ–°å¢å¥—é¤æ¥å£:&#123;&#125;&quot;</span>,setmealDTO);</span><br><span class="line">    setmealService.saveWithDish(setmealDTO);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;setmealCache&quot;,allEntries = true)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ‰¹é‡åˆ é™¤å¥—é¤&quot;)</span></span><br><span class="line"><span class="keyword">public</span>  Result <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;Long&gt; ids)</span>&#123;</span><br><span class="line">    setmealService.deleteBatch(ids);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;ä¿®æ”¹å¥—é¤&quot;)</span></span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;setmealCache&quot;,allEntries = true)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SetmealDTO setmealDTO)</span> &#123;</span><br><span class="line">    setmealService.update(setmealDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å¥—é¤èµ·å”®åœå”®&quot;)</span></span><br><span class="line"><span class="meta">@CacheEvict(cacheNames = &quot;setmealCache&quot;,allEntries = true)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">startOrStop</span><span class="params">(<span class="meta">@PathVariable</span> Integer status, Long id)</span> &#123;</span><br><span class="line">    setmealService.startOrStop(status, id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red">ç»™user&#x2F;adminç«¯çš„dishcontrollerç±»ä¸­ä¹Ÿä¿®æ”¹å¯¹åº”çš„æ³¨é‡Šã€‚</font></p>
<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>ç®¡ç†ç«¯å‰ç«¯ç™»å½•ï¼Œä¿®æ”¹èœå“ä»·æ ¼ï¼Œä¼šå‘ç°redisä¸­å¯¹åº”çš„ç¼“å­˜æ•°æ®è¢«åˆ é™¤ã€‚</p>
<p>å®¢æˆ·ç«¯æ ¹æ®åˆ†ç±»æŸ¥è¯¢èœå“ï¼Œä¼šå‘ç°redisä¸­ä¿å­˜äº†èœå“çš„å¯¹åº”æ•°æ®ã€‚</p>
<h1 id="æ·»åŠ è´­ç‰©è½¦"><a href="#æ·»åŠ è´­ç‰©è½¦" class="headerlink" title="æ·»åŠ è´­ç‰©è½¦"></a>æ·»åŠ è´­ç‰©è½¦</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301135115767.png" alt="image-20240301135115767"></p>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li>è¯·æ±‚æ–¹å¼ï¼šPOST</li>
<li>è¯·æ±‚è·¯å¾„ï¼š&#x2F;user&#x2F;shoppingCart&#x2F;add</li>
<li>è¯·æ±‚å‚æ•°ï¼šå¥—é¤idã€èœå“idã€å£å‘³</li>
<li>è¿”å›ç»“æœï¼šcodeã€dataã€msg</li>
</ul>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301135634271.png" alt="image-20240301135634271"></p>
<p><strong>æ•°æ®åº“è®¾è®¡</strong></p>
<ul>
<li>ä½œç”¨ï¼šæš‚æ—¶å­˜æ”¾æ‰€é€‰å•†å“çš„åœ°æ–¹</li>
<li>é€‰çš„ä»€ä¹ˆå•†å“</li>
<li>æ¯ä¸ªå•†å“éƒ½ä¹°äº†å‡ ä¸ª</li>
<li>ä¸åŒç”¨æˆ·çš„è´­ç‰©è½¦éœ€è¦åŒºåˆ†å¼€</li>
</ul>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301140329045.png" alt="image-20240301140329045"></p>
<p>åŠ ç‚¹å†—ä½™å­—æ®µï¼Œä¸ç”¨è”è¡¨æŸ¥è¯¢ï¼Œå•è¡¨æŸ¥è¯¢ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<h2 id="ä»£ç å¼€å‘-2"><a href="#ä»£ç å¼€å‘-2" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>shoppingCartControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/shoppingCart&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;Cç«¯-è´­ç‰©è½¦ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartService shoppingCartService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shoppingCartDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ·»åŠ è´­ç‰©è½¦&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> ShoppingCartDTO shoppingCartDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ·»åŠ è´­ç‰©è½¦ï¼Œå•†å“ä¿¡æ¯ä¸ºï¼š&#123;&#125;&quot;</span>,shoppingCartDTO);</span><br><span class="line"></span><br><span class="line">        shoppingCartService.addShoppingCart(shoppingCartDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceæ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.ShoppingCartDTO;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shoppingCartDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addShoppingCart</span><span class="params">(ShoppingCartDTO shoppingCartDTO)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealMapper setmealMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shoppingCartDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addShoppingCart</span><span class="params">(ShoppingCartDTO shoppingCartDTO)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰åŠ å…¥åˆ°è´­ç‰©è½¦ä¸­çš„å•†å“æ˜¯å¦å·²ç»å­˜åœ¨äº†</span></span><br><span class="line">        <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line">        BeanUtils.copyProperties(shoppingCartDTO, shoppingCart);</span><br><span class="line">        <span class="type">Long</span> <span class="variable">currentId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        shoppingCart.setUserId(currentId);</span><br><span class="line"></span><br><span class="line">        List&lt;ShoppingCart&gt; list = shoppingCartMapper.list(shoppingCart);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœå·²ç»å­˜åœ¨äº†ï¼Œåªéœ€è¦å°†æ•°é‡åŠ ä¸€</span></span><br><span class="line">        <span class="comment">//è¦ä¹ˆæŸ¥ä¸åˆ°ï¼Œè¦ä¹ˆå¯¹äºåŒä¸€ç”¨æˆ·çš„çš„åŒä¸€å•†å“çš„åŒä¸€å£å‘³ï¼Œåªæœ‰å¯èƒ½è·å¾—ä¸€æ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (list != <span class="literal">null</span> &amp;&amp; list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">ShoppingCart</span> <span class="variable">cart</span> <span class="operator">=</span> list.get(<span class="number">0</span>);  <span class="comment">//æŸ¥åˆ°æ•°æ®</span></span><br><span class="line">            cart.setNumber(cart.getNumber() + <span class="number">1</span>); <span class="comment">//update shopping_car set number = ? and id = ?</span></span><br><span class="line">            shoppingCartMapper.updateNumberById(cart);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸å­˜åœ¨ï¼Œéœ€è¦æ’å…¥ä¸€æ¡è´­ç‰©è½¦æ•°æ®</span></span><br><span class="line">            <span class="comment">//åˆ¤æ–­æœ¬æ¬¡æ·»åŠ åˆ°è´­ç‰©è½¦çš„æ˜¯èœå“è¿˜æ˜¯å¥—é¤</span></span><br><span class="line">            <span class="type">Long</span> <span class="variable">dishId</span> <span class="operator">=</span> shoppingCartDTO.getDishId();</span><br><span class="line">            <span class="type">Long</span> <span class="variable">setmealId</span> <span class="operator">=</span> shoppingCartDTO.getSetmealId();</span><br><span class="line">            <span class="keyword">if</span> (dishId != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">//æœ¬æ¬¡æ·»åŠ åˆ°è´­ç‰©è½¦çš„æ˜¯èœå“</span></span><br><span class="line">                <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishMapper.getById(dishId);</span><br><span class="line">                shoppingCart.setName(dish.getName());</span><br><span class="line">                shoppingCart.setImage(dish.getImage());</span><br><span class="line">                shoppingCart.setAmount(dish.getPrice());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//æœ¬æ¬¡æ·»åŠ åˆ°è´­ç‰©è½¦çš„æ˜¯å¥—é¤</span></span><br><span class="line">                <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> setmealMapper.getById(setmealId);</span><br><span class="line">                shoppingCart.setName(setmeal.getName());</span><br><span class="line">                shoppingCart.setImage(setmeal.getImage());</span><br><span class="line">                shoppingCart.setAmount(setmeal.getPrice());</span><br><span class="line">            &#125;</span><br><span class="line">            shoppingCart.setNumber(<span class="number">1</span>);</span><br><span class="line">            shoppingCart.setCreateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">            shoppingCartMapper.insert(shoppingCart);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.ShoppingCart;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartMapper</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ¨æ€æ¡ä»¶æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shoppingCart</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;ShoppingCart&gt; <span class="title function_">list</span><span class="params">(ShoppingCart shoppingCart)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update shopping_cart set number = #&#123;number&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateNumberById</span><span class="params">(ShoppingCart shoppingCart)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥è´­ç‰©è½¦æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> shoppingCart</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into shopping_cart (name, image, user_id, dish_id, setmeal_id, dish_flavor, amount, create_time) &quot; +</span></span><br><span class="line"><span class="meta">        &quot;values (#&#123;name&#125;,#&#123;userId&#125;,#&#123;dishId&#125;,#&#123;setmealId&#125;,#&#123;dishFlavor&#125;,#&#123;amount&#125;,#&#123;createTime&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(ShoppingCart shoppingCart)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.ShoppingCartMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sky.entity.ShoppingCart&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.sky.entity.ShoppingCart&quot;</span>&gt;</span></span><br><span class="line">        select * from shopping_cart</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userId != null&quot;</span>&gt;</span>user_id = #&#123;userId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;setmealId != null&quot;</span>&gt;</span>setmeal_id = #&#123;setmealId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishId != null&quot;</span>&gt;</span>dish_id = #&#123;dishId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishFlavor != null&quot;</span>&gt;</span>dish_flavor = #&#123;dishFlavor&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>æ­£å¸¸æµ‹è¯•å³å¯ã€‚</p>
<h1 id="æŸ¥çœ‹è´­ç‰©è½¦"><a href="#æŸ¥çœ‹è´­ç‰©è½¦" class="headerlink" title="æŸ¥çœ‹è´­ç‰©è½¦"></a>æŸ¥çœ‹è´­ç‰©è½¦</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301151804526.png" alt="image-20240301151804526"></p>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li>è¯·æ±‚æ–¹å¼ï¼šGETæ–¹å¼</li>
<li>è¯·æ±‚è·¯å¾„ï¼š&#x2F;user&#x2F;shoppingCart&#x2F;list</li>
<li>è¯·æ±‚å‚æ•°ï¼šæ— </li>
</ul>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301153218027.png" alt="image-20240301153218027"></p>
<h2 id="ä»£ç å¼€å‘-3"><a href="#ä»£ç å¼€å‘-3" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ShoppingCartControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥çœ‹è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥çœ‹è´­ç‰©è½¦&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;ShoppingCart&gt;&gt; <span class="title function_">list</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;ShoppingCart&gt; list = shoppingCartService.showShoppingCart();</span><br><span class="line">    <span class="keyword">return</span> Result.success(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥çœ‹è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">List&lt;ShoppingCart&gt; <span class="title function_">showShoppingCart</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealMapper setmealMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥çœ‹è´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;ShoppingCart&gt; <span class="title function_">showShoppingCart</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line"></span><br><span class="line">        <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> ShoppingCart.builder()</span><br><span class="line">            .userId(userId)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        List&lt;ShoppingCart&gt; list = shoppingCartMapper.list(shoppingCart);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.ShoppingCartMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sky.entity.ShoppingCart&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.sky.entity.ShoppingCart&quot;</span>&gt;</span></span><br><span class="line">        select * from shopping_cart</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userId != null&quot;</span>&gt;</span>user_id = #&#123;userId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;setmealId != null&quot;</span>&gt;</span>and setmeal_id = #&#123;setmealId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishId != null&quot;</span>&gt;</span>and dish_id = #&#123;dishId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishFlavor != null&quot;</span>&gt;</span>and dish_flavor = #&#123;dishFlavor&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-3"><a href="#åŠŸèƒ½æµ‹è¯•-3" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301154323794.png" alt="image-20240301154323794"></p>
<h1 id="æ¸…ç©ºè´­ç‰©è½¦"><a href="#æ¸…ç©ºè´­ç‰©è½¦" class="headerlink" title="æ¸…ç©ºè´­ç‰©è½¦"></a>æ¸…ç©ºè´­ç‰©è½¦</h1><h2 id="éœ€æ±‚åˆ†æä¸è®¾è®¡"><a href="#éœ€æ±‚åˆ†æä¸è®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æä¸è®¾è®¡"></a>éœ€æ±‚åˆ†æä¸è®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301154620724.png" alt="image-20240301154620724"></p>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li><p>è¯·æ±‚æ–¹å¼ï¼šDELETE</p>
</li>
<li><p>è¯·æ±‚è·¯å¾„ï¼š&#x2F;user&#x2F;shoppingCart&#x2F;clean</p>
</li>
<li><p>è¯·æ±‚å‚æ•°ï¼šæ— </p>
</li>
<li><p>è¿”å›ç»“æœï¼šResult.sucess()</p>
</li>
</ul>
<p>æŠŠå½“å‰ç”¨æˆ·æ‰€æœ‰è´­ç‰©è½¦æ•°æ®åˆ é™¤å³å¯ã€‚</p>
<p><img src="/2024/02/29/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day07-%E7%BC%93%E5%AD%98%E5%95%86%E5%93%81%E3%80%81%E8%B4%AD%E7%89%A9%E8%BD%A6/image-20240301154809669.png" alt="image-20240301154809669"></p>
<h2 id="ä»£ç å¼€å‘-4"><a href="#ä»£ç å¼€å‘-4" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ShoppingCartControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/shoppingCart&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;Cç«¯-è´­ç‰©è½¦ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartService shoppingCartService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¸…ç©ºè´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/clean&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ¸…ç©ºè´­ç‰©è½¦&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">clean</span><span class="params">()</span>&#123;</span><br><span class="line">        shoppingCartService.cleanShoppingCart();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.ShoppingCartDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.ShoppingCart;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¸…ç©ºè´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">cleanShoppingCart</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealMapper setmealMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¸…ç©ºè´­ç‰©è½¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cleanShoppingCart</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line"></span><br><span class="line">        shoppingCartMapper.deleteByUserId(userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®UserIdåˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from shopping_cart where user_id = #&#123;userId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteByUserId</span><span class="params">(Long userId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åŠŸèƒ½æµ‹è¯•-4"><a href="#åŠŸèƒ½æµ‹è¯•-4" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>å·²æµ‹è¯•</p>
<h1 id="ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“"><a href="#ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“" class="headerlink" title="ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“"></a>ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“</h1><p><strong>ShoppingCartController</strong>ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/sub&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;ä»è´­ç‰©è½¦ä¸­å‡å»æŸä¸ªå•†å“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">sub</span><span class="params">(<span class="meta">@RequestBody</span> ShoppingCartDTO shoppingCartDTO)</span>&#123;</span><br><span class="line">    shoppingCartService.subShoppingCart(shoppingCartDTO);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartService</span>  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">subShoppingCart</span><span class="params">(ShoppingCartDTO shoppingCartDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShoppingCartServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">ShoppingCartService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ShoppingCartMapper shoppingCartMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealMapper setmealMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">subShoppingCart</span><span class="params">(ShoppingCartDTO shoppingCartDTO)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line">        <span class="type">ShoppingCart</span> <span class="variable">shoppingCart</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShoppingCart</span>();</span><br><span class="line">        BeanUtils.copyProperties(shoppingCartDTO,shoppingCart);</span><br><span class="line">        shoppingCart.setUserId(userId);</span><br><span class="line"></span><br><span class="line">        List&lt;ShoppingCart&gt; list = shoppingCartMapper.list(shoppingCart);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœå·²ç»å­˜åœ¨äº†ï¼Œåªéœ€è¦å°†æ•°é‡åŠ ä¸€</span></span><br><span class="line">        <span class="comment">//è¦ä¹ˆæŸ¥ä¸åˆ°ï¼Œè¦ä¹ˆå¯¹äºåŒä¸€ç”¨æˆ·çš„çš„åŒä¸€å•†å“çš„åŒä¸€å£å‘³ï¼Œåªæœ‰å¯èƒ½è·å¾—ä¸€æ¡æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (list != <span class="literal">null</span> &amp;&amp; list.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">ShoppingCart</span> <span class="variable">cart</span> <span class="operator">=</span> list.get(<span class="number">0</span>);  <span class="comment">//æŸ¥åˆ°æ•°æ®</span></span><br><span class="line">            <span class="keyword">if</span> (cart.getNumber() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                cart.setNumber(cart.getNumber() - <span class="number">1</span>); <span class="comment">//update shopping_car set number = ? and id = ?</span></span><br><span class="line">                shoppingCartMapper.updateNumberById(cart);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                shoppingCartMapper.delByUserInfo(cart);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ShoppingCartMapper</span> &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delByUserInfo</span><span class="params">(ShoppingCart cart)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ShoppingCartMapper.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.ShoppingCartMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;delByUserInfo&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.sky.entity.ShoppingCart&quot;</span>&gt;</span></span><br><span class="line">        delete from shopping_cart</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;userId != null&quot;</span>&gt;</span>user_id = #&#123;userId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;setmealId != null&quot;</span>&gt;</span>and setmeal_id = #&#123;setmealId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishId != null&quot;</span>&gt;</span>and dish_id = #&#123;dishId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;dishFlavor != null&quot;</span>&gt;</span>and dish_flavor = #&#123;dishFlavor&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day06-å¾®ä¿¡ç™»å½•ã€å•†å“æµè§ˆ</title>
    <url>/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/</url>
    <content><![CDATA[<h1 id="å¾®ä¿¡ç™»å½•ã€å•†å“æµè§ˆ"><a href="#å¾®ä¿¡ç™»å½•ã€å•†å“æµè§ˆ" class="headerlink" title="å¾®ä¿¡ç™»å½•ã€å•†å“æµè§ˆ"></a>å¾®ä¿¡ç™»å½•ã€å•†å“æµè§ˆ</h1><p>ä»ä½¿ç”¨è€…è§’åº¦æ¥çœ‹ï¼Œåˆ†ä¸ºä¸¤ä¸ªç«¯ï¼Œä¸€ä¸ªæ˜¯æä¾›ç»™å•†å®¶æ¥ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç®¡ç†ç«¯ï¼Œè¿˜æœ‰ä¸€ä¸ªæ˜¯ç»™ç‚¹é¤ç”¨æˆ·ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç”¨æˆ·ç«¯ã€‚ç”¨æˆ·ç«¯å®é™…ä¸Šæ˜¯é€šè¿‡å¾®ä¿¡å°ç¨‹åºæ¥å®ç°ã€‚æˆ‘ä»¬ä»Šå¤©è¦å¼€å‘çš„æ˜¯ç”¨æˆ·ç«¯çš„ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯å¾®ä¿¡ç™»å½•ï¼Œå¦ä¸€ä¸ªæ˜¯å•†å“æµè§ˆã€‚</p>
<p><strong>å®ç°æ•ˆæœ</strong></p>
<p>å½“ç‚¹é¤ç”¨æˆ·è¿›å…¥å°ç¨‹åºä¹‹åï¼Œå°ç¨‹åºä¼šå¼¹å‡ºè¿™ä¸ªçª—å£ï¼Œå³è·å–å½“å‰å¾®ä¿¡ç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒï¼Œç„¶åç”¨æˆ·æ—¢å¯ä»¥ç‚¹å‡»å…è®¸ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è·å–ç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯ï¼Œå®Œæˆç™»å½•ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227153826569.png" alt="image-20240227153826569"></p>
<p>ç™»å½•æˆåŠŸä¹‹åå°±ä¼šè¿›å…¥é¦–é¡µé¢ï¼Œé¦–é¡µé¢ä¼šå±•ç¤ºå¯¹åº”çš„å•†å“ï¼Œå•†å“åªæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯èœå“ã€ä¸€ç§æ˜¯å¥—é¤ã€‚å®ƒæ˜¯æŒ‰ç…§ä¸åŒçš„åˆ†ç±»æ¥å±•ç¤ºçš„ï¼Œä¸åŒçš„åˆ†ç±»ä¸‹é¢æŒ‚ç€ç›¸åº”çš„èœå“æˆ–å¥—é¤ï¼Œæˆ‘ä»¬è¿™è¾¹åˆ†åˆ«å±•ç¤ºå¥—é¤å’Œèœå“çš„ç›¸åº”ç»“æœã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227153911199.png" alt="image-20240227153911199"></p>
<p>æˆ‘ä»¬ä»Šå¤©è¦å®Œæˆçš„æ˜¯å®¢æˆ·ç«¯çš„å¾®ä¿¡ç™»å½•å’Œå•†å“æµè§ˆåŠŸèƒ½ã€‚</p>
<h1 id="HttpClient"><a href="#HttpClient" class="headerlink" title="HttpClient"></a>HttpClient</h1><p>ä½¿ç”¨å®ƒå°±å¯ä»¥åœ¨Javaä¸­æ„é€ è¯·æ±‚å¹¶å‘é€è¯·æ±‚ï¼Œåé¢è¦å®ç°å¾®ä¿¡ç™»å½•ï¼Œåœ¨å®ç°åŠŸèƒ½æ—¶ä¼šä½¿ç”¨HttpClientæ¥è¯·æ±‚å¾®ä¿¡çš„æŸä¸ªæ¥å£ï¼Œæœ€ç»ˆå®ç°å¾®ä¿¡ç™»å½•ã€‚</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>HttpClientæ—¶Apache Jakarta Commonä¸‹çš„å­é¡¹ç›®ï¼Œå¯ä»¥ç”¨æ¥æä¾›é«˜æ•ˆçš„ã€æœ€æ–°çš„ã€åŠŸèƒ½ä¸°å¯Œçš„æ”¯æŒHTTPåè®®çš„å®¢æˆ·ç«¯ç¼–ç¨‹å·¥å…·åŒ…ï¼Œå¹¶ä¸”å®ƒæ”¯æŒHTTPåè®®æœ€æ–°çš„ç‰ˆæœ¬å’Œå»ºè®®ã€‚</p>
<ul>
<li><p>HttpClientæ—¶å®¢æˆ·ç«¯ç¼–ç¨‹å·¥å…·åŒ…</p>
</li>
<li><p>å¯ä»¥åœ¨Javaç¨‹åºä¸­é€šè¿‡HttpClientå·¥å…·åŒ…æ„å»ºHttpè¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥å‘é€HttpClientè¯·æ±‚</p>
</li>
<li><p>å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªä¾èµ–çš„è¯ï¼Œè¦æ·»åŠ å¦‚ä¸‹çš„ä¾èµ–åæ ‡</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>æ ¸å¿ƒAPIï¼š</p>
<ul>
<li>HttpClientï¼ˆæ¥å£ï¼Œè®¾è®¡äº†å¯ä»¥å‘é€httpè¯·æ±‚çš„æ–¹æ³•ï¼‰</li>
<li>HttpClientsï¼ˆå¯ä»¥åˆ›å»ºHttpClientå®ç°ç±»å¯¹è±¡ï¼‰</li>
<li>CloseableHttpClientï¼ˆå®ç°ç±»ï¼Œå®ç°äº†HttpClientæ¥å£çš„æ–¹æ³•ï¼‰</li>
<li>HttpGetï¼ˆHttp Getè¯·æ±‚ï¼‰</li>
<li>HttpPostï¼ˆHttp Postè¯·æ±‚ï¼‰</li>
</ul>
<p>å‘é€è¯·æ±‚æ­¥éª¤ï¼š</p>
<ul>
<li><p>åˆ›å»ºHttpClientå¯¹è±¡</p>
</li>
<li><p>åˆ›å»ºHttpè¯·æ±‚å¯¹è±¡ï¼ˆå¦‚æœè¦å‘é€getæ–¹å¼è¯·æ±‚ï¼Œå°±éœ€è¦æ„é€ httpgetå¯¹è±¡ï¼ŒåŒç†ï¼Œå¦‚æœè¦å‘é€postæ–¹å¼è¯·æ±‚ï¼Œå°±éœ€è¦æ„é€ httppostå¯¹è±¡ï¼‰</p>
</li>
<li><p>è°ƒç”¨HttpClientçš„executeæ–¹æ³•å‘é€è¯·æ±‚</p>
</li>
</ul>
<h2 id="å…¥é—¨æ¡ˆä¾‹"><a href="#å…¥é—¨æ¡ˆä¾‹" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>åœ¨sky-commonåŒ…ä¸‹å·²ç»å¯¼å…¥äº†aliyun-sdk-ossåæ ‡ï¼Œå®ƒå…¶å®åº•å±‚ä½¿ç”¨äº†httpclientä¾èµ–ï¼Œå·²ç»å¯¼å…¥äº†å¯¹åº”çš„jaråŒ…ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227155419091.png" alt="image-20240227155419091"></p>
<h2 id="å‘é€GETæ–¹å¼è¯·æ±‚"><a href="#å‘é€GETæ–¹å¼è¯·æ±‚" class="headerlink" title="å‘é€GETæ–¹å¼è¯·æ±‚"></a>å‘é€GETæ–¹å¼è¯·æ±‚</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClients;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.util.EntityUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpClientTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡httpclientå‘é€GETæ–¹å¼çš„è¯·æ±‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGET</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºHttpClientå¯¹è±¡(æ˜¯HttpClientæ¥å£çš„å®ç°ç±»ï¼‰</span></span><br><span class="line">        <span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºHttpè¯·æ±‚å¯¹è±¡(è®¾ç½®è¯·æ±‚urlï¼‰</span></span><br><span class="line">        <span class="type">HttpGet</span> <span class="variable">httpGet</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(<span class="string">&quot;http://localhost:8080/user/shop/status&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€è¯·æ±‚,æ¥æ”¶å“åº”ç»“æœ</span></span><br><span class="line">        <span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> httpClient.execute(httpGet);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æœåŠ¡ç«¯è¿”å›çš„çŠ¶æ€ç </span></span><br><span class="line">        <span class="type">int</span> <span class="variable">statusCode</span> <span class="operator">=</span> response.getStatusLine().getStatusCode();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯è¿”å›çš„çŠ¶æ€ç ä¸ºï¼š&quot;</span> + statusCode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–å“åº”ä½“(å®ƒæ˜¯HttpEntityç±»ï¼‰</span></span><br><span class="line">        <span class="type">HttpEntity</span> <span class="variable">entity</span> <span class="operator">=</span> response.getEntity();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç”¨EntityUtilsè§£æHttpEntityç±»å¯¹è±¡çš„å†…å®¹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> EntityUtils.toString(entity);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ä¸ºï¼š&quot;</span> + body);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        response.close();</span><br><span class="line">        httpClient.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡httpclientå‘é€POSTæ–¹å¼çš„è¯·æ±‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPOST</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227161833300.png" alt="image-20240227161833300"></p>
<h2 id="å‘é€POSTæ–¹å¼è¯·æ±‚"><a href="#å‘é€POSTæ–¹å¼è¯·æ±‚" class="headerlink" title="å‘é€POSTæ–¹å¼è¯·æ±‚"></a>å‘é€POSTæ–¹å¼è¯·æ±‚</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpPost;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.entity.StringEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClients;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.util.EntityUtils;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONException;</span><br><span class="line"><span class="keyword">import</span> org.json.JSONObject;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpClientTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡httpclinetå‘é€POSTæ–¹å¼çš„è¯·æ±‚,POSTè¦æäº¤JSONæ ¼å¼çš„æ•°æ®ï¼ŒåŒ…å«ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPOST</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºhttpclientå¯¹è±¡</span></span><br><span class="line">        <span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºè¯·æ±‚å¯¹è±¡</span></span><br><span class="line">        <span class="type">HttpPost</span> <span class="variable">httpPost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(<span class="string">&quot;http://localhost:8080/admin/employee/login&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºJSONå¯¹è±¡ï¼Œå¯¹åº”è¯·æ±‚ä½“ï¼Œè¯·æ±‚ä½“ä¸­å­˜å‚¨å¯¹åº”çš„é”®å€¼å¯¹</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        jsonObject.put(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        jsonObject.put(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">StringEntity</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringEntity</span>(jsonObject.toString());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®è¯·æ±‚å‚æ•°</span></span><br><span class="line">        entity.setContentEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®è¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼</span></span><br><span class="line">        entity.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        <span class="comment">//å°†è¯·æ±‚ä½“æ•°æ®entityæ”¾åˆ°httpPostä¸­</span></span><br><span class="line">        httpPost.setEntity(entity);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€è¯·æ±‚</span></span><br><span class="line">        <span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> httpClient.execute(httpPost);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è§£æè¿”å›ç»“æœ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">statusCode</span> <span class="operator">=</span> response.getStatusLine().getStatusCode();</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯è¿”å›çš„çŠ¶æ€ç ä¸º: &quot;</span> + statusCode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–å“åº”ä½“ï¼ˆå®ƒæ˜¯httpEntityç±»å¯¹è±¡ï¼‰</span></span><br><span class="line">        <span class="type">HttpEntity</span> <span class="variable">entity1</span> <span class="operator">=</span> response.getEntity();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç”¨EntityUtilsè§£æHttpEntityç±»å¯¹è±¡çš„å†…å®¹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> EntityUtils.toString(entity1);</span><br><span class="line">        System.out.println(<span class="string">&quot;æœåŠ¡ç«¯è¿”å›çš„æ•°æ®ä¸ºï¼š&quot;</span> + body);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…³é—­èµ„æº</span></span><br><span class="line">        response.close();</span><br><span class="line">        httpClient.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227165020563.png" alt="image-20240227165020563"></p>
<p>ä¸ºäº†æ–¹ä¾¿åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®sky-commonä¸­å°è£…äº†HttpClientUtilå·¥å…·ç±»ï¼Œé‡Œé¢æœ‰doGetæ–¹æ³•ï¼ŒdoPostæ–¹æ³•ï¼ŒdoPost4Jsonæ–¹æ³•ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227165701177.png" alt="image-20240227165701177"></p>
<h1 id="å¾®ä¿¡å°ç¨‹åºå¼€å‘"><a href="#å¾®ä¿¡å°ç¨‹åºå¼€å‘" class="headerlink" title="å¾®ä¿¡å°ç¨‹åºå¼€å‘"></a>å¾®ä¿¡å°ç¨‹åºå¼€å‘</h1><p>ç”¨æˆ·ç«¯æ—¶åŸºäºå¾®ä¿¡å°ç¨‹åºå¼€å‘çš„ï¼Œè®²ä¸€ä¸‹å®ƒçš„å®Œæ•´å¼€å‘æµç¨‹ã€‚</p>
<h2 id="ä»‹ç»-1"><a href="#ä»‹ç»-1" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227170358065.png" alt="image-20240227170358065"></p>
<p><a href="https://mp.weixin.qq.com/cgi-bin/wx?token=&lang=zh_CN">https://mp.weixin.qq.com/cgi-bin/wx?token=&amp;lang=zh_CN</a></p>
<p><strong>å¼€æ”¾æ³¨å†ŒèŒƒå›´</strong></p>
<p><font color="red"><strong>ä¸ªäººæ˜¯æ²¡æœ‰æƒé™å¼€é€šæ”¯ä»˜åŠŸèƒ½çš„</strong></font></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227170636131.png" alt="image-20240227170636131"></p>
<p><strong>å¼€å‘æ”¯æŒ</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227170717321.png" alt="image-20240227170717321"></p>
<p><strong>ä»‹ç»</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240227170758028.png" alt="image-20240227170758028"></p>
<h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><h3 id="æ³¨å†Œå°ç¨‹åº"><a href="#æ³¨å†Œå°ç¨‹åº" class="headerlink" title="æ³¨å†Œå°ç¨‹åº"></a>æ³¨å†Œå°ç¨‹åº</h3><p>æ³¨å†Œåœ°å€ï¼š<a href="https://mp.weixin.qq.com/wxopen/waregister?action=step1">https://mp.weixin.qq.com/wxopen/waregister?action=step1</a></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228114809590.png" alt="image-20240228114809590"></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228115457266.png" alt="image-20240228115457266"></p>
<h3 id="å®Œå–„å°ç¨‹åºä¿¡æ¯"><a href="#å®Œå–„å°ç¨‹åºä¿¡æ¯" class="headerlink" title="å®Œå–„å°ç¨‹åºä¿¡æ¯"></a>å®Œå–„å°ç¨‹åºä¿¡æ¯</h3><p><font color="red">å®Œå–„å°ç¨‹åºä¿¡æ¯ã€å°ç¨‹åºç±»ç›®</font></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228115852988.png" alt="image-20240228115852988"></p>
<p>è·å–APPIDå’ŒAppSecret </p>
<p>ï¼ˆappIDï¼šwx1d1f9482fef7f19eï¼‰</p>
<p>ï¼ˆå¯†é’¥ï¼šxxxï¼‰</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228120100017.png" alt="image-20240228120100017"></p>
<h3 id="ä¸‹è½½å¼€å‘è€…å·¥å…·"><a href="#ä¸‹è½½å¼€å‘è€…å·¥å…·" class="headerlink" title="ä¸‹è½½å¼€å‘è€…å·¥å…·"></a>ä¸‹è½½å¼€å‘è€…å·¥å…·</h3><p>ä¸‹è½½åœ°å€ï¼š <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html">https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html</a></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228120158680.png" alt="image-20240228120158680"></p>
<p>ä¸‹è½½å¹¶å®‰è£…å¼€å‘è€…å·¥å…·</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228120734805.png" alt="image-20240228120734805"></p>
<p><strong>å¼€å‘ç•Œé¢ä»‹ç»</strong></p>
<p><strong>å·¦ä¾§-æ¨¡æ‹Ÿå™¨ï¼Œæœ€ç»ˆåœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºçš„æ•ˆæœ</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228120947976.png" alt="image-20240228120947976"></p>
<p><strong>å³ä¾§-è°ƒè¯•å™¨ï¼Œè°ƒè¯•å°ç¨‹åºï¼Œå°ç¨‹åºå‘é€äº†ä½•ç§è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å“åº”å›æ¥çš„æ•°æ®æ˜¯ä»€ä¹ˆï¼Œå®ƒå®é™…ä¸Šè·Ÿæµè§ˆå™¨çš„è°ƒè¯•å·¥å…·æ˜¯ä¸€æ ·çš„ï¼Œå³å®ƒä»¬ç”¨çš„æ˜¯åŒä¸€ä¸ªå†…æ ¸ã€‚</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228121022625.png" alt="image-20240228121022625"></p>
<p><strong>ä¸­é—´-ç¼–è¾‘å™¨ï¼Œä¸»è¦å¯¹ä»£ç è¿›è¡Œç¼–è¾‘æ“ä½œçš„åŒºåŸŸ</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228121250712.png" alt="image-20240228121250712"></p>
<p><strong>è®¾ç½®é€‰æ‹©æ˜¾ç¤ºå“ªäº›ç•Œé¢</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228121430392.png" alt="image-20240228121430392"></p>
<p><font color="red">åœ¨æœ¬åœ°è®¾ç½®ä¸­å‹¾é€‰ä¸æ ¡éªŒåˆæ³•åŸŸåï¼Œæˆ‘ä»¬ç°åœ¨åœ¨å¼€å‘é˜¶æ®µï¼Œå°ç¨‹åºæœ‰å¯èƒ½è¦å‘å‡ºè¯·æ±‚ï¼Œæœ€ç»ˆè¯·æ±‚åˆ°æˆ‘ä»¬æœ¬åœ°åç«¯çš„tomcatæœåŠ¡å™¨ï¼Œå¦‚æœä¸å‹¾é€‰ä¸æ ¡éªŒåˆæ³•åŸŸåï¼Œè¯·æ±‚æ˜¯å‘é€ä¸å‡ºå»çš„ã€‚</font></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228121549279.png" alt="image-20240228121549279"></p>
<h2 id="å…¥é—¨æ¡ˆä¾‹-1"><a href="#å…¥é—¨æ¡ˆä¾‹-1" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹"></a>å…¥é—¨æ¡ˆä¾‹</h2><p>æ“ä½œæ­¥éª¤ï¼š</p>
<ul>
<li><p>äº†è§£å°ç¨‹åºç›®å½•ç»“æ„</p>
</li>
<li><p>ç¼–å†™å°ç¨‹åºä»£ç </p>
</li>
<li><p>ç¼–è¯‘å°ç¨‹åºï¼ˆåœ¨å¼€å‘å·¥å…·æ¨¡æ‹Ÿå™¨ä¸­å¯ä»¥æŸ¥çœ‹æ•ˆæœï¼‰</p>
</li>
</ul>
<h3 id="äº†è§£å°ç¨‹åºç›®å½•ç»“æ„"><a href="#äº†è§£å°ç¨‹åºç›®å½•ç»“æ„" class="headerlink" title="äº†è§£å°ç¨‹åºç›®å½•ç»“æ„"></a>äº†è§£å°ç¨‹åºç›®å½•ç»“æ„</h3><p>å°ç¨‹åºåŒ…å«ä¸€ä¸ªæè¿°æ•´ä½“ç¨‹åºçš„appå’Œå¤šä¸ªæè¿°å„è‡ªé¡µé¢çš„pageã€‚ä¸€ä¸ªå°ç¨‹åºä¸»ä½“éƒ¨åˆ†ç”±ä¸‰ä¸ªæ–‡ä»¶ç»„æˆï¼Œå¿…é¡»æ”¾åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ–‡ä»¶</th>
<th>å¿…éœ€</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>app.js</td>
<td>æ˜¯</td>
<td>å°ç¨‹åºé€»è¾‘</td>
</tr>
<tr>
<td>app.json</td>
<td>æ˜¯</td>
<td>å°ç¨‹åºå…¬å…±é…ç½®</td>
</tr>
<tr>
<td>app.wxss</td>
<td>å¦</td>
<td>å°ç¨‹åºå…¬å…±æ ·å¼è¡¨</td>
</tr>
</tbody></table>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228122652914.png" alt="image-20240228122652914"></p>
<p>ä¸€ä¸ªå°ç¨‹åºå¯èƒ½æœ‰å¤šä¸ªé¡µé¢ï¼Œå•†å“æµè§ˆé¡µé¢ï¼Œè´­ç‰©è½¦é¡µé¢ï¼Œè®¢å•æ”¯ä»˜é¡µé¢ï¼Œå•†å“è¯¦æƒ…é¡µé¢ã€‚è¿™äº›é¡µé¢ä¼šæ”¾åœ¨pagesä¸­ã€‚ä¸€ä¸ªå°ç¨‹åºé¡µé¢ç”±å››ä¸ªæ–‡ä»¶ç»„æˆï¼š</p>
<table>
<thead>
<tr>
<th>æ–‡ä»¶ç±»å‹</th>
<th>å¿…éœ€</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>js</td>
<td>æ˜¯</td>
<td>é¡µé¢é€»è¾‘</td>
</tr>
<tr>
<td>wxml</td>
<td>æ˜¯</td>
<td>é¡µé¢ç»“æ„</td>
</tr>
<tr>
<td>json</td>
<td>å¦</td>
<td>é¡µé¢é…ç½®</td>
</tr>
<tr>
<td>wxss</td>
<td>å¦</td>
<td>é¡µé¢æ ·å¼è¡¨</td>
</tr>
</tbody></table>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228122700305.png" alt="image-20240228122700305"></p>
<h3 id="å†…å®¹è®²è§£"><a href="#å†…å®¹è®²è§£" class="headerlink" title="å†…å®¹è®²è§£"></a>å†…å®¹è®²è§£</h3><p>app.jsonå†…å®¹ä¸­çš„pagesè®¾ç½®äº†å½“å‰é¡µé¢çš„æ–‡ä»¶è·¯å¾„ï¼Œå®é™…ä¸Šæ˜¯page&#x2F;indexç›®å½•ä¸‹çš„index.wxmlæ–‡ä»¶ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228124635317.png" alt="image-20240228124635317"></p>
<p>index.wxmlå°±ç±»ä¼¼äºhtmlï¼Œæ¨¡æ‹Ÿå™¨ä¸­çš„Weixinå­—æ®µæ˜¯ç”±index.wxmlæ¥å†³å®šçš„ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228125651655.png" alt="image-20240228125651655"></p>
<p>åœ¨æ¨¡æ‹Ÿå™¨ä¸­åŠ¨æ€è®¾ç½®æ˜¾ç¤ºçš„å€¼ï¼Œç°åœ¨index.wxmlä¸­ç¼–å†™å¯¹åº”çš„å˜é‡ï¼Œå†åœ¨index.jsä¸­è®¾ç½®dataï¼Œç¼–å†™é”®å€¼å¯¹msgè®¾ç½®å¯¹åº”çš„å€¼ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228125909677.png" alt="image-20240228125909677"></p>
<p>åœ¨index.wxmlä¸­åˆ›å»ºè·å–ç”¨æˆ·ä¿¡æ¯æŒ‰é’®ï¼Œç»™æŒ‰é’®è®¾ç½®æ˜¾ç¤ºæ ·å¼bind:tagï¼ŒæŒ‚é æ–¹æ³•getUserInfoï¼Œåœ¨index.jsä¸­è®¾ç½®å¯¹åº”çš„æ–¹æ³•å®ç°ã€‚</p>
<p>æ–¹æ³•çš„å…·ä½“å®ç°ç»†èŠ‚å¦‚ä¸‹ï¼šä½¿ç”¨å¾®ä¿¡å°ç¨‹åºå†…ç½®å¯¹è±¡wxï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„getUserProfileæ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ—¶ä¼šåœ¨æ¨¡æ‹Ÿå™¨ä¸­å¼¹å‡ºè·å–æ˜µç§°ã€å¤´åƒç­‰é¡µé¢ä¿¡æ¯ï¼Œè¯¥æ–¹æ³•ä¼šè·å–å½“å‰å¾®ä¿¡ç”¨æˆ·çš„ä¿¡æ¯ã€‚successå±æ€§å¯¹åº”ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç±»ä¼¼äºlambdaè¡¨è¾¾å¼ï¼Œresæ˜¯è¿”å›å€¼ï¼Œé€šè¿‡consoleåœ¨æ§åˆ¶å°è¾“å‡ºè¿”å›å€¼ä¸­åŒ…å«çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<p><font color="red">æ³¨ï¼šå¾®ä¿¡ç‰ˆæœ¬æ›´æ–°ä¹‹åï¼Œè¿™ä¸ªå°ç¨‹åºä¼šä¸å¼¹æ¡†ï¼Œè¦ä¿®æ”¹åŸºç¡€åº“ï¼Œåœ¨å³ä¸Šè§’ è¯¦ç»†-&gt;æœ¬åœ°è®¾ç½®-&gt;è°ƒè¯•åŸºç¡€åº“ å»ºè®®é€‰æ‹©åŸºç¡€åº“ç‰ˆæœ¬åœ¨2.21.2~2.27.0ç‰ˆæœ¬ä¹‹é—´å¤´åƒï¼Œæ˜µç§°éƒ½èƒ½è·å–ã€‚</font></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228131640243.png" alt="image-20240228131640243"></p>
<h3 id="è·å–ç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒ"><a href="#è·å–ç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒ" class="headerlink" title="è·å–ç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒ"></a><strong>è·å–ç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒ</strong></h3><p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228133125216.png" alt="image-20240228133125216"></p>
<p>ä¸Šè¿°çš„åŠŸèƒ½å¹¶ä¸æ˜¯å¾®ä¿¡ç™»å½•ï¼Œå¾®ä¿¡ç™»å½•è¦è·å–å½“å‰å¾®ä¿¡ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œå³openidï¼Œè¦è·å–openidï¼Œå°±éœ€è¦å¾®ä¿¡å°ç¨‹åºé¦–å…ˆè·å¾—æˆæƒç ï¼ˆç”¨æˆ·æˆæƒç»™æˆ‘ä»¬ï¼‰ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨è·å¾—çš„æˆæƒç å‘å¾®ä¿¡æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œæœ€ç»ˆè·å–åˆ°å½“å‰å¾®ä¿¡ç”¨æˆ·çš„openIdã€‚</p>
<p>ä¸‹é¢æ¼”ç¤ºå¦‚ä½•è·å–å¾®ä¿¡ç”¨æˆ·çš„æˆæƒç ï¼ˆåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œç”¨æˆ·æ¯æ¬¡è¿”å›çš„æˆæƒç æ˜¯ä¸åŒçš„ï¼‰ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228134325727.png" alt="image-20240228134325727"></p>
<h3 id="å‘æœåŠ¡å™¨å‘é€GETè¯·æ±‚"><a href="#å‘æœåŠ¡å™¨å‘é€GETè¯·æ±‚" class="headerlink" title="å‘æœåŠ¡å™¨å‘é€GETè¯·æ±‚"></a><strong>å‘æœåŠ¡å™¨å‘é€GETè¯·æ±‚</strong></h3><p>åœ¨index.wxmlä¸­ç¼–å†™å‘é€è¯·æ±‚æŒ‰é’®ï¼ŒæŒ‚è½½wxLoginæ–¹æ³•ï¼Œåœ¨index.jsä¸­å®ç°wxLoginæ–¹æ³•ï¼Œè°ƒç”¨wx.requestæ–¹æ³•ï¼Œè®¾ç½®urlï¼Œè¯·æ±‚æ–¹å¼methodä»¥åŠæˆåŠŸåè·å–çš„å€¼res.dataã€‚åœ¨æ¨¡æ‹Ÿå™¨ä¸­ç‚¹å‡»å‘é€è¯·æ±‚æŒ‰é’®ï¼Œä¼šå‘urlåœ°å€ä»¥methodæ–¹å¼å‘é€è¯·æ±‚ï¼Œè¿”å›çš„å€¼Resultçš„jsonæ•°æ®æ ¼å¼å°è£…åœ¨res.dataä¸­ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228152755836.png" alt="image-20240228152755836"></p>
<h3 id="å‘å¸ƒå°ç¨‹åº"><a href="#å‘å¸ƒå°ç¨‹åº" class="headerlink" title="å‘å¸ƒå°ç¨‹åº"></a>å‘å¸ƒå°ç¨‹åº</h3><p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228153324209.png" alt="image-20240228153324209"></p>
<p>ç›®å‰ä¸Šä¼ çš„ç‰ˆæœ¬æ˜¯å¼€å‘è€…ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨å¾®ä¿¡å°ç¨‹åºç½‘é¡µç«¯æŸ¥è¯¢ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228153502527.png" alt="image-20240228153502527"></p>
<p>ä»–æ˜¯å¼€å‘ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åœ¨å¾®ä¿¡å°ç¨‹åºä¸­æ˜¯æœç´¢ä¸åˆ°è¿™ä¸ªå°ç¨‹åºçš„ã€‚</p>
<h1 id="å¾®ä¿¡ç™»å½•"><a href="#å¾®ä¿¡ç™»å½•" class="headerlink" title="å¾®ä¿¡ç™»å½•"></a>å¾®ä¿¡ç™»å½•</h1><h2 id="å¯¼å…¥å°ç¨‹åºä»£ç "><a href="#å¯¼å…¥å°ç¨‹åºä»£ç " class="headerlink" title="å¯¼å…¥å°ç¨‹åºä»£ç "></a>å¯¼å…¥å°ç¨‹åºä»£ç </h2><p>å¼€å‘å°ç¨‹åºæœ¬è´¨ä¸Šå±äºå‰ç«¯çš„å¼€å‘ã€‚æœ¬é¡¹ç›®ä¾§é‡åç«¯å¼€å‘ã€‚å¯¹äºå°ç¨‹åºçš„ä»£ç ï¼Œæˆ‘ä»¬å·²ç»æä¾›å¥½äº†ã€‚ç›´æ¥å¯¼å…¥åˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ä½¿ç”¨å³å¯ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228154535876.png" alt="image-20240228154535876"></p>
<p><font color="red">ç¡®ä¿AppIDæ˜¯è‡ªå·±çš„IDã€‚</font></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228154724267.png" alt="image-20240228154724267"></p>
<p><strong>é¡¹ç›®ä»£ç æ•´ä½“ç»“æ„</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228155000326.png" alt="image-20240228155000326"></p>
<p>å¯ä»¥é€šè¿‡vendor.jsä¿®æ”¹å¯¹åº”åç«¯è¯·æ±‚çš„ç«¯å£å·ã€‚</p>
<h2 id="å¾®ä¿¡ç™»å½•æµç¨‹"><a href="#å¾®ä¿¡ç™»å½•æµç¨‹" class="headerlink" title="å¾®ä¿¡ç™»å½•æµç¨‹"></a>å¾®ä¿¡ç™»å½•æµç¨‹</h2><p>å¾®ä¿¡ç™»å½•ï¼š<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html">https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html</a></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228155242039.png" alt="image-20240228155242039"></p>
<ol>
<li>åœ¨å°ç¨‹åºç«¯ï¼Œä½¿ç”¨wx.login()è·å–æˆæƒç ï¼Œå†ä½¿ç”¨wx.request()å‘æœ¬åœ°ç¼–å†™çš„åç«¯æœåŠ¡å‘é€æˆæƒç </li>
<li>åç«¯æœåŠ¡è¦è°ƒç”¨å¾®ä¿¡æ¥å£æœåŠ¡ï¼Œéœ€è¦å‘å¾®ä¿¡æ¥å£ä¼ è¾“ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼Œappidï¼Œappsecretï¼Œcodeã€‚ï¼ˆé€šè¿‡httpclientå®ç°è¯¥åŠŸèƒ½ï¼‰</li>
<li>å¾®ä¿¡æ¥å£æœåŠ¡å‘åç«¯æœåŠ¡è¿”å›ç›¸åº”çš„æ•°æ®ï¼Œå³session_keyå’ŒopenIdï¼ˆå¾®ä¿¡ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼‰ã€‚</li>
<li>åç«¯æœåŠ¡è¦è‡ªå®šä¹‰ç™»å½•çŠ¶æ€ï¼Œè®°å½•å½“å‰å¾®ä¿¡ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯ï¼Œå¦‚openidå­˜åˆ°æ•°æ®åº“ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¸ºå¾®ä¿¡ç”¨æˆ·äº§ç”Ÿä¸€ä¸ªtokenï¼Œå³ä¸€ä¸ªä»¤ç‰Œï¼Œå› ä¸ºåç»­å°ç¨‹åºè¿˜è¦æŒç»­ä¸æ–­çš„è¯·æ±‚åç«¯æœåŠ¡ï¼Œå¦‚æ·»åŠ è´­ç‰©è½¦ï¼Œä¸‹å•ç­‰ï¼Œè¿™ä¸ªæ—¶å€™éƒ½éœ€è¦çŸ¥é“å°ç¨‹åºçš„å¾®ä¿¡ç”¨æˆ·æ˜¯è°ã€‚å› æ­¤ï¼Œåç«¯æœåŠ¡ä¼šå°†ä»¤ç‰Œè¿”å›ç»™å°ç¨‹åºã€‚</li>
<li>å°ç¨‹åºå­˜å‚¨è‡ªå®šä¹‰ç™»å½•çŠ¶æ€ã€‚</li>
<li>åç»­å‘èµ·å„ç§ä¸šåŠ¡è¯·æ±‚ï¼Œå¦‚æ·»åŠ è´­ç‰©è½¦ï¼Œæµè§ˆå•†å“ï¼ŒæŸ¥çœ‹è®¢å•ï¼ŒæŸ¥è¯¢å†å²è®¢å•ï¼Œä¸€ç³»åˆ—çš„ä¸šåŠ¡è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å®ƒå°±è¦å°†è‡ªå®šä¹‰çš„ç™»å½•çŠ¶æ€ç»™ä»–å¸¦è¿‡å»ï¼Œè¯·æ±‚åç«¯æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯å¼€å‘è€…æœåŠ¡å™¨ã€‚</li>
<li>åç«¯æœåŠ¡è¦è§£ætokenï¼Œè§£æå®Œä¹‹åå°±çŸ¥é“å½“å‰å¾®ä¿¡ç”¨æˆ·ï¼Œè¿›è¡Œç›¸åº”ä¸šåŠ¡æ“ä½œï¼Œè¿”å›ä¸šåŠ¡æ•°æ®ã€‚</li>
</ol>
<p>åœ¨postmanä¸­å‘å¾®ä¿¡æ¥å£æœåŠ¡å‘é€è¯·æ±‚ï¼š<a href="https://api.weixin.qq.com/sns/jscode2session?appid=wx1d1f9482fef7f19e&secret=2aaa22b5aeafd21e2d8742d72e99cdd1&js_code=0f1Jgz100T0aER1o1k400rlBAK0Jgz1g&grant_type=authorization_code%EF%BC%8C%E5%BE%AE%E4%BF%A1%E6%8E%A5%E5%8F%A3%E6%9C%8D%E5%8A%A1%E4%BC%9A%E8%BF%94%E5%9B%9E%E5%AF%B9%E5%BA%94%E7%9A%84session_key%E5%92%8Copenid%E3%80%82">https://api.weixin.qq.com/sns/jscode2session?appid=wx1d1f9482fef7f19e&amp;secret=2aaa22b5aeafd21e2d8742d72e99cdd1&amp;js_code=0f1Jgz100T0aER1o1k400rlBAK0Jgz1g&amp;grant_type=authorization_codeï¼Œå¾®ä¿¡æ¥å£æœåŠ¡ä¼šè¿”å›å¯¹åº”çš„session_keyå’Œopenidã€‚</a></p>
<p>å‘é€çš„è¯·æ±‚è¦æ±‚å¡«å†™å››ä¸ªå‚æ•°ï¼Œå…¶ä¸­grant_typeçš„å€¼è¦æ±‚å›ºå®šä¸ºauthorization_codeã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228225958639.png" alt="image-20240228225958639"></p>
<h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228230305932.png" alt="image-20240228230305932"></p>
<p>ç”¨æˆ·åè´¦å·ç™»å½•è¦æ³¨å†Œè´¦å·ï¼Œè®¾ç½®å¯†ç ï¼Œä½¿ç”¨æ³¨å†Œçš„è´¦å·å¯†ç ç™»å½•ã€‚</p>
<p>å¾®ä¿¡ç™»å½•ä¸ç”¨æ³¨å†Œï¼Œç›´æ¥æ¥è·å¾—å¾®ä¿¡ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼ŒçŸ¥é“å½“å‰çš„å¾®ä¿¡ç”¨æˆ·æ˜¯è°å³å¯ã€‚</p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>åŸºäºå¾®ä¿¡ç™»å½•å®ç°å°ç¨‹åºçš„ç™»å½•åŠŸèƒ½</li>
<li><font color="red">å¦‚æœæ˜¯æ–°ç”¨æˆ·éœ€è¦è‡ªåŠ¨å®Œæˆæ³¨å†Œï¼ŒæŠŠç”¨æˆ·è¿”å›çš„ä¿¡æ¯ä¿å­˜åˆ°è‡ªå®šä¹‰çš„æ•°æ®åº“å½“ä¸­ã€‚</font></li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p>è¦å®Œæˆå¾®ä¿¡ç™»å½•ï¼Œè¦è·å¾—openIdï¼›è¦è·å¾—openIdï¼Œå°±è¦å…ˆè·å¾—æˆæƒç codeï¼›æ¥å£åº”è¯¥å°ç¨‹åºå’Œåç«¯å‘é€è¯·æ±‚ï¼Œå¹¶ä¸”æŠŠæˆæƒç å‘è¿‡æ¥ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨æˆæƒç è¯·æ±‚å¾®ä¿¡æ¥å£æœåŠ¡ï¼Œéœ€è¦ç»™ç”¨æˆ·è¿”å›ä»¤ç‰Œï¼Œä»¤ç‰Œä¸­åŒ…å«ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œåç»­ç”¨æˆ·æ“ä½œéƒ½è¦æºå¸¦ä»¤ç‰Œï¼ŒéªŒè¯ä»–æ˜¯åˆæ³•ç”¨æˆ·ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228231445814.png" alt="image-20240228231445814"></p>
<p>æ•°æ®åº“è®¾è®¡ï¼ˆuserè¡¨ï¼‰ï¼š</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228231818854.png" alt="image-20240228231818854"></p>
<p>(ä¸åŒçš„å°ç¨‹åºï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨çš„æƒé™æ˜¯ä¸åŒçš„ï¼Œå¦‚æœæ˜¯ä»¥ä¸ªäººæ³¨å†Œçš„å°ç¨‹åºï¼Œæ²¡æœ‰æƒé™è·å–åˆ°å¾®ä¿¡ç”¨æˆ·æ³¨å†Œçš„æ‰‹æœºå·çš„ï¼Œå¦‚æœæ˜¯ä»¥ä¼ä¸šçš„èµ„è´¨æ³¨å†Œçš„å°ç¨‹åºï¼Œå¯ä»¥æ‹¿åˆ°å¾®ä¿¡ç”¨æˆ·çš„æ‰‹æœºå·)</p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>é…ç½®å¾®ä¿¡ç™»å½•æ‰€éœ€çš„é…ç½®é¡¹ï¼š</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228232754608.png" alt="image-20240228232754608"></p>
<p>é…ç½®ä¸ºå¾®ä¿¡ç”¨æˆ·ç”Ÿæˆjwtä»¤ç‰Œæ—¶ä½¿ç”¨çš„é…ç½®é¡¹ï¼ˆç®¡ç†ç«¯å’Œç”¨æˆ·ç«¯æœ‰ä¸åŒçš„jwtä»¤ç‰Œè§„åˆ™ï¼Œæ³¨æ„token-nameå·²ç»æå‰è·Ÿå‰ç«¯æ²Ÿé€šå¥½äº†ï¼Œå‰ç«¯ä¼šé€šè¿‡è¯·æ±‚å¤´å¸¦è¿‡æ¥tokenï¼Œç„¶åæˆ‘ä»¬æŒ‰ç…§è·å–è¿™ä¸ªå‚æ•°çš„å€¼æ¥æ ¡éªŒå³å¯ï¼‰</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228233039039.png" alt="image-20240228233039039"></p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®äº†å¯¹åº”çš„é…ç½®å±æ€§ç±»ï¼Œç¨‹åºå¯åŠ¨æ—¶ï¼Œ@Componentæ³¨è§£å°†å…¶è‡ªåŠ¨ä½œä¸ºBeanå¯¹è±¡æ³¨å…¥åˆ°IOCå®¹å™¨ä¸­ï¼ŒåŒæ—¶@ConfigurationProperties(prefix&#x3D;â€xxxâ€)ä¼šè®©è¯¥Beanå¯¹è±¡ä»ymlæ–‡ä»¶çš„å¯¹åº”é…ç½®é¡¹ä¸­è·å–å±æ€§å€¼ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240228234536502.png" alt="image-20240228234536502"></p>
<p><strong>UserContrller</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.UserLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.UserService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.UserLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/user&quot;)</span>  <span class="comment">//ç”¨æˆ·ç«¯çš„ç”¨æˆ·æ¨¡å—</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;Cç«¯ç”¨æˆ·ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾®ä¿¡ç™»å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userLoginDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;å¾®ä¿¡ç™»å½•&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;UserLoginVO&gt; <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> UserLoginDTO userLoginDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¾®ä¿¡ç”¨æˆ·ç™»å½•ï¼š&#123;&#125;&quot;</span>,userLoginDTO.getCode());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¾®ä¿¡ç™»å½•</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.wxLogin(userLoginDTO);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;String, Object&gt; claims = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        claims.put(JwtClaimsConstant.USER_ID,user.getId());  <span class="comment">//ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œç”¨æˆ·çš„ä¸»é”®ID</span></span><br><span class="line">        <span class="comment">//ä¸ºå¾®ä¿¡ç”¨æˆ·ç”Ÿæˆjwtä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtUtil.createJWT(jwtProperties.getUserSecretKey(), jwtProperties.getUserTtl(), claims);</span><br><span class="line"></span><br><span class="line">        <span class="type">UserLoginVO</span> <span class="variable">userLoginVO</span> <span class="operator">=</span> UserLoginVO.builder()</span><br><span class="line">            .id(user.getId())</span><br><span class="line">            .openid(user.getOpenid())</span><br><span class="line">            .token(token)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(userLoginVO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserServiceæ¥å£</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.UserLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾®ä¿¡ç™»å½•ï¼Œè¿”å›ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userLoginDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    User <span class="title function_">wxLogin</span><span class="params">(UserLoginDTO userLoginDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.UserLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.LoginFailedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.WeChatProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.UserService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.HttpClientUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WeChatProperties weChatProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¾®ä¿¡æœåŠ¡æ¥å£åœ°å€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String WX_LOGIN=<span class="string">&quot;https://api.weixin.qq.com/sns/jscode2session&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾®ä¿¡ç™»å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userLoginDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">wxLogin</span><span class="params">(UserLoginDTO userLoginDTO)</span> &#123;</span><br><span class="line">        <span class="comment">//ä¼ ç»Ÿçš„ç”¨æˆ·ç™»å½•æ˜¯æ£€æŸ¥è‡ªå·±çš„ç”¨æˆ·è¡¨ï¼Œæ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œç°åœ¨æ˜¯å¾®ä¿¡æœåŠ¡ï¼Œéœ€è¦å…ˆè°ƒç”¨å¾®ä¿¡æœåŠ¡å™¨æ¥å£ï¼Œè·å¾—å½“å‰å¾®ä¿¡ç”¨æˆ·çš„openidã€‚</span></span><br><span class="line">        <span class="comment">//è°ƒç”¨å¾®ä¿¡æ¥å£æœåŠ¡ï¼Œè·å–å½“å‰å¾®ä¿¡ç”¨æˆ·çš„openidã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">openid</span> <span class="operator">=</span> getOpenid(userLoginDTO.getCode());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(openid == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">LoginFailedException</span>(MessageConstant.LOGIN_FAILED);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºæ–°ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.getByOpenId(openid);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœæ˜¯æ–°ç”¨æˆ·ï¼Œè‡ªåŠ¨å®Œæˆæ³¨å†Œ</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>)&#123;</span><br><span class="line">            user = User.builder()</span><br><span class="line">                    .openid(openid)</span><br><span class="line">                    .createTime(LocalDateTime.now())</span><br><span class="line">                    .build();</span><br><span class="line">            userMapper.insert(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å›è¿™ä¸ªç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒç”¨å¾®ä¿¡æ¥å£æœåŠ¡ï¼Œè·å–å¾®ä¿¡ç”¨æˆ·çš„openid</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getOpenid</span><span class="params">(String code)</span>&#123;</span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;appid&quot;</span>,weChatProperties.getAppid());</span><br><span class="line">        map.put(<span class="string">&quot;secret&quot;</span>,weChatProperties.getSecret());</span><br><span class="line">        map.put(<span class="string">&quot;js_code&quot;</span>,code);</span><br><span class="line">        map.put(<span class="string">&quot;grant_type&quot;</span>,<span class="string">&quot;authorization_code&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> HttpClientUtil.doGet(WX_LOGIN, map);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­openidæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œè¡¨ç¤ºç™»å½•å¤±è´¥ï¼ŒæŠ›å‡ºä¸šåŠ¡å¼‚å¸¸</span></span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> JSON.parseObject(json);</span><br><span class="line">        <span class="type">String</span> <span class="variable">openid</span> <span class="operator">=</span> jsonObject.getString(<span class="string">&quot;openid&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> openid;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>UserMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®openidæŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> openid</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from User where openid = #&#123;openId&#125; &quot;)</span></span><br><span class="line">    User <span class="title function_">getByOpenId</span><span class="params">(String openid)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(User user)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>UserMapper.xml</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.sky.mapper.UserMapper&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert id=<span class="string">&quot;insert&quot;</span> useGeneratedKeys=<span class="string">&quot;true&quot;</span> keyProperty=<span class="string">&quot;id&quot;</span>&gt;</span><br><span class="line">        insert into <span class="title function_">user</span> <span class="params">(openid, name, phone, sex, id_number, avatar, create_time)</span> VALUES</span><br><span class="line">                        (#&#123;openid&#125;,#&#123;name&#125;,#&#123;phone&#125;,#&#123;sex&#125;,#&#123;idNumber&#125;,#&#123;avatar&#125;,#&#123;createTime&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229123908275.png" alt="image-20240229123908275"></p>
<p>ç™»å½•æˆåŠŸåï¼Œåç»­æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šåœ¨è¯·æ±‚å¤´ä¸­æŠŠtokenå¸¦è¿‡å»ï¼Œä½†æ˜¯å®ƒçš„è¯·æ±‚å¤´çš„é”®æ˜¯authenticationï¼Œå€¼æ˜¯ç™»å½•æˆåŠŸæ˜¯è¿”å›ç»™å°ç¨‹åºç«¯çš„tokenã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229123949741.png" alt="image-20240229123949741"></p>
<p>æ¥ä¸‹æ¥è¦ç¼–å†™æ‹¦æˆªå™¨æ¥æ ¡éªŒç”¨æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯å°ç¨‹åºç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œæ ¡éªŒå…¶tokenæ˜¯å¦åˆæ³•ã€‚</p>
<p>å¤åˆ¶å®¢æˆ·ç«¯æ‹¦æˆªå™¨ï¼Œä¿®æ”¹éƒ¨åˆ†ä»£ç </p>
<p><strong>JwtTokenUserInterceptor</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.method.HandlerMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jwtä»¤ç‰Œæ ¡éªŒçš„æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtTokenUserInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¡éªŒjwt</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> handler</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰çº¿ç¨‹çš„id:&quot;</span> + Thread.currentThread().getId());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰æ‹¦æˆªåˆ°çš„æ˜¯Controllerçš„æ–¹æ³•è¿˜æ˜¯å…¶ä»–èµ„æº</span></span><br><span class="line">        <span class="keyword">if</span> (!(handler <span class="keyword">instanceof</span> HandlerMethod)) &#123;</span><br><span class="line">            <span class="comment">//å½“å‰æ‹¦æˆªåˆ°çš„ä¸æ˜¯åŠ¨æ€æ–¹æ³•ï¼Œç›´æ¥æ”¾è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1ã€ä»è¯·æ±‚å¤´ä¸­è·å–ä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(jwtProperties.getUserTokenName());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2ã€æ ¡éªŒä»¤ç‰Œ</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;jwtæ ¡éªŒ:&#123;&#125;&quot;</span>, token);</span><br><span class="line">            <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> JwtUtil.parseJWT(jwtProperties.getUserSecretKey(), token);</span><br><span class="line">            <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> Long.valueOf(claims.get(JwtClaimsConstant.USER_ID).toString());</span><br><span class="line">            log.info(<span class="string">&quot;å½“å‰ç”¨æˆ·idï¼š&quot;</span>, userId);</span><br><span class="line">            BaseContext.setCurrentId(userId);</span><br><span class="line">            <span class="comment">//3ã€é€šè¿‡ï¼Œæ”¾è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            <span class="comment">//4ã€ä¸é€šè¿‡ï¼Œå“åº”401çŠ¶æ€ç </span></span><br><span class="line">            response.setStatus(<span class="number">401</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229124703282.png" alt="image-20240229124703282"></p>
<p><strong>æ³¨å†Œæ‹¦æˆªå™¨ï¼Œæ’é™¤ä¸ç”¨çš„éƒ¨åˆ†</strong></p>
<p><strong>WebMvcConfiguration</strong></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229124744445.png" alt="image-20240229124744445"></p>
<h1 id="å¯¼å…¥å•†å“æµè§ˆåŠŸèƒ½ä»£ç "><a href="#å¯¼å…¥å•†å“æµè§ˆåŠŸèƒ½ä»£ç " class="headerlink" title="å¯¼å…¥å•†å“æµè§ˆåŠŸèƒ½ä»£ç "></a>å¯¼å…¥å•†å“æµè§ˆåŠŸèƒ½ä»£ç </h1><p>ä»æŠ€æœ¯å±‚é¢æ¥è¯´ä»ç„¶å±äºCRUDèŒƒå›´ã€‚åˆ†æéœ€æ±‚ï¼Œä½¿ç”¨çš„æ¥å£ã€‚</p>
<h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p>ç”¨æˆ·è¿›å…¥è‹ç©¹å¤–å–å°ç¨‹åºä¹‹å‰è¦å…ˆè¿›è¡Œå¾®ä¿¡ç™»å½•ï¼Œç™»å½•ä¹‹åï¼Œä¼šè¿›å…¥åˆ°ä¸‹é¢è¿™ä¸ªé¡µé¢ã€‚</p>
<p><strong>äº§å“åŸå‹</strong></p>
<p>å·¦ä¾§ï¼šå¥—é¤åˆ†ç±»ã€èœå“åˆ†ç±»ã€‚</p>
<p>å³ä¾§ï¼šèœå“ã€‚èœå“å±•ç¤ºè¿˜æœ‰åŒºåˆ«ï¼Œæœ‰çš„èœå“æœ‰è§„æ ¼é€‰æ‹©ï¼Œæœ‰çš„èœå“æ˜¯+å·ã€‚</p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229125411899.png" alt="image-20240229125411899"></p>
<p><strong>æ¥å£åˆ†æ</strong></p>
<ol>
<li>æŸ¥è¯¢åˆ†ç±»ï¼ˆå·¦ä¾§åˆ†ç±»æ•°æ®è¦æŸ¥è¯¢ï¼Œå¯¹åº”æŸ¥è¯¢åˆ†ç±»çš„æ¥å£ã€‚ï¼‰</li>
<li>æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“ï¼ˆå³ä¾§èœå“è¦æŸ¥ï¼Œæ ¹æ®æŸä¸ªèœå“çš„åˆ†ç±»IDæŸ¥è¯¢å¯¹åº”çš„èœå“ã€‚ï¼‰</li>
<li>æ ¹æ®åˆ†ç±»idæŸ¥è¯¢å¥—é¤ï¼ˆæ ¹æ®åˆ†ç±»IDæŸ¥å¥—é¤çš„æ•°æ®ã€‚ï¼‰</li>
<li>æ ¹æ®å¥—é¤idæŸ¥è¯¢åŒ…å«çš„èœå“ï¼ˆæ ¹æ®å¥—é¤IDæŸ¥è¯¢ä»–å…·ä½“åŒ…å«å“ªäº›èœå“ã€‚ï¼‰</li>
</ol>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229125830802.png" alt="image-20240229125830802"></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229130002753.png" alt="image-20240229130002753"></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229130532936.png" alt="image-20240229130532936"></p>
<p><img src="/2024/02/27/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day06-%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95%E3%80%81%E5%95%86%E5%93%81%E6%B5%8F%E8%A7%88/image-20240229130554697.png" alt="image-20240229130554697"></p>
<h2 id="ä»£ç å¯¼å…¥å’ŒåŠŸèƒ½æµ‹è¯•"><a href="#ä»£ç å¯¼å…¥å’ŒåŠŸèƒ½æµ‹è¯•" class="headerlink" title="ä»£ç å¯¼å…¥å’ŒåŠŸèƒ½æµ‹è¯•"></a>ä»£ç å¯¼å…¥å’ŒåŠŸèƒ½æµ‹è¯•</h2><p>(å·²å®Œæˆ)</p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day05-redis-åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®</title>
    <url>/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/</url>
    <content><![CDATA[<h1 id="åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®"><a href="#åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®" class="headerlink" title="åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®"></a>åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®</h1><p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240224203009689.png" alt="image-20240224203009689"></p>
<h1 id="Rediså…¥é—¨"><a href="#Rediså…¥é—¨" class="headerlink" title="Rediså…¥é—¨"></a>Rediså…¥é—¨</h1><h2 id="Redisç®€ä»‹"><a href="#Redisç®€ä»‹" class="headerlink" title="Redisç®€ä»‹"></a>Redisç®€ä»‹</h2><p>Redisæ˜¯ä¸€ä¸ªåŸºäº<strong>å†…å­˜</strong>çš„key-valueç»“æ„æ•°æ®åº“ã€‚ï¼ˆå†…å­˜å­˜å‚¨ï¼‰</p>
<ul>
<li>åŸºäºå†…å­˜å­˜å‚¨ï¼Œè¯»å†™æ€§èƒ½é«˜</li>
<li>é€‚åˆå­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼ˆçƒ­ç‚¹å•†å“ã€å’¨è¯¢ã€æ–°é—»ï¼‰ï¼ˆçƒ­ç‚¹æ•°æ®ï¼šåœ¨æŸä¸ªç‚¹ä¼šæœ‰å¤§é‡ç”¨æˆ·è®¿é—®è¯¥æ•°æ®ï¼‰</li>
<li>ä¼ä¸šåº”ç”¨å¹¿æ³›</li>
</ul>
<p>å®˜ç½‘ï¼š<a href="https://redis.io/">https://redis.io</a></p>
<p>ä¸­æ–‡ç½‘ï¼š<a href="https://www.redis.net.cn/">https://www.redis.net.cn/</a></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225211637018.png" alt="image-20240225211637018"></p>
<p><strong>Redisä¸mysqlçš„åŒºåˆ«</strong></p>
<ol>
<li>rediså°†æ•°æ®å­˜åˆ°å†…å­˜ä¸­ï¼Œmysqlå°†æ•°æ®å­˜åˆ°ç£ç›˜çš„æ•°æ®æ–‡ä»¶ä¸­ã€‚</li>
<li>redisæ˜¯åŸºäºé”®å€¼å¯¹å­˜å‚¨æ•°æ®ï¼Œmysqlé€šè¿‡äºŒç»´è¡¨çš„å½¢å¼å­˜å‚¨æ•°æ®ã€‚</li>
</ol>
<h2 id="Redisä¸‹è½½ä¸å®‰è£…"><a href="#Redisä¸‹è½½ä¸å®‰è£…" class="headerlink" title="Redisä¸‹è½½ä¸å®‰è£…"></a>Redisä¸‹è½½ä¸å®‰è£…</h2><p>Rediså®‰è£…åŒ…åˆ†ä¸ºWindowsç‰ˆæœ¬å’ŒLinuxç‰ˆæœ¬ï¼š</p>
<ul>
<li>Windowsç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/microsoftarchive/redis/releases">https://github.com/microsoftarchive/redis/releases</a></li>
<li>Linuxç‰ˆä¸‹è½½åœ°å€ï¼š<a href="https://download.redis.io/releases/">https://download.redis.io/releases/</a></li>
</ul>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225211828939.png" alt="image-20240225211828939"></p>
<p>Redisçš„Windowsç‰ˆå±äºç»¿è‰²è½¯ä»¶ï¼Œç›´æ¥è§£å‹å³å¯ä½¿ç”¨ï¼Œè§£å‹åç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225212144784.png" alt="image-20240225212144784"></p>
<h2 id="RedisæœåŠ¡å¯åŠ¨ä¸åœæ­¢"><a href="#RedisæœåŠ¡å¯åŠ¨ä¸åœæ­¢" class="headerlink" title="RedisæœåŠ¡å¯åŠ¨ä¸åœæ­¢"></a>RedisæœåŠ¡å¯åŠ¨ä¸åœæ­¢</h2><p><strong>å¯åŠ¨æœåŠ¡</strong>ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°æ˜¯redis-server.exeï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯redis.windows.confï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-server.exe redis.windows.conf</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225213141902.png" alt="image-20240225213141902"></p>
<p><strong>åœæ­¢æœåŠ¡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctrl + c</span><br></pre></td></tr></table></figure>



<p><strong>é€šè¿‡å®¢æˆ·ç«¯è¿æ¥redisæœåŠ¡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-cls.exe</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225214144982.png" alt="image-20240225214144982"></p>
<p>æµ‹è¯•æ˜¯å¦è¿ä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">keys *</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225214313241.png" alt="image-20240225214313241"></p>
<p>é€€å‡ºredis</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225214412285.png" alt="image-20240225214412285"></p>
<p><strong>æŒ‡å®šè¿æ¥ä¸»æœºåœ°å€å’Œç«¯å£</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redis-cli.exe -h localhost -p 6379</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225214532703.png" alt="image-20240225214532703"></p>
<p>redisé…ç½®æ–‡ä»¶ä¸­é»˜è®¤æ˜¯æ²¡æœ‰é…ç½®å¯†ç çš„ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¸ç”¨å¯†ç å°±å¯ä»¥è¿æ¥ä¸Šè¯¥redisã€‚</p>
<p><strong>é…ç½®redis.windows.confæ–‡ä»¶ï¼Œç»™redisè®¾ç½®å¯†ç ã€‚</strong>ï¼ˆredisä¸­æ²¡æœ‰ç”¨æˆ·åçš„æ¦‚å¿µï¼‰</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225214937198.png" alt="image-20240225214937198"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225215410275.png" alt="image-20240225215410275"></p>
<p>æˆ‘ä»¬åæœŸç»å¸¸ç”¨çš„æ˜¯rediså®¢æˆ·ç«¯å›¾å½¢ç•Œé¢ã€‚</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225215513434.png" alt="image-20240225215513434"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225215559337.png" alt="image-20240225215559337"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225215648190.png" alt="image-20240225215648190"></p>
<p><strong>é€‰æ‹©ç®€ä½“ä¸­æ–‡</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225215828897.png" alt="image-20240225215828897"></p>
<h1 id="Redisæ•°æ®ç±»å‹"><a href="#Redisæ•°æ®ç±»å‹" class="headerlink" title="Redisæ•°æ®ç±»å‹"></a>Redisæ•°æ®ç±»å‹</h1><h2 id="5ç§å¸¸ç”¨æ•°æ®ç±»å‹ä»‹ç»"><a href="#5ç§å¸¸ç”¨æ•°æ®ç±»å‹ä»‹ç»" class="headerlink" title="5ç§å¸¸ç”¨æ•°æ®ç±»å‹ä»‹ç»"></a>5ç§å¸¸ç”¨æ•°æ®ç±»å‹ä»‹ç»</h2><p>Rediså­˜å‚¨çš„æ˜¯key-valueç»“æ„çš„æ•°æ®ï¼Œå…¶ä¸­keyæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œvalueæœ‰5ç§å¸¸ç”¨çš„æ•°æ®ç±»å‹ã€‚</p>
<ul>
<li>å­—ç¬¦ä¸²string</li>
<li>å“ˆå¸Œhash</li>
<li>åˆ—è¡¨list</li>
<li>é›†åˆset</li>
<li>æœ‰åºé›†åˆ sorted set &#x2F; zset</li>
</ul>
<h2 id="å„ç§æ•°æ®ç±»å‹ç‰¹ç‚¹"><a href="#å„ç§æ•°æ®ç±»å‹ç‰¹ç‚¹" class="headerlink" title="å„ç§æ•°æ®ç±»å‹ç‰¹ç‚¹"></a>å„ç§æ•°æ®ç±»å‹ç‰¹ç‚¹</h2><p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225220033296.png" alt="image-20240225220033296"></p>
<ul>
<li>å­—ç¬¦ä¸²ï¼ˆstringï¼‰ï¼šæ™®é€šå­—ç¬¦ä¸²ï¼ŒRedisä¸­æœ€ç®€å•çš„æ•°æ®ç±»å‹</li>
<li>å“ˆå¸Œï¼ˆhashï¼‰ï¼šä¹Ÿå«æ•£åˆ—ï¼Œç±»ä¼¼äºJavaä¸­çš„HashMapç»“æ„ï¼ˆé€‚åˆå­˜å‚¨å¯¹è±¡ï¼Œè¿™ä¸ªå€¼ä¹Ÿå¯ä»¥çœ‹æˆé”®å€¼å¯¹ï¼‰</li>
<li>åˆ—è¡¨ï¼ˆlistï¼‰ï¼šæŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œå¯ä»¥æœ‰é‡å¤å…ƒç´ ï¼Œç±»ä¼¼äºJavaä¸­çš„LinkedListï¼ˆæœ‹å‹åœˆç‚¹èµçš„æ•°æ®å¯ä»¥ä½¿ç”¨åˆ—è¡¨å­˜å‚¨ï¼‰</li>
<li>é›†åˆï¼ˆsetï¼‰ï¼šæ— åºé›†åˆï¼Œæ²¡æœ‰é‡å¤å…ƒç´ ï¼Œç±»ä¼¼äºJavaä¸­çš„HashSetï¼Œé›†åˆæ˜¯å¯ä»¥åšè¿ç®—çš„ã€‚ï¼ˆæœ‹å‹åœˆçš„å…±åŒæœ‹å‹ï¼‰</li>
<li>æœ‰åºé›†åˆï¼ˆsorted set &#x2F; zsetï¼‰ï¼šé›†åˆä¸­æ¯ä¸ªå…ƒç´ ä¼šå…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰,æ ¹æ®åˆ†æ•°å‡åºæ’åºï¼Œæ²¡æœ‰é‡å¤å…ƒç´ ï¼ˆå„ç§æ’è¡Œæ¦œï¼Œè§†é¢‘æ’­æ”¾æ’è¡Œæ¦œï¼ŒæŠ•ç¥¨æ’è¡Œæ¦œç­‰ç­‰ï¼‰</li>
</ul>
<h1 id="Rediså¸¸ç”¨å‘½ä»¤"><a href="#Rediså¸¸ç”¨å‘½ä»¤" class="headerlink" title="Rediså¸¸ç”¨å‘½ä»¤"></a>Rediså¸¸ç”¨å‘½ä»¤</h1><p>mysqlä¸­æ“ä½œæ•°æ®æ˜¯é€šè¿‡æ‰§è¡Œsqlè¯­å¥å®ç°ã€‚</p>
<p>redisä¸­æ“ä½œæ•°æ®ï¼Œæ ¹æ®æ•°æ®ç±»å‹å†³å®šå…·ä½“çš„æ“ä½œè¯­å¥ã€‚</p>
<p>rediså’Œmysqlä¸€æ ·ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<h2 id="å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤"><a href="#å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤"></a>å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤</h2><p>Rediså­—ç¬¦ä¸²ç±»å‹å¸¸ç”¨å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>SET key value</td>
<td>è®¾ç½®æŒ‡å®škeyçš„å€¼</td>
</tr>
<tr>
<td>GET key</td>
<td>è·å–æŒ‡å®škeyçš„å€¼</td>
</tr>
<tr>
<td>SETEX key seconds value</td>
<td>è®¾ç½®æŒ‡å®škeyçš„å€¼ï¼Œå¹¶å°†keyçš„è¿‡æœŸæ—¶é—´è®¾ä¸ºsecondsç§’</td>
</tr>
<tr>
<td>SETNX key value</td>
<td>åªæœ‰åœ¨keyä¸å­˜åœ¨æ—¶è®¾ç½®keyçš„å€¼</td>
</tr>
</tbody></table>
<p>SETEX key seconds valueï¼ˆè·å–æ‰‹æœºå·ï¼Œè¾“å…¥éªŒè¯ç ï¼ŒéªŒè¯ç æ˜¯æœ‰æ—¶é—´æœ‰æ•ˆæœŸçš„ï¼‰</p>
<p>SETNX key valueï¼ˆåˆ†å¸ƒå¼é”ï¼‰</p>
<p><strong>redisç¼–å†™ç•Œé¢</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225221635635.png" alt="image-20240225221635635"></p>
<ul>
<li>set name jackï¼ˆè®¾ç½®é”®nameçš„å€¼ä¸ºjackï¼‰</li>
<li>setex code 30 1234ï¼ˆè®¾ç½®é”®codeçš„å€¼ä¸º1234ï¼Œæœ‰æ•ˆæœŸä¸º30ç§’ï¼‰</li>
<li>setnx name jackï¼ˆå¦‚æœå†…å­˜ä¸­æ²¡æœ‰é”®nameï¼Œé‚£ä¹ˆè®¾ç½®å…¶å¯¹åº”çš„å€¼ä¸ºjackï¼‰</li>
<li>get nameï¼ˆè·å–é”®nameçš„å€¼ï¼‰</li>
</ul>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225222726132.png" alt="image-20240225222726132"></p>
<h2 id="å“ˆå¸Œæ“ä½œå‘½ä»¤"><a href="#å“ˆå¸Œæ“ä½œå‘½ä»¤" class="headerlink" title="å“ˆå¸Œæ“ä½œå‘½ä»¤"></a>å“ˆå¸Œæ“ä½œå‘½ä»¤</h2><p>Redis hashæ˜¯ä¸€ä¸ªstringç±»å‹çš„fieldå’Œvalueçš„æ˜ å°„è¡¨ï¼Œhashç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ï¼Œå¸¸ç”¨å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>HSET key field value</td>
<td>å°†å“ˆå¸Œè¡¨keyä¸­çš„å­—æ®µfieldçš„å€¼è®¾ä¸ºvalue</td>
</tr>
<tr>
<td>HGET key field</td>
<td>è·å–å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®šå­—æ®µçš„å€¼</td>
</tr>
<tr>
<td>HDEL key field</td>
<td>åˆ é™¤å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸­çš„æŒ‡å®šå­—æ®µ</td>
</tr>
<tr>
<td>HKEYS key</td>
<td>è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å­—æ®µ</td>
</tr>
<tr>
<td>HVALS key</td>
<td>è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼</td>
</tr>
</tbody></table>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225224022001.png" alt="image-20240225224022001"></p>
<p><strong>æ–°å¢é”®å€¼å¯¹</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225225123082.png" alt="image-20240225225123082"></p>
<p><strong>åˆ é™¤é”®å€¼å¯¹</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225225353214.png" alt="image-20240225225353214"></p>
<p><strong>æŸ¥çœ‹é”®å€¼å¯¹</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225225551179.png" alt="image-20240225225551179"></p>
<h2 id="åˆ—è¡¨æ“ä½œå‘½ä»¤"><a href="#åˆ—è¡¨æ“ä½œå‘½ä»¤" class="headerlink" title="åˆ—è¡¨æ“ä½œå‘½ä»¤"></a>åˆ—è¡¨æ“ä½œå‘½ä»¤</h2><p>Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºï¼Œå¸¸ç”¨å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>LPUSH key value1 [value2]</td>
<td>å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å¤´éƒ¨ï¼ˆLæŒ‡çš„æ˜¯leftï¼‰</td>
</tr>
<tr>
<td>LRANGE key start stop</td>
<td>è·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼ˆç±»ä¼¼äºsqlå½“ä¸­çš„åˆ†é¡µæŸ¥è¯¢ï¼‰</td>
</tr>
<tr>
<td>RPOP key</td>
<td>ç§»é™¤å¹¶è·å–åˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆä»å³ä¾§ç§»å‡ºå…ƒç´ ï¼‰</td>
</tr>
<tr>
<td>LLEN key</td>
<td>è·å–åˆ—è¡¨é•¿åº¦ï¼ˆå…ƒç´ çš„ä¸ªæ•°ï¼‰</td>
</tr>
</tbody></table>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225225837799.png" alt="image-20240225225837799"></p>
<p><strong>LPUSHæ“ä½œ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225230124699.png" alt="image-20240225230124699"></p>
<p><strong>LRANGEæ“ä½œ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225230318256.png" alt="image-20240225230318256"></p>
<p><strong>RPOPæ“ä½œ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225230429180.png" alt="image-20240225230429180"></p>
<p><strong>LLENæ“ä½œ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225230507692.png" alt="image-20240225230507692"></p>
<h2 id="é›†åˆæ“ä½œå‘½ä»¤"><a href="#é›†åˆæ“ä½œå‘½ä»¤" class="headerlink" title="é›†åˆæ“ä½œå‘½ä»¤"></a>é›†åˆæ“ä½œå‘½ä»¤</h2><p>Redis setæ˜¯stringç±»å‹çš„æ— åºé›†åˆã€‚é›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œé›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ï¼Œå¸¸ç”¨å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>SADD key member1 [member2]</td>
<td>å‘é›†åˆä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td>
</tr>
<tr>
<td>SMEMBERS key</td>
<td>è¿”å›é›†åˆä¸­çš„æ‰€æœ‰æˆå‘˜</td>
</tr>
<tr>
<td>SCARD key</td>
<td>è·å–é›†åˆçš„æˆå‘˜æ•°</td>
</tr>
<tr>
<td>SINTER key1 [key2]</td>
<td>è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›†</td>
</tr>
<tr>
<td>SUNION key1 [key2]</td>
<td>è¿”å›æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†</td>
</tr>
<tr>
<td>SREM key member1 [member2]</td>
<td>åˆ é™¤é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td>
</tr>
</tbody></table>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231003667.png" alt="image-20240225231003667"></p>
<p><strong>åˆ›å»ºset</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231309602.png" alt="image-20240225231309602"></p>
<p><strong>æŸ¥çœ‹setæ‰€æœ‰æˆå‘˜</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231430272.png" alt="image-20240225231430272"></p>
<p><strong>è·å–é›†åˆæˆå‘˜æ•°</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231453157.png" alt="image-20240225231453157"></p>
<p><strong>æŸ¥çœ‹é›†åˆäº¤é›†</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231554456.png" alt="image-20240225231554456"></p>
<p><strong>æŸ¥çœ‹é›†åˆå¹¶é›†</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231619565.png" alt="image-20240225231619565"></p>
<p><strong>åˆ é™¤é›†åˆæˆå‘˜</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225231711195.png" alt="image-20240225231711195"></p>
<h2 id="æœ‰åºé›†åˆæ“ä½œå‘½ä»¤"><a href="#æœ‰åºé›†åˆæ“ä½œå‘½ä»¤" class="headerlink" title="æœ‰åºé›†åˆæ“ä½œå‘½ä»¤"></a>æœ‰åºé›†åˆæ“ä½œå‘½ä»¤</h2><p>Redisæœ‰åºé›†åˆæ˜¯stringç±»å‹å…ƒç´ çš„é›†åˆï¼Œä¸”ä¸å…è®¸æœ‰é‡å¤æˆå‘˜ã€‚æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ªdoubleç±»å‹çš„åˆ†æ•°ã€‚åˆ†æ•°å¯ä»¥ç”¨æ¥æ’åºã€‚å¸¸ç”¨å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>ZADD key score1 member1 [score2  member2]</td>
<td>å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td>
</tr>
<tr>
<td>ZRANGE key start stop [WITHSCORES]</td>
<td>é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šåŒºé—´å†…çš„æˆå‘˜</td>
</tr>
<tr>
<td>ZINCRBY key increment member</td>
<td>æœ‰åºé›†åˆä¸­å¯¹æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡increment</td>
</tr>
<tr>
<td>ZREM key member [member â€¦]</td>
<td>ç§»é™¤æœ‰åºé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td>
</tr>
</tbody></table>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225232001110.png" alt="image-20240225232001110"></p>
<p><strong>åˆ›å»ºæœ‰åºé›†åˆ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225232306448.png" alt="image-20240225232306448"></p>
<p><strong>æŸ¥è¯¢æœ‰åºé›†åˆçš„å†…å®¹ï¼ˆé»˜è®¤æŒ‰ç…§å‡åºæ’åˆ—ï¼‰</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225232508385.png" alt="image-20240225232508385"></p>
<p><strong>å¢åŠ æœ‰åºé›†åˆä¸­å€¼çš„æƒé‡</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225232631623.png" alt="image-20240225232631623"></p>
<p><strong>åˆ é™¤æœ‰åºé›†åˆä¸­çš„å…ƒç´ </strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225232737356.png" alt="image-20240225232737356"></p>
<h2 id="é€šç”¨å‘½ä»¤"><a href="#é€šç”¨å‘½ä»¤" class="headerlink" title="é€šç”¨å‘½ä»¤"></a>é€šç”¨å‘½ä»¤</h2><p>Redisçš„é€šç”¨å‘½ä»¤æ˜¯ä¸åˆ†æ•°æ®ç±»å‹çš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ï¼š</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æ„ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>KEYS pattern</td>
<td>æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆç»™å®šæ¨¡å¼ï¼ˆpatternï¼‰çš„key</td>
</tr>
<tr>
<td>EXISTS key</td>
<td>æ£€æŸ¥ç»™å®škeyæ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td>TYPE key</td>
<td>è¿”å›keyæ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹</td>
</tr>
<tr>
<td>DEL key</td>
<td>è¯¥å‘½ä»¤ç”¨äºåœ¨keyå­˜åœ¨æ—¶åˆ é™¤key</td>
</tr>
</tbody></table>
<p><strong>æŸ¥çœ‹æ‰€æœ‰çš„key</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225233017458.png" alt="image-20240225233017458"></p>
<p><strong>æ£€æŸ¥æŸä¸ªkeyæ˜¯å¦å­˜åœ¨</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225233046764.png" alt="image-20240225233046764"></p>
<p><strong>æ£€æŸ¥keyçš„å€¼ç±»å‹</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225233128225.png" alt="image-20240225233128225"></p>
<p><strong>åˆ é™¤key</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240225233151433.png" alt="image-20240225233151433"></p>
<h1 id="åœ¨Javaä¸­æ“ä½œRedis"><a href="#åœ¨Javaä¸­æ“ä½œRedis" class="headerlink" title="åœ¨Javaä¸­æ“ä½œRedis"></a>åœ¨Javaä¸­æ“ä½œRedis</h1><h2 id="Redisçš„Javaå®¢æˆ·ç«¯"><a href="#Redisçš„Javaå®¢æˆ·ç«¯" class="headerlink" title="Redisçš„Javaå®¢æˆ·ç«¯"></a>Redisçš„Javaå®¢æˆ·ç«¯</h2><p>Redisçš„Javaå®¢æˆ·ç«¯å¾ˆå¤šï¼Œå¸¸ç”¨çš„å‡ ç§ï¼š</p>
<ul>
<li>Jedisï¼ˆRediså®˜æ–¹æ¨èçš„å®¢æˆ·ç«¯ï¼‰</li>
<li>Lettuce</li>
<li>Spring Data Redisï¼ˆå¯¹Jediså’ŒLettuceè¿›è¡Œäº†é«˜åº¦å°è£…ï¼‰</li>
</ul>
<p>Spring Data Redisæ˜¯Springçš„ä¸€éƒ¨åˆ†ï¼Œå¯¹Redisåº•å±‚å¼€å‘åŒ…è¿›è¡Œäº†é«˜åº¦å°è£…ã€‚</p>
<p>åœ¨Springé¡¹ç›®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Spring Data Redisæ¥ç®€åŒ–æ“ä½œã€‚</p>
<h2 id="Spring-Data-Redisä½¿ç”¨æ–¹å¼"><a href="#Spring-Data-Redisä½¿ç”¨æ–¹å¼" class="headerlink" title="Spring Data Redisä½¿ç”¨æ–¹å¼"></a>Spring Data Redisä½¿ç”¨æ–¹å¼</h2><p>æ“ä½œæ­¥éª¤ï¼š</p>
<ol>
<li><p>å¯¼å…¥Spring Data Redisçš„mavenåæ ‡</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226001646019.png" alt="image-20240226001646019"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®Redisæ•°æ®æº</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226001654290.png" alt="image-20240226001654290"></p>
<p><font color="red">redisæœåŠ¡å¯åŠ¨åï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»–åœ¨redisæœåŠ¡ä¸­ï¼Œåˆ›å»ºäº†16ä¸ªåº“ã€‚å¯ä»¥é€šè¿‡databaseæŒ‡å®šä½¿ç”¨çš„æ•°æ®åº“ï¼Œä¸åŒæ•°æ®åº“çš„æ•°æ®æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚å¦‚æœä¸é…ç½®databaseï¼Œé»˜è®¤è¿æ¥åˆ°redisåï¼Œä½¿ç”¨0å·æ•°æ®åº“ã€‚</font></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226002257564.png" alt="image-20240226002257564"></p>
</li>
<li><p>ç¼–å†™é…ç½®ç±»ï¼Œåˆ›å»ºRedisTemplateå¯¹è±¡ï¼ˆè¿™ä¸ªå¯¹è±¡æ˜¯Spring Data Redisæœ€æ ¸å¿ƒã€æœ€å¸¸ç”¨çš„å¯¹è±¡ï¼‰</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226001724266.png" alt="image-20240226001724266"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.config;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span>&#123; <span class="comment">//å¦‚æœç¬¬ä¸‰æ–¹beanéœ€è¦ä¾èµ–å…¶ä»–beanå¯¹è±¡ï¼Œç›´æ¥å†beanå®šä¹‰æ–¹æ³•ä¸­è®¾ç½®å½¢å‚å³å¯ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…</span></span><br><span class="line">        <span class="type">RedisTemplate</span> <span class="variable">redisTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®redisçš„è¿æ¥å·¥å‚å¯¹è±¡</span></span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¾ç½®rediså½“ä¸­keyçš„åºåˆ—åŒ–å™¨</span></span><br><span class="line">        redisTemplate.setKeySerializer(<span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é€šè¿‡RedisTemplateå¯¹è±¡æ“ä½œRedisï¼ˆé€šè¿‡å•å…ƒæµ‹è¯•å¯ä»¥ç³»ç»Ÿå­¦ä¹ redisçš„å…·ä½“ä½¿ç”¨æ–¹å¼ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226004010021.png" alt="image-20240226004010021"></p>
</li>
</ol>
<p>redisæœ‰äº”ç§æ•°æ®ç±»å‹ï¼Œæ¯ä¸€ç§æ•°æ®ç±»å‹æä¾›äº†å„ç§æ“ä½œå‘½ä»¤ï¼Œåœ¨æ­¤ï¼ŒredisTemplateå°è£…äº†äº”ç§æ“ä½œæ¥å£ï¼Œå¯¹åº”äº”ç§æ•°æ®ç±»å‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line"></span><br><span class="line">        <span class="type">ValueOperations</span> <span class="variable">valueOperations</span> <span class="operator">=</span> redisTemplate.opsForValue();</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226004304257.png" alt="image-20240226004304257"></p>
<h3 id="Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®"><a href="#Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®" class="headerlink" title="Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®"></a>Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testString</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//set å‘redisä¸­æ’å…¥æ•°æ®</span></span><br><span class="line">        <span class="comment">//get ä»redisä¸­è·å–æ•°æ®</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;city&quot;</span>,<span class="string">&quot;åŒ—äº¬&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">city</span> <span class="operator">=</span> (String) redisTemplate.opsForValue().get(<span class="string">&quot;city&quot;</span>);</span><br><span class="line">        System.out.println(city);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//setex æ’å…¥æ•°æ®çš„åŒæ—¶è®¾ç½®æ•°æ®æœ‰æ•ˆæœŸï¼ˆè®¾ç½®é”®å€¼å¯¹code:1234ï¼Œæœ‰æ•ˆæœŸæ˜¯3åˆ†é’Ÿï¼‰</span></span><br><span class="line">        redisTemplate.opsForValue().set(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;1234&quot;</span>,<span class="number">3</span>, TimeUnit.MINUTES);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//setnx å‘redisä¸­æ’å…¥æ•°æ®ï¼ˆå¦‚æœé”®ä¸å­˜åœ¨ï¼‰ï¼ˆvalueå¯ä»¥ç»™ä»»æ„ç±»å‹ï¼Œæœ€ç»ˆå®ƒéƒ½ä¼šå°†å…¶åºåˆ—åŒ–ï¼Œæœ€ç»ˆéƒ½ä¼šè½¬æˆrediså½“ä¸­çš„stringè¿›è¡Œå­˜å‚¨ï¼Œä»javaä»£ç è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥ç»™ä»»ä½•ç±»å‹çš„å‚æ•°ï¼‰</span></span><br><span class="line">        redisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        redisTemplate.opsForValue().setIfAbsent(<span class="string">&quot;lock&quot;</span>,<span class="string">&quot;2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;lock&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨application-dev.ymlæ–‡ä»¶ä¸­è®¾ç½®äº†redisè¿æ¥çš„å†…å­˜çš„æ•°æ®åº“ä¸º10å·ï¼Œåœ¨debugæ¨¡å¼ä¸‹è¿›å…¥åˆ°ä»¥ä¸‹è¯­å¥ï¼Œå†æŸ¥çœ‹db10ä¸­å¯¹åº”çš„é”®å€¼å¯¹ã€‚</p>
<p>æ­¤æ—¶db10ä¸­å·²ç»å­˜åœ¨å¯¹åº”çš„é”®å€¼å¯¹ â€œcityâ€:â€åŒ—äº¬â€</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226103538896.png" alt="image-20240226103538896"></p>
<p>æˆ‘ä»¬ä½¿ç”¨redis desktop manageræŸ¥çœ‹db10ä¸­cityçš„å€¼ï¼Œä¼šå‘ç°å®ƒæ˜¯ä¹±ç çš„ã€‚</p>
<p><font color="red">è¿™ä¸ªæ—¶å€™å®ƒå…¶å®ä¸æ˜¯ä¹±ç çš„ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡javaç¨‹åºæ“ä½œå¯¹åº”çš„redisæ•°æ®ï¼Œå®ƒå…¶å®å¯¹æ•°æ®è¿›è¡Œäº†åºåˆ—åŒ–æ“ä½œï¼Œåºåˆ—åŒ–ä¹‹åæ‰å˜æˆäº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å€¼ã€‚è€Œä¸”keyï¼ˆcityï¼‰æ˜¯æ²¡é—®é¢˜çš„ï¼Œå¹¶æœªå‡ºç°ä¹±ç çš„æ•ˆæœï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ç”¨é…ç½®ç±»å£°æ˜RedisTemplateæ—¶ï¼Œåœ¨å…¶ä¸­é…ç½®äº†redis keyçš„åºåˆ—åŒ–å™¨ã€‚å¦‚æœä¸é…ç½®åºåˆ—åŒ–å™¨ï¼Œredisä¹Ÿä¼šä½¿ç”¨é»˜è®¤çš„åºåˆ—åŒ–å™¨æ¥åºåˆ—åŒ–æ•°æ®ã€‚</font></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226103631514.png" alt="image-20240226103631514"></p>
<p><font color="red">æ‰€ä»¥åœ¨javaä¸­æŸ¥è¯¢redisçš„é”®å€¼å¯¹ä¸­çš„valueæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚åªæ˜¯åœ¨å®¢æˆ·ç«¯ä¸Šçœ‹èµ·æ¥ä¹±ç ã€‚</font></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226104111245.png" alt="image-20240226104111245"></p>
<h3 id="Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå“ˆå¸Œç±»å‹çš„æ•°æ®"><a href="#Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå“ˆå¸Œç±»å‹çš„æ•°æ®" class="headerlink" title="Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå“ˆå¸Œç±»å‹çš„æ•°æ®"></a>Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå“ˆå¸Œç±»å‹çš„æ•°æ®</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line"></span><br><span class="line">        <span class="type">ValueOperations</span> <span class="variable">valueOperations</span> <span class="operator">=</span> redisTemplate.opsForValue();</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œå“ˆå¸Œç±»å‹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testHash</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="comment">//hset</span></span><br><span class="line">        hashOperations.put(<span class="string">&quot;100&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        hashOperations.put(<span class="string">&quot;100&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;20&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//hget</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> (String) hashOperations.get(<span class="string">&quot;100&quot;</span>, <span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">age</span> <span class="operator">=</span> (String) hashOperations.get(<span class="string">&quot;100&quot;</span>, <span class="string">&quot;age&quot;</span>);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        System.out.println(age);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//hkeys</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">keys</span> <span class="operator">=</span> hashOperations.keys(<span class="string">&quot;100&quot;</span>);</span><br><span class="line">        System.out.println(keys);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//hvals</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">values</span> <span class="operator">=</span> hashOperations.values(<span class="string">&quot;100&quot;</span>);</span><br><span class="line">        System.out.println(values);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//hdel</span></span><br><span class="line">        hashOperations.delete(<span class="string">&quot;100&quot;</span>,<span class="string">&quot;age&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226105445070.png" alt="image-20240226105445070"></p>
<h3 id="Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå…¶ä»–ç±»å‹çš„æ•°æ®"><a href="#Spring-Data-Redisä½¿ç”¨æ–¹æ³•-æ“ä½œå…¶ä»–ç±»å‹çš„æ•°æ®" class="headerlink" title="Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå…¶ä»–ç±»å‹çš„æ•°æ®"></a>Spring Data Redisä½¿ç”¨æ–¹æ³• æ“ä½œå…¶ä»–ç±»å‹çš„æ•°æ®</h3><p><strong>æ“ä½œlistç±»å‹æ•°æ®</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226110601784.png" alt="image-20240226110601784"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œåˆ—è¡¨ç±»å‹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testList</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//lpush lrange rpop llen</span></span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//lpush</span></span><br><span class="line">        listOperations.leftPushAll(<span class="string">&quot;mylist&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>);</span><br><span class="line">        listOperations.leftPush(<span class="string">&quot;mylist&quot;</span>,<span class="string">&quot;d&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//lrange</span></span><br><span class="line">        <span class="type">List</span> <span class="variable">mylist</span> <span class="operator">=</span> listOperations.range(<span class="string">&quot;mylist&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">        System.out.println(mylist);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//rpop</span></span><br><span class="line">        listOperations.rightPop(<span class="string">&quot;mylist&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Long</span> <span class="variable">size</span> <span class="operator">=</span> listOperations.size(<span class="string">&quot;mylist&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">List</span> <span class="variable">mylist2</span> <span class="operator">=</span> listOperations.range(<span class="string">&quot;mylist&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">        System.out.println(mylist2);</span><br><span class="line"></span><br><span class="line">        System.out.println(size);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ“ä½œsetç±»å‹æ•°æ®</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226111149869.png" alt="image-20240226111149869"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line"></span><br><span class="line">        <span class="type">ValueOperations</span> <span class="variable">valueOperations</span> <span class="operator">=</span> redisTemplate.opsForValue();</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œé›†åˆç±»å‹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSet</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line"></span><br><span class="line">        setOperations.add(<span class="string">&quot;set1&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>);</span><br><span class="line">        setOperations.add(<span class="string">&quot;set2&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;x&quot;</span>,<span class="string">&quot;y&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Set</span> <span class="variable">set1</span> <span class="operator">=</span> setOperations.members(<span class="string">&quot;set1&quot;</span>);</span><br><span class="line">        System.out.println(set1);</span><br><span class="line"></span><br><span class="line">        <span class="type">Long</span> <span class="variable">size</span> <span class="operator">=</span> setOperations.size(<span class="string">&quot;set1&quot;</span>);</span><br><span class="line">        System.out.println(size);</span><br><span class="line"></span><br><span class="line">        <span class="type">Set</span> <span class="variable">intersect</span> <span class="operator">=</span> setOperations.intersect(<span class="string">&quot;set1&quot;</span>, <span class="string">&quot;set2&quot;</span>);</span><br><span class="line">        System.out.println(intersect);</span><br><span class="line"></span><br><span class="line">        <span class="type">Set</span> <span class="variable">union</span> <span class="operator">=</span> setOperations.union(<span class="string">&quot;set1&quot;</span>, <span class="string">&quot;set2&quot;</span>);</span><br><span class="line">        System.out.println(union);</span><br><span class="line"></span><br><span class="line">        setOperations.remove(<span class="string">&quot;set1&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>);</span><br><span class="line">        System.out.println(setOperations.members(<span class="string">&quot;set1&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æœ‰åºé›†åˆç±»å‹æ•°æ®</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226111711857.png" alt="image-20240226111711857"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line"></span><br><span class="line">        <span class="type">ValueOperations</span> <span class="variable">valueOperations</span> <span class="operator">=</span> redisTemplate.opsForValue();</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ“ä½œæœ‰åºé›†åˆç±»å‹çš„æ•°æ®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testZset</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">        zSetOperations.add(<span class="string">&quot;zset1&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="number">10</span>);</span><br><span class="line">        zSetOperations.add(<span class="string">&quot;zset1&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="number">12</span>);</span><br><span class="line">        zSetOperations.add(<span class="string">&quot;zset1&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Set</span> <span class="variable">zset1</span> <span class="operator">=</span> zSetOperations.range(<span class="string">&quot;zset1&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">        System.out.println(zset1);</span><br><span class="line"></span><br><span class="line">        zSetOperations.incrementScore(<span class="string">&quot;zset1&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">        zSetOperations.remove(<span class="string">&quot;zset1&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šç”¨å‘½ä»¤æ“ä½œ</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226112106895.png" alt="image-20240226112106895"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.DataType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringDataRedisTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testRedisTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(redisTemplate);</span><br><span class="line"></span><br><span class="line">        <span class="type">ValueOperations</span> <span class="variable">valueOperations</span> <span class="operator">=</span> redisTemplate.opsForValue();</span><br><span class="line">        <span class="type">HashOperations</span> <span class="variable">hashOperations</span> <span class="operator">=</span> redisTemplate.opsForHash();</span><br><span class="line">        <span class="type">ListOperations</span> <span class="variable">listOperations</span> <span class="operator">=</span> redisTemplate.opsForList();</span><br><span class="line">        <span class="type">SetOperations</span> <span class="variable">setOperations</span> <span class="operator">=</span> redisTemplate.opsForSet();</span><br><span class="line">        <span class="type">ZSetOperations</span> <span class="variable">zSetOperations</span> <span class="operator">=</span> redisTemplate.opsForZSet();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šç”¨å‘½ä»¤æ“ä½œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCommon</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//keys exists type del</span></span><br><span class="line">        <span class="type">Set</span> <span class="variable">keys</span> <span class="operator">=</span> redisTemplate.keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        System.out.println(keys);</span><br><span class="line"></span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">name</span> <span class="operator">=</span> redisTemplate.hasKey(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        <span class="type">Boolean</span> <span class="variable">set</span> <span class="operator">=</span> redisTemplate.hasKey(<span class="string">&quot;set&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Object key : keys) &#123;</span><br><span class="line">            <span class="type">DataType</span> <span class="variable">type</span> <span class="operator">=</span> redisTemplate.type(key);</span><br><span class="line">            System.out.println(type.name());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        redisTemplate.delete(<span class="string">&quot;mylist&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®-1"><a href="#åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®-1" class="headerlink" title="åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®"></a>åº—é“ºè¥ä¸šçŠ¶æ€è®¾ç½®</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240226134917828.png" alt="image-20240226134917828"></p>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li><p>ä¿®æ”¹è¥ä¸šçŠ¶æ€çš„æ¥å£</p>
</li>
<li><p>ç®¡ç†ç«¯æŸ¥è¯¢è¥ä¸šçŠ¶æ€</p>
<p>æŸ¥è¯¢è¥ä¸šæ¥å£é¦–å…ˆè¦åœ¨å•†å®¶æŸ¥è¯¢ï¼Œåœ¨å®¢æˆ·ç«¯ä¹Ÿè¦æ˜¯æŸ¥è¯¢çš„ï¼Œå•†å®¶å’Œå®¢æˆ·ç«¯èƒ½ä¸èƒ½ç”¨åŒä¸€ä¸ªæ¥å£æŸ¥è¯¢è¥ä¸šçŠ¶æ€ã€‚ä»æŠ€æœ¯å±‚é¢ä¸Šæ˜¯å¯ä»¥å®ç°çš„ï¼Œä½†æ˜¯åœ¨é¡¹ç›®å½“ä¸­ï¼Œæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºä¸¤ä¸ªä¸åŒçš„æŸ¥è¯¢æ¥å£ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾ç½®æ˜¯å› ä¸ºï¼Œå½“å‰é¡¹ç›®å¯¹äºè¯·æ±‚è·¯å¾„æ¥å£åšäº†çº¦å®šã€‚</p>
</li>
<li><p>ç”¨æˆ·ç«¯æŸ¥è¯¢è¥ä¸šçŠ¶æ€</p>
</li>
</ul>
<p>æœ¬é¡¹ç›®çº¦å®šï¼š</p>
<ul>
<li>ç®¡ç†ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨&#x2F;adminä½œä¸ºå‰ç¼€</li>
<li>ç”¨æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨&#x2F;userä½œä¸ºå‰ç¼€</li>
</ul>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><font color="red">å»ºè®®åœ¨æ¯æ¬¡å¼€å‘å‰å°†æµ‹è¯•ç±»çš„æ–¹æ³•å‰é¢çš„æ³¨é‡Š@SpringBootTestæ³¨é‡Šæ‰ã€‚</font></p>
<p>è®¾ç½®shopControllerå±‚ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/shop&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;åº—é“ºç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopController</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®åº—é“ºçš„è¥ä¸šçŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/&#123;status&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è®¾ç½®åº—é“ºçš„è¥ä¸šçŠ¶æ€&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">setStatus</span><span class="params">(<span class="meta">@PathVariable</span> Integer status)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;è®¾ç½®åº—é“ºçš„è¥ä¸šçŠ¶æ€ï¼š&#123;&#125;&quot;</span>,status == <span class="number">1</span> ? <span class="string">&quot;è¥ä¸šä¸­&quot;</span>:<span class="string">&quot;æ‰“çƒŠä¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åº—é“ºçš„è¥ä¸šçŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è·å–åº—é“ºçš„è¥ä¸šçŠ¶æ€&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/status&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Integer&gt; <span class="title function_">getStatus</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">//        log.info(&quot;è·å–åˆ°åº—é“ºçš„è¥ä¸šçŠ¶æ€ä¸ºï¼š&#123;&#125;&quot;,);</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> (Integer) redisTemplate.opsForValue().get(<span class="string">&quot;SHOP_STATUS&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;è®¾ç½®åº—é“ºçš„è¥ä¸šçŠ¶æ€ï¼š&#123;&#125;&quot;</span>, status == <span class="number">1</span> ? <span class="string">&quot;è¥ä¸šä¸­&quot;</span>:<span class="string">&quot;æ‰“çƒŠä¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬è¿™é‡Œè¦æ“ä½œrediså°±éœ€è¦redisTemplateç±»ï¼Œæˆ‘ä»¬å·²ç»åœ¨é…ç½®ç±»ä¸­åˆ›å»ºäº†è¿™ä¸ªç±»ï¼Œè¯¥ç±»çš„å¯¹è±¡å·²ç»æ³¨å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚</p>
<p><strong>åˆ›å»ºç”¨æˆ·ç«¯controllerç±»ï¼Œä¿®æ”¹æ¥å£ï¼Œä¿ç•™æŸ¥è¯¢æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/shop&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;åº—é“ºç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShopController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åº—é“ºçš„è¥ä¸šçŠ¶æ€</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è·å–åº—é“ºçš„è¥ä¸šçŠ¶æ€&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/status&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Integer&gt; <span class="title function_">getStatus</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="comment">//        log.info(&quot;è·å–åˆ°åº—é“ºçš„è¥ä¸šçŠ¶æ€ä¸ºï¼š&#123;&#125;&quot;,);</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> (Integer) redisTemplate.opsForValue().get(<span class="string">&quot;SHOP_STATUS&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;è®¾ç½®åº—é“ºçš„è¥ä¸šçŠ¶æ€ï¼š&#123;&#125;&quot;</span>, status == <span class="number">1</span> ? <span class="string">&quot;è¥ä¸šä¸­&quot;</span>:<span class="string">&quot;æ‰“çƒŠä¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç›®å‰å‡ºç°çš„é—®é¢˜</strong></p>
<p>userå’Œadminä¸‹çš„ç±»å‡ä¸ºShopControllerï¼Œä¸”å‡åŠ äº†æ³¨è§£@ResControllerï¼Œå®ƒä»¬éƒ½ä¼šåˆ›å»ºåœ¨Springå®¹å™¨ä¸­ï¼Œä¸”Beançš„åç§°ç›¸åŒï¼Œå¯åŠ¨æ—¶ä¼šæŠ¥é”™ã€‚</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227134346557.png" alt="image-20240227134346557"></p>
<p><strong>è§£å†³åŠæ³•</strong></p>
<p>åœ¨userå’Œadminç›®å½•ä¸‹åˆ†åˆ«è®¾ç½®RestControllerç±»çš„Beanå¯¹è±¡çš„åˆ«å</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227134611221.png" alt="image-20240227134611221"></p>
<p><strong>ä¿®æ”¹çŠ¶æ€å€¼ä¸ºå¸¸é‡ï¼Œæ–¹ä¾¿ä»£ç ç»´æŠ¤</strong></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227134842819.png" alt="image-20240227134842819"></p>
<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><ol>
<li><p>åç«¯æ¥å£æµ‹è¯•</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227145920511.png" alt="image-20240227145920511"></p>
</li>
<li><p>å‰åç«¯è”è°ƒæµ‹è¯•</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227145838851.png" alt="image-20240227145838851"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227145851147.png" alt="image-20240227145851147"></p>
</li>
</ol>
<p>éœ€æ±‚ï¼šæˆ‘ä»¬å¸Œæœ›å®¢æˆ·ç«¯ç›¸å…³æ¥å£å’Œç®¡ç†ç«¯ç›¸å…³æ¥å£åˆ†å¼€ï¼Œæ–¹ä¾¿åç»­æµ‹è¯•ã€‚</p>
<p>è§£å†³åŠæ³•ï¼Œå¤åˆ¶ä¸€ä»½WebMvcConfigurationé…ç½®ç±»ä¸‹çš„docketæ–¹æ³•ï¼Œå¹¶ä¿®æ”¹éƒ¨åˆ†ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227150848627.png" alt="image-20240227150848627"></p>
<p>é‡å¯å¹¶æ‰“å¼€åç«¯æµ‹è¯•ç•Œé¢</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day05-redis/image-20240227150914330.png" alt="image-20240227150914330"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day04-å¥—é¤ç®¡ç†</title>
    <url>/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<p>å®Œæˆå¥—é¤ç®¡ç†æ¨¡å—æ‰€æœ‰ä¸šåŠ¡åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>æ–°å¢å¥—é¤</li>
<li>å¥—é¤åˆ†é¡µæŸ¥è¯¢</li>
<li>åˆ é™¤å¥—é¤</li>
<li>ä¿®æ”¹å¥—é¤</li>
<li>èµ·å”®åœå”®å¥—é¤</li>
</ul>
<p>è¦æ±‚ï¼š</p>
<ol>
<li>æ ¹æ®äº§å“åŸå‹è¿›è¡Œéœ€æ±‚åˆ†æï¼Œåˆ†æå‡ºä¸šåŠ¡è§„åˆ™</li>
<li>è®¾è®¡æ¥å£</li>
<li>æ¢³ç†è¡¨ä¹‹é—´çš„å…³ç³»ï¼ˆåˆ†ç±»è¡¨ã€èœå“è¡¨ã€å¥—é¤è¡¨ã€å£å‘³è¡¨ã€å¥—é¤èœå“å…³ç³»è¡¨ï¼‰</li>
<li>æ ¹æ®æ¥å£è®¾è®¡è¿›è¡Œä»£ç å®ç°</li>
<li>åˆ†åˆ«é€šè¿‡swaggeræ¥å£æ–‡æ¡£å’Œå‰åç«¯è”è°ƒè¿›è¡ŒåŠŸèƒ½æµ‹è¯•</li>
</ol>
<h3 id="1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#1-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>1.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018135930842-17087774618395.png" alt="image-20221018135930842"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018140833345-17087774618396.png" alt="image-20221018140833345"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¥—é¤åç§°å”¯ä¸€</li>
<li>å¥—é¤å¿…é¡»å±äºæŸä¸ªåˆ†ç±»</li>
<li>å¥—é¤å¿…é¡»åŒ…å«èœå“</li>
<li>åç§°ã€åˆ†ç±»ã€ä»·æ ¼ã€å›¾ç‰‡ä¸ºå¿…å¡«é¡¹</li>
<li>æ·»åŠ èœå“çª—å£éœ€è¦æ ¹æ®åˆ†ç±»ç±»å‹æ¥å±•ç¤ºèœå“</li>
<li>æ–°å¢çš„å¥—é¤é»˜è®¤ä¸ºåœå”®çŠ¶æ€</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼ˆå…±æ¶‰åŠåˆ°4ä¸ªæ¥å£ï¼‰ï¼š</p>
<ul>
<li>æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†ç±»ï¼ˆå·²å®Œæˆï¼‰</li>
<li>æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“</li>
<li>å›¾ç‰‡ä¸Šä¼ ï¼ˆå·²å®Œæˆï¼‰</li>
<li>æ–°å¢å¥—é¤</li>
</ul>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018141521068-17087774618408.png" alt="image-20221018141521068"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018141606787-17087774618407.png" alt="image-20221018141606787"></p>
<p>æ•°æ®åº“è®¾è®¡ï¼š</p>
<p>setmealè¡¨ä¸ºå¥—é¤è¡¨ï¼Œç”¨äºå­˜å‚¨å¥—é¤çš„ä¿¡æ¯ã€‚å…·ä½“è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å­—æ®µå</th>
<th>æ•°æ®ç±»å‹</th>
<th>è¯´æ˜</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>bigint</td>
<td>ä¸»é”®</td>
<td>è‡ªå¢</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>å¥—é¤åç§°</td>
<td>å”¯ä¸€</td>
</tr>
<tr>
<td>category_id</td>
<td>bigint</td>
<td>åˆ†ç±»id</td>
<td>é€»è¾‘å¤–é”®</td>
</tr>
<tr>
<td>price</td>
<td>decimal(10,2)</td>
<td>å¥—é¤ä»·æ ¼</td>
<td></td>
</tr>
<tr>
<td>image</td>
<td>varchar(255)</td>
<td>å›¾ç‰‡è·¯å¾„</td>
<td></td>
</tr>
<tr>
<td>description</td>
<td>varchar(255)</td>
<td>å¥—é¤æè¿°</td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>å”®å–çŠ¶æ€</td>
<td>1èµ·å”® 0åœå”®</td>
</tr>
<tr>
<td>create_time</td>
<td>datetime</td>
<td>åˆ›å»ºæ—¶é—´</td>
<td></td>
</tr>
<tr>
<td>update_time</td>
<td>datetime</td>
<td>æœ€åä¿®æ”¹æ—¶é—´</td>
<td></td>
</tr>
<tr>
<td>create_user</td>
<td>bigint</td>
<td>åˆ›å»ºäººid</td>
<td></td>
</tr>
<tr>
<td>update_user</td>
<td>bigint</td>
<td>æœ€åä¿®æ”¹äººid</td>
<td></td>
</tr>
</tbody></table>
<p>setmeal_dishè¡¨ä¸ºå¥—é¤èœå“å…³ç³»è¡¨ï¼Œç”¨äºå­˜å‚¨å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»ã€‚å…·ä½“è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>å­—æ®µå</th>
<th>æ•°æ®ç±»å‹</th>
<th>è¯´æ˜</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>bigint</td>
<td>ä¸»é”®</td>
<td>è‡ªå¢</td>
</tr>
<tr>
<td>setmeal_id</td>
<td>bigint</td>
<td>å¥—é¤id</td>
<td>é€»è¾‘å¤–é”®</td>
</tr>
<tr>
<td>dish_id</td>
<td>bigint</td>
<td>èœå“id</td>
<td>é€»è¾‘å¤–é”®</td>
</tr>
<tr>
<td>name</td>
<td>varchar(32)</td>
<td>èœå“åç§°</td>
<td>å†—ä½™å­—æ®µ</td>
</tr>
<tr>
<td>price</td>
<td>decimal(10,2)</td>
<td>èœå“å•ä»·</td>
<td>å†—ä½™å­—æ®µ</td>
</tr>
<tr>
<td>copies</td>
<td>int</td>
<td>èœå“ä»½æ•°</td>
<td></td>
</tr>
</tbody></table>
<h3 id="1-2-ä»£ç å®ç°"><a href="#1-2-ä»£ç å®ç°" class="headerlink" title="1.2 ä»£ç å®ç°"></a>1.2 ä»£ç å®ç°</h3><h4 id="1-2-1-DishController"><a href="#1-2-1-DishController" class="headerlink" title="1.2.1 DishController"></a>1.2.1 DishController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;Dish&gt;&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span>&#123;</span><br><span class="line">    List&lt;Dish&gt; list = dishService.list(categoryId);</span><br><span class="line">    <span class="keyword">return</span> Result.success(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-2-DishService"><a href="#1-2-2-DishService" class="headerlink" title="1.2.2 DishService"></a>1.2.2 DishService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;Dish&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-3-DishServiceImpl"><a href="#1-2-3-DishServiceImpl" class="headerlink" title="1.2.3 DishServiceImpl"></a>1.2.3 DishServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> categoryId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Dish&gt; <span class="title function_">list</span><span class="params">(Long categoryId)</span> &#123;</span><br><span class="line">    <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> Dish.builder()</span><br><span class="line">        .categoryId(categoryId)</span><br><span class="line">        .status(StatusConstant.ENABLE)</span><br><span class="line">        .build();</span><br><span class="line">    <span class="keyword">return</span> dishMapper.list(dish);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-4-DishMapper"><a href="#1-2-4-DishMapper" class="headerlink" title="1.2.4 DishMapper"></a>1.2.4 DishMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ¨æ€æ¡ä»¶æŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dish</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;Dish&gt; <span class="title function_">list</span><span class="params">(Dish dish)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-5-DishMapper-xml"><a href="#1-2-5-DishMapper-xml" class="headerlink" title="1.2.5 DishMapper.xml"></a>1.2.5 DishMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Dish&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Dish&quot;</span>&gt;</span></span><br><span class="line">    select * from dish</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span></span><br><span class="line">            and name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;categoryId != null&quot;</span>&gt;</span></span><br><span class="line">            and category_id = #&#123;categoryId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span></span><br><span class="line">            and status = #&#123;status&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    order by create_time desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-6-SetmealController"><a href="#1-2-6-SetmealController" class="headerlink" title="1.2.6 SetmealController"></a>1.2.6 SetmealController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¥—é¤ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/setmeal&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å¥—é¤ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SetmealController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealService setmealService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–°å¢å¥—é¤&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> SetmealDTO setmealDTO)</span> &#123;</span><br><span class="line">        setmealService.saveWithDish(setmealDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-7-SetmealService"><a href="#1-2-7-SetmealService" class="headerlink" title="1.2.7 SetmealService"></a>1.2.7 SetmealService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SetmealService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å¥—é¤ï¼ŒåŒæ—¶éœ€è¦ä¿å­˜å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveWithDish</span><span class="params">(SetmealDTO setmealDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-8-SetmealServiceImpl"><a href="#1-2-8-SetmealServiceImpl" class="headerlink" title="1.2.8 SetmealServiceImpl"></a>1.2.8 SetmealServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¥—é¤ä¸šåŠ¡å®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SetmealServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SetmealService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealMapper setmealMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealDishMapper setmealDishMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å¥—é¤ï¼ŒåŒæ—¶éœ€è¦ä¿å­˜å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveWithDish</span><span class="params">(SetmealDTO setmealDTO)</span> &#123;</span><br><span class="line">        <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Setmeal</span>();</span><br><span class="line">        BeanUtils.copyProperties(setmealDTO, setmeal);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘å¥—é¤è¡¨æ’å…¥æ•°æ®</span></span><br><span class="line">        setmealMapper.insert(setmeal);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ç”Ÿæˆçš„å¥—é¤id</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">setmealId</span> <span class="operator">=</span> setmeal.getId();</span><br><span class="line"></span><br><span class="line">        List&lt;SetmealDish&gt; setmealDishes = setmealDTO.getSetmealDishes();</span><br><span class="line">        setmealDishes.forEach(setmealDish -&gt; &#123;</span><br><span class="line">            setmealDish.setSetmealId(setmealId);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line">        setmealDishMapper.insertBatch(setmealDishes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-9-SetmealMapper"><a href="#1-2-9-SetmealMapper" class="headerlink" title="1.2.9 SetmealMapper"></a>1.2.9 SetmealMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmeal</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@AutoFill(OperationType.INSERT)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Setmeal setmeal)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-10-SetmealMapper-xml"><a href="#1-2-10-SetmealMapper-xml" class="headerlink" title="1.2.10 SetmealMapper.xml"></a>1.2.10 SetmealMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Setmeal&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">    insert into setmeal</span><br><span class="line">    (category_id, name, price, status, description, image, create_time, update_time, create_user, update_user)</span><br><span class="line">    values (#&#123;categoryId&#125;, #&#123;name&#125;, #&#123;price&#125;, #&#123;status&#125;, #&#123;description&#125;, #&#123;image&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;,</span><br><span class="line">    #&#123;createUser&#125;, #&#123;updateUser&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="1-2-11-SetmealDishMapper"><a href="#1-2-11-SetmealDishMapper" class="headerlink" title="1.2.11 SetmealDishMapper"></a>1.2.11 SetmealDishMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡ä¿å­˜å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDishes</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">insertBatch</span><span class="params">(List&lt;SetmealDish&gt; setmealDishes)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-12-SetmealDishMapper-xml"><a href="#1-2-12-SetmealDishMapper-xml" class="headerlink" title="1.2.12 SetmealDishMapper.xml"></a>1.2.12 SetmealDishMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    insert into setmeal_dish</span><br><span class="line">    (setmeal_id,dish_id,name,price,copies)</span><br><span class="line">    values</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;setmealDishes&quot;</span> <span class="attr">item</span>=<span class="string">&quot;sd&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (#&#123;sd.setmealId&#125;,#&#123;sd.dishId&#125;,#&#123;sd.name&#125;,#&#123;sd.price&#125;,#&#123;sd.copies&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3-åŠŸèƒ½æµ‹è¯•"><a href="#1-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="1.3 åŠŸèƒ½æµ‹è¯•"></a>1.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="2-å¥—é¤åˆ†é¡µæŸ¥è¯¢"><a href="#2-å¥—é¤åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="2. å¥—é¤åˆ†é¡µæŸ¥è¯¢"></a>2. å¥—é¤åˆ†é¡µæŸ¥è¯¢</h2><h3 id="2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#2-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>2.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018152429246.png" alt="image-20221018152429246"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>æ ¹æ®é¡µç è¿›è¡Œåˆ†é¡µå±•ç¤º</li>
<li>æ¯é¡µå±•ç¤º10æ¡æ•°æ®</li>
<li>å¯ä»¥æ ¹æ®éœ€è¦ï¼ŒæŒ‰ç…§å¥—é¤åç§°ã€åˆ†ç±»ã€å”®å–çŠ¶æ€è¿›è¡ŒæŸ¥è¯¢</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018152731141.png" alt="image-20221018152731141"></p>
<h3 id="2-2-ä»£ç å®ç°"><a href="#2-2-ä»£ç å®ç°" class="headerlink" title="2.2 ä»£ç å®ç°"></a>2.2 ä»£ç å®ç°</h3><h4 id="2-2-1-SetmealController"><a href="#2-2-1-SetmealController" class="headerlink" title="2.2.1 SetmealController"></a>2.2.1 SetmealController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;åˆ†é¡µæŸ¥è¯¢&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">page</span><span class="params">(SetmealPageQueryDTO setmealPageQueryDTO)</span> &#123;</span><br><span class="line">    <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> setmealService.pageQuery(setmealPageQueryDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-2-SetmealService"><a href="#2-2-2-SetmealService" class="headerlink" title="2.2.2 SetmealService"></a>2.2.2 SetmealService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">PageResult <span class="title function_">pageQuery</span><span class="params">(SetmealPageQueryDTO setmealPageQueryDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-SetmealServiceImpl"><a href="#2-2-3-SetmealServiceImpl" class="headerlink" title="2.2.3 SetmealServiceImpl"></a>2.2.3 SetmealServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> PageResult <span class="title function_">pageQuery</span><span class="params">(SetmealPageQueryDTO setmealPageQueryDTO)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">pageNum</span> <span class="operator">=</span> setmealPageQueryDTO.getPage();</span><br><span class="line">    <span class="type">int</span> <span class="variable">pageSize</span> <span class="operator">=</span> setmealPageQueryDTO.getPageSize();</span><br><span class="line"></span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    Page&lt;SetmealVO&gt; page = setmealMapper.pageQuery(setmealPageQueryDTO);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>(page.getTotal(), page.getResult());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-4-SetmealMapper"><a href="#2-2-4-SetmealMapper" class="headerlink" title="2.2.4 SetmealMapper"></a>2.2.4 SetmealMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">Page&lt;SetmealVO&gt; <span class="title function_">pageQuery</span><span class="params">(SetmealPageQueryDTO setmealPageQueryDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-5-SetmealMapper-xml"><a href="#2-2-5-SetmealMapper-xml" class="headerlink" title="2.2.5 SetmealMapper.xml"></a>2.2.5 SetmealMapper.xml</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;pageQuery&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sky.vo.SetmealVO&quot;</span>&gt;</span></span><br><span class="line">    select</span><br><span class="line">    	s.*,c.name categoryName</span><br><span class="line">    from</span><br><span class="line">    	setmeal s</span><br><span class="line">    left join</span><br><span class="line">    	category c</span><br><span class="line">    on</span><br><span class="line">    	s.category_id = c.id</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span></span><br><span class="line">            and s.name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span></span><br><span class="line">            and s.status = #&#123;status&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;categoryId != null&quot;</span>&gt;</span></span><br><span class="line">            and s.category_id = #&#123;categoryId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">    order by s.create_time desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-åŠŸèƒ½æµ‹è¯•"><a href="#2-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="2.3 åŠŸèƒ½æµ‹è¯•"></a>2.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="3-åˆ é™¤å¥—é¤"><a href="#3-åˆ é™¤å¥—é¤" class="headerlink" title="3. åˆ é™¤å¥—é¤"></a>3. åˆ é™¤å¥—é¤</h2><h3 id="3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#3-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>3.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018153756531.png" alt="image-20221018153756531"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¯ä»¥ä¸€æ¬¡åˆ é™¤ä¸€ä¸ªå¥—é¤ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡åˆ é™¤å¥—é¤</li>
<li>èµ·å”®ä¸­çš„å¥—é¤ä¸èƒ½åˆ é™¤</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018154541067.png" alt="image-20221018154541067"></p>
<h3 id="3-2-ä»£ç å®ç°"><a href="#3-2-ä»£ç å®ç°" class="headerlink" title="3.2 ä»£ç å®ç°"></a>3.2 ä»£ç å®ç°</h3><h4 id="3-2-1-SetmealController"><a href="#3-2-1-SetmealController" class="headerlink" title="3.2.1 SetmealController"></a>3.2.1 SetmealController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡åˆ é™¤å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ‰¹é‡åˆ é™¤å¥—é¤&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;Long&gt; ids)</span>&#123;</span><br><span class="line">    setmealService.deleteBatch(ids);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-2-SetmealService"><a href="#3-2-2-SetmealService" class="headerlink" title="3.2.2 SetmealService"></a>3.2.2 SetmealService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡åˆ é™¤å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteBatch</span><span class="params">(List&lt;Long&gt; ids)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-3-SetmealServiceImpl"><a href="#3-2-3-SetmealServiceImpl" class="headerlink" title="3.2.3 SetmealServiceImpl"></a>3.2.3 SetmealServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡åˆ é™¤å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBatch</span><span class="params">(List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">    ids.forEach(id -&gt; &#123;</span><br><span class="line">        <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> setmealMapper.getById(id);</span><br><span class="line">        <span class="keyword">if</span>(StatusConstant.ENABLE == setmeal.getStatus())&#123;</span><br><span class="line">            <span class="comment">//èµ·å”®ä¸­çš„å¥—é¤ä¸èƒ½åˆ é™¤</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DeletionNotAllowedException</span>(MessageConstant.SETMEAL_ON_SALE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    ids.forEach(setmealId -&gt; &#123;</span><br><span class="line">        <span class="comment">//åˆ é™¤å¥—é¤è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">        setmealMapper.deleteById(setmealId);</span><br><span class="line">        <span class="comment">//åˆ é™¤å¥—é¤èœå“å…³ç³»è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">        setmealDishMapper.deleteBySetmealId(setmealId);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-4-SetmealMapper"><a href="#3-2-4-SetmealMapper" class="headerlink" title="3.2.4 SetmealMapper"></a>3.2.4 SetmealMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from setmeal where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">Setmeal <span class="title function_">getById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idåˆ é™¤å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealId</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from setmeal where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long setmealId)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-5-SetmealDishMapper"><a href="#3-2-5-SetmealDishMapper" class="headerlink" title="3.2.5 SetmealDishMapper"></a>3.2.5 SetmealDishMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®å¥—é¤idåˆ é™¤å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealId</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Delete(&quot;delete from setmeal_dish where setmeal_id = #&#123;setmealId&#125;&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">deleteBySetmealId</span><span class="params">(Long setmealId)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-åŠŸèƒ½æµ‹è¯•"><a href="#3-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="3.3 åŠŸèƒ½æµ‹è¯•"></a>3.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="4-ä¿®æ”¹å¥—é¤"><a href="#4-ä¿®æ”¹å¥—é¤" class="headerlink" title="4. ä¿®æ”¹å¥—é¤"></a>4. ä¿®æ”¹å¥—é¤</h2><h3 id="4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#4-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>4.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018160214225.png" alt="image-20221018160214225"></p>
<p>æ¥å£è®¾è®¡ï¼ˆå…±æ¶‰åŠåˆ°5ä¸ªæ¥å£ï¼‰ï¼š</p>
<ul>
<li>æ ¹æ®idæŸ¥è¯¢å¥—é¤</li>
<li>æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†ç±»ï¼ˆå·²å®Œæˆï¼‰</li>
<li>æ ¹æ®åˆ†ç±»idæŸ¥è¯¢èœå“ï¼ˆå·²å®Œæˆï¼‰</li>
<li>å›¾ç‰‡ä¸Šä¼ ï¼ˆå·²å®Œæˆï¼‰</li>
<li>ä¿®æ”¹å¥—é¤</li>
</ul>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018160915177.png" alt="image-20221018160915177"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018160949864.png" alt="image-20221018160949864"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018161046352.png" alt="image-20221018161046352"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018161117780.png" alt="image-20221018161117780"></p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018161139861.png" alt="image-20221018161139861"></p>
<h3 id="4-2-ä»£ç å®ç°"><a href="#4-2-ä»£ç å®ç°" class="headerlink" title="4.2 ä»£ç å®ç°"></a>4.2 ä»£ç å®ç°</h3><h4 id="4-2-1-SetmealController"><a href="#4-2-1-SetmealController" class="headerlink" title="4.2.1 SetmealController"></a>4.2.1 SetmealController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢å¥—é¤ï¼Œç”¨äºä¿®æ”¹é¡µé¢å›æ˜¾æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢å¥—é¤&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;SetmealVO&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> &#123;</span><br><span class="line">    <span class="type">SetmealVO</span> <span class="variable">setmealVO</span> <span class="operator">=</span> setmealService.getByIdWithDish(id);</span><br><span class="line">    <span class="keyword">return</span> Result.success(setmealVO);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹å¥—é¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;ä¿®æ”¹å¥—é¤&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SetmealDTO setmealDTO)</span> &#123;</span><br><span class="line">    setmealService.update(setmealDTO);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-SetmealService"><a href="#4-2-2-SetmealService" class="headerlink" title="4.2.2 SetmealService"></a>4.2.2 SetmealService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢å¥—é¤å’Œå…³è”çš„èœå“æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">SetmealVO <span class="title function_">getByIdWithDish</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹å¥—é¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">update</span><span class="params">(SetmealDTO setmealDTO)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-SetmealServiceImpl"><a href="#4-2-3-SetmealServiceImpl" class="headerlink" title="4.2.3 SetmealServiceImpl"></a>4.2.3 SetmealServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢å¥—é¤å’Œå¥—é¤èœå“å…³ç³»</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> SetmealVO <span class="title function_">getByIdWithDish</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> setmealMapper.getById(id);</span><br><span class="line">    List&lt;SetmealDish&gt; setmealDishes = setmealDishMapper.getBySetmealId(id);</span><br><span class="line"></span><br><span class="line">    <span class="type">SetmealVO</span> <span class="variable">setmealVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SetmealVO</span>();</span><br><span class="line">    BeanUtils.copyProperties(setmeal, setmealVO);</span><br><span class="line">    setmealVO.setSetmealDishes(setmealDishes);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> setmealVO;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹å¥—é¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealDTO</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(SetmealDTO setmealDTO)</span> &#123;</span><br><span class="line">    <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Setmeal</span>();</span><br><span class="line">    BeanUtils.copyProperties(setmealDTO, setmeal);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1ã€ä¿®æ”¹å¥—é¤è¡¨ï¼Œæ‰§è¡Œupdate</span></span><br><span class="line">    setmealMapper.update(setmeal);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¥—é¤id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">setmealId</span> <span class="operator">=</span> setmealDTO.getId();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2ã€åˆ é™¤å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»ï¼Œæ“ä½œsetmeal_dishè¡¨ï¼Œæ‰§è¡Œdelete</span></span><br><span class="line">    setmealDishMapper.deleteBySetmealId(setmealId);</span><br><span class="line"></span><br><span class="line">    List&lt;SetmealDish&gt; setmealDishes = setmealDTO.getSetmealDishes();</span><br><span class="line">    setmealDishes.forEach(setmealDish -&gt; &#123;</span><br><span class="line">        setmealDish.setSetmealId(setmealId);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//3ã€é‡æ–°æ’å…¥å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»ï¼Œæ“ä½œsetmeal_dishè¡¨ï¼Œæ‰§è¡Œinsert</span></span><br><span class="line">    setmealDishMapper.insertBatch(setmealDishes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4-SetmealDishMapper"><a href="#4-2-4-SetmealDishMapper" class="headerlink" title="4.2.4 SetmealDishMapper"></a>4.2.4 SetmealDishMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ ¹æ®å¥—é¤idæŸ¥è¯¢å¥—é¤å’Œèœå“çš„å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> setmealId</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Select(&quot;select * from setmeal_dish where setmeal_id = #&#123;setmealId&#125;&quot;)</span></span><br><span class="line">   List&lt;SetmealDish&gt; <span class="title function_">getBySetmealId</span><span class="params">(Long setmealId)</span>;</span><br></pre></td></tr></table></figure>



<h3 id="4-3-åŠŸèƒ½æµ‹è¯•"><a href="#4-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="4.3 åŠŸèƒ½æµ‹è¯•"></a>4.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
<h2 id="5-èµ·å”®åœå”®å¥—é¤"><a href="#5-èµ·å”®åœå”®å¥—é¤" class="headerlink" title="5. èµ·å”®åœå”®å¥—é¤"></a>5. èµ·å”®åœå”®å¥—é¤</h2><h3 id="5-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#5-1-éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="5.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>5.1 éœ€æ±‚åˆ†æå’Œè®¾è®¡</h3><p>äº§å“åŸå‹ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018163720881.png" alt="image-20221018163720881"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¯ä»¥å¯¹çŠ¶æ€ä¸ºèµ·å”®çš„å¥—é¤è¿›è¡Œåœå”®æ“ä½œï¼Œå¯ä»¥å¯¹çŠ¶æ€ä¸ºåœå”®çš„å¥—é¤è¿›è¡Œèµ·å”®æ“ä½œ</li>
<li>èµ·å”®çš„å¥—é¤å¯ä»¥å±•ç¤ºåœ¨ç”¨æˆ·ç«¯ï¼Œåœå”®çš„å¥—é¤ä¸èƒ½å±•ç¤ºåœ¨ç”¨æˆ·ç«¯</li>
<li>èµ·å”®å¥—é¤æ—¶ï¼Œå¦‚æœå¥—é¤å†…åŒ…å«åœå”®çš„èœå“ï¼Œåˆ™ä¸èƒ½èµ·å”®</li>
</ul>
<p>æ¥å£è®¾è®¡ï¼š</p>
<p><img src="/2024/02/24/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day04-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/image-20221018165055208.png" alt="image-20221018165055208"></p>
<h3 id="5-2-ä»£ç å®ç°"><a href="#5-2-ä»£ç å®ç°" class="headerlink" title="5.2 ä»£ç å®ç°"></a>5.2 ä»£ç å®ç°</h3><h4 id="5-2-1-SetmealController"><a href="#5-2-1-SetmealController" class="headerlink" title="5.2.1 SetmealController"></a>5.2.1 SetmealController</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¥—é¤èµ·å”®åœå”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å¥—é¤èµ·å”®åœå”®&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">startOrStop</span><span class="params">(<span class="meta">@PathVariable</span> Integer status, Long id)</span> &#123;</span><br><span class="line">    setmealService.startOrStop(status, id);</span><br><span class="line">    <span class="keyword">return</span> Result.success();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-2-SetmealService"><a href="#5-2-2-SetmealService" class="headerlink" title="5.2.2 SetmealService"></a>5.2.2 SetmealService</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¥—é¤èµ·å”®ã€åœå”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">startOrStop</span><span class="params">(Integer status, Long id)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-3-SetmealServiceImpl"><a href="#5-2-3-SetmealServiceImpl" class="headerlink" title="5.2.3 SetmealServiceImpl"></a>5.2.3 SetmealServiceImpl</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¥—é¤èµ·å”®ã€åœå”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startOrStop</span><span class="params">(Integer status, Long id)</span> &#123;</span><br><span class="line">    <span class="comment">//èµ·å”®å¥—é¤æ—¶ï¼Œåˆ¤æ–­å¥—é¤å†…æ˜¯å¦æœ‰åœå”®èœå“ï¼Œæœ‰åœå”®èœå“æç¤º&quot;å¥—é¤å†…åŒ…å«æœªå¯å”®èœå“ï¼Œæ— æ³•å¯å”®&quot;</span></span><br><span class="line">    <span class="keyword">if</span>(status == StatusConstant.ENABLE)&#123;</span><br><span class="line">        <span class="comment">//select a.* from dish a left join setmeal_dish b on a.id = b.dish_id where b.setmeal_id = ?</span></span><br><span class="line">        List&lt;Dish&gt; dishList = dishMapper.getBySetmealId(id);</span><br><span class="line">        <span class="keyword">if</span>(dishList != <span class="literal">null</span> &amp;&amp; dishList.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            dishList.forEach(dish -&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span>(StatusConstant.DISABLE == dish.getStatus())&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SetmealEnableFailedException</span>(MessageConstant.SETMEAL_ENABLE_FAILED);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">Setmeal</span> <span class="variable">setmeal</span> <span class="operator">=</span> Setmeal.builder()</span><br><span class="line">        .id(id)</span><br><span class="line">        .status(status)</span><br><span class="line">        .build();</span><br><span class="line">    setmealMapper.update(setmeal);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-4-DishMapper"><a href="#5-2-4-DishMapper" class="headerlink" title="5.2.4 DishMapper"></a>5.2.4 DishMapper</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®å¥—é¤idæŸ¥è¯¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> setmealId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Select(&quot;select a.* from dish a left join setmeal_dish b on a.id = b.dish_id where b.setmeal_id = #&#123;setmealId&#125;&quot;)</span></span><br><span class="line">List&lt;Dish&gt; <span class="title function_">getBySetmealId</span><span class="params">(Long setmealId)</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-åŠŸèƒ½æµ‹è¯•"><a href="#5-3-åŠŸèƒ½æµ‹è¯•" class="headerlink" title="5.3 åŠŸèƒ½æµ‹è¯•"></a>5.3 åŠŸèƒ½æµ‹è¯•</h3><p>ç•¥</p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day03-èœå“ç®¡ç†</title>
    <url>/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<h1 id="é—®é¢˜åˆ†æå’Œå®ç°æ€è·¯"><a href="#é—®é¢˜åˆ†æå’Œå®ç°æ€è·¯" class="headerlink" title="é—®é¢˜åˆ†æå’Œå®ç°æ€è·¯"></a>é—®é¢˜åˆ†æå’Œå®ç°æ€è·¯</h1><p>å…·ä½“è¦æ±‚ï¼šæ–°å»ºèœå“ã€ä¿®æ”¹èœå“ã€åˆ é™¤èœå“ã€å¯ç”¨ç¦ç”¨èœå“ï¼Œèœå“åˆ†é¡µæŸ¥è¯¢</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221223949538.png" alt="image-20240221223949538"></p>
<h1 id="å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……"><a href="#å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……" class="headerlink" title="å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……"></a>å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……</h1><h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p>ä¸šåŠ¡è¡¨ä¸­çš„å…¬å…±å­—æ®µï¼š</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221224200823.png" alt="image-20240221224200823"></p>
<p>å‰é¢è¯¾ç¨‹å¼€å‘çš„å‘˜å·¥ç®¡ç†æ¨¡å—å’Œç›´æ¥å¯¼å…¥çš„åˆ†ç±»ç®¡ç†æ¨¡å—ï¼Œå¯¹åº”ä¸¤å¼ è¡¨ï¼Œä¸€ä¸ªæ˜¯å‘˜å·¥è¡¨ï¼Œä¸€ä¸ªæ˜¯åˆ†ç±»è¡¨ï¼Œä¸¤ä¸ªè¡¨ä¸­éƒ½æœ‰è¿™å››ä¸ªå­—æ®µã€‚èœå“è¡¨ï¼Œå¥—é¤è¡¨è¿™äº›ä¸šåŠ¡è¡¨ä¸­éƒ½æœ‰è¿™å‡ ä¸ªå…¬å…±å­—æ®µï¼Œå½“æˆ‘ä»¬å‘è¿™äº›è¡¨ä¸­æ’å…¥æ•°æ®æ—¶ï¼Œéœ€è¦ä¸ºè¿™äº›å…¬å…±å­—æ®µèµ‹å€¼ã€‚å³å¾ˆæœ‰å¯èƒ½ä¼šå¤šæ¬¡çœ‹åˆ°è¿™ç§ä»£ç ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221224523173.png" alt="image-20240221224523173">\</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221224605012.png" alt="image-20240221224605012"></p>
<p><font color="red">åœ¨ç¨‹åºä¸­å­˜åœ¨å†—ä½™çš„ä»£ç ï¼Œå¦‚æœåæœŸè¡¨ç»“æ„å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™éƒ¨åˆ†çš„ä»£ç éƒ½è¦ä¿®æ”¹ã€‚ç°åœ¨é—®é¢˜æ˜¯ï¼šä¸šåŠ¡è¡¨ä¸­å­˜åœ¨å…¬å…±å­—æ®µï¼Œå¯¼è‡´Javaä»£ç ä¸­å­˜åœ¨å†—ä½™çš„ä»£ç ï¼ŒåæœŸå¦‚æœå‘ç”Ÿå˜æ›´ï¼Œä»£ç ç»´æŠ¤å¤æ‚ã€‚</font></p>
<h2 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h2><ol>
<li><p>æ˜ç¡®å…¬å…±å­—æ®µåœ¨ä»€ä¹ˆæ“ä½œç±»å‹ä¸‹ä¼šè¢«ä¿®æ”¹ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221224853616.png" alt="image-20240221224853616"></p>
</li>
<li><p>å¯¹äºå…¬å…±å­—æ®µï¼Œè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ‡é¢çš„æ–¹å¼å¤„ç†å…¬å…±å­—æ®µã€‚é€šè¿‡åˆ‡é¢æ‹¦æˆªMapperå±‚ï¼Œç»Ÿä¸€ä¸ºå…¶èµ‹å€¼ã€‚ä½†æ˜¯Mapperå±‚è¿˜æœ‰å…¶ä»–æ–¹æ³•æ˜¯ä¸éœ€è¦åˆ‡é¢æ‹¦æˆªçš„ï¼Œä¾‹å¦‚Selectã€‚é€šè¿‡å®šä¹‰æ³¨è§£ï¼Œè¡¨ç¤ºå½“å‰æ–¹æ³•éœ€è¦è¢«æ‹¦æˆªï¼Œéœ€è¦ä¸ºè¿™å‡ ä¸ªå…¬å…±å­—æ®µèµ‹å€¼ï¼Œå¦‚æœä¸åŠ ï¼Œåˆ™ä¸éœ€è¦å¤„ç†ã€‚</p>
</li>
</ol>
<p><strong>è§£å†³åŠæ³•</strong></p>
<ul>
<li>è‡ªå®šä¹‰æ³¨è§£AutoFillï¼Œç”¨äºæ ‡è¯†éœ€è¦è¿›è¡Œå…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……çš„æ–¹æ³•</li>
<li>è‡ªå®šä¹‰åˆ‡é¢ç±»AutoFillAspectï¼Œç»Ÿä¸€æ‹¦æˆªåŠ å…¥äº†AutoFillæ³¨è§£çš„æ–¹æ³•ï¼Œé€šè¿‡åå°„ä¸ºå…¬å…±å­—æ®µèµ‹å€¼</li>
<li>åœ¨Mapperçš„æ–¹æ³•ä¸ŠåŠ ä¸ŠAutoFillæ³¨è§£</li>
</ul>
<p>æŠ€æœ¯ç‚¹ï¼šæšä¸¾ã€æ³¨è§£ã€AOPã€åå°„</p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><ol>
<li><p>åˆ›å»ºè‡ªå®šä¹‰æ³¨è§£AutoFill</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰æ³¨è§£ï¼Œç”¨äºæ ‡è¯†æŸä¸ªæ–¹æ³•éœ€è¦è¿›è¡ŒåŠŸèƒ½å­—æ®µè‡ªåŠ¨å¡«å……å¤„ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AutoFill &#123;</span><br><span class="line">    <span class="comment">//æ•°æ®åº“æ“ä½œç±»å‹</span></span><br><span class="line">    OperationType <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221231935143.png" alt="image-20240221231935143"></p>
</li>
<li><p>å®ç°è‡ªå®šä¹‰åˆ‡é¢ç±»ï¼ˆåŠ ä¸Š@Aspectæ³¨è§£ç¡®å®šä»–æ˜¯åˆ‡é¢ç±»ï¼Œè®¾ç½®@PointCutï¼ŒæŒ‡å®šä»£æ‹¦æˆªçš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰åˆ‡é¢ï¼Œå®ç°å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……å¤„ç†é€»è¾‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span> <span class="comment">//log</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//äº¤ç”±IOCå®¹å™¨çš„Beanå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoFillAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡å®šåˆ‡å…¥ç‚¹ï¼ˆå¯¹å“ªäº›ç±»çš„å“ªäº›æ–¹æ³•æŒ‡å®šï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span>  <span class="comment">//æ‹¦æˆªmapperåŒ…ä¸‹æ‰€æœ‰ç±»å’Œæ¥å£çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFillPointCut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‰ç½®é€šçŸ¥ï¼Œåœ¨é€šçŸ¥ä¸­è¿›è¡Œå…¬å…±å­—æ®µçš„èµ‹å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before(&quot;autoFillPointCut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFill</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¼€å§‹è¿›è¡Œå…¬å…±å­—æ®µçš„è‡ªåŠ¨å¡«å……...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»™å¾…æµ‹è¯•çš„æ–¹æ³•insertå’Œupdateåˆ†åˆ«åŠ ä¸Š@AutoFillå­—æ®µï¼Œä½¿å…¶æˆä¸ºAOPçš„æ‹¦æˆªæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.image.RescaleOp;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥å‘˜å·¥æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into employee (name, username, password, phone, sex, id_number, create_time, update_time, create_user, update_user) &quot; +</span></span><br><span class="line"><span class="meta">        &quot;values(#&#123;name&#125;,#&#123;username&#125;,#&#123;password&#125;,#&#123;phone&#125;,#&#123;sex&#125;,#&#123;idNumber&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;,#&#123;createUser&#125;,#&#123;updateUser&#125;)&quot;)</span></span><br><span class="line">    <span class="meta">@AutoFill(value = OperationType.INSERT)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸»é”®åŠ¨æ€ä¿®æ”¹å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AutoFill(value = OperationType.UPDATE)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å‰åç«¯è”è°ƒæµ‹è¯•</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240221233716527.png" alt="image-20240221233716527"></p>
</li>
</ol>
<p>autoFillå‰ç½®é€šçŸ¥æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œæ‹¦æˆªäº†@PointCutè®¾ç½®çš„ç¬¦åˆæ¡ä»¶çš„mapperæ–¹æ³•ï¼ˆåŠ äº†@AutoFillæ³¨è§£ï¼‰ã€‚</p>
<p>åœ¨åˆ‡é¢ç±»ä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;autoFillPointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFill</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;å¼€å§‹è¿›è¡Œå…¬å…±å­—æ®µçš„è‡ªåŠ¨å¡«å……...&quot;</span>);</span><br><span class="line">    <span class="comment">//è·å–å½“å‰è¢«æ‹¦æˆªçš„æ–¹æ³•ä¸Šçš„æ•°æ®åº“æ“ä½œç±»å‹ï¼ˆè¿™ä¸ªæ•°æ®åº“æ“ä½œç±»å‹åŠ è½½@AutoFillæ³¨è§£çš„valueå±æ€§ä¸Šï¼‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çš„å…·ä½“ç¼–å†™æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li>è·å–å½“å‰è¢«æ‹¦æˆªçš„æ–¹æ³•çš„æ•°æ®åº“çš„æ“ä½œç±»å‹</li>
<li>è·å–åˆ°æ–¹æ³•çš„å‚æ•°ï¼ˆå®ä½“ç±»ï¼Œå¯ä»¥æ˜¯å‘˜å·¥å®ä½“ï¼Œåˆ†ç±»å®ä½“ï¼Œå¥—é¤å®ä½“ï¼Œèœå“å®ä½“ï¼‰</li>
<li>å‡†å¤‡å¾…èµ‹å€¼çš„æ•°æ®ï¼Œä¸ºå®ä½“å¯¹è±¡èµ‹å€¼ï¼ˆæœ‰createTimeï¼ŒupdateTimeï¼ŒcreateUserï¼ŒupdateUserï¼‰</li>
<li>æ ¹æ®å½“å‰ä¸åŒçš„æ“ä½œç±»å‹ï¼Œä¸ºå¯¹åº”çš„å±æ€§èµ‹å€¼ï¼ˆé€šè¿‡åå°„ï¼‰</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.AutoFillConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.Signature;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.reflect.MethodSignature;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰åˆ‡é¢ï¼Œå®ç°å…¬å…±å­—æ®µè‡ªåŠ¨å¡«å……å¤„ç†é€»è¾‘</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span> <span class="comment">//log</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//åˆ‡é¢ç±»</span></span><br><span class="line"><span class="meta">@Component</span> <span class="comment">//äº¤ç”±IOCå®¹å™¨çš„Beanå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoFillAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡å®šåˆ‡å…¥ç‚¹ï¼ˆå¯¹å“ªäº›ç±»çš„å“ªäº›æ–¹æ³•æŒ‡å®šï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span>  <span class="comment">//æ‹¦æˆªmapperåŒ…ä¸‹æ‰€æœ‰ç±»å’Œæ¥å£çš„æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFillPointCut</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‰ç½®é€šçŸ¥ï¼Œåœ¨é€šçŸ¥ä¸­è¿›è¡Œå…¬å…±å­—æ®µçš„èµ‹å€¼ï¼Œè¿™ä¸ªåˆ‡é¢çš„æ‰§è¡Œä¼šç›´æ¥ä¿®æ”¹é€šè¿‡è¿™äº›mapperæ–¹æ³•ä¼ é€’çš„å‚æ•°å®ä½“ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before(&quot;autoFillPointCut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">autoFill</span><span class="params">(JoinPoint joinPoint)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¼€å§‹è¿›è¡Œå…¬å…±å­—æ®µçš„è‡ªåŠ¨å¡«å……...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*        Signature signature = joinPoint.getSignature(); //è·å–ç›®æ ‡æ–¹æ³•ç­¾å</span></span><br><span class="line"><span class="comment">        String name = joinPoint.getSignature().getName();</span></span><br><span class="line"><span class="comment">        Object[] args = joinPoint.getArgs();</span></span><br><span class="line"><span class="comment">        System.out.println(signature);</span></span><br><span class="line"><span class="comment">        System.out.println(name);</span></span><br><span class="line"><span class="comment">        System.out.println(args);*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        1. è·å–å½“å‰è¢«æ‹¦æˆªçš„æ–¹æ³•çš„æ•°æ®åº“çš„æ“ä½œç±»å‹ï¼ˆä¸Šé¢æ˜¯åå°„åŒ…çš„ç›¸å…³ä»£ç ï¼Œå¯è¯»æ€§ç›¸å¯¹å·®ä¸€äº›ï¼‰</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature(); <span class="comment">//æ–¹æ³•ç­¾åå¯¹è±¡</span></span><br><span class="line"><span class="comment">//        void com.sky.mapper.EmployeeMapper.update(Employee)</span></span><br><span class="line"><span class="comment">//        System.out.println(signature);</span></span><br><span class="line">        <span class="type">AutoFill</span> <span class="variable">autoFill</span> <span class="operator">=</span> signature.getMethod().getAnnotation(AutoFill.class);  <span class="comment">//è·å¾—æ–¹æ³•ä¸Šçš„æ³¨è§£å¯¹è±¡</span></span><br><span class="line"><span class="comment">//        System.out.println(autoFill);</span></span><br><span class="line"><span class="comment">//        @com.sky.annotation.AutoFill(UPDATE)</span></span><br><span class="line">        <span class="type">OperationType</span> <span class="variable">operationType</span> <span class="operator">=</span> autoFill.value(); <span class="comment">//è·å¾—æ•°æ®åº“æ“ä½œç±»å‹</span></span><br><span class="line"><span class="comment">//        System.out.println(operationType);</span></span><br><span class="line"><span class="comment">//        UPDATE</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//        2. è·å–åˆ°æ–¹æ³•çš„å‚æ•°ï¼ˆå®ä½“ç±»ï¼Œå¯ä»¥æ˜¯å‘˜å·¥å®ä½“ï¼Œåˆ†ç±»å®ä½“ï¼Œå¥—é¤å®ä½“ï¼Œèœå“å®ä½“ï¼‰ï¼Œç¡®ä¿å®ä½“ç±»å¯¹è±¡æ”¾åœ¨ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line"><span class="comment">//        System.out.println(args);</span></span><br><span class="line"><span class="comment">//        [Ljava.lang.Object;@6f17c9e0</span></span><br><span class="line"><span class="comment">//        System.out.println(&quot;\n\n&quot;);</span></span><br><span class="line">        <span class="keyword">if</span>(args == <span class="literal">null</span> &amp;&amp; args.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">entity</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(args[0]);</span></span><br><span class="line"><span class="comment">//        Employee(id=8, username=wangwu, name=ç‹äº”, password=null, phone=15988853410, sex=1, idNumber=112233445566778989, status=null, createTime=null, updateTime=2024-02-22T12:08:43.927707700, createUser=null, updateUser=1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        3. å‡†å¤‡å¾…èµ‹å€¼çš„æ•°æ®ï¼Œä¸ºå®ä½“å¯¹è±¡èµ‹å€¼ï¼ˆæœ‰createTimeï¼ŒupdateTimeï¼ŒcreateUserï¼ŒupdateUserï¼‰</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">now</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">currentId</span> <span class="operator">=</span> BaseContext.getCurrentId();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        4. æ ¹æ®å½“å‰ä¸åŒçš„æ“ä½œç±»å‹ï¼Œä¸ºå¯¹åº”çš„å±æ€§èµ‹å€¼ï¼ˆé€šè¿‡åå°„ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span>(operationType == OperationType.INSERT)&#123;</span><br><span class="line">            <span class="comment">//ä¸º4ä¸ªå…¬å…±å­—æ®µèµ‹å€¼</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//ç›´æ¥ç”¨æ–¹æ³•åå»å–methodï¼Œæ˜¯ç¡¬ç¼–ç ï¼Œå¦‚æœè·å–çš„ç±»æ–¹æ³•å‘ç”Ÿäº†å˜åŒ–ï¼Œæ•´ä¸ªä»£ç å°±è¦é‡æ„</span></span><br><span class="line">                <span class="comment">//ä½¿ç”¨ç±»å¸¸é‡å‘½åï¼Œé˜²æ­¢æ‰‹æ•²å‡ºé”™</span></span><br><span class="line">                <span class="type">Method</span> <span class="variable">setCreateTime</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_TIME, LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">setCreateUser</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_USER, Long.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">setUpdateTime</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">setUpdateUser</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//é€šè¿‡åå°„ä¸ºå¯¹è±¡å±æ€§èµ‹å€¼</span></span><br><span class="line">                setCreateTime.invoke(entity,now);</span><br><span class="line">                setUpdateTime.invoke(entity,now);</span><br><span class="line">                setCreateUser.invoke(entity,currentId);</span><br><span class="line">                setUpdateUser.invoke(entity,currentId);</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(operationType == OperationType.UPDATE)&#123;</span><br><span class="line">            <span class="comment">//ä¸º2ä¸ªå…¬å…±å­—æ®µèµ‹å€¼</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Method</span> <span class="variable">setUpdateTime</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">setUpdateUser</span> <span class="operator">=</span> entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//é€šè¿‡åå°„ä¸ºå¯¹è±¡å±æ€§èµ‹å€¼</span></span><br><span class="line">                setUpdateTime.invoke(entity,now);</span><br><span class="line">                setUpdateUser.invoke(entity,currentId);</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†åˆ†ç±»æ¨¡å—ä¸‹çš„æ›´æ–°å’Œæ’å…¥æ–¹æ³•åŠ ä¸Š@AutoFillæ³¨è§£</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222124141927.png" alt="image-20240222124141927"></p>
<p>å°†å‘˜å·¥æ¨¡å—ä¸‹çš„æ›´æ–°å’Œæ’å…¥æ–¹æ³•åŠ ä¸Š@AutoFillæ³¨è§£</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222124243680.png" alt="image-20240222124243680"></p>
<p>ä¿®æ”¹EmpServiceImplå’ŒCategoryServiceImplä¸‹çš„å®ç°æ–¹æ³•ï¼Œæ³¨é‡Šæ‰å¯¹åº”çš„ä»£ç </p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222124454312.png" alt="image-20240222124454312"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222124620554.png" alt="image-20240222124620554"></p>
<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><strong>å‰åç«¯è”è°ƒæµ‹è¯•</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222125401691.png" alt="image-20240222125401691"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222125445984.png" alt="image-20240222125445984"></p>
<h1 id="æ–°å¢èœå“"><a href="#æ–°å¢èœå“" class="headerlink" title="æ–°å¢èœå“"></a>æ–°å¢èœå“</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹é¡µé¢</strong></p>
<p>è¦æ–°å¢ä¸€ä¸ªèœå“ï¼Œéœ€è¦å½•å…¥èœå“åç§°ã€èœå“åˆ†ç±»ï¼ˆä»åˆ†ç±»è¡¨ä¸­æŸ¥è¯¢ï¼Œå¯ä»¥è°ƒç”¨åˆ†ç±»ç®¡ç†çš„æ¥å£ï¼Œè·å–å¯¹åº”çš„æ•°æ®ï¼Œæœ€ç»ˆå±•ç¤ºåœ¨ä¸‹æ‹‰æ¡†ä¸­ï¼‰ã€èœå“ä»·æ ¼ã€å£å‘³åšæ³•é…ç½®ã€èœå“å›¾ç‰‡ã€èœå“æè¿°ï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222125801979.png" alt="image-20240222125801979"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>èœå“åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„</li>
<li>èœå“å¿…é¡»å±äºæŸä¸ªåˆ†ç±»ä¸‹ ï¼Œä¸èƒ½å•ç‹¬å­˜åœ¨</li>
<li>æ–°å¢èœå“æ—¶å¯ä»¥æ ¹æ®æƒ…å†µé€‰æ‹©èœå“çš„å“å‘³</li>
<li>æ¯ä¸ªèœå“å¿…é¡»å¯¹åº”ä¸€å¼ å›¾ç‰‡</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li><p>æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†ç±»ï¼ˆå·²å®Œæˆï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222130510250.png" alt="image-20240222130510250"></p>
</li>
<li><p>æ–‡ä»¶ä¸Šä¼ </p>
<p>è¯·æ±‚æ–¹å¼æ˜¯POSTæ–¹å¼ï¼Œè¯·æ±‚è·¯å¾„æ˜¯&#x2F;admin&#x2F;common&#x2F;uploadï¼Œå› ä¸ºæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¦åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½®é”®å€¼å¯¹ï¼ŒContent-Type:multipart&#x2F;form-dataã€‚è¿”å›æ•°æ®è¦æ±‚è¿”å›æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„urlï¼ˆå®é™…ä¸Šæ˜¯é˜¿é‡Œäº‘ç»å¯¹çš„è®¿é—®åœ°å€ï¼‰ï¼Œä¸ºä»€ä¹ˆè¦è¿”å›çš„æ˜¯urlï¼Œå› ä¸ºå¸Œæœ›è·å–urlï¼Œåœ¨é¡µé¢å›æ˜¾æ—¶æ˜¾ç¤ºè¯¥å›¾ç‰‡ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222131025056.png" alt="image-20240222131025056"></p>
</li>
<li><p>æ–°å¢èœå“</p>
<p>è¯·æ±‚æ–¹å¼æ˜¯POSTæ–¹å¼ï¼Œè¯·æ±‚åœ°å€æ˜¯&#x2F;admin&#x2F;dishï¼Œä»¥JSONæ ¼å¼æäº¤æ•°æ®ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222131851174.png" alt="image-20240222131851174"></p>
<p><strong>æ•°æ®åº“è®¾è®¡ï¼ˆdishèœå“è¡¨å’Œdish_flavorå£å‘³è¡¨ï¼Œdishèœå“è¡¨åŒ…å«åˆ†ç±»idï¼‰</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222132532058.png" alt="image-20240222132532058"></p>
</li>
</ul>
<h2 id="ä»£ç å¼€å‘-1"><a href="#ä»£ç å¼€å‘-1" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>åˆ†æä¸‹æ¥ï¼Œæ–°å¢èœå“è¦æ¶‰åŠåˆ°ä¸‰ä¸ªæ¥å£ï¼Œç¬¬ä¸€ä¸ªæ¥å£æ˜¯æŸ¥è¯¢åˆ†ç±»æ¥å£ï¼Œç¬¬äºŒä¸ªæ¥å£ï¼Œæ–‡ä»¶ä¸Šä¼ æ¥å£ï¼Œæ–°å¢èœå“æ¥å£ã€‚</p>
<p><strong>å¼€å‘æ–‡ä»¶ä¸Šä¼ æ¥å£ï¼š</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222133731966.png" alt="image-20240222133731966"></p>
<p><strong>åˆ›å»ºCommonControllerå±‚ä»£ç </strong>(æ³¨æ„æ¥æ”¶çš„å‚æ•°æ˜¯äºŒè¿›åˆ¶çš„multipart&#x2F;form-dataï¼Œè¯·æ±‚ä½“ä¸­çš„å‚æ•°æ˜¯file)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šç”¨æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/common&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;é€šç”¨æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonController</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–‡ä»¶ä¸Šä¼ &quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ ï¼š&#123;&#125;&quot;</span>,file);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222152625240.png" alt="image-20240222152625240"></p>
<p><strong>application-dev.yml</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sky:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">3306</span></span><br><span class="line">    <span class="attr">database:</span> <span class="string">sky_take_out</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">  <span class="attr">alioss:</span></span><br><span class="line">    <span class="attr">endpoint :</span> <span class="string">https://oss-cn-hangzhou.aliyuncs.com</span></span><br><span class="line">    <span class="attr">access-key-id :</span> <span class="string">xxx</span></span><br><span class="line">    <span class="attr">access-key-secret :</span> <span class="string">xxx</span></span><br><span class="line">    <span class="attr">bucket-name :</span> <span class="string">waterdance-web-tlias</span></span><br></pre></td></tr></table></figure>

<p><strong>application.yml</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">main:</span></span><br><span class="line">    <span class="attr">allow-circular-references:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">driver-class-name:</span> <span class="string">$&#123;sky.datasource.driver-class-name&#125;</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">jdbc:mysql://$&#123;sky.datasource.host&#125;:$&#123;sky.datasource.port&#125;/$&#123;sky.datasource.database&#125;?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;allowPublicKeyRetrieval=true</span></span><br><span class="line">      <span class="attr">username:</span> <span class="string">$&#123;sky.datasource.username&#125;</span></span><br><span class="line">      <span class="attr">password:</span> <span class="string">$&#123;sky.datasource.password&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="comment">#mapperé…ç½®æ–‡ä»¶</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.sky.entity</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="comment">#å¼€å¯é©¼å³°å‘½å</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com:</span></span><br><span class="line">      <span class="attr">sky:</span></span><br><span class="line">        <span class="attr">mapper:</span> <span class="string">debug</span></span><br><span class="line">        <span class="attr">service:</span> <span class="string">info</span></span><br><span class="line">        <span class="attr">controller:</span> <span class="string">info</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sky:</span></span><br><span class="line">  <span class="attr">jwt:</span></span><br><span class="line">    <span class="comment"># è®¾ç½®jwtç­¾ååŠ å¯†æ—¶ä½¿ç”¨çš„ç§˜é’¥</span></span><br><span class="line">    <span class="attr">admin-secret-key:</span> <span class="string">itcast</span></span><br><span class="line">    <span class="comment"># è®¾ç½®jwtè¿‡æœŸæ—¶é—´</span></span><br><span class="line">    <span class="attr">admin-ttl:</span>  <span class="number">864000000</span></span><br><span class="line">    <span class="comment"># è®¾ç½®å‰ç«¯ä¼ é€’è¿‡æ¥çš„ä»¤ç‰Œåç§°</span></span><br><span class="line">    <span class="attr">admin-token-name:</span> <span class="string">token</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">alioss:</span></span><br><span class="line">    <span class="attr">endpoint:</span> <span class="string">$&#123;sky.alioss.endpoint&#125;</span></span><br><span class="line">    <span class="attr">access-key-id:</span> <span class="string">$&#123;sky.alioss.access-key-id&#125;</span></span><br><span class="line">    <span class="attr">access-key-secret:</span> <span class="string">$&#123;sky.alioss.access-key-secret&#125;</span></span><br><span class="line">    <span class="attr">bucket-name:</span> <span class="string">$&#123;sky.alioss.bucket-name&#125;</span></span><br></pre></td></tr></table></figure>

<p><font color="red">ä¸ºä»€ä¹ˆåœ¨application.ymlä¸­å®šä¹‰aliyunå‚æ•°æ—¶å¯ä»¥ä¸ç”¨ç¡¬ç¼–ç ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº†å±æ€§é…ç½®ç±»ï¼Œåœ¨com.sky.propertiesä¸‹ã€‚ä¸”æˆ‘ä»¬ç‰¹æ„å°†å…·ä½“çš„é…ç½®å†™åœ¨äº†application-dev.ymlæ–‡ä»¶ä¸­ï¼Œæ˜¯å› ä¸ºå¼€å‘ç¯å¢ƒä¸‹ç¡¬ç¼–ç å†™å…¥çš„OSSé…ç½®å¯èƒ½ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ã€‚</font></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222154924046.png" alt="image-20240222154924046"></p>
<p><font color="red">application.ymlæ–‡ä»¶ä¸­æŒ‡å®šäº†å…·ä½“çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®äº†spring.profiles.activeçš„å±æ€§ä¸ºdevï¼Œå³å¯ä»¥å¯¼å…¥application-dev.ymlä¸­çš„é…ç½®è€Œä¸ç”¨ç¡¬ç¼–ç ã€‚</font></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240222160207606.png" alt="image-20240222160207606"></p>
<p>æŸ¥çœ‹AliOssUtil.javaæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.ClientException;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSS;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSClientBuilder;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.oss.OSSException;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOssUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(<span class="type">byte</span>[] bytes, String objectName)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºOSSClientå®ä¾‹ã€‚</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(endpoint, accessKeyId, accessKeySecret);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºPutObjectè¯·æ±‚ã€‚</span></span><br><span class="line">            ossClient.putObject(bucketName, objectName, <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (OSSException oe) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;but was rejected with an error response for some reason.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + oe.getErrorMessage());</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Code:&quot;</span> + oe.getErrorCode());</span><br><span class="line">            System.out.println(<span class="string">&quot;Request ID:&quot;</span> + oe.getRequestId());</span><br><span class="line">            System.out.println(<span class="string">&quot;Host ID:&quot;</span> + oe.getHostId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException ce) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an ClientException, which means the client encountered &quot;</span></span><br><span class="line">                    + <span class="string">&quot;a serious internal problem while trying to communicate with OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;such as not being able to access the network.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + ce.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–‡ä»¶è®¿é—®è·¯å¾„è§„åˆ™ https://BucketName.Endpoint/ObjectName</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;https://&quot;</span>);</span><br><span class="line">        stringBuilder</span><br><span class="line">                .append(bucketName)</span><br><span class="line">                .append(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">                .append(endpoint)</span><br><span class="line">                .append(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">                .append(objectName);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ åˆ°:&#123;&#125;&quot;</span>, stringBuilder.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><font color="red">AliOssUtilç±»è¿˜æ²¡æœ‰å®ä½“åŒ–ï¼Œä»–çš„å±æ€§å€¼æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬è¦åœ¨é…ç½®ç±»ä¸­å£°æ˜è¯¥ç±»çš„å¯¹è±¡ï¼ŒåŠ ä¸Š@Beanæ³¨è§£ï¼Œå°†å…¶åŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚</font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.properties.AliOssProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.AliOssUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºAliOssUtilå¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="keyword">public</span> AliOssUtil <span class="title function_">aliOssUtil</span><span class="params">(AliOssProperties aliOssProperties)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¼€å§‹åˆ›å»ºé˜¿é‡Œäº‘æ–‡ä»¶ä¸Šä¼ å·¥å…·ç±»å¯¹è±¡ï¼š&#123;&#125;&quot;</span>,aliOssProperties);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AliOssUtil</span>(aliOssProperties.getEndpoint(),</span><br><span class="line">                                aliOssProperties.getAccessKeyId(),</span><br><span class="line">                                aliOssProperties.getAccessKeySecret(),</span><br><span class="line">                                aliOssProperties.getBucketName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å®ç°ä¸Šä¼ å›¾ç‰‡è‡³é˜¿é‡Œäº‘æœåŠ¡å™¨çš„åŠŸèƒ½</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.AliOssUtil;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šç”¨æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/common&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;é€šç”¨æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AliOssUtil aliOssUtil;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–‡ä»¶ä¸Šä¼ &quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ ï¼š&#123;&#125;&quot;</span>,file);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//åŸå§‹æ–‡ä»¶å</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">            <span class="comment">//æˆªå–åŸå§‹æ–‡ä»¶åçš„åç¼€ dfdfdf.png</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">extension</span> <span class="operator">=</span> originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">            <span class="comment">//æ„é€ æ–°æ–‡ä»¶åç§°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">objectName</span> <span class="operator">=</span> UUID.randomUUID().toString() + extension;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ä¸ºäº†é˜²æ­¢æ–‡ä»¶é‡åå¯¼è‡´æ–‡ä»¶è¦†ç›–ï¼Œä½¿ç”¨UUIDé‡å‘½åï¼Œ</span></span><br><span class="line">            <span class="comment">//æ–‡ä»¶çš„è¯·æ±‚è·¯å¾„</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">filePath</span> <span class="operator">=</span> aliOssUtil.upload(file.getBytes(), objectName);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> Result.success(filePath);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼š&#123;&#125;&quot;</span>,e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.error(MessageConstant.UPLOAD_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å‰åç«¯è”è°ƒ</strong></p>
<p>å‰ç«¯è¯·æ±‚äº†æˆ‘ä»¬è¿”å›çš„è·¯å¾„ï¼Œä»è€Œå±•ç¤ºäº†å›¾ç‰‡çš„ä¿¡æ¯ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223174439657.png" alt="image-20240223174439657"></p>
<p><strong>æ–°å¢èœå“æ¥å£</strong></p>
<p><strong>DishControllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢èœå“</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–°å¢èœå“æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> DishDTO dishDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–°å¢èœå“ï¼š&#123;&#125;&quot;</span>,dishDTO);</span><br><span class="line">        dishService.saveWithFlavor(dishDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™DishServiceImplå±‚ä»£ç </strong></p>
<p>æ³¨æ„ï¼Œè¿™è¾¹åŠ äº†@Transactionalæ³¨è§£ï¼Œè¡¨ç¤ºå°†æ–¹æ³•ä½œä¸ºäº‹åŠ¡æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ã€‚</p>
<ol>
<li>dishè¡¨æ’å…¥æ’å…¥èœå“</li>
<li>dishFlavorè¡¨æ’å…¥å£å‘³</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢èœå“å’Œå¯¹åº”çš„å£å‘³</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional</span> <span class="comment">//è¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveWithFlavor</span><span class="params">(DishDTO dishDTO)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå®ä½“ç±»Dishå¯¹è±¡ï¼ˆå±æ€§å‘½åå¿…é¡»ä¿æŒä¸€è‡´æ‰èƒ½æ‹·è´ï¼‰</span></span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dish</span>();</span><br><span class="line">        BeanUtils.copyProperties(dishDTO,dish);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘èœå“è¡¨æ’å…¥1æ¡æ•°æ®</span></span><br><span class="line">        dishMapper.insert(dish);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–insertè¯­å¥ç”Ÿæˆçš„ä¸»é”®å€¼</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">dishId</span> <span class="operator">=</span> dish.getId();</span><br><span class="line"></span><br><span class="line">        List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br><span class="line">        <span class="keyword">if</span>(flavors != <span class="literal">null</span> &amp;&amp; flavors.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//ä¸ºå£å‘³è¡¨çš„å…ƒç´ è®¾ç½®dishIdã€‚</span></span><br><span class="line">            flavors.forEach(dishFlavor -&gt; &#123;</span><br><span class="line">                dishFlavor.setDishId(dishId);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å‘å£å‘³è¡¨æ’å…¥næ¡æ•°æ®</span></span><br><span class="line">            <span class="comment">//sqlæ”¯æŒæ‰¹é‡æ’å…¥ï¼Œç›´æ¥æŠŠé›†åˆå¯¹è±¡ä¼ å…¥</span></span><br><span class="line">            dishFlavorMapper.insertBatch(flavors);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>DishMapper.xml</strong>ï¼ˆæ’å…¥è¯­å¥è¦è¿”å›å¯¹åº”çš„idä¸»é”®ï¼Œæ‰€ä»¥è®¾ç½®äº†useGeneratedKeys&#x3D;â€trueâ€ keyProperty&#x3D;â€idâ€ï¼Œå†è¯¦ç»†ç‚¹è¯´ï¼Œ<code>useGeneratedKeys</code>è¿™ä¸ªå±æ€§åœ¨MyBatisçš„<code>&lt;insert&gt;</code>æ ‡ç­¾ä¸­ä½¿ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŒ‡ç¤ºMyBatisåœ¨æ‰§è¡Œæ’å…¥æ“ä½œåä½¿ç”¨æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®å€¼ã€‚è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚åˆæ•°æ®åº“è¡¨ä¸­æœ‰è‡ªå¢é•¿ä¸»é”®çš„æƒ…å†µã€‚å½“ä½ è®¾ç½®<code>useGeneratedKeys=&quot;true&quot;</code>æ—¶ï¼ŒMyBatisä¼šè‡ªåŠ¨å¯»æ‰¾æ•°æ®åº“ç”Ÿæˆçš„ä¸»é”®å€¼ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™ä½ åœ¨<code>keyProperty</code>å±æ€§ä¸­æŒ‡å®šçš„Javaå¯¹è±¡çš„å±æ€§ã€‚ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.DishMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span> # è·å¾—insertè¯­å¥æ’å…¥æ‰€ç”Ÿæˆçš„ä¸»é”®å€¼</span><br><span class="line">        insert into dish (name, category_id, price, image, description, create_time, update_time, create_user,</span><br><span class="line">                          update_user, status)</span><br><span class="line">        VALUES (#&#123;name&#125;, #&#123;categoryId&#125;, #&#123;price&#125;, #&#123;image&#125;, #&#123;description&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;, #&#123;createUser&#125;,</span><br><span class="line">                #&#123;updateUser&#125;, #&#123;status&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>DishFlavorMapper.xml</strong>ï¼ˆå°†é›†åˆç›´æ¥foreachéå†æ’å…¥åˆ°dishflavorè¡¨ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span><br><span class="line">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.sky.mapper.DishFlavorMapper&quot;</span>&gt;</span><br><span class="line">    &lt;insert id=<span class="string">&quot;insertBatch&quot;</span>&gt;</span><br><span class="line">        insert into <span class="title function_">dish_flavor</span> <span class="params">(dish_id, name, value)</span></span><br><span class="line">        values</span><br><span class="line">        &lt;foreach collection=<span class="string">&quot;flavors&quot;</span> item=<span class="string">&quot;df&quot;</span> separator=<span class="string">&quot;,&quot;</span>&gt;</span><br><span class="line">            (#&#123;df.dishId&#125;,#&#123;df.name&#125;,#&#123;df.value&#125;)</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>





<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223192947602.png" alt="image-20240223192947602"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223193053795.png" alt="image-20240223193053795"></p>
<h1 id="èœå“åˆ†é¡µæŸ¥è¯¢"><a href="#èœå“åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="èœå“åˆ†é¡µæŸ¥è¯¢"></a>èœå“åˆ†é¡µæŸ¥è¯¢</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p>è¿™é‡Œæœ‰èœå“åç§°ã€å›¾ç‰‡ã€åˆ†ç±»ã€å”®ä»·ã€çŠ¶æ€ç­‰ç­‰ã€‚å› ä¸ºæ˜¯åˆ†é¡µæŸ¥è¯¢ï¼Œæ‰€ä»¥åœ¨å³ä¸‹è§’éœ€è¦å±•ç¤ºåˆ†é¡µæ¡ã€‚åˆ†é¡µæ¡å±•ç¤ºæ€»è®¡è®°å½•æ•°å’Œé¡µç ã€‚æœç´¢æ ä¸­æœ‰èœå“çš„åç§°ã€èœå“çš„åˆ†ç±»ã€å”®å–çŠ¶æ€ç­‰ç­‰ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223215642367.png" alt="image-20240223215642367"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>æ ¹æ®é¡µç å±•ç¤ºèœå“ä¿¡æ¯</li>
<li>æ¯é¡µå±•ç¤º10æ¡æ•°æ®</li>
<li>åˆ†é¡µæŸ¥è¯¢æ—¶å¯ä»¥æ ¹æ®éœ€è¦è¾“å…¥èœå“åç§°ã€èœå“åˆ†ç±»ã€èœå“çŠ¶æ€è¿›è¡ŒæŸ¥è¯¢</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p>å› ä¸ºåˆ†é¡µæŸ¥è¯¢æ˜¯æŸ¥è¯¢ç±»çš„æ“ä½œï¼Œæ‰€ä»¥å®ƒçš„è¯·æ±‚æ–¹å¼æ˜¯GETï¼Œè¯·æ±‚è·¯å¾„è¿˜æ˜¯&#x2F;admin&#x2F;dish&#x2F;pageï¼Œæ³¨æ„ï¼Œåœ¨è¿”å›æ•°æ®ä¸­ï¼ŒcategoryNameå­—æ®µä¸åœ¨dishè¡¨ä¸­</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223221213389.png" alt="image-20240223221213389"></p>
<h2 id="ä»£ç å¼€å‘-2"><a href="#ä»£ç å¼€å‘-2" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>æ ¹æ®èœå“åˆ†é¡µæŸ¥è¯¢æ¥å£å®šä¹‰è®¾è®¡å¯¹åº”çš„DTOï¼šï¼ˆDTOæ¥æ”¶å‰ç«¯ä¼ æ¥çš„å‚æ•°ï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223221625402.png" alt="image-20240223221625402"></p>
<p>æ ¹æ®èœå“åˆ†é¡µæŸ¥è¯¢æ¥å£å®šä¹‰è®¾è®¡å¯¹åº”çš„VOï¼šï¼ˆVOæ˜¯è¿”å›å‰ç«¯çš„æ•°æ®ï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223222003240.png" alt="image-20240223222003240"></p>
<p><strong>controllerå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;èœå“åˆ†é¡µæŸ¥è¯¢æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">page</span><span class="params">(DishPageQueryDTO dishPageQueryDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;èœå“åˆ†é¡µæŸ¥è¯¢:&#123;&#125;&quot;</span>,dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> dishService.pageQuery(dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èœå“åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishPageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult <span class="title function_">pageQuery</span><span class="params">(DishPageQueryDTO dishPageQueryDTO)</span> &#123;</span><br><span class="line">        PageHelper.startPage(dishPageQueryDTO.getPage(), dishPageQueryDTO.getPageSize());</span><br><span class="line"></span><br><span class="line">        Page&lt;DishVO&gt; page = dishMapper.pageQuery(dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>(page.getTotal(),page.getResult());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥èœå“æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dish</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AutoFill(value= OperationType.INSERT)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Dish dish)</span>;</span><br><span class="line"></span><br><span class="line">    Page&lt;DishVO&gt; <span class="title function_">pageQuery</span><span class="params">(DishPageQueryDTO dishPageQueryDTO)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>mapper.xmlç¼–å†™</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.DishMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;pageQuery&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sky.vo.DishVO&quot;</span>&gt;</span></span><br><span class="line">        select d.*, c.name as categoryName from dish d left join category c on d.category_id = c.id</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span> d.name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;),<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status!=null&quot;</span>&gt;</span> d.status = #&#123;status&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;categoryId != null&quot;</span>&gt;</span> d.category_id = #&#123;categoryId&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by d.create_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240223231956652.png" alt="image-20240223231956652"></p>
<h1 id="åˆ é™¤èœå“"><a href="#åˆ é™¤èœå“" class="headerlink" title="åˆ é™¤èœå“"></a>åˆ é™¤èœå“</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-2"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-2" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p>åœ¨æ“ä½œåˆ—æœ‰åˆ é™¤æŒ‰é’®ï¼Œç‚¹å‡»åˆ é™¤å¯ä»¥åˆ é™¤å•ä¸ªèœå“ï¼Œå‹¾é€‰å¤šä¸ªèœå“ç‚¹å‡»æ‰¹é‡åˆ é™¤å¯ä»¥åˆ é™¤å¤šä¸ªèœå“ã€‚åœ¨é€»è¾‘å®ç°åŠŸèƒ½ä¸Šï¼Œå¦‚æœèœå“æ­£åœ¨å¯å”®ï¼Œæ˜¯ä¸èƒ½åˆ é™¤èœå“çš„ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224131914657.png" alt="image-20240224131914657"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¯ä»¥ä¸€æ¬¡åˆ é™¤ä¸€ä¸ªèœå“ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡åˆ é™¤èœå“</li>
<li>èµ·å”®ä¸­çš„èœå“ä¸èƒ½åˆ é™¤</li>
<li>è¢«å¥—é¤å…³è”çš„èœå“ä¸èƒ½åˆ é™¤</li>
<li>åˆ é™¤èœå“åï¼Œå…³è”çš„å£å‘³æ•°æ®ä¹Ÿéœ€è¦åˆ é™¤æ‰</li>
</ul>
<p><strong>æ¥å£åˆ†æ</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224132421431.png" alt="image-20240224132421431"></p>
<p><strong>æ•°æ®åº“è®¾è®¡</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224132745888.png" alt="image-20240224132745888"></p>
<ul>
<li>dishè¡¨</li>
<li>dish_flavorè¡¨ï¼ˆèœå“çš„å£å‘³è¡¨ï¼‰</li>
<li>setmeal_dishè¡¨ï¼ˆå¥—é¤å’Œèœå“çš„å…³è”è¡¨ï¼‰</li>
</ul>
<h2 id="ä»£ç å¼€å‘-3"><a href="#ä»£ç å¼€å‘-3" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯stringç±»å‹é€—å·åˆ†éš”çš„æ•°ç»„ï¼Œè¯·æ±‚æ–¹å¼æ˜¯queryã€‚æ¥æ”¶è¯¥å‚æ•°çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ã€‚ç½‘å€ï¼š<a href="https://localhost:8080/admin/dish?ids=1,2,3">https://localhost:8080/admin/dish?ids=1,2,3</a></p>
<ol>
<li>String ids</li>
<li><font color="red">@RequestParam List&lt;Long&gt; idsï¼ˆåŠ æ³¨è§£@RequestParamä¹‹åï¼ŒMVCæ‰ä¼šåŠ¨æ€è§£æè‡ªåŠ¨ä¸²å¹¶å°†å…¶å°è£…åˆ°idsä¸­)</font></li>
</ol>
<p><strong>controllerå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èœå“æ‰¹é‡åˆ é™¤æ¥å£</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;èœå“æ‰¹é‡åˆ é™¤æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;èœå“æ‰¹é‡åˆ é™¤ï¼š&#123;&#125;&quot;</span>, ids);</span><br><span class="line">        dishService.deleteBatch(ids);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.DeletionNotAllowedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.SetmealDishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealDishMapper setmealDishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èœå“æ‰¹é‡åˆ é™¤åŠŸèƒ½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBatch</span><span class="params">(List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰èœå“æ˜¯å¦èƒ½å¤Ÿåˆ é™¤--æ˜¯å¦å­˜åœ¨èµ·å”®ä¸­çš„èœå“ï¼Ÿï¼Ÿ</span></span><br><span class="line">        <span class="keyword">for</span> (Long id : ids) &#123;</span><br><span class="line">            <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishMapper.getById(id);</span><br><span class="line">            <span class="keyword">if</span>(dish.getStatus() == StatusConstant.ENABLE)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DeletionNotAllowedException</span>(MessageConstant.DISH_ON_SALE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰èœå“æ˜¯å¦èƒ½å¤Ÿåˆ é™¤--æ˜¯å¦è¢«å¥—é¤å…³è”äº†ï¼Ÿï¼Ÿ</span></span><br><span class="line">        List&lt;Long&gt; setmealIds = setmealDishMapper.getSetmealIdsByDishIds(ids);</span><br><span class="line">        <span class="keyword">if</span>(setmealIds != <span class="literal">null</span> &amp;&amp; setmealIds.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//å½“å‰èœå“è¢«å¥—é¤å…³è”äº†ï¼Œä¸èƒ½åˆ é™¤</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DeletionNotAllowedException</span>(MessageConstant.DISH_BE_RELATED_BY_SETMEAL);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ é™¤èœå“è¡¨ä¸­çš„èœå“æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (Long id : ids) &#123;</span><br><span class="line">            dishMapper.deleteById(id);</span><br><span class="line">            <span class="comment">//åˆ é™¤èœå“å…³è”çš„å£å‘³æ•°æ®</span></span><br><span class="line">            dishFlavorMapper.deleteByDishId(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸»åˆ é™¤èœå“æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from dish where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SetmealDishMapper</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®èœå“IDæŸ¥è¯¢å¯¹åº”çš„å¥—é¤id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishIds</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//select setmeal_id from setmeal_dish where dishId in dishIds;</span></span><br><span class="line">    List&lt;Long&gt; <span class="title function_">getSetmealIdsByDishIds</span><span class="params">(List&lt;Long&gt; dishIds)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.SetmealDishMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getSetmealIdsByDishIds&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Long&quot;</span>&gt;</span></span><br><span class="line">        select setmeal_id from setmeal_dish where setmeal_id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;dishIds&quot;</span> <span class="attr">item</span>=<span class="string">&quot;dishId&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">            #&#123;dishId&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-3"><a href="#åŠŸèƒ½æµ‹è¯•-3" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224141308731.png" alt="image-20240224141308731"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224141320685.png" alt="image-20240224141320685"></p>
<p><strong>æ”¹è¿›ç©ºé—´</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.DeletionNotAllowedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.SetmealDishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealDishMapper setmealDishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èœå“æ‰¹é‡åˆ é™¤åŠŸèƒ½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBatch</span><span class="params">(List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰èœå“æ˜¯å¦èƒ½å¤Ÿåˆ é™¤--æ˜¯å¦å­˜åœ¨èµ·å”®ä¸­çš„èœå“ï¼Ÿï¼Ÿ</span></span><br><span class="line">        <span class="keyword">for</span> (Long id : ids) &#123;</span><br><span class="line">            <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishMapper.getById(id);</span><br><span class="line">            <span class="keyword">if</span>(dish.getStatus() == StatusConstant.ENABLE)&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DeletionNotAllowedException</span>(MessageConstant.DISH_ON_SALE);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰èœå“æ˜¯å¦èƒ½å¤Ÿåˆ é™¤--æ˜¯å¦è¢«å¥—é¤å…³è”äº†ï¼Ÿï¼Ÿ</span></span><br><span class="line">        List&lt;Long&gt; setmealIds = setmealDishMapper.getSetmealIdsByDishIds(ids);</span><br><span class="line">        <span class="keyword">if</span>(setmealIds != <span class="literal">null</span> &amp;&amp; setmealIds.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//å½“å‰èœå“è¢«å¥—é¤å…³è”äº†ï¼Œä¸èƒ½åˆ é™¤</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DeletionNotAllowedException</span>(MessageConstant.DISH_BE_RELATED_BY_SETMEAL);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ é™¤èœå“è¡¨ä¸­çš„èœå“æ•°æ®</span></span><br><span class="line">        <span class="keyword">for</span> (Long id : ids) &#123;</span><br><span class="line">            dishMapper.deleteById(id);</span><br><span class="line">            <span class="comment">//åˆ é™¤èœå“å…³è”çš„å£å‘³æ•°æ®</span></span><br><span class="line">            dishFlavorMapper.deleteByDishId(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„åˆ é™¤èœå“è¡¨ä¸­èœå“è¦æ±‚å¯¹æ•°æ®åº“é¢‘ç¹æ“ä½œã€‚èƒ½å¤Ÿåªå‘ä¸€æ¡sqlï¼Œå°±åˆ é™¤èœå“å£å‘³è¡¨ä¸­æ‰€æœ‰ç›¸å…³æ•°æ®ã€‚</p>
<p>åˆ›å»ºdeleteByIdså’ŒdeleteByDishIdsï¼Œä¼ å…¥idså‚æ•°ï¼Œç›´æ¥åœ¨sqlè¯­å¥ä¸­åˆ é™¤å¯¹åº”çš„æ•°æ®</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.DishFlavorMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteByDishIds&quot;</span>&gt;</span></span><br><span class="line">        delete from dish_flavor where dish_id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span>&gt;</span></span><br><span class="line">            #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.DishMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteByIds&quot;</span> &gt;</span></span><br><span class="line">        delete from dish where id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">            #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="ä¿®æ”¹èœå“"><a href="#ä¿®æ”¹èœå“" class="headerlink" title="ä¿®æ”¹èœå“"></a>ä¿®æ”¹èœå“</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-3"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-3" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224151756233.png" alt="image-20240224151756233"></p>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li>æ ¹æ®idæŸ¥è¯¢èœå“</li>
<li>æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†ç±»ï¼ˆå·²ç»å®ç°ï¼‰</li>
<li>æ–‡ä»¶ä¸Šä¼ ï¼ˆå·²å®ç°ï¼‰</li>
<li>ä¿®æ”¹èœå“</li>
</ul>
<p><strong>æ ¹æ®idæŸ¥è¯¢èœå“</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224152053594.png" alt="image-20240224152053594"></p>
<p><strong>ä¿®æ”¹èœå“</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224152241187.png" alt="image-20240224152241187"></p>
<h2 id="ä»£ç å¼€å‘-4"><a href="#ä»£ç å¼€å‘-4" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>æ ¹æ®idæŸ¥è¯¢èœå“</strong></p>
<p><strong>controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢èœå“&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;DishVO&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ ¹æ®idæŸ¥è¯¢èœå“ï¼š&#123;&#125;&quot;</span>,id);</span><br><span class="line">        <span class="type">DishVO</span> <span class="variable">dishVO</span> <span class="operator">=</span> dishService.getByIdWithFlavor(id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(dishVO);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.DeletionNotAllowedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.SetmealDishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealDishMapper setmealDishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢èœå“å’Œå¯¹åº”çš„å£å‘³æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> DishVO <span class="title function_">getByIdWithFlavor</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="comment">//1. æŸ¥è¯¢idæŸ¥è¯¢èœå“ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishMapper.getById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. æŸ¥è¯¢èœå“æŸ¥è¯¢å£å‘³æ•°æ®</span></span><br><span class="line">        List&lt;DishFlavor&gt; dishFlavors =  dishFlavorMapper.getByDishId(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. å°†æŸ¥è¯¢åˆ°çš„æ•°æ®å°è£…ä¸ºVO</span></span><br><span class="line">        <span class="type">DishVO</span> <span class="variable">dishVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DishVO</span>();</span><br><span class="line">        BeanUtils.copyProperties(dish,dishVO);</span><br><span class="line">        dishVO.setFlavors(dishFlavors);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dishVO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishFlavorMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®èœå“idæŸ¥è¯¢å¯¹åº”çš„å£å‘³æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from dish_flavor where dish_id = #&#123;dishId&#125;&quot;)</span></span><br><span class="line">    List&lt;DishFlavor&gt; <span class="title function_">getByDishId</span><span class="params">(Long dishId)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>ä¿®æ”¹èœå“</strong></p>
<p><strong>ç¼–å†™controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/dish&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;èœå“ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ä¿®æ”¹èœå“æ¥å£&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> DishDTO dishDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;ä¿®æ”¹èœå“:&#123;&#125;&quot;</span>,dishDTO);</span><br><span class="line">        dishService.updateWithFlavor(dishDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.DishFlavor;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.DeletionNotAllowedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishFlavorMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.DishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.SetmealDishMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.DishService;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SetmealDishMapper setmealDishMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idä¿®æ”¹èœå“å’Œå¯¹åº”çš„å£å‘³æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dishDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateWithFlavor</span><span class="params">(DishDTO dishDTO)</span> &#123;</span><br><span class="line">        <span class="comment">//ä¿®æ”¹èœå“è¡¨åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dish</span>();</span><br><span class="line">        BeanUtils.copyProperties(dishDTO,dish);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ é™¤åŸæœ‰çš„å£å‘³æ•°æ®</span></span><br><span class="line">        dishMapper.update(dish);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ é™¤åŸæœ‰å£å‘³æ•°æ®</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> dishDTO.getId();</span><br><span class="line">        dishFlavorMapper.deleteByDishId(id);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//é‡æ–°æ’å…¥å£å‘³æ•°æ®</span></span><br><span class="line">        List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br><span class="line">        <span class="keyword">if</span> (flavors != <span class="literal">null</span> &amp;&amp; flavors.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//ä¸ºå£å‘³è¡¨çš„å…ƒç´ è®¾ç½®dishIdã€‚</span></span><br><span class="line">            flavors.forEach(dishFlavor -&gt; &#123;</span><br><span class="line">                dishFlavor.setDishId(id);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å‘å£å‘³è¡¨æ’å…¥næ¡æ•°æ®</span></span><br><span class="line">            <span class="comment">//sqlæ”¯æŒæ‰¹é‡æ’å…¥ï¼Œç›´æ¥æŠŠé›†åˆå¯¹è±¡ä¼ å…¥</span></span><br><span class="line">            dishFlavorMapper.insertBatch(flavors);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.annotation.AutoFill;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.DishPageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Dish;</span><br><span class="line"><span class="keyword">import</span> com.sky.enumeration.OperationType;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.DishVO;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®IDåŠ¨æ€ä¿®æ”¹èœå“æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dish</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AutoFill(value = OperationType.UPDATE)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Dish dish)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.DishMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.sky.entity.Dish&quot;</span>&gt;</span></span><br><span class="line">        update dish</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;name != null&quot;</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;categoryId != null&quot;</span>&gt;</span>category_id=#&#123;categoryId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;price != null&quot;</span>&gt;</span>price=#&#123;price&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;image != null&quot;</span>&gt;</span>image=#&#123;image&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;description != null&quot;</span>&gt;</span>description=#&#123;description&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;status != null&quot;</span>&gt;</span>status=#&#123;status&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;name != null&quot;</span>&gt;</span>name=#&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateTime != null&quot;</span>&gt;</span> update_time = #&#123;updateTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateUser != null&quot;</span>&gt;</span> update_user = #&#123;updateUser&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-4"><a href="#åŠŸèƒ½æµ‹è¯•-4" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224155659378.png" alt="image-20240224155659378"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day03-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/image-20240224155719158.png" alt="image-20240224155719158"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day02-å‘˜å·¥ç®¡ç†ã€åˆ†ç±»ç®¡ç†</title>
    <url>/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[<h1 id="å‘˜å·¥ç®¡ç†ã€åˆ†ç±»ç®¡ç†"><a href="#å‘˜å·¥ç®¡ç†ã€åˆ†ç±»ç®¡ç†" class="headerlink" title="å‘˜å·¥ç®¡ç†ã€åˆ†ç±»ç®¡ç†"></a>å‘˜å·¥ç®¡ç†ã€åˆ†ç±»ç®¡ç†</h1><p>æœ¬èŠ‚ä¸»è¦å®Œæˆå•†å®¶ç®¡ç†éƒ¨åˆ†çš„å‘˜å·¥ç®¡ç†å’Œåˆ†ç±»ç®¡ç†ã€‚</p>
<p><strong>å‘˜å·¥ç®¡ç†æ¨¡å—</strong>æœ‰æ·»åŠ å‘˜å·¥ã€åˆ†é¡µæŸ¥è¯¢å‘˜å·¥ã€ä¿®æ”¹å‘˜å·¥ã€ç¦ç”¨å‘˜å·¥ç­‰å®ç°åŠŸèƒ½ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221122736390.png" alt="image-20240221122736390"></p>
<p><strong>åˆ†ç±»ç®¡ç†æ¨¡å—</strong>æœ‰æ–°å»ºèœå“åˆ†ç±»å’Œæ–°å¢å¥—é¤åˆ†ç±»ï¼ŒæŸ¥è¯¢åˆ†ç±»ï¼Œå¯¹åˆ†ç±»è¿›è¡Œä¿®æ”¹ã€åˆ é™¤ã€ç¦ç”¨ç­‰åŠŸèƒ½ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221122850337.png" alt="image-20240221122850337"></p>
<h1 id="æ–°å¢å‘˜å·¥"><a href="#æ–°å¢å‘˜å·¥" class="headerlink" title="æ–°å¢å‘˜å·¥"></a>æ–°å¢å‘˜å·¥</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221123500727.png" alt="image-20240221123500727"></p>
<ul>
<li><p>è´¦å·å¿…é¡»æ˜¯å”¯ä¸€çš„</p>
</li>
<li><p>æ‰‹æœºå·ä¸ºåˆæ³•çš„11ä½æ‰‹æœºå·ç </p>
</li>
<li><p>èº«ä»½è¯ä¸ºåˆæ³•çš„18ä½èº«ä»½è¯å·ç </p>
</li>
<li><p>å¯†ç é»˜è®¤ä¸º123456</p>
</li>
</ul>
<p>æ¥å£çš„è¯·æ±‚æ–¹å¼åº”è¯¥æ˜¯POSTï¼Œæäº¤çš„æ•°æ®æ˜¯è¡¨å•é¡¹ä¸­çš„æ•°æ®ï¼Œä»¥jsonæ ¼å¼æäº¤ï¼Œåç«¯è¿”å›çš„è®¾è®¡æ ¼å¼ä¹Ÿæ˜¯jsonã€‚</p>
<p><strong>æ¥å£è®¾è®¡</strong>ï¼š</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221124004779.png" alt="image-20240221124004779"></p>
<p>æœ¬é¡¹ç›®çº¦å®šï¼š</p>
<ul>
<li>ç®¡ç†ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨&#x2F;adminä½œä¸ºå‰ç¼€</li>
<li>ç”¨æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œç»Ÿä¸€ä½¿ç”¨&#x2F;userä½œä¸ºå‰ç¼€</li>
</ul>
<p><strong>æ•°æ®åº“è®¾è®¡ï¼ˆemployeeè¡¨ï¼‰</strong>ï¼š</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221124246494.png" alt="image-20240221124246494"></p>
<h2 id="ä»£ç å¼€å‘"><a href="#ä»£ç å¼€å‘" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>æ ¹æ®æ–°å¢å‘˜å·¥æ¥å£è®¾è®¡å¯¹åº”çš„DTOï¼Œå°è£…å‰ç«¯æäº¤è¿‡æ¥çš„æ•°æ®ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221124508384.png" alt="image-20240221124508384"></p>
<p>ä¸ºä»€ä¹ˆä¸ç”¨å®ä½“ç±»æ¥å°è£…å‰ç«¯æäº¤çš„æ•°æ®ï¼Ÿ</p>
<p><font color="red">åŸå› ï¼šå½“å‰ç«¯æäº¤çš„æ•°æ®å’Œå®ä½“ç±»ä¸­å¯¹åº”çš„å±æ€§å·®åˆ«è¾ƒå¤§æ—¶ï¼Œå»ºè®®ä½¿ç”¨DTOæ¥å°è£…æ•°æ®ã€‚</font></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221124722772.png" alt="image-20240221124722772"></p>
<p><strong>ç¼–å†™controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å‘˜å·¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employeeDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;æ–°å¢å‘˜å·¥&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> EmployeeDTO employeeDTO)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–°å¢å‘˜å·¥ï¼š&#123;&#125;&quot;</span>, employeeDTO);</span><br><span class="line">        employeeService.save(employeeDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢å‘˜å·¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employeeDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;æ–°å¢å‘˜å·¥&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> EmployeeDTO employeeDTO)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–°å¢å‘˜å·¥ï¼š&#123;&#125;&quot;</span>, employeeDTO);</span><br><span class="line">        employeeService.save(employeeDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’å…¥å‘˜å·¥æ•°æ®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into employee (name, username, password, phone, sex, id_number, create_time, update_time, create_user, update_user) &quot; +</span></span><br><span class="line"><span class="meta">        &quot;values(#&#123;name&#125;,#&#123;username&#125;,#&#123;password&#125;,#&#123;phone&#125;,#&#123;sex&#125;,#&#123;idNumber&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;,#&#123;createUser&#125;,#&#123;updateUser&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="åŠŸèƒ½æµ‹è¯•"><a href="#åŠŸèƒ½æµ‹è¯•" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>åŠŸèƒ½æµ‹è¯•æ–¹å¼</p>
<ul>
<li>é€šè¿‡æ¥å£æ–‡æ¡£æµ‹è¯•</li>
<li>é€šè¿‡å‰åç«¯è”è°ƒæµ‹è¯•</li>
</ul>
<p>æ³¨æ„ï¼šç”±äºå¼€å‘é˜¶æ®µå‰ç«¯å’Œåç«¯æ˜¯å¹¶è¡Œå¼€å‘çš„ï¼Œåç«¯å®ŒæˆæŸä¸ªåŠŸèƒ½åï¼Œæ­¤æ—¶å‰ç«¯å¯¹åº”çš„åŠŸèƒ½å¯èƒ½è¿˜æ²¡æœ‰å¼€å‘å®Œæˆï¼Œå¯¼è‡´æ— æ³•è¿›è¡Œå‰åç«¯è”è°ƒæµ‹è¯•ã€‚æ‰€ä»¥åœ¨å¼€å‘é˜¶æ®µï¼Œåç«¯æµ‹è¯•ä¸»è¦ä»¥æ¥å£æ–‡æ¡£æµ‹è¯•ä¸ºä¸»ã€‚</p>
<p>å…ˆé€šè¿‡å‘˜å·¥ç™»å½•æ¥å£è·å–tokenï¼Œå¹¶å°†å…¶è®¾ç½®åœ¨æ–‡æ¡£ç®¡ç†çš„å…¨å±€å‚æ•°è®¾ç½®ä¸­ã€‚</p>
<p><strong>è·å–token</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221134158354.png" alt="image-20240221134158354"></p>
<p><strong>å°†tokené…ç½®åˆ°å…¨å±€å‚æ•°è®¾ç½®ä¸­</strong>ï¼ˆå‚æ•°ç±»å‹æ˜¯headerï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221134241220.png" alt="image-20240221134241220"></p>
<p><strong>å†æ¬¡æµ‹è¯•æ–°å¢å‘˜å·¥æ–¹æ³•</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221134327794.png" alt="image-20240221134327794"></p>
<p><strong>å‰åç«¯è”è°ƒ</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221134704428.png" alt="image-20240221134704428"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221134910323.png" alt="image-20240221134910323"></p>
<h2 id="ä»£ç å®Œå–„"><a href="#ä»£ç å®Œå–„" class="headerlink" title="ä»£ç å®Œå–„"></a>ä»£ç å®Œå–„</h2><p>ç¨‹åºå­˜åœ¨çš„é—®é¢˜ï¼š</p>
<ul>
<li><p>å½•å…¥çš„ç”¨æˆ·åå·²ç»å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸åæ²¡æœ‰å¤„ç†</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221135055314.png" alt="image-20240221135055314"></p>
<p>è§£å†³åŠæ³•ï¼šåœ¨å…¨å±€å¼‚å¸¸å¤„ç†å™¨ä¸­æ•è·å¼‚å¸¸</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.BaseException;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.message.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.SQLIntegrityConstraintViolationException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Œå¤„ç†é¡¹ç›®ä¸­æŠ›å‡ºçš„ä¸šåŠ¡å¼‚å¸¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†SQLå¼‚å¸¸</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ex</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">exceptionHandler</span><span class="params">(SQLIntegrityConstraintViolationException ex)</span>&#123;</span><br><span class="line"><span class="comment">//        Duplicate entry &#x27;zhangsan&#x27; for key &#x27;employee.idx_username&#x27;</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> ex.getMessage();</span><br><span class="line">        <span class="keyword">if</span>(message.contains(<span class="string">&quot;Duplicate entry&quot;</span>))&#123;</span><br><span class="line">            String[] split = message.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> split[<span class="number">2</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> username + MessageConstant.ALREADY_EXISTS;</span><br><span class="line">            <span class="keyword">return</span> Result.error(msg);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.error(MessageConstant.UNKNOWN_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å¢å‘˜å·¥æ—¶ï¼Œåˆ›å»ºäººidå’Œä¿®æ”¹äººidè®¾ç½®ä¸ºäº†å›ºå®šå€¼</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221135135315.png" alt="image-20240221135135315"></p>
<p>è§£å†³åŠæ³•ï¼šé’ˆå¯¹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œéœ€è¦é€šè¿‡æŸç§æ–¹å¼åŠ¨æ€è·å–å½“å‰ç™»å½•å‘˜å·¥çš„idã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221145518597.png" alt="image-20240221145518597"></p>
<p>JWTè®¤è¯æµç¨‹</p>
<p>å‰ç«¯å‘èµ·è¯·æ±‚ï¼ŒæŠŠç”¨æˆ·åå’Œå¯†ç æäº¤ç»™åç«¯ã€‚åç«¯æ ¡éªŒä¹‹åè®¤è¯é€šè¿‡ï¼Œç”ŸæˆJWT tokenå¹¶è¿”å›ç»™å‰ç«¯ï¼Œå‰ç«¯ä¼šåœ¨æœ¬åœ°ä¿å­˜JWTä»¤ç‰Œã€‚åç»­å‰ç«¯çš„æ¯æ¬¡æ“ä½œè¯·æ±‚åç«¯æ¥å£éƒ½ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦JWTï¼Œåç«¯æ¥æ”¶åˆ°è¯·æ±‚åä¼šç”¨æ‹¦æˆªå™¨æ‹¦æˆªè¯·æ±‚ï¼Œæ£€æŸ¥tokenï¼Œå¦‚æœé€šè¿‡ï¼Œå°±æ”¾è¡Œï¼Œä¸é€šè¿‡å°±è¿”å›é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>æ‹¦æˆªå™¨éªŒè¯çš„tokenä¸­å­˜åœ¨ç”¨æˆ·åå’Œå¯†ç ã€‚å¦‚æœæ–°å¢å‘˜å·¥ä¸šåŠ¡åœ¨æ‹¦æˆªå™¨æ‹¦æˆªæ—¶èƒ½å¤Ÿè·å–JWTä¸­çš„ä¿¡æ¯ï¼Œå°±èƒ½ç¡®å®šå½“å‰ç™»å½•å‘˜å·¥çš„IDã€‚</p>
</li>
</ul>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221150141394.png" alt="image-20240221150141394"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221150254097.png" alt="image-20240221150254097"></p>
<p>è§£æå‡ºç™»å½•å‘˜å·¥IDä¹‹åï¼Œå¦‚ä½•ä¼ é€’ç»™Serviceçš„saveæ–¹æ³•?</p>
<p>ç­”ï¼šThreadLocalã€‚</p>
<p>ThreadLocalå¹¶ä¸æ˜¯ä¸€ä¸ªThreadï¼Œè€Œæ˜¯Threadçš„å±€éƒ¨å˜é‡ã€‚</p>
<p><font color="red">ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›å•ç‹¬ä¸€ä»½å­˜å‚¨ç©ºé—´ï¼Œå…·æœ‰çº¿ç¨‹éš”ç¦»çš„æ•ˆæœï¼Œåªæœ‰åœ¨çº¿ç¨‹å†…æ‰èƒ½è·å–å¯¹åº”çš„å€¼ï¼Œçº¿ç¨‹å¤–åˆ™ä¸èƒ½è®¿é—®ã€‚</font></p>
<p><font color="red">å®¢æˆ·ç«¯å‘èµ·çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œtomcatéƒ½ä¼šä¸ºå…¶åˆ†é…å•ç‹¬çš„çº¿ç¨‹ï¼Œåœ¨çº¿ç¨‹ä¸Šå¯èƒ½è¦æ‰§è¡Œä¸åŒçš„ä»£ç ï¼Œæ¯”å¦‚æ‹¦æˆªå™¨ä»£ç ï¼Œcontrollerä»£ç ï¼Œserviceä»£ç ï¼Œå®ƒä»¬éƒ½å±äºåŒä¸€ä¸ªçº¿ç¨‹ã€‚åªè¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ThreadLocalï¼Œå°†æˆ‘ä»¬çš„æ•°æ®å­˜è¿›å»ï¼Œåœ¨å¯¹åº”çš„åœ°æ–¹å–å‡ºæ¥ã€‚</font></p>
<p>ThreadLocalå¸¸ç”¨æ–¹æ³•</p>
<ul>
<li>public void set(T value) è®¾ç½®å½“å‰çº¿ç¨‹çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼</li>
<li>public T get() è¿”å›å½“å‰çº¿ç¨‹æ‰€å¯¹åº”çš„çº¿ç¨‹å±€éƒ¨å˜é‡çš„å€¼</li>
<li>public void remove() ç§»é™¤å½“å‰çº¿ç¨‹çš„çº¿ç¨‹å±€éƒ¨å˜é‡</li>
</ul>
<p>æˆ‘ä»¬ä½¿ç”¨ThreadLocalæ—¶é€šå¸¸çš„åšæ³•æ˜¯å°†å…¶å°è£…ä¸ºå·¥å…·ç±»ï¼Œè¿™æ ·ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221151624886.png" alt="image-20240221151624886"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseContext</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ThreadLocal&lt;Long&gt; threadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setCurrentId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        threadLocal.set(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Long <span class="title function_">getCurrentId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> threadLocal.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">removeCurrentId</span><span class="params">()</span> &#123;</span><br><span class="line">        threadLocal.remove();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å®ç°æ­¥éª¤</p>
<ol>
<li><p>åœ¨JWTæ‹¦æˆªå™¨éƒ¨åˆ†å°†è§£æå‡ºæ¥çš„IDå€¼åŠ å…¥åˆ°Threadä¸­ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221152153763.png" alt="image-20240221152153763"></p>
</li>
<li><p>åœ¨æ–°å¢å‘˜å·¥ä¸šåŠ¡å°†å¯¹åº”çš„Threadå€¼å­˜å…¥æ•°æ®è¡¨ä¸­</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221152257216.png" alt="image-20240221152257216"></p>
</li>
</ol>
<h1 id="å‘˜å·¥åˆ†é¡µæŸ¥è¯¢"><a href="#å‘˜å·¥åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="å‘˜å·¥åˆ†é¡µæŸ¥è¯¢"></a>å‘˜å·¥åˆ†é¡µæŸ¥è¯¢</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-1"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-1" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221152741313.png" alt="image-20240221152741313"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>æ ¹æ®é¡µç å±•ç¤ºå‘˜å·¥ä¿¡æ¯</li>
<li>æ¯é¡µå±•ç¤º10æ¡æ•°æ®</li>
<li>åˆ†é¡µæŸ¥è¯¢æ—¶å¯ä»¥æ ¹æ®éœ€è¦ï¼Œè¾“å…¥å‘˜å·¥å§“åè¿›è¡ŒæŸ¥è¯¢</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p>æ“ä½œæ˜¯æŸ¥è¯¢æ“ä½œï¼Œè¯·æ±‚æ–¹å¼æ˜¯getç±»å‹ï¼Œåˆ†é¡µæŸ¥è¯¢éœ€è¦å°†é¡µç ï¼Œæ¯ä¸€é¡µçš„è®°å½•æ•°ï¼Œå‘˜å·¥å§“åä½œä¸ºæŸ¥è¯¢å‚æ•°å‘é€ç»™åç«¯ï¼Œåç«¯éœ€è¦å±•ç¤ºæ€»çš„è®°å½•æ•°ï¼Œå¹¶ä¸”å°†å½“å‰é¡µå±•ç¤ºçš„æ•°æ®é›†åˆå“åº”ç»™å‰ç«¯ã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221153439677.png" alt="image-20240221153439677"></p>
<p>è¯·æ±‚å‚æ•°æ˜¯ä»¥Queryçš„æ–¹å¼ä¼ åˆ°åç«¯çš„ï¼Œç›¸å½“äºåœ¨urlåé¢åŠ å‚æ•°å’Œå€¼ã€‚è¿™æ„å‘³ç€controllerå±‚å¯¹åº”æ–¹æ³•è¦åŠ ä¸Šä¸ä¹‹åŒåçš„å½¢å‚ã€‚</p>
<h2 id="ä»£ç å¼€å‘-1"><a href="#ä»£ç å¼€å‘-1" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p>æ ¹æ®åˆ†é¡µæŸ¥è¯¢æ¥å£è®¾è®¡å¯¹åº”çš„DTOã€‚</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221154353897.png" alt="image-20240221154353897"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221154344482.png" alt="image-20240221154344482"></p>
<p>åé¢æ‰€æœ‰çš„åˆ†é¡µæŸ¥è¯¢ï¼Œç»Ÿä¸€éƒ½å°è£…æˆPageResultå¯¹è±¡ï¼š</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221154906603.png" alt="image-20240221154906603"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221154939771.png" alt="image-20240221154939771"></p>
<p>å‘˜å·¥ä¿¡æ¯åˆ†é¡µæŸ¥è¯¢åç«¯è¿”å›çš„å¯¹è±¡ç±»å‹ä¸ºï¼šResult&lt;PageResult&gt;</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221155025472.png" alt="image-20240221155025472"></p>
<p><strong>controllerå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;å‘˜å·¥åˆ†é¡µæŸ¥è¯¢&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&gt; <span class="title function_">page</span><span class="params">(EmployeePageQueryDTO employeePageQueryDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å‘˜å·¥åˆ†é¡µæŸ¥è¯¢ï¼šå‚æ•°ä¸ºï¼š&#123;&#125;&quot;</span>,employeePageQueryDTO);</span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> employeeService.pageQuery(employeePageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(pageResult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.PasswordConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountLockedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountNotFoundException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.PasswordErrorException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.DigestUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmployeeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employeePageQueryDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult <span class="title function_">pageQuery</span><span class="params">(EmployeePageQueryDTO employeePageQueryDTO)</span> &#123;</span><br><span class="line"><span class="comment">//        //1.è®¾ç½®åˆ†é¡µå‚æ•°</span></span><br><span class="line"><span class="comment">//        PageHelper.startPage(employeePageQueryDTO.getPage(),employeePageQueryDTO.getPageSize());</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        //2.æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">//        List&lt;Employee&gt; empList = employeeMapper.list();</span></span><br><span class="line"><span class="comment">//        Page&lt;Employee&gt; p = (Page&lt;Employee&gt;) empList;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        // 3. å°è£…PageBeanå¯¹è±¡</span></span><br><span class="line"><span class="comment">//        PageResult pageResult = new PageResult(p.getTotal(),p.getResult());</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        return pageResult;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¼€å§‹åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        PageHelper.startPage(employeePageQueryDTO.getPage(),employeePageQueryDTO.getPageSize());</span><br><span class="line"></span><br><span class="line">        Page&lt;Employee&gt; page = employeeMapper.pageQuery(employeePageQueryDTO);</span><br><span class="line"></span><br><span class="line">        <span class="type">PageResult</span> <span class="variable">pageResult</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageResult</span>(page.getTotal(), page.getResult());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageResult;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç ç¼–å†™</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from employee&quot;)</span></span><br><span class="line">    List&lt;Employee&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Page&lt;Employee&gt; <span class="title function_">pageQuery</span><span class="params">(EmployeePageQueryDTO employeePageQueryDTO)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”çš„mapper.xmlæ–‡ä»¶ç¼–å†™pageQueryå®ç°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;pageQuery&quot;</span>  <span class="attr">resultType</span>=<span class="string">&quot;com.sky.entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        select * from employee</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;name != null and name != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by create_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-1"><a href="#åŠŸèƒ½æµ‹è¯•-1" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p>å¯ä»¥é€šè¿‡æ¥å£æ–‡æ¡£è¿›è¡Œæµ‹è¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‰åç«¯è”è°ƒæµ‹è¯•ï¼Œæœ€åæ“ä½œæ—¶é—´å­—æ®µå±•ç¤ºæœ‰é—®é¢˜ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221162938244.png" alt="image-20240221162938244"></p>
<h2 id="ä»£ç å®Œå–„-1"><a href="#ä»£ç å®Œå–„-1" class="headerlink" title="ä»£ç å®Œå–„"></a>ä»£ç å®Œå–„</h2><p>è§£å†³æ–¹å¼ï¼š</p>
<ul>
<li><p>æ–¹å¼ä¸€ï¼šåœ¨å±æ€§ä¸ŠåŠ å…¥æ³¨è§£ï¼Œå¯¹æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–ï¼ˆç¼ºç‚¹ï¼šåªèƒ½ç»™å•ä¸ªæˆå‘˜å˜é‡åŠ æ³¨é‡Šï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime updateTime;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221164702793.png" alt="image-20240221164702793"></p>
</li>
<li><p>æ–¹å¼äºŒï¼šåœ¨WebMvcConfigurationä¸­æ‹“å±•Spring MVCçš„æ¶ˆæ¯è½¬æ¢å™¨ï¼Œç»Ÿä¸€å¯¹æ—¥æœŸç±»å‹è¿›è¡Œæ ¼å¼åŒ–å¤„ç†</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221164331753.png" alt="image-20240221164331753"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.interceptor.JwtTokenAdminInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.sky.json.JacksonObjectMapper;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»ï¼Œæ³¨å†Œwebå±‚ç›¸å…³ç»„ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtTokenAdminInterceptor jwtTokenAdminInterceptor;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰©å±•Spring MVCæ¡†æ¶çš„æ¶ˆæ¯è½¬åŒ–å™¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converters</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">extendMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ¶ˆæ¯è½¬æ¢å™¨å¯¹è±¡</span></span><br><span class="line">        <span class="type">MappingJackson2HttpMessageConverter</span> <span class="variable">converter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éœ€è¦ä¸ºæ¶ˆæ¯è½¬æ¢å™¨è®¾ç½®ä¸€ä¸ªå¯¹è±¡è½¬æ¢å™¨ï¼Œå¯¹è±¡è½¬æ¢å™¨å¯ä»¥å°†Javaå¯¹è±¡åºåˆ—åŒ–ä¸ºjsonæ•°ç»„</span></span><br><span class="line">        converter.setObjectMapper(<span class="keyword">new</span> <span class="title class_">JacksonObjectMapper</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†æˆ‘ä»¬è‡ªå·±çš„è½¬æ¢å™¨æ”¾å…¥spring MVCæ¡†æ¶çš„å®¹å™¨ä¸­</span></span><br><span class="line">        converters.add(<span class="number">0</span>,converter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JacksonObjectMapperç›¸å…³ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.DeserializationFeature;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.<span class="keyword">module</span>.SimpleModule;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalDateDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.deser.LocalTimeDeserializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalDateSerializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.ser.LocalTimeSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalTime;</span><br><span class="line"><span class="keyword">import</span> java.time.format.DateTimeFormatter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¹è±¡æ˜ å°„å™¨:åŸºäºjacksonå°†Javaå¯¹è±¡è½¬ä¸ºjsonï¼Œæˆ–è€…å°†jsonè½¬ä¸ºJavaå¯¹è±¡</span></span><br><span class="line"><span class="comment"> * å°†JSONè§£æä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸º [ä»JSONååºåˆ—åŒ–Javaå¯¹è±¡]</span></span><br><span class="line"><span class="comment"> * ä»Javaå¯¹è±¡ç”ŸæˆJSONçš„è¿‡ç¨‹ç§°ä¸º [åºåˆ—åŒ–Javaå¯¹è±¡åˆ°JSON]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JacksonObjectMapper</span> <span class="keyword">extends</span> <span class="title class_">ObjectMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_DATE_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd&quot;</span>;</span><br><span class="line">    <span class="comment">//public static final String DEFAULT_DATE_TIME_FORMAT = &quot;yyyy-MM-dd HH:mm:ss&quot;;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_DATE_TIME_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;yyyy-MM-dd HH:mm&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEFAULT_TIME_FORMAT</span> <span class="operator">=</span> <span class="string">&quot;HH:mm:ss&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">JacksonObjectMapper</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="comment">//æ”¶åˆ°æœªçŸ¥å±æ€§æ—¶ä¸æŠ¥å¼‚å¸¸</span></span><br><span class="line">        <span class="built_in">this</span>.configure(FAIL_ON_UNKNOWN_PROPERTIES, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ååºåˆ—åŒ–æ—¶ï¼Œå±æ€§ä¸å­˜åœ¨çš„å…¼å®¹å¤„ç†</span></span><br><span class="line">        <span class="built_in">this</span>.getDeserializationConfig().withoutFeatures(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);</span><br><span class="line"></span><br><span class="line">        <span class="type">SimpleModule</span> <span class="variable">simpleModule</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleModule</span>()</span><br><span class="line">                .addDeserializer(LocalDateTime.class, <span class="keyword">new</span> <span class="title class_">LocalDateTimeDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))</span><br><span class="line">                .addDeserializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))</span><br><span class="line">                .addDeserializer(LocalTime.class, <span class="keyword">new</span> <span class="title class_">LocalTimeDeserializer</span>(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)))</span><br><span class="line">                .addSerializer(LocalDateTime.class, <span class="keyword">new</span> <span class="title class_">LocalDateTimeSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))</span><br><span class="line">                .addSerializer(LocalDate.class, <span class="keyword">new</span> <span class="title class_">LocalDateSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))</span><br><span class="line">                .addSerializer(LocalTime.class, <span class="keyword">new</span> <span class="title class_">LocalTimeSerializer</span>(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ³¨å†ŒåŠŸèƒ½æ¨¡å— ä¾‹å¦‚ï¼Œå¯ä»¥æ·»åŠ è‡ªå®šä¹‰åºåˆ—åŒ–å™¨å’Œååºåˆ—åŒ–å™¨</span></span><br><span class="line">        <span class="built_in">this</span>.registerModule(simpleModule);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·"><a href="#å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·" class="headerlink" title="å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·"></a>å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-2"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-2" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹ï¼š</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221170119891.png" alt="image-20240221170119891"></p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>å¯ä»¥å¯¹çŠ¶æ€ä¸ºâ€œå¯ç”¨â€çš„å‘˜å·¥è´¦å·è¿›è¡Œâ€œç¦ç”¨â€æ“ä½œ</li>
<li>å¯ä»¥å¯¹çŠ¶æ€ä¸ºâ€œç¦ç”¨â€çš„å‘˜å·¥è´¦å·è¿›è¡Œâ€œå¯ç”¨â€æ“ä½œ</li>
<li>çŠ¶æ€ä¸ºâ€œç¦ç”¨â€çš„å‘˜å·¥è´¦å·ä¸èƒ½ç™»å½•ç³»ç»Ÿ</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221170325406.png" alt="image-20240221170325406"></p>
<p><font color="red">æ³¨æ„è¿™é‡Œçš„statusæ˜¯è·¯å¾„å‚æ•°ï¼Œä½†æ˜¯idæ˜¯queryæ–¹å¼ä¼ ä¸Šå»çš„ã€‚äºæ˜¯æˆ‘ä»¬åœ¨controllerå±‚æ¥å—è¿™ä¸ªä¸¤ä¸ªå‚æ•°æ—¶ï¼Œstatusè¦ç”¨@PathVariableæ³¨è§£ã€‚idåˆ™ç›´æ¥ä½œä¸ºå‡½æ•°çš„å‚æ•°å½¢å‚ä¼ å…¥å³å¯ã€‚</font></p>
<h2 id="ä»£ç å¼€å‘-2"><a href="#ä»£ç å¼€å‘-2" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><p><strong>ç¼–å†™controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">startOrStop</span><span class="params">(<span class="meta">@PathVariable</span> Integer status,Long id)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·:&#123;&#125;,&#123;&#125;&quot;</span>,status,id);</span><br><span class="line"></span><br><span class="line">        employeeService.startOrStop(status,id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.PasswordConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountLockedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountNotFoundException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.PasswordErrorException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.DigestUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmployeeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ç”¨ç¦ç”¨å‘˜å·¥è´¦å·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> status</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">startOrStop</span><span class="params">(Integer status, Long id)</span> &#123;</span><br><span class="line">        <span class="comment">// update employee set status = ? where id = ?</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/*Employee employee = new Employee();</span></span><br><span class="line"><span class="comment">        employee.setStatus(status);</span></span><br><span class="line"><span class="comment">        employee.setId(id);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> Employee.builder()</span><br><span class="line">            .status(status)</span><br><span class="line">            .id(id)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        employeeMapper.update(employee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸»é”®åŠ¨æ€ä¿®æ”¹å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Employee&quot;</span>&gt;</span></span><br><span class="line">        update employee</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>name = #&#123;name&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null&quot;</span>&gt;</span>password = #&#123;password&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null&quot;</span>&gt;</span>username = #&#123;username&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;phone != null&quot;</span>&gt;</span>phone = #&#123;phone&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null&quot;</span>&gt;</span>sex = #&#123;sex&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;idNumber != null&quot;</span>&gt;</span>id_Number = #&#123;idNumber&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateTime != null&quot;</span>&gt;</span>update_time = #&#123;updateTime&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateUser != null&quot;</span>&gt;</span>update_user = #&#123;updateUser&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span>status = #&#123;status&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="åŠŸèƒ½æµ‹è¯•-2"><a href="#åŠŸèƒ½æµ‹è¯•-2" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221174844571.png" alt="image-20240221174844571"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221174911640.png" alt="image-20240221174911640"></p>
<h1 id="ç¼–è¾‘å‘˜å·¥"><a href="#ç¼–è¾‘å‘˜å·¥" class="headerlink" title="ç¼–è¾‘å‘˜å·¥"></a>ç¼–è¾‘å‘˜å·¥</h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-3"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-3" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221175433011.png" alt="image-20240221175433011"></p>
<p>å¯¹å‘˜å·¥ä¿¡æ¯è¿›è¡Œæ“ä½œï¼Œèƒ½å¤Ÿä¿®æ”¹çš„é€‰é¡¹å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p>
<p>è¦å®Œæˆç¼–è¾‘å‘˜å·¥çš„ä¸šåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™è¾¹æœ‰ä¸€ä¸ªå›æ˜¾æ“ä½œï¼Œå›å†™éœ€è¦æ ¹æ®å‘˜å·¥çš„IDæŸ¥è¯¢å‡ºæ•°æ®ï¼Œç„¶åæ‰èƒ½åœ¨è¿™ä¸ªé¡µé¢å›æ˜¾æ•°æ®ã€‚</p>
<p>æ‰€ä»¥ç¬¬ä¸€æ­¥è¦æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œç¬¬äºŒæ­¥åœ¨è¡¨å•é¡µé¢è¿›è¡Œä¿¡æ¯ä¿®æ”¹ã€‚</p>
<p>ç¼–è¾‘å‘˜å·¥åŠŸèƒ½æ¶‰åŠåˆ°ä¸¤ä¸ªæ¥å£ï¼š</p>
<ul>
<li><p>æ ¹æ®idæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221180539074.png" alt="image-20240221180539074"></p>
</li>
<li><p>ç¼–è¾‘å‘˜å·¥ä¿¡æ¯ï¼ˆå®ƒå±äºä¿®æ”¹ç±»çš„æ“ä½œï¼Œæ‰€ä»¥è¯·æ±‚æ–¹å¼æ˜¯PUTï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221180634012.png" alt="image-20240221180634012"></p>
</li>
</ul>
<h2 id="ä»£ç å¼€å‘-3"><a href="#ä»£ç å¼€å‘-3" class="headerlink" title="ä»£ç å¼€å‘"></a>ä»£ç å¼€å‘</h2><ul>
<li><p>æ ¹æ®idæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221180539074.png" alt="image-20240221180539074"></p>
</li>
</ul>
<p><strong>controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Employee&gt; <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeService.getById(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success(employee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.PasswordConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountLockedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountNotFoundException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.PasswordErrorException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.DigestUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmployeeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®idæŸ¥è¯¢å‘˜å·¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Employee <span class="title function_">getById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeMapper.getById(id);</span><br><span class="line">        employee.setPassword(<span class="string">&quot;****&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> employee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.image.RescaleOp;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸»é”®åŠ¨æ€ä¿®æ”¹å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sky.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;pageQuery&quot;</span>  <span class="attr">resultType</span>=<span class="string">&quot;com.sky.entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        select * from employee</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;name != null and name != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">                name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by create_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Employee&quot;</span>&gt;</span></span><br><span class="line">        update employee</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>name = #&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;password != null&quot;</span>&gt;</span>password = #&#123;password&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;username != null&quot;</span>&gt;</span>username = #&#123;username&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;phone != null&quot;</span>&gt;</span>phone = #&#123;phone&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != null&quot;</span>&gt;</span>sex = #&#123;sex&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;idNumber != null&quot;</span>&gt;</span>id_Number = #&#123;idNumber&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateTime != null&quot;</span>&gt;</span>update_time = #&#123;updateTime&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;updateUser != null&quot;</span>&gt;</span>update_user = #&#123;updateUser&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;status != null&quot;</span>&gt;</span>status = #&#123;status&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li><p>ç¼–è¾‘å‘˜å·¥ä¿¡æ¯ï¼ˆå®ƒå±äºä¿®æ”¹ç±»çš„æ“ä½œï¼Œæ‰€ä»¥è¯·æ±‚æ–¹å¼æ˜¯PUTï¼‰</p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221180634012.png" alt="image-20240221180634012"></p>
</li>
</ul>
<p><strong>controllerå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.controller.admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.constant.JwtClaimsConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.properties.JwtProperties;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> com.sky.utils.JwtUtil;</span><br><span class="line"><span class="keyword">import</span> com.sky.vo.EmployeeLoginVO;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/employee&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;å‘˜å·¥ç›¸å…³æ¥å£&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeService employeeService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JwtProperties jwtProperties;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼–è¾‘å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employeeDTO</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ç¼–è¾‘å‘˜å·¥ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="meta">@PutMapping</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> EmployeeDTO employeeDTO)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;ç¼–è¾‘å‘˜å·¥ä¿¡æ¯ï¼š&#123;&#125;&quot;</span>,employeeDTO);</span><br><span class="line">        employeeService.update(employeeDTO);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.MessageConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.PasswordConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.constant.StatusConstant;</span><br><span class="line"><span class="keyword">import</span> com.sky.context.BaseContext;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeLoginDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountLockedException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.AccountNotFoundException;</span><br><span class="line"><span class="keyword">import</span> com.sky.exception.PasswordErrorException;</span><br><span class="line"><span class="keyword">import</span> com.sky.mapper.EmployeeMapper;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.PageResult;</span><br><span class="line"><span class="keyword">import</span> com.sky.service.EmployeeService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.DigestUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmployeeService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¼–è¾‘å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employeeDTO</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(EmployeeDTO employeeDTO)</span> &#123;</span><br><span class="line">        <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Employee</span>();</span><br><span class="line">        BeanUtils.copyProperties(employeeDTO, employee);</span><br><span class="line">        employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        employee.setUpdateUser(BaseContext.getCurrentId());</span><br><span class="line"></span><br><span class="line">        employeeMapper.update(employee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeeDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.dto.EmployeePageQueryDTO;</span><br><span class="line"><span class="keyword">import</span> com.sky.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> com.sky.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PutMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.image.RescaleOp;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸»é”®åŠ¨æ€ä¿®æ”¹å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> employee</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="åŠŸèƒ½æµ‹è¯•-3"><a href="#åŠŸèƒ½æµ‹è¯•-3" class="headerlink" title="åŠŸèƒ½æµ‹è¯•"></a>åŠŸèƒ½æµ‹è¯•</h2><p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221193142242.png" alt="image-20240221193142242"></p>
<h1 id="å¯¼å…¥åˆ†ç±»æ¨¡å—åŠŸèƒ½ä»£ç "><a href="#å¯¼å…¥åˆ†ç±»æ¨¡å—åŠŸèƒ½ä»£ç " class="headerlink" title="å¯¼å…¥åˆ†ç±»æ¨¡å—åŠŸèƒ½ä»£ç "></a>å¯¼å…¥åˆ†ç±»æ¨¡å—åŠŸèƒ½ä»£ç </h1><h2 id="éœ€æ±‚åˆ†æå’Œè®¾è®¡-4"><a href="#éœ€æ±‚åˆ†æå’Œè®¾è®¡-4" class="headerlink" title="éœ€æ±‚åˆ†æå’Œè®¾è®¡"></a>éœ€æ±‚åˆ†æå’Œè®¾è®¡</h2><p><strong>äº§å“åŸå‹</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221193359609.png" alt="image-20240221193359609"></p>
<p>èœå“åˆ†ç±»å’Œå¥—é¤åˆ†ç±»ï¼Œè¿˜æœ‰ä¿®æ”¹ã€æŸ¥è¯¢ã€ç¦ç”¨æ“ä½œã€‚</p>
<p>ä¸šåŠ¡è§„åˆ™ï¼š</p>
<ul>
<li>åˆ†ç±»åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</li>
<li>åˆ†ç±»æŒ‰ç…§ç±»å‹å¯ä»¥åˆ†ä¸ºèœå“åˆ†ç±»å’Œå¥—é¤åˆ†ç±»ã€‚</li>
<li>æ–°æ·»åŠ çš„åˆ†ç±»çŠ¶æ€é»˜è®¤ä¸ºâ€œç¦ç”¨â€ã€‚</li>
</ul>
<p><strong>æ¥å£è®¾è®¡</strong></p>
<ul>
<li>æ–°å¢åˆ†ç±»</li>
<li>åˆ†ç±»åˆ†é¡µæŸ¥è¯¢</li>
<li>æ ¹æ®idåˆ é™¤åˆ†ç±»</li>
<li>ä¿®æ”¹åˆ†ç±»</li>
<li>å¯ç”¨ç¦ç”¨åˆ†ç±»</li>
<li>æ ¹æ®ç±»å‹æŸ¥è¯¢åˆ†ç±»</li>
</ul>
<p><strong>åˆ†ç±»æ¥å£</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221193942346.png" alt="image-20240221193942346"></p>
<p><strong>æ•°æ®åº“è®¾è®¡ï¼ˆcategoryè¡¨ï¼‰</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221194404816.png" alt="image-20240221194404816"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221222612780.png" alt="image-20240221222612780"></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221223226040.png" alt="image-20240221223226040"></p>
<p><strong>ç¬¬ä¸‰æ–¹å¯¼å…¥çš„ç±»å»ºè®®æœ€å¥½å†ç¼–è¯‘ä¸€ä¸‹</strong></p>
<p><img src="/2024/02/21/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day02-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E3%80%81%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20240221223333510.png" alt="image-20240221223333510"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>è‹ç©¹å¤–å–-day01-é¡¹ç›®æ¦‚è¿°ã€ç¯å¢ƒæ­å»º</title>
    <url>/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/</url>
    <content><![CDATA[<h1 id="è¯¾ç¨‹ä¼˜åŠ¿"><a href="#è¯¾ç¨‹ä¼˜åŠ¿" class="headerlink" title="è¯¾ç¨‹ä¼˜åŠ¿"></a>è¯¾ç¨‹ä¼˜åŠ¿</h1><p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220181432990.png" alt="image-20240220181432990"></p>
<h1 id="è¯¾ç¨‹å®‰æ’"><a href="#è¯¾ç¨‹å®‰æ’" class="headerlink" title="è¯¾ç¨‹å®‰æ’"></a>è¯¾ç¨‹å®‰æ’</h1><p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220181624181.png" alt="image-20240220181624181"></p>
<h1 id="é¡¹ç›®æ•ˆæœæ¼”ç¤º"><a href="#é¡¹ç›®æ•ˆæœæ¼”ç¤º" class="headerlink" title="é¡¹ç›®æ•ˆæœæ¼”ç¤º"></a>é¡¹ç›®æ•ˆæœæ¼”ç¤º</h1><p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220181837351.png" alt="image-20240220181837351"></p>
<p><strong>ç®¡ç†ç«¯</strong></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220181935488.png" alt="image-20240220181935488"></p>
<p><strong>ç”¨æˆ·ç«¯</strong></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220181957327.png" alt="image-20240220181957327"></p>
<h1 id="é¡¹ç›®æ¦‚è¿°ã€ç¯å¢ƒæ­å»º"><a href="#é¡¹ç›®æ¦‚è¿°ã€ç¯å¢ƒæ­å»º" class="headerlink" title="é¡¹ç›®æ¦‚è¿°ã€ç¯å¢ƒæ­å»º"></a>é¡¹ç›®æ¦‚è¿°ã€ç¯å¢ƒæ­å»º</h1><h2 id="è½¯ä»¶å¼€å‘æ•´ä½“ä»‹ç»"><a href="#è½¯ä»¶å¼€å‘æ•´ä½“ä»‹ç»" class="headerlink" title="è½¯ä»¶å¼€å‘æ•´ä½“ä»‹ç»"></a>è½¯ä»¶å¼€å‘æ•´ä½“ä»‹ç»</h2><h3 id="è½¯ä»¶å¼€å‘æµç¨‹"><a href="#è½¯ä»¶å¼€å‘æµç¨‹" class="headerlink" title="è½¯ä»¶å¼€å‘æµç¨‹"></a>è½¯ä»¶å¼€å‘æµç¨‹</h3><p><strong>éœ€æ±‚åˆ†æ</strong>ï¼šéœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ã€äº§å“åŸå‹</p>
<p>éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ï¼šwordè§„æ ¼çš„å†…å®¹ã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184001140.png" alt="image-20240220184001140"></p>
<p>äº§å“åŸå‹ï¼šé€šè¿‡é™æ€ç½‘é¡µçš„å½¢å¼æ¥å±•ç¤ºé¡¹ç›®å½“ä¸­ä¸€ä¸ªä¸ªä¸šåŠ¡åŠŸèƒ½ã€‚</p>
<p>ä»¥ä¸‹æ˜¯æ–°å¢å‘˜å·¥çš„ä¸šåŠ¡åŠŸèƒ½çš„é¡µé¢åŸå‹ã€‚</p>
<p> <img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184155834.png" alt="image-20240220184155834"></p>
<p><strong>è®¾è®¡</strong>ï¼šUIè®¾è®¡ã€æ•°æ®åº“è®¾è®¡ã€æ¥å£è®¾è®¡</p>
<p>UIè®¾è®¡ï¼šæœ€ç»ˆé¡¹ç›®åšå®Œä¹‹åçš„ç•Œé¢æ•ˆæœï¼Œå°åˆ°ä¸€ä¸ªæŒ‰é’®çš„æ•ˆæœï¼Œå¤§åˆ°é¡µé¢å¸ƒå±€ï¼ŒåŒ…æ‹¬äººæœºäº¤äº’çš„é€»è¾‘</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184312846.png" alt="image-20240220184312846"></p>
<p>æ•°æ®åº“è®¾è®¡ï¼šæ•°æ®åº“ç»“æ„ï¼Œæ¯ä¸ªè¡¨çš„å­—æ®µï¼Œç±»å‹ï¼Œå®šä¹‰å‡ºæ¥ï¼ŒåŒ…æ‹¬è¡¨ä¹‹é—´çš„å…³ç³»</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184434245.png" alt="image-20240220184434245"></p>
<p>æ¥å£è®¾è®¡ï¼šè¯·æ±‚æ–¹å¼ã€è¯·æ±‚è·¯å¾„ã€ä¼ çš„å‚æ•°ï¼Œè¿”å›æ•°æ®ç­‰è§„å®š</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184516432.png" alt="image-20240220184516432"></p>
<p><strong>ç¼–ç </strong>ï¼šé¡¹ç›®ä»£ç ã€å•å…ƒæµ‹è¯•ï¼ˆå¼€å‘äººå‘˜æµ‹è¯•ä»£ç ï¼Œç¡®ä¿ä»£ç æ­£ç¡®æœ‰æ•ˆï¼‰</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184549237.png" alt="image-20240220184549237"></p>
<p><strong>æµ‹è¯•</strong>ï¼šç¼–å†™æµ‹è¯•ç”¨ä¾‹ã€æµ‹è¯•æŠ¥å‘Š</p>
<p><strong>ä¸Šçº¿è¿ç»´</strong>ï¼šè½¯ä»¶ç¯å¢ƒçš„å®‰è£…ã€é…ç½®</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184638064.png" alt="image-20240220184638064"></p>
<h3 id="è§’è‰²åˆ†å·¥"><a href="#è§’è‰²åˆ†å·¥" class="headerlink" title="è§’è‰²åˆ†å·¥"></a>è§’è‰²åˆ†å·¥</h3><ul>
<li><p>é¡¹ç›®ç»ç†ï¼šå¯¹æ•´ä¸ªé¡¹ç›®è´Ÿè´£ã€ä»»åŠ¡åˆ†é…ï¼ŒæŠŠæ§è¿›åº¦ï¼ˆç®¡ç†è§’è‰²ï¼‰</p>
</li>
<li><p>äº§å“ç»ç†ï¼šè¿›è¡Œéœ€æ±‚è°ƒç ”ï¼Œè¾“å‡ºéœ€æ±‚è°ƒç ”æ–‡æ¡£ï¼Œäº§å“åŸå‹ç­‰</p>
</li>
<li><p>UIè®¾è®¡å¸ˆï¼šæ ¹æ®äº§å“åŸå‹è¾“å‡ºç•Œé¢æ•ˆæœå›¾</p>
</li>
<li><p>æ¶æ„å¸ˆï¼šé¡¹ç›®æ•´ä½“æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹</p>
</li>
<li><p>å¼€å‘å·¥ç¨‹å¸ˆï¼šä»£ç å®ç°</p>
</li>
<li><p>æµ‹è¯•å·¥ç¨‹å¸ˆï¼šç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œè¾“å‡ºæµ‹è¯•æŠ¥å‘Š</p>
</li>
<li><p>è¿ç»´å·¥ç¨‹å¸ˆï¼šè½¯ä»¶ç¯å¢ƒæ­å»ºã€é¡¹ç›®ä¸Šçº¿</p>
</li>
</ul>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220184900920.png" alt="image-20240220184900920"></p>
<h3 id="è½¯ä»¶ç¯å¢ƒ"><a href="#è½¯ä»¶ç¯å¢ƒ" class="headerlink" title="è½¯ä»¶ç¯å¢ƒ"></a>è½¯ä»¶ç¯å¢ƒ</h3><ul>
<li>å¼€å‘ç¯å¢ƒï¼ˆdevelopmentï¼‰ï¼šå¼€å‘äººå‘˜åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨çš„ç¯å¢ƒï¼Œä¸€èˆ¬å¤–éƒ¨ç”¨æˆ·æ— æ³•è®¿é—®</li>
<li>æµ‹è¯•ç¯å¢ƒï¼ˆtestingï¼‰ï¼šä¸“é—¨ç»™æµ‹è¯•äººå‘˜ä½¿ç”¨çš„ç¯å¢ƒï¼Œç”¨äºæµ‹è¯•é¡¹ç›®ï¼Œä¸€èˆ¬å¤–éƒ¨ç”¨æˆ·æ— æ³•è®¿é—®</li>
<li>ç”Ÿäº§ç¯å¢ƒï¼ˆproductionï¼‰ï¼šå³çº¿ä¸Šç¯å¢ƒï¼Œæ­£å¼æä¾›å¯¹å¤–æœåŠ¡çš„ç¯å¢ƒ</li>
</ul>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220191425242.png" alt="image-20240220191425242"></p>
<h2 id="è‹ç©¹å¤–å–é¡¹ç›®ä»‹ç»"><a href="#è‹ç©¹å¤–å–é¡¹ç›®ä»‹ç»" class="headerlink" title="è‹ç©¹å¤–å–é¡¹ç›®ä»‹ç»"></a>è‹ç©¹å¤–å–é¡¹ç›®ä»‹ç»</h2><h3 id="é¡¹ç›®ä»‹ç»"><a href="#é¡¹ç›®ä»‹ç»" class="headerlink" title="é¡¹ç›®ä»‹ç»"></a>é¡¹ç›®ä»‹ç»</h3><p>å®šä½ï¼šä¸“é—¨ä¸ºé¤é¥®ä¼ä¸šï¼ˆé¤å…ã€é¥­åº—ï¼‰å®šåˆ¶çš„ä¸€æ¬¾è½¯ä»¶äº§å“</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220191757076.png" alt="image-20240220191757076"></p>
<p>åŠŸèƒ½æ¶æ„ï¼šä½“ç°é¡¹ç›®ä¸­çš„ä¸šåŠ¡åŠŸèƒ½æ¨¡å—</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220191908865.png" alt="image-20240220191908865"></p>
<h3 id="äº§å“åŸå‹"><a href="#äº§å“åŸå‹" class="headerlink" title="äº§å“åŸå‹"></a>äº§å“åŸå‹</h3><p>äº§å“åŸå‹ï¼šç”¨äºå±•ç¤ºé¡¹ç›®çš„ä¸šåŠ¡åŠŸèƒ½ï¼šä¸€èˆ¬ç”±äº§å“ç»ç†è¿›è¡Œè®¾è®¡</p>
<p><strong>ç®¡ç†ç«¯</strong></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220192009154.png" alt="image-20240220192009154"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220192627836.png" alt="image-20240220192627836"></p>
<p><strong>ç”¨æˆ·ç«¯</strong></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220192018972.png" alt="image-20240220192018972"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220192554198.png" alt="image-20240220192554198"></p>
<h3 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h3><p>æŠ€æœ¯é€‰å‹ï¼š<font color="red">å±•ç¤ºé¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„æŠ€æœ¯æ¡†æ¶å’Œä¸­é—´ä»¶ç­‰</font></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220192934832.png" alt="image-20240220192934832"></p>
<h2 id="å¼€å‘ç¯å¢ƒæ­å»º"><a href="#å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="å¼€å‘ç¯å¢ƒæ­å»º"></a>å¼€å‘ç¯å¢ƒæ­å»º</h2><h3 id="å‰ç«¯ç¯å¢ƒæ­å»º"><a href="#å‰ç«¯ç¯å¢ƒæ­å»º" class="headerlink" title="å‰ç«¯ç¯å¢ƒæ­å»º"></a>å‰ç«¯ç¯å¢ƒæ­å»º</h3><p>å‰ç«¯ä»£ç å·²ç»å¼€å‘å¥½ï¼Œåªè¦ç¯å¢ƒè¿è¡Œèµ·æ¥å°±å¯ã€‚å·²ç»æä¾›äº†NginxæœåŠ¡å™¨ã€‚</p>
<h4 id="æ•´ä½“ç»“æ„"><a href="#æ•´ä½“ç»“æ„" class="headerlink" title="æ•´ä½“ç»“æ„"></a>æ•´ä½“ç»“æ„</h4><p>ç®¡ç†ç«¯ï¼ˆWebï¼‰æ˜¯åŸºäºNginxæœåŠ¡å™¨è¿è¡Œçš„ï¼Œè‡³äºç”¨æˆ·ç«¯ï¼ˆå°ç¨‹åºï¼‰çš„æ­å»ºï¼Œåœ¨å¼€å‘åˆ°ç›¸åº”é˜¶æ®µæ—¶å†è®¾ç½®ã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220193245072.png" alt="image-20240220193245072"></p>
<p>å‰ç«¯å·¥ç¨‹åŸºäºnginxè¿è¡Œã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220193724490.png" alt="image-20240220193724490"></p>
<p>å¯åŠ¨nginxï¼šåŒå‡»nginx.exeå³å¯å¯åŠ¨nginxæœåŠ¡ï¼Œè®¿é—®ç«¯å£å·é»˜è®¤ä¸º80ï¼ˆæ³¨æ„nginxè¦æ±‚åœ¨åŸè‹±æ–‡è·¯å¾„ä¸‹æ‰èƒ½æ­£å¸¸è¿è¡Œï¼‰</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220193911190.png" alt="image-20240220193911190"></p>
<h3 id="åç«¯ç¯å¢ƒæ­å»º"><a href="#åç«¯ç¯å¢ƒæ­å»º" class="headerlink" title="åç«¯ç¯å¢ƒæ­å»º"></a>åç«¯ç¯å¢ƒæ­å»º</h3><p>åç«¯å·¥ç¨‹åŸºäºmavenè¿›è¡Œé¡¹ç›®æ„å»ºï¼Œå¹¶ä¸”è¿›è¡Œåˆ†æ¨¡å—å¼€å‘</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220194118617.png" alt="image-20240220194118617"></p>
<p>ç”¨IDEAæ‰“å¼€åˆå§‹å·¥ç¨‹ï¼Œäº†è§£é¡¹ç›®çš„æ•´ä½“ç»“æ„</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220194259776.png" alt="image-20240220194259776"></p>
<table>
<thead>
<tr>
<th>åºå·</th>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>sky-take-out</td>
<td>mavençˆ¶å·¥ç¨‹ï¼Œç»Ÿä¸€ç®¡ç†ä»¥æ¥ç‰ˆæœ¬ï¼Œèšåˆå…¶ä»–å­æ¨¡å—</td>
</tr>
<tr>
<td>2</td>
<td>sky-common</td>
<td>å­æ¨¡å—ï¼Œå­˜æ”¾å…¬å…±ç±»ï¼Œä¾‹å¦‚ï¼šå·¥å…·ç±»ï¼Œå¸¸é‡ç±»ï¼Œå¼‚å¸¸ç±»ç­‰</td>
</tr>
<tr>
<td>3</td>
<td>sky-pojo</td>
<td>å­æ¨¡å—ï¼Œå­˜æ”¾å®ä½“ç±»ï¼ŒVOï¼ŒDTOç­‰</td>
</tr>
<tr>
<td>4</td>
<td>sky-server</td>
<td>å­æ¨¡å—ï¼Œåç«¯æœåŠ¡ï¼Œå­˜æ”¾é…ç½®æ–‡ä»¶ã€Controllerã€Serviceã€Mapperç­‰</td>
</tr>
</tbody></table>
<p>sky-commonå­æ¨¡å—ä¸­å­˜æ”¾çš„æ˜¯ä¸€äº›å…¬å…±ç±»ï¼Œå¯ä»¥ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220194544087.png" alt="image-20240220194544087"></p>
<p>sky-pojoå­æ¨¡å—ä¸­å­˜æ”¾çš„æ˜¯ä¸€äº›entityã€DTOã€VO</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220194710799.png" alt="image-20240220194710799"></p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Entity</td>
<td>å®ä½“ã€é€šå¸¸å’Œæ•°æ®åº“ä¸­çš„è¡¨å¯¹åº”</td>
</tr>
<tr>
<td>DTO</td>
<td>æ•°æ®ä¼ è¾“å¯¹è±¡ã€é€šå¸¸ç”¨äºç¨‹åºä¸­å„å±‚ä¹‹é—´ä¼ é€’æ•°æ®ï¼ˆå‰ç«¯æä¾›JSONï¼Œåç«¯ä½¿ç”¨DTOä½œä¸ºç±»å°è£…JSONï¼‰</td>
</tr>
<tr>
<td>VO</td>
<td>è§†å›¾å¯¹è±¡ï¼Œä¸ºå‰ç«¯å±•ç¤ºæ•°æ®æä¾›çš„å¯¹è±¡ï¼ˆåˆ—è¡¨æ•°æ®ï¼Œè¡¨å•æ•°æ®ç­‰ï¼‰</td>
</tr>
<tr>
<td>POJO</td>
<td>æ™®é€šJavaå¯¹è±¡ï¼Œåªæœ‰å±æ€§å’Œå¯¹åº”çš„getterå’Œsetter</td>
</tr>
</tbody></table>
<p>sky-serverå­æ¨¡å—ä¸­å­˜æ”¾çš„æ˜¯é…ç½®æ–‡ä»¶ã€é…ç½®ç±»ã€æ‹¦æˆªå™¨ã€controllerã€serviceã€mapperã€å¯åŠ¨ç±»ç­‰</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220195029539.png" alt="image-20240220195029539"></p>
<h4 id="ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶"><a href="#ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶"></a>ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶</h4><p>ä½¿ç”¨Gitè¿›è¡Œç‰ˆæœ¬ä»£ç çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œå…·ä½“æ“ä½œï¼š</p>
<ul>
<li><p>åˆ›å»ºGitæœ¬åœ°ä»“åº“</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220201845559.png" alt="image-20240220201845559"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220201900511.png" alt="image-20240220201900511"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220201713170.png" alt="image-20240220201713170"></p>
</li>
<li><p>åˆ›å»ºGitè¿œç¨‹ä»“åº“</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220202018386.png" alt="image-20240220202018386"></p>
</li>
<li><p>å°†æœ¬åœ°æ–‡ä»¶æ¨é€è‡³Gitè¿œç¨‹ä»“åº“</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220202041009.png" alt="image-20240220202041009"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220202403868.png" alt="image-20240220202403868"></p>
</li>
</ul>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220202637021.png" alt="image-20240220202637021"></p>
<h4 id="æ•°æ®åº“ç¯å¢ƒæ­å»º"><a href="#æ•°æ®åº“ç¯å¢ƒæ­å»º" class="headerlink" title="æ•°æ®åº“ç¯å¢ƒæ­å»º"></a>æ•°æ®åº“ç¯å¢ƒæ­å»º</h4><p>é€šè¿‡æ•°æ®åº“å»ºè¡¨è¯­å¥åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE  IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `sky_take_out` ;</span><br><span class="line">USE `sky_take_out`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `address_book`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `address_book` (</span><br><span class="line">                                `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                                `user_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">                                `consignee` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ”¶è´§äºº&#x27;</span>,</span><br><span class="line">                                `sex` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">                                `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">                                `province_code` <span class="type">varchar</span>(<span class="number">12</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çœçº§åŒºåˆ’ç¼–å·&#x27;</span>,</span><br><span class="line">                                `province_name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çœçº§åç§°&#x27;</span>,</span><br><span class="line">                                `city_code` <span class="type">varchar</span>(<span class="number">12</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¸‚çº§åŒºåˆ’ç¼–å·&#x27;</span>,</span><br><span class="line">                                `city_name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¸‚çº§åç§°&#x27;</span>,</span><br><span class="line">                                `district_code` <span class="type">varchar</span>(<span class="number">12</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åŒºçº§åŒºåˆ’ç¼–å·&#x27;</span>,</span><br><span class="line">                                `district_name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åŒºçº§åç§°&#x27;</span>,</span><br><span class="line">                                `detail` <span class="type">varchar</span>(<span class="number">200</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è¯¦ç»†åœ°å€&#x27;</span>,</span><br><span class="line">                                `label` <span class="type">varchar</span>(<span class="number">100</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ ‡ç­¾&#x27;</span>,</span><br><span class="line">                                `is_default` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é»˜è®¤ 0 å¦ 1æ˜¯&#x27;</span>,</span><br><span class="line">                                <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">2</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;åœ°å€ç°¿&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `category`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `category` (</span><br><span class="line">                            `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                            `type` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç±»å‹   1 èœå“åˆ†ç±» 2 å¥—é¤åˆ†ç±»&#x27;</span>,</span><br><span class="line">                            `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ†ç±»åç§°&#x27;</span>,</span><br><span class="line">                            `sort` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é¡ºåº&#x27;</span>,</span><br><span class="line">                            `status` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ†ç±»çŠ¶æ€ 0:ç¦ç”¨ï¼Œ1:å¯ç”¨&#x27;</span>,</span><br><span class="line">                            `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                            `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">                            `create_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">                            `update_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">                            <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">                            <span class="keyword">UNIQUE</span> KEY `idx_category_name` (`name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">23</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;èœå“åŠå¥—é¤åˆ†ç±»&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">11</span>,<span class="number">1</span>,<span class="string">&#x27;é…’æ°´é¥®æ–™&#x27;</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:09:18&#x27;</span>,<span class="string">&#x27;2022-06-09 22:09:18&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">12</span>,<span class="number">1</span>,<span class="string">&#x27;ä¼ ç»Ÿä¸»é£Ÿ&#x27;</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:09:32&#x27;</span>,<span class="string">&#x27;2022-06-09 22:18:53&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">13</span>,<span class="number">2</span>,<span class="string">&#x27;äººæ°”å¥—é¤&#x27;</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:11:38&#x27;</span>,<span class="string">&#x27;2022-06-10 11:04:40&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">15</span>,<span class="number">2</span>,<span class="string">&#x27;å•†åŠ¡å¥—é¤&#x27;</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:14:10&#x27;</span>,<span class="string">&#x27;2022-06-10 11:04:48&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">16</span>,<span class="number">1</span>,<span class="string">&#x27;èœ€å‘³çƒ¤é±¼&#x27;</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:15:37&#x27;</span>,<span class="string">&#x27;2022-08-31 14:27:25&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">17</span>,<span class="number">1</span>,<span class="string">&#x27;èœ€å‘³ç‰›è›™&#x27;</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:16:14&#x27;</span>,<span class="string">&#x27;2022-08-31 14:39:44&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">18</span>,<span class="number">1</span>,<span class="string">&#x27;ç‰¹è‰²è’¸èœ&#x27;</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:17:42&#x27;</span>,<span class="string">&#x27;2022-06-09 22:17:42&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">19</span>,<span class="number">1</span>,<span class="string">&#x27;æ–°é²œæ—¶è”¬&#x27;</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:18:12&#x27;</span>,<span class="string">&#x27;2022-06-09 22:18:28&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">20</span>,<span class="number">1</span>,<span class="string">&#x27;æ°´ç…®é±¼&#x27;</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:22:29&#x27;</span>,<span class="string">&#x27;2022-06-09 22:23:45&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` <span class="keyword">VALUES</span> (<span class="number">21</span>,<span class="number">1</span>,<span class="string">&#x27;æ±¤ç±»&#x27;</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:51:47&#x27;</span>,<span class="string">&#x27;2022-06-10 10:51:47&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `dish`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `dish` (</span><br><span class="line">                        `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                        `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“åç§°&#x27;</span>,</span><br><span class="line">                        `category_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“åˆ†ç±»id&#x27;</span>,</span><br><span class="line">                        `price` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“ä»·æ ¼&#x27;</span>,</span><br><span class="line">                        `image` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾ç‰‡&#x27;</span>,</span><br><span class="line">                        `description` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æè¿°ä¿¡æ¯&#x27;</span>,</span><br><span class="line">                        `status` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;0 åœå”® 1 èµ·å”®&#x27;</span>,</span><br><span class="line">                        `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                        `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">                        `create_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">                        `update_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">                        <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">                        <span class="keyword">UNIQUE</span> KEY `idx_dish_name` (`name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">70</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;èœå“&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">46</span>,<span class="string">&#x27;ç‹è€å‰&#x27;</span>,<span class="number">11</span>,<span class="number">6.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/41bfcacf-7ad4-4927-8b26-df366553a94c.png&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-09 22:40:47&#x27;</span>,<span class="string">&#x27;2022-06-09 22:40:47&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">47</span>,<span class="string">&#x27;åŒ—å†°æ´‹&#x27;</span>,<span class="number">11</span>,<span class="number">4.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/4451d4be-89a2-4939-9c69-3a87151cb979.png&#x27;</span>,<span class="string">&#x27;è¿˜æ˜¯å°æ—¶å€™çš„å‘³é“&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:18:49&#x27;</span>,<span class="string">&#x27;2022-06-10 09:18:49&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">48</span>,<span class="string">&#x27;é›ªèŠ±å•¤é…’&#x27;</span>,<span class="number">11</span>,<span class="number">4.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/bf8cbfc1-04d2-40e8-9826-061ee41ab87c.png&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:22:54&#x27;</span>,<span class="string">&#x27;2022-06-10 09:22:54&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">49</span>,<span class="string">&#x27;ç±³é¥­&#x27;</span>,<span class="number">12</span>,<span class="number">2.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/76752350-2121-44d2-b477-10791c23a8ec.png&#x27;</span>,<span class="string">&#x27;ç²¾é€‰äº”å¸¸å¤§ç±³&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:30:17&#x27;</span>,<span class="string">&#x27;2022-06-10 09:30:17&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">50</span>,<span class="string">&#x27;é¦’å¤´&#x27;</span>,<span class="number">12</span>,<span class="number">1.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/475cc599-8661-4899-8f9e-121dd8ef7d02.png&#x27;</span>,<span class="string">&#x27;ä¼˜è´¨é¢ç²‰&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:34:28&#x27;</span>,<span class="string">&#x27;2022-06-10 09:34:28&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">51</span>,<span class="string">&#x27;è€å›é…¸èœé±¼&#x27;</span>,<span class="number">20</span>,<span class="number">56.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/4a9cefba-6a74-467e-9fde-6e687ea725d7.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šæ±¤ï¼Œè‰é±¼ï¼Œé…¸èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:40:51&#x27;</span>,<span class="string">&#x27;2022-06-10 09:40:51&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">52</span>,<span class="string">&#x27;ç»å…¸é…¸èœé®°é±¼&#x27;</span>,<span class="number">20</span>,<span class="number">66.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/5260ff39-986c-4a97-8850-2ec8c7583efc.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šé…¸èœï¼Œæ±Ÿå›¢ï¼Œé®°é±¼&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:46:02&#x27;</span>,<span class="string">&#x27;2022-06-10 09:46:02&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">53</span>,<span class="string">&#x27;èœ€å‘³æ°´ç…®è‰é±¼&#x27;</span>,<span class="number">20</span>,<span class="number">38.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/a6953d5a-4c18-4b30-9319-4926ee77261f.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šè‰é±¼ï¼Œæ±¤&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:48:37&#x27;</span>,<span class="string">&#x27;2022-06-10 09:48:37&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">54</span>,<span class="string">&#x27;æ¸…ç‚’å°æ²¹èœ&#x27;</span>,<span class="number">19</span>,<span class="number">18.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/3613d38e-5614-41c2-90ed-ff175bf50716.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šå°æ²¹èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:51:46&#x27;</span>,<span class="string">&#x27;2022-06-10 09:51:46&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">55</span>,<span class="string">&#x27;è’œè“‰å¨ƒå¨ƒèœ&#x27;</span>,<span class="number">19</span>,<span class="number">18.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/4879ed66-3860-4b28-ba14-306ac025fdec.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šè’œï¼Œå¨ƒå¨ƒèœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:53:37&#x27;</span>,<span class="string">&#x27;2022-06-10 09:53:37&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">56</span>,<span class="string">&#x27;æ¸…ç‚’è¥¿å…°èŠ±&#x27;</span>,<span class="number">19</span>,<span class="number">18.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/e9ec4ba4-4b22-4fc8-9be0-4946e6aeb937.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šè¥¿å…°èŠ±&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:55:44&#x27;</span>,<span class="string">&#x27;2022-06-10 09:55:44&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">57</span>,<span class="string">&#x27;ç‚ç‚’åœ†ç™½èœ&#x27;</span>,<span class="number">19</span>,<span class="number">18.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/22f59feb-0d44-430e-a6cd-6a49f27453ca.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šåœ†ç™½èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 09:58:35&#x27;</span>,<span class="string">&#x27;2022-06-10 09:58:35&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">58</span>,<span class="string">&#x27;æ¸…è’¸é²ˆé±¼&#x27;</span>,<span class="number">18</span>,<span class="number">98.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/c18b5c67-3b71-466c-a75a-e63c6449f21c.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šé²ˆé±¼&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:12:28&#x27;</span>,<span class="string">&#x27;2022-06-10 10:12:28&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">59</span>,<span class="string">&#x27;ä¸œå¡è‚˜å­&#x27;</span>,<span class="number">18</span>,<span class="number">138.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/a80a4b8c-c93e-4f43-ac8a-856b0d5cc451.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šçŒªè‚˜æ£’&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:24:03&#x27;</span>,<span class="string">&#x27;2022-06-10 10:24:03&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">60</span>,<span class="string">&#x27;æ¢…èœæ‰£è‚‰&#x27;</span>,<span class="number">18</span>,<span class="number">58.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/6080b118-e30a-4577-aab4-45042e3f88be.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šçŒªè‚‰ï¼Œæ¢…èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:26:03&#x27;</span>,<span class="string">&#x27;2022-06-10 10:26:03&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">61</span>,<span class="string">&#x27;å‰æ¤’é±¼å¤´&#x27;</span>,<span class="number">18</span>,<span class="number">66.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/13da832f-ef2c-484d-8370-5934a1045a06.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šé²¢é±¼ï¼Œå‰æ¤’&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:28:54&#x27;</span>,<span class="string">&#x27;2022-06-10 10:28:54&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">62</span>,<span class="string">&#x27;é‡‘æ±¤é…¸èœç‰›è›™&#x27;</span>,<span class="number">17</span>,<span class="number">88.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/7694a5d8-7938-4e9d-8b9e-2075983a2e38.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šé²œæ´»ç‰›è›™ï¼Œé…¸èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:33:05&#x27;</span>,<span class="string">&#x27;2022-06-10 10:33:05&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">63</span>,<span class="string">&#x27;é¦™é”…ç‰›è›™&#x27;</span>,<span class="number">17</span>,<span class="number">88.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/f5ac8455-4793-450c-97ba-173795c34626.png&#x27;</span>,<span class="string">&#x27;é…æ–™ï¼šé²œæ´»ç‰›è›™ï¼Œè²è—•ï¼Œé’ç¬‹&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:35:40&#x27;</span>,<span class="string">&#x27;2022-06-10 10:35:40&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">64</span>,<span class="string">&#x27;é¦‹å˜´ç‰›è›™&#x27;</span>,<span class="number">17</span>,<span class="number">88.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/7a55b845-1f2b-41fa-9486-76d187ee9ee1.png&#x27;</span>,<span class="string">&#x27;é…æ–™ï¼šé²œæ´»ç‰›è›™ï¼Œä¸ç“œï¼Œé»„è±†èŠ½&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:37:52&#x27;</span>,<span class="string">&#x27;2022-06-10 10:37:52&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">65</span>,<span class="string">&#x27;è‰é±¼2æ–¤&#x27;</span>,<span class="number">16</span>,<span class="number">68.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/b544d3ba-a1ae-4d20-a860-81cb5dec9e03.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šè‰é±¼ï¼Œé»„è±†èŠ½ï¼Œè²è—•&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:41:08&#x27;</span>,<span class="string">&#x27;2022-06-10 10:41:08&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">66</span>,<span class="string">&#x27;æ±Ÿå›¢é±¼2æ–¤&#x27;</span>,<span class="number">16</span>,<span class="number">119.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/a101a1e9-8f8b-47b2-afa4-1abd47ea0a87.png&#x27;</span>,<span class="string">&#x27;é…æ–™ï¼šæ±Ÿå›¢é±¼ï¼Œé»„è±†èŠ½ï¼Œè²è—•&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:42:42&#x27;</span>,<span class="string">&#x27;2022-06-10 10:42:42&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">67</span>,<span class="string">&#x27;é®°é±¼2æ–¤&#x27;</span>,<span class="number">16</span>,<span class="number">72.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/8cfcc576-4b66-4a09-ac68-ad5b273c2590.png&#x27;</span>,<span class="string">&#x27;åŸæ–™ï¼šé®°é±¼ï¼Œé»„è±†èŠ½ï¼Œè²è—•&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:43:56&#x27;</span>,<span class="string">&#x27;2022-06-10 10:43:56&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">68</span>,<span class="string">&#x27;é¸¡è›‹æ±¤&#x27;</span>,<span class="number">21</span>,<span class="number">4.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/c09a0ee8-9d19-428d-81b9-746221824113.png&#x27;</span>,<span class="string">&#x27;é…æ–™ï¼šé¸¡è›‹ï¼Œç´«èœ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:54:25&#x27;</span>,<span class="string">&#x27;2022-06-10 10:54:25&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish` <span class="keyword">VALUES</span> (<span class="number">69</span>,<span class="string">&#x27;å¹³è‡è±†è…æ±¤&#x27;</span>,<span class="number">21</span>,<span class="number">6.00</span>,<span class="string">&#x27;https://sky-itcast.oss-cn-beijing.aliyuncs.com/16d0a3d6-2253-4cfc-9b49-bf7bd9eb2ad2.png&#x27;</span>,<span class="string">&#x27;é…æ–™ï¼šè±†è…ï¼Œå¹³è‡&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-06-10 10:55:02&#x27;</span>,<span class="string">&#x27;2022-06-10 10:55:02&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `dish_flavor`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `dish_flavor` (</span><br><span class="line">                               `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                               `dish_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“&#x27;</span>,</span><br><span class="line">                               `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å£å‘³åç§°&#x27;</span>,</span><br><span class="line">                               `<span class="keyword">value</span>` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å£å‘³æ•°æ®list&#x27;</span>,</span><br><span class="line">                               <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">104</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;èœå“å£å‘³å…³ç³»è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">40</span>,<span class="number">10</span>,<span class="string">&#x27;ç”œå‘³&#x27;</span>,<span class="string">&#x27;[\&quot;æ— ç³–\&quot;,\&quot;å°‘ç³–\&quot;,\&quot;åŠç³–\&quot;,\&quot;å¤šç³–\&quot;,\&quot;å…¨ç³–\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">41</span>,<span class="number">7</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">42</span>,<span class="number">7</span>,<span class="string">&#x27;æ¸©åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;çƒ­é¥®\&quot;,\&quot;å¸¸æ¸©\&quot;,\&quot;å»å†°\&quot;,\&quot;å°‘å†°\&quot;,\&quot;å¤šå†°\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">45</span>,<span class="number">6</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">46</span>,<span class="number">6</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">47</span>,<span class="number">5</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">48</span>,<span class="number">5</span>,<span class="string">&#x27;ç”œå‘³&#x27;</span>,<span class="string">&#x27;[\&quot;æ— ç³–\&quot;,\&quot;å°‘ç³–\&quot;,\&quot;åŠç³–\&quot;,\&quot;å¤šç³–\&quot;,\&quot;å…¨ç³–\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">49</span>,<span class="number">2</span>,<span class="string">&#x27;ç”œå‘³&#x27;</span>,<span class="string">&#x27;[\&quot;æ— ç³–\&quot;,\&quot;å°‘ç³–\&quot;,\&quot;åŠç³–\&quot;,\&quot;å¤šç³–\&quot;,\&quot;å…¨ç³–\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">50</span>,<span class="number">4</span>,<span class="string">&#x27;ç”œå‘³&#x27;</span>,<span class="string">&#x27;[\&quot;æ— ç³–\&quot;,\&quot;å°‘ç³–\&quot;,\&quot;åŠç³–\&quot;,\&quot;å¤šç³–\&quot;,\&quot;å…¨ç³–\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">51</span>,<span class="number">3</span>,<span class="string">&#x27;ç”œå‘³&#x27;</span>,<span class="string">&#x27;[\&quot;æ— ç³–\&quot;,\&quot;å°‘ç³–\&quot;,\&quot;åŠç³–\&quot;,\&quot;å¤šç³–\&quot;,\&quot;å…¨ç³–\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">52</span>,<span class="number">3</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">86</span>,<span class="number">52</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">87</span>,<span class="number">52</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">88</span>,<span class="number">51</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">89</span>,<span class="number">51</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">92</span>,<span class="number">53</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">93</span>,<span class="number">53</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">94</span>,<span class="number">54</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">95</span>,<span class="number">56</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">96</span>,<span class="number">57</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">97</span>,<span class="number">60</span>,<span class="string">&#x27;å¿Œå£&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¦è‘±\&quot;,\&quot;ä¸è¦è’œ\&quot;,\&quot;ä¸è¦é¦™èœ\&quot;,\&quot;ä¸è¦è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">101</span>,<span class="number">66</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">102</span>,<span class="number">67</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `dish_flavor` <span class="keyword">VALUES</span> (<span class="number">103</span>,<span class="number">65</span>,<span class="string">&#x27;è¾£åº¦&#x27;</span>,<span class="string">&#x27;[\&quot;ä¸è¾£\&quot;,\&quot;å¾®è¾£\&quot;,\&quot;ä¸­è¾£\&quot;,\&quot;é‡è¾£\&quot;]&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `employee`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employee` (</span><br><span class="line">                            `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                            `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">                            `username` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">                            `password` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">                            `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">                            `sex` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">                            `id_number` <span class="type">varchar</span>(<span class="number">18</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èº«ä»½è¯å·&#x27;</span>,</span><br><span class="line">                            `status` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;çŠ¶æ€ 0:ç¦ç”¨ï¼Œ1:å¯ç”¨&#x27;</span>,</span><br><span class="line">                            `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                            `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">                            `create_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">                            `update_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">                            <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">                            <span class="keyword">UNIQUE</span> KEY `idx_username` (`username`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">2</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;å‘˜å·¥ä¿¡æ¯&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `employee` <span class="keyword">VALUES</span> (<span class="number">1</span>,<span class="string">&#x27;ç®¡ç†å‘˜&#x27;</span>,<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;13812312312&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;110101199001010047&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2022-02-15 15:51:20&#x27;</span>,<span class="string">&#x27;2022-02-17 09:16:20&#x27;</span>,<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `order_detail`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `order_detail` (</span><br><span class="line">                                `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                                `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åå­—&#x27;</span>,</span><br><span class="line">                                `image` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾ç‰‡&#x27;</span>,</span><br><span class="line">                                `order_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•id&#x27;</span>,</span><br><span class="line">                                `dish_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“id&#x27;</span>,</span><br><span class="line">                                `setmeal_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥—é¤id&#x27;</span>,</span><br><span class="line">                                `dish_flavor` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å£å‘³&#x27;</span>,</span><br><span class="line">                                `number` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;æ•°é‡&#x27;</span>,</span><br><span class="line">                                `amount` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‡‘é¢&#x27;</span>,</span><br><span class="line">                                <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">5</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;è®¢å•æ˜ç»†è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `orders`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `orders` (</span><br><span class="line">                          `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                          `number` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•å·&#x27;</span>,</span><br><span class="line">                          `status` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;è®¢å•çŠ¶æ€ 1å¾…ä»˜æ¬¾ 2å¾…æ¥å• 3å·²æ¥å• 4æ´¾é€ä¸­ 5å·²å®Œæˆ 6å·²å–æ¶ˆ 7é€€æ¬¾&#x27;</span>,</span><br><span class="line">                          `user_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸‹å•ç”¨æˆ·&#x27;</span>,</span><br><span class="line">                          `address_book_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åœ°å€id&#x27;</span>,</span><br><span class="line">                          `order_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸‹å•æ—¶é—´&#x27;</span>,</span><br><span class="line">                          `checkout_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç»“è´¦æ—¶é—´&#x27;</span>,</span><br><span class="line">                          `pay_method` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;æ”¯ä»˜æ–¹å¼ 1å¾®ä¿¡,2æ”¯ä»˜å®&#x27;</span>,</span><br><span class="line">                          `pay_status` tinyint <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ”¯ä»˜çŠ¶æ€ 0æœªæ”¯ä»˜ 1å·²æ”¯ä»˜ 2é€€æ¬¾&#x27;</span>,</span><br><span class="line">                          `amount` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å®æ”¶é‡‘é¢&#x27;</span>,</span><br><span class="line">                          `remark` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¤‡æ³¨&#x27;</span>,</span><br><span class="line">                          `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">                          `address` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åœ°å€&#x27;</span>,</span><br><span class="line">                          `user_name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·åç§°&#x27;</span>,</span><br><span class="line">                          `consignee` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ”¶è´§äºº&#x27;</span>,</span><br><span class="line">                          `cancel_reason` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•å–æ¶ˆåŸå› &#x27;</span>,</span><br><span class="line">                          `rejection_reason` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•æ‹’ç»åŸå› &#x27;</span>,</span><br><span class="line">                          `cancel_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è®¢å•å–æ¶ˆæ—¶é—´&#x27;</span>,</span><br><span class="line">                          `estimated_delivery_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢„è®¡é€è¾¾æ—¶é—´&#x27;</span>,</span><br><span class="line">                          `delivery_status` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;é…é€çŠ¶æ€  1ç«‹å³é€å‡º  0é€‰æ‹©å…·ä½“æ—¶é—´&#x27;</span>,</span><br><span class="line">                          `delivery_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é€è¾¾æ—¶é—´&#x27;</span>,</span><br><span class="line">                          `pack_amount` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰“åŒ…è´¹&#x27;</span>,</span><br><span class="line">                          `tableware_number` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¤å…·æ•°é‡&#x27;</span>,</span><br><span class="line">                          `tableware_status` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;é¤å…·æ•°é‡çŠ¶æ€  1æŒ‰é¤é‡æä¾›  0é€‰æ‹©å…·ä½“æ•°é‡&#x27;</span>,</span><br><span class="line">                          <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;è®¢å•è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `setmeal`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `setmeal` (</span><br><span class="line">                           `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                           `category_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“åˆ†ç±»id&#x27;</span>,</span><br><span class="line">                           `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥—é¤åç§°&#x27;</span>,</span><br><span class="line">                           `price` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥—é¤ä»·æ ¼&#x27;</span>,</span><br><span class="line">                           `status` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;å”®å–çŠ¶æ€ 0:åœå”® 1:èµ·å”®&#x27;</span>,</span><br><span class="line">                           `description` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æè¿°ä¿¡æ¯&#x27;</span>,</span><br><span class="line">                           `image` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾ç‰‡&#x27;</span>,</span><br><span class="line">                           `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                           `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">                           `create_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">                           `update_user` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">                           <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">                           <span class="keyword">UNIQUE</span> KEY `idx_setmeal_name` (`name`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">32</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;å¥—é¤&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `setmeal_dish`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `setmeal_dish` (</span><br><span class="line">                                `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                                `setmeal_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥—é¤id&#x27;</span>,</span><br><span class="line">                                `dish_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“id&#x27;</span>,</span><br><span class="line">                                `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“åç§° ï¼ˆå†—ä½™å­—æ®µï¼‰&#x27;</span>,</span><br><span class="line">                                `price` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“å•ä»·ï¼ˆå†—ä½™å­—æ®µï¼‰&#x27;</span>,</span><br><span class="line">                                `copies` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“ä»½æ•°&#x27;</span>,</span><br><span class="line">                                <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">47</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;å¥—é¤èœå“å…³ç³»&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `shopping_cart`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `shopping_cart` (</span><br><span class="line">                                 `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                                 `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å•†å“åç§°&#x27;</span>,</span><br><span class="line">                                 `image` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾ç‰‡&#x27;</span>,</span><br><span class="line">                                 `user_id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                                 `dish_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå“id&#x27;</span>,</span><br><span class="line">                                 `setmeal_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¥—é¤id&#x27;</span>,</span><br><span class="line">                                 `dish_flavor` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å£å‘³&#x27;</span>,</span><br><span class="line">                                 `number` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;æ•°é‡&#x27;</span>,</span><br><span class="line">                                 `amount` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‡‘é¢&#x27;</span>,</span><br><span class="line">                                 `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                                 <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">9</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;è´­ç‰©è½¦&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `<span class="keyword">user</span>`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">                        `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">                        `openid` <span class="type">varchar</span>(<span class="number">45</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¾®ä¿¡ç”¨æˆ·å”¯ä¸€æ ‡è¯†&#x27;</span>,</span><br><span class="line">                        `name` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">                        `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">                        `sex` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">                        `id_number` <span class="type">varchar</span>(<span class="number">18</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èº«ä»½è¯å·&#x27;</span>,</span><br><span class="line">                        `avatar` <span class="type">varchar</span>(<span class="number">500</span>) <span class="keyword">COLLATE</span> utf8_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¤´åƒ&#x27;</span>,</span><br><span class="line">                        `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">                        <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">4</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_bin COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·ä¿¡æ¯&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220210022362.png" alt="image-20240220210022362"></p>
<h4 id="å‰åç«¯è”è°ƒ"><a href="#å‰åç«¯è”è°ƒ" class="headerlink" title="å‰åç«¯è”è°ƒ"></a>å‰åç«¯è”è°ƒ</h4><p>åç«¯çš„åˆå§‹å·¥ç¨‹å·²ç»å®ç°äº†ç™»å½•åŠŸèƒ½ï¼Œç›´æ¥è¿›è¡Œå‰åç«¯è”è°ƒæµ‹è¯•å³å¯</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220210553806.png" alt="image-20240220210553806"></p>
<ol>
<li><p>ç¼–è¯‘æ–‡ä»¶</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220225310010.png" alt="image-20240220225310010"></p>
</li>
<li><p>è¿è¡Œå¯åŠ¨ç±»</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220225423436.png" alt="image-20240220225423436"></p>
</li>
<li><p>ä¿®æ”¹é…ç½®é¡µé¢ï¼Œç¡®ä¿æ•°æ®åº“ç”¨æˆ·å¯†ç æ­£ç¡®</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220231214419.png" alt="image-20240220231214419"></p>
</li>
</ol>
<h4 id="Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡æ¦‚å¿µ"><a href="#Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡æ¦‚å¿µ" class="headerlink" title="Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡æ¦‚å¿µ"></a>Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡æ¦‚å¿µ</h4><p><strong>å‰ç«¯å‘é€çš„è¯·æ±‚ï¼Œæ˜¯å¦‚ä½•è¯·æ±‚åˆ°åç«¯æœåŠ¡çš„ï¼Ÿ</strong></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220232059536.png" alt="image-20240220232059536"></p>
<p>å‰ç«¯çš„è¯·æ±‚åœ°å€æ˜¯localhostï¼Œæ²¡æœ‰æŒ‡å®šç«¯å£å·ï¼Œé»˜è®¤80ï¼Œåé¢çš„è·¯å¾„æ˜¯api&#x2F;employee&#x2F;loginã€‚å‰ç«¯çš„è¯·æ±‚åœ°å€ï¼š<a href="http://localhost/api/employee/login">http://localhost/api/employee/login</a></p>
<p>åç«¯çš„æ¥å£åœ°å€æ˜¯ <a href="http://localhost:8080/admin/employee/login">http://localhost:8080/admin/employee/login</a></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220232208186.png" alt="image-20240220232208186"></p>
<p>å‰åç«¯çš„æ¥å£åœ°å€å¹¶æœªåŒ¹é…ï¼Œä½†æ˜¯è¯·æ±‚æˆåŠŸäº†ï¼Œè¿™æ˜¯é—®ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>åŸå› ï¼šnginxåå‘ä»£ç†ï¼Œå°±æ˜¯å°†å‰ç«¯å‘é€çš„åŠ¨æ€è¯·æ±‚ç”±nginxè½¬å‘åˆ°åç«¯æœåŠ¡å™¨ã€‚nginxåœ¨ä¹‹å‰çš„è¯¾ç¨‹ä¸­ä¸»è¦ç”¨æ¥éƒ¨ç½²é™æ€èµ„æºï¼ŒæŠŠå®ƒå½“ä½œHTTPæœåŠ¡å™¨ã€‚å®é™…ä¸Šnginxè¿˜å¯ä»¥ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œä¸€èˆ¬é€šè¿‡nginxåšåå‘ä»£ç†ï¼ŒæŠŠå‰ç«¯å‘è¿‡æ¥çš„åŠ¨æ€è¯·æ±‚è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220232459573.png" alt="image-20240220232459573"></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¹‹å‰çš„ç™»å½•è¯·æ±‚è¿‡ç¨‹å®é™…å¯ä»¥çœ‹ä½œå¦‚ä¸‹çš„è¿‡ç¨‹ï¼ˆnginxé€šè¿‡åå‘ä»£ç†è½¬å‘å‰ç«¯è¯·æ±‚åˆ°åç«¯çš„tomcatæœåŠ¡å™¨ï¼‰ï¼š</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220232723613.png" alt="image-20240220232723613"></p>
<p>ä¸ºä½•ä¸ç›´æ¥å°†å‰ç«¯çš„è¯·æ±‚å‘é€åˆ°åç«¯çš„tomcatæœåŠ¡å™¨ï¼Œè€Œæ˜¯è¦ç”¨nginxæœåŠ¡å™¨å‘¢ï¼Ÿ</p>
<p>nginxåå‘ä»£ç†çš„å¥½å¤„ï¼š</p>
<ul>
<li><p>æé«˜è®¿é—®é€Ÿåº¦ï¼ˆå‘nginxå‘é€ç›¸åŒè¯·æ±‚ï¼Œnginxå¯ä»¥ç¼“å­˜åç«¯æ•°æ®ï¼Œç›´æ¥è¿”å›ç›¸åº”çš„åç«¯æ•°æ®ï¼‰</p>
</li>
<li><p>è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼ˆ<font color="red">å°†å¤§é‡çš„è¯·æ±‚æŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„æ–¹å¼å‡è¡¡çš„åˆ†é…ç»™é›†ç¾¤ä¸­çš„æ¯å°æœåŠ¡å™¨</font>ï¼‰</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220232959729.png" alt="image-20240220232959729"></p>
</li>
<li><p>ä¿è¯åç«¯æœåŠ¡å®‰å…¨ï¼ˆæœåŠ¡å™¨å¾€å¾€éƒ¨ç½²åœ¨å…¬å¸å†…éƒ¨çš„å±€åŸŸç½‘å†…ï¼Œä¸æ˜¯å¯¹å¤–å¼€æ”¾çš„ï¼Œé€šè¿‡å‰ç«¯ä¸èƒ½ç›´æ¥è¯·æ±‚åˆ°åç«¯çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™è¦è¯·æ±‚åç«¯æœåŠ¡ï¼Œåªæœ‰è¿™ä¸ªå…¥å£ï¼Œå³å‰ç«¯å‘æ¥çš„è¯·æ±‚ï¼Œå…ˆè¯·æ±‚åˆ°nginxæœåŠ¡å™¨ï¼Œç„¶åå†ç”±nginxæœåŠ¡å™¨èµ°å†…ç½‘ï¼Œå°†è¿™ä¸ªè¯·æ±‚è½¬å‘ç»™åç«¯æœåŠ¡ï¼‰</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220233224248.png" alt="image-20240220233224248"></p>
</li>
</ul>
<h4 id="Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡é…ç½®"><a href="#Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡é…ç½®" class="headerlink" title="Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡é…ç½®"></a>Nginxåå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡é…ç½®</h4><p><strong>nginxåå‘ä»£ç†çš„é…ç½®æ–¹å¼</strong>(é…ç½®nginxçš„é…ç½®æ–‡ä»¶nginx.conf)ï¼š</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220233455762.png" alt="image-20240220233455762"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220233556775.png" alt="image-20240220233556775"></p>
<p><strong>nginxè´Ÿè½½å‡è¡¡çš„é…ç½®æ–¹å¼</strong>((é…ç½®nginxçš„é…ç½®æ–‡ä»¶nginx.conf)ï¼š</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220233837975.png" alt="image-20240220233837975"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220233846731.png" alt="image-20240220233846731"></p>
<p>ä¸»è¦é…ç½®webserversï¼Œå£°æ˜äº†ä¸¤ä¸ªåç«¯æœåŠ¡å™¨çš„8080ç«¯å£ã€‚è®©ä¸¤ä¸ªæœåŠ¡å™¨æ¥æ¥å—å‰ç«¯çš„è¯·æ±‚ï¼Œåº•å±‚è¿˜æ˜¯åŸºäºåå‘ä»£ç†ã€‚åªä¸è¿‡è´Ÿè½½å‡è¡¡è½¬å‘æ—¶éœ€è¦è½¬å‘åˆ°ä»»æ„ä¸€å°æœåŠ¡å™¨ã€‚</p>
<p>nginxè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼š</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>è½®è¯¢</td>
<td>é»˜è®¤æ–¹å¼</td>
</tr>
<tr>
<td>weight</td>
<td>æƒé‡æ–¹å¼ï¼Œé»˜è®¤ä¸º1ï¼Œæƒé‡è¶Šé«˜ï¼Œè¢«åˆ†é…çš„å®¢æˆ·ç«¯è¯·æ±‚å°±è¶Šå¤š</td>
</tr>
<tr>
<td>ip_hash</td>
<td>æ ¹æ®ipåˆ†é…æ–¹å¼ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å¯ä»¥å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡</td>
</tr>
<tr>
<td>least_conn</td>
<td>ä¾æ®æœ€å°‘è¿æ¥æ–¹å¼ï¼ŒæŠŠè¯·æ±‚ä¼˜å…ˆåˆ†é…ç»™è¿æ¥æ•°å°‘çš„åç«¯æœåŠ¡</td>
</tr>
<tr>
<td>url_hash</td>
<td>ä¾æ®urlåˆ†é…æ–¹å¼ï¼Œè¿™æ ·ç›¸åŒçš„urlä¼šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡</td>
</tr>
<tr>
<td>fair</td>
<td>ä¾æ®å“åº”æ—¶é—´æ–¹å¼ï¼Œå“åº”æ—¶é—´çŸ­çš„æœåŠ¡å°†ä¼šè¢«ä¼˜å…ˆåˆ†é…</td>
</tr>
</tbody></table>
<h3 id="å®Œå–„ç™»å½•åŠŸèƒ½"><a href="#å®Œå–„ç™»å½•åŠŸèƒ½" class="headerlink" title="å®Œå–„ç™»å½•åŠŸèƒ½"></a>å®Œå–„ç™»å½•åŠŸèƒ½</h3><p>é—®é¢˜ï¼šå‘˜å·¥è¡¨ä¸­çš„å¯†ç æ˜¯æ˜æ–‡å­˜å‚¨ï¼Œå®‰å…¨æ€§å¤ªä½ã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220235038781.png" alt="image-20240220235038781"></p>
<ol>
<li><p>å°†å¯†ç åŠ å¯†ä¹‹åå­˜å‚¨ï¼Œæé«˜å®‰å…¨æ€§</p>
</li>
<li><p>ä½¿ç”¨MD5 åŠ å¯†æ–¹å¼å¯¹æ˜æ–‡å¯†ç åŠ å¯†</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220235218252.png" alt="image-20240220235218252"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220235408563.png" alt="image-20240220235408563"></p>
</li>
</ol>
<p>å®ç°æ­¥éª¤</p>
<ol>
<li><p>ä¿®æ”¹æ•°æ®åº“ä¸­æ˜æ–‡å¯†ç ï¼Œæ”¹ä¸ºMD5åŠ å¯†åçš„å¯†æ–‡</p>
</li>
<li><p>ä¿®æ”¹Javaä»£ç ï¼Œå‰ç«¯æäº¤çš„ä»£ç è¿›è¡ŒMD5åŠ å¯†åå†è·Ÿæ•°æ®åº“ä¸­å¯†ç å¯¹æ¯”</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240220235547628.png" alt="image-20240220235547628"></p>
</li>
</ol>
<p><font color="red">æ‰¾åˆ°TODOæ ‡ç­¾é¡µï¼Œé‡Œé¢æœ‰æ‰€æœ‰é—ç•™é—®é¢˜çš„é“¾æ¥</font></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221000308322.png" alt="image-20240221000308322"></p>
<p>å®ŒæˆTODOå†…å®¹ï¼Œå…ˆå¯¹å‰ç«¯æ¥çš„passwordåšmd5åŠ å¯†ã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221001526426.png" alt="image-20240221001526426"></p>
<h2 id="å¯¼å…¥æ¥å£æ–‡æ¡£"><a href="#å¯¼å…¥æ¥å£æ–‡æ¡£" class="headerlink" title="å¯¼å…¥æ¥å£æ–‡æ¡£"></a>å¯¼å…¥æ¥å£æ–‡æ¡£</h2><p>å‰é¢å®Œæˆäº†å¼€å‘ç¯å¢ƒçš„æ­å»ºï¼Œåé¢è¦å¯¼å…¥æ¥å£æ–‡æ¡£ï¼Œå¼€å‘æ–¹å¼æ˜¯åŸºäºå‰åç«¯åˆ†ç¦»çš„å¼€å‘æ–¹å¼ï¼Œè¦æ±‚å¼€å‘ä¹‹å‰ï¼Œå…ˆå°†æ¥å£å®šä¹‰å¥½ï¼Œç„¶åå‘¢ï¼Œå‰åç«¯å¼€å‘äººå‘˜æ‰èƒ½å¹¶è¡Œå¼€å‘ã€‚æˆ‘ä»¬éœ€è¦å°†é¡¹ç›®çš„æ¥å£å¯¼å…¥åˆ°æ¥å£ç®¡ç†å¹³å°ï¼Œä¸ºä¸šåŠ¡å¼€å‘åšå¥½å‡†å¤‡ã€‚</p>
<p>æ¥å£æ˜¯å¼€å‘è¿‡ç¨‹ä¸­å‰åç«¯å¤šæ¬¡å¼€ä¼šå†³å®šçš„ï¼Œä¸”ä¼šä¸æ–­åœ°æ”¹è¿›ã€‚</p>
<h4 id="å‰åç«¯åˆ†ç¦»å¼€å‘æµç¨‹"><a href="#å‰åç«¯åˆ†ç¦»å¼€å‘æµç¨‹" class="headerlink" title="å‰åç«¯åˆ†ç¦»å¼€å‘æµç¨‹"></a>å‰åç«¯åˆ†ç¦»å¼€å‘æµç¨‹</h4><p>å‰åç«¯åˆ†ç¦»å¼€å‘æµç¨‹ï¼š</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002030439.png" alt="image-20240221002030439"></p>
<h4 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h4><p>å°†è¯¾ç¨‹èµ„æ–™ä¸­æä¾›çš„é¡¹ç›®æ¥å£å¯¼å…¥YApiã€‚</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002137198.png" alt="image-20240221002137198"></p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002354144.png" alt="image-20240221002354144"></p>
<p>å¯¼å…¥å¯¹åº”çš„ç®¡ç†ç«¯JSONæ–‡ä»¶</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002444885.png" alt="image-20240221002444885"></p>
<p>æŸ¥çœ‹æ¥å£å†…å®¹</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002651360.png" alt="image-20240221002651360"></p>
<p>åŒç†ä¸Šä¼ å®Œå®¢æˆ·ç«¯æ¥å£</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221002807634.png" alt="image-20240221002807634"></p>
<h2 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h2><p>å‰é¢å·²ç»å¯¼å…¥äº†æ¥å£æ–‡æ¡£ï¼Œæœ‰äº†æ¥å£æ–‡æ¡£ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å‘åç«¯çš„ä»£ç äº†ï¼Œå¦‚æœå¼€å‘å®Œäº†æŸä¸ªåŠŸèƒ½ï¼Œåç«¯å¦‚ä½•æ¥éªŒè¯åŠŸèƒ½æ˜¯å¦æ­£ç¡®ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æµ‹è¯•ï¼Œå¦‚ä½•æµ‹è¯•ï¼Œä¹‹å‰ä½¿ç”¨çš„æ˜¯postmanã€‚</p>
<p>ä½¿ç”¨postmanæœ‰ä¸ªé—®é¢˜ï¼Œæœ‰çš„æ¥å£è¯·æ±‚å‚æ•°è¿‡å¤šï¼Œå¦‚æœç”¨postmanæµ‹è¯•ï¼Œè¦æ„å»ºè®¸å¤šå‚æ•°ï¼Œ æ•ˆç‡è¿˜æ˜¯æ¯”è¾ƒä½çš„ï¼Œswaggeråº”è¿è€Œç”Ÿã€‚</p>
<p>swaggerå¸®åŠ©åç«¯é«˜æ•ˆç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œåç«¯çš„æ¥å£æµ‹è¯•ï¼Œå®ƒæ˜¯åç«¯å¼€å‘çš„å¸¸è§æŠ€æœ¯ã€‚</p>
<h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>ä½¿ç”¨Swaggeråªéœ€è¦æŒ‰ç…§å®ƒçš„è§„èŒƒå»å®šä¹‰æ¥å£åŠæ¥å£ç›¸å…³çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥åšåˆ°<strong>ç”Ÿæˆæ¥å£æ–‡æ¡£</strong>ï¼Œä»¥åŠ<strong>åœ¨çº¿æ¥å£è°ƒè¯•é¡µé¢</strong>ã€‚</p>
<p>å®˜ç½‘ï¼š<a href="https://swagger.io/">https://swagger.io/</a></p>
<p>Knife4jæ˜¯ä¸ºJava MVCæ¡†æ¶é›†æˆSwaggerç”ŸæˆAPiæ–‡æ¡£çš„å¢å¼ºè§£å†³æ–¹æ¡ˆã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221114241942.png" alt="image-20240221114241942"></p>
<h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><ol>
<li><p>å¯¼å…¥knife4jçš„mavenåæ ‡</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221114507874.png" alt="image-20240221114507874"></p>
</li>
<li><p>åœ¨é…ç½®ç±»ä¸­åŠ å…¥knife4jçš„ç›¸å…³é…ç½®</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221114520003.png" alt="image-20240221114520003"></p>
</li>
<li><p>è®¾ç½®é™æ€èµ„æºæ˜ å°„ï¼Œå¦åˆ™æ¥å£æ–‡æ¡£é¡µé¢æ— æ³•è®¿é—®</p>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221115134316.png" alt="image-20240221115134316"></p>
</li>
</ol>
<p>å®Œæ•´ä»£ç (WebMvcConfigurationåŠ äº†@Configurationï¼Œæ˜¯é…ç½®ç±»ï¼Œä¸”ç»§æ‰¿è‡ªWebMvcConfigurationSupport)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sky.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sky.interceptor.JwtTokenAdminInterceptor;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é…ç½®ç±»ï¼Œæ³¨å†Œwebå±‚ç›¸å…³ç»„ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfiguration</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡knife4jç”Ÿæˆæ¥å£æ–‡æ¡£</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">docket</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å‡†å¤‡ç”Ÿæˆæ¥å£æ–‡æ¡£...&quot;</span>);</span><br><span class="line">        <span class="type">ApiInfo</span> <span class="variable">apiInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line">                .title(<span class="string">&quot;è‹ç©¹å¤–å–é¡¹ç›®æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;2.0&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;è‹ç©¹å¤–å–é¡¹ç›®æ¥å£æ–‡æ¡£&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="type">Docket</span> <span class="variable">docket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo)</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.sky.controller&quot;</span>))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">return</span> docket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®é™æ€èµ„æºæ˜ å°„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> registry</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;å¼€å§‹è®¾ç½®é™æ€èµ„æºæ˜ å°„...&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/doc.html&quot;</span>).addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/&quot;</span>);</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/webjars/**&quot;</span>).addResourceLocations(<span class="string">&quot;classpath:/META-INF/resources/webjars/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>é€šè¿‡Swaggerå°±å¯ä»¥ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦Yapiäº†ï¼Ÿ</p>
<ol>
<li>Yapiæ˜¯æ¶‰åŠé˜¶æ®µä½¿ç”¨çš„å·¥å…·ï¼Œç®¡ç†å’Œç»´æŠ¤æ¥å£</li>
<li>Swaggeråœ¨å¼€å‘é˜¶æ®µä½¿ç”¨çš„æ¡†æ¶ï¼Œå¸®åŠ©åç«¯äººå‘˜åšåç«¯çš„æ¥å£æµ‹è¯•</li>
</ol>
<h3 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h3><p>é€šè¿‡æ³¨è§£å¯ä»¥æ§åˆ¶ç”Ÿæˆçš„æ¥å£æ–‡æ¡£ï¼Œä½¿æ¥å£æ–‡æ¡£æ‹¥æœ‰æ›´å¥½çš„å¯è¯»æ€§ï¼Œå¸¸ç”¨æ³¨è§£å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>@Api</td>
<td>ç”¨åœ¨ç±»ä¸Šï¼Œä¾‹å¦‚Controllerï¼Œè¡¨ç¤ºå¯¹ç±»çš„è¯´æ˜</td>
</tr>
<tr>
<td>@ApiModel</td>
<td>ç”¨åœ¨ç±»ä¸Šï¼Œä¾‹å¦‚entityã€DTOã€VOï¼Œè¡¨ç¤ºå¯¹ç”¨é€”çš„è¯´æ˜</td>
</tr>
<tr>
<td>@ApiModelProperty</td>
<td>ç”¨åœ¨å±æ€§ä¸Šï¼Œæè¿°å±æ€§ä¿¡æ¯</td>
</tr>
<tr>
<td>@ApiOperation</td>
<td>ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œä¾‹å¦‚Controllerçš„æ–¹æ³•ï¼Œè¯´æ˜æ–¹æ³•çš„ç”¨é€”ã€ä½œç”¨</td>
</tr>
</tbody></table>
<p>ä¾‹å¦‚</p>
<ul>
<li>@Api(tags &#x3D; â€œå‘˜å·¥ç›¸å…³æ¥å£â€)</li>
<li>@ApiOperation(value &#x3D; â€œå‘˜å·¥ç™»å½•â€)</li>
<li>@ApiModel(description &#x3D; â€œå‘˜å·¥ç™»å½•è¿”å›çš„æ•°æ®æ ¼å¼â€)</li>
<li>@ApiModelProperty(â€œç”¨æˆ·åâ€)</li>
</ul>
<p><img src="/2024/02/20/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96-day01/image-20240221122024885.png" alt="image-20240221122024885"></p>
]]></content>
      <categories>
        <category>è‹ç©¹å¤–å–</category>
      </categories>
  </entry>
  <entry>
    <title>mybatisplus-day01</title>
    <url>/2024/02/18/mybatisplus-day01/</url>
    <content><![CDATA[<h1 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h1><h2 id="å…¥é—¨æ¡ˆä¾‹Mybatis"><a href="#å…¥é—¨æ¡ˆä¾‹Mybatis" class="headerlink" title="å…¥é—¨æ¡ˆä¾‹Mybatis"></a>å…¥é—¨æ¡ˆä¾‹Mybatis</h2><p>éœ€æ±‚ï¼šåŸºäºè¯¾ç¨‹èµ„æ–™æä¾›çš„é¡¹ç›®ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li>æ–°å¢ç”¨æˆ·åŠŸèƒ½</li>
<li>æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</li>
<li>æ ¹æ®idæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·</li>
<li>æ ¹æ®idæ›´æ–°ç”¨æˆ·</li>
<li>æ ¹æ®idåˆ é™¤ç”¨æˆ·</li>
</ol>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218131908492.png" alt="image-20240218131908492"></p>
<p>åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“è¡¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- å¯¼å‡º mp çš„æ•°æ®åº“ç»“æ„</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `mp` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci */</span> <span class="comment">/*!80016 DEFAULT ENCRYPTION=&#x27;N&#x27; */</span>;</span><br><span class="line">USE `mp`;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¯¼å‡º  è¡¨ mp.address ç»“æ„</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `address` (</span><br><span class="line">                                         `id` <span class="type">bigint</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">                                         `user_id` <span class="type">bigint</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·ID&#x27;</span>,</span><br><span class="line">                                         `province` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çœ&#x27;</span>,</span><br><span class="line">                                         `city` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¸‚&#x27;</span>,</span><br><span class="line">                                         `town` <span class="type">varchar</span>(<span class="number">10</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¿/åŒº&#x27;</span>,</span><br><span class="line">                                         `mobile` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœº&#x27;</span>,</span><br><span class="line">                                         `street` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è¯¦ç»†åœ°å€&#x27;</span>,</span><br><span class="line">                                         `contact` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è”ç³»äºº&#x27;</span>,</span><br><span class="line">                                         `is_default` bit(<span class="number">1</span>) <span class="keyword">DEFAULT</span> b<span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦æ˜¯é»˜è®¤ 1é»˜è®¤ 0å¦&#x27;</span>,</span><br><span class="line">                                         `notes` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¤‡æ³¨&#x27;</span>,</span><br><span class="line">                                         `deleted` bit(<span class="number">1</span>) <span class="keyword">DEFAULT</span> b<span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;é€»è¾‘åˆ é™¤&#x27;</span>,</span><br><span class="line">                                         <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">                                         KEY `user_id` (`user_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">71</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 ROW_FORMAT<span class="operator">=</span>COMPACT;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ­£åœ¨å¯¼å‡ºè¡¨  mp.address çš„æ•°æ®ï¼š~11 rows (å¤§çº¦)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `address` (`id`, `user_id`, `province`, `city`, `town`, `mobile`, `street`, `contact`, `is_default`, `notes`, `deleted`) <span class="keyword">VALUES</span></span><br><span class="line">                                                                                                                                         (<span class="number">59</span>, <span class="number">2</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;æœé˜³åŒº&#x27;</span>, <span class="string">&#x27;13900112222&#x27;</span>, <span class="string">&#x27;é‡‘ç‡•é¾™åŠå…¬æ¥¼&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">60</span>, <span class="number">1</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;æœé˜³åŒº&#x27;</span>, <span class="string">&#x27;13700221122&#x27;</span>, <span class="string">&#x27;ä¿®æ­£å¤§å¦&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">61</span>, <span class="number">1</span>, <span class="string">&#x27;ä¸Šæµ·&#x27;</span>, <span class="string">&#x27;ä¸Šæµ·&#x27;</span>, <span class="string">&#x27;æµ¦ä¸œæ–°åŒº&#x27;</span>, <span class="string">&#x27;13301212233&#x27;</span>, <span class="string">&#x27;èˆªå¤´é•‡èˆªå¤´è·¯&#x27;</span>, <span class="string">&#x27;Jack&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">63</span>, <span class="number">2</span>, <span class="string">&#x27;å¹¿ä¸œ&#x27;</span>, <span class="string">&#x27;ä½›å±±&#x27;</span>, <span class="string">&#x27;æ°¸æ˜¥&#x27;</span>, <span class="string">&#x27;13301212233&#x27;</span>, <span class="string">&#x27;æ°¸æ˜¥æ­¦é¦†&#x27;</span>, <span class="string">&#x27;Rose&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">64</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13567809102&#x27;</span>, <span class="string">&#x27;æµ™æ±Ÿå¤§å­¦&#x27;</span>, <span class="string">&#x27;Hope&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">65</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hope&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">66</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">67</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hopey&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">68</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">69</span>, <span class="number">3</span>, <span class="string">&#x27;æµ™æ±Ÿ&#x27;</span>, <span class="string">&#x27;æ­å·&#x27;</span>, <span class="string">&#x27;æ‹±å¢…åŒº&#x27;</span>, <span class="string">&#x27;13967589201&#x27;</span>, <span class="string">&#x27;å·¦å²¸èŠ±å›­&#x27;</span>, <span class="string">&#x27;Hopey&#x27;</span>, b<span class="string">&#x27;0&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                                                                                                                                         (<span class="number">70</span>, <span class="number">4</span>, <span class="string">&#x27;æ¹–åŒ—&#x27;</span>, <span class="string">&#x27;æ­¦æ±‰&#x27;</span>, <span class="string">&#x27;æ±‰å£&#x27;</span>, <span class="string">&#x27;13967519202&#x27;</span>, <span class="string">&#x27;å¤©å¤©èŠ±å›­&#x27;</span>, <span class="string">&#x27;Thomas&#x27;</span>, b<span class="string">&#x27;1&#x27;</span>, <span class="keyword">NULL</span>, b<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¯¼å‡º  è¡¨ mp.user ç»“æ„</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">                        `id` <span class="type">BIGINT</span>(<span class="number">19</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">                        `username` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span> <span class="keyword">COLLATE</span> <span class="string">&#x27;utf8_general_ci&#x27;</span>,</span><br><span class="line">                        `password` <span class="type">VARCHAR</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span> <span class="keyword">COLLATE</span> <span class="string">&#x27;utf8_general_ci&#x27;</span>,</span><br><span class="line">                        `phone` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ³¨å†Œæ‰‹æœºå·&#x27;</span> <span class="keyword">COLLATE</span> <span class="string">&#x27;utf8_general_ci&#x27;</span>,</span><br><span class="line">                        `info` JSON <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è¯¦ç»†ä¿¡æ¯&#x27;</span>,</span><br><span class="line">                        `status` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;1&#x27;</span> COMMENT <span class="string">&#x27;ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸ 2å†»ç»“ï¼‰&#x27;</span>,</span><br><span class="line">                        `balance` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è´¦æˆ·ä½™é¢&#x27;</span>,</span><br><span class="line">                        `create_time` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">                        `update_time` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">                        <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">                        <span class="keyword">UNIQUE</span> INDEX `username` (`username`) <span class="keyword">USING</span> BTREE</span><br><span class="line">)</span><br><span class="line">    COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span></span><br><span class="line">    <span class="keyword">COLLATE</span><span class="operator">=</span><span class="string">&#x27;utf8_general_ci&#x27;</span></span><br><span class="line">    ENGINE<span class="operator">=</span>InnoDB</span><br><span class="line">    ROW_FORMAT<span class="operator">=</span>COMPACT</span><br><span class="line">    AUTO_INCREMENT<span class="operator">=</span><span class="number">5</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ­£åœ¨å¯¼å‡ºè¡¨  mp.user çš„æ•°æ®ï¼š~4 rows (å¤§çº¦)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` (`id`, `username`, `password`, `phone`, `info`, `status`, `balance`, `create_time`, `update_time`) <span class="keyword">VALUES</span></span><br><span class="line">                                                                                                                          (<span class="number">1</span>, <span class="string">&#x27;Jack&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;13900112224&#x27;</span>, <span class="string">&#x27;&#123;&quot;age&quot;: 20, &quot;intro&quot;: &quot;ä½›ç³»é’å¹´&quot;, &quot;gender&quot;: &quot;male&quot;&#125;&#x27;</span>, <span class="number">1</span>, <span class="number">1600</span>, <span class="string">&#x27;2023-05-19 20:50:21&#x27;</span>, <span class="string">&#x27;2023-06-19 20:50:21&#x27;</span>),</span><br><span class="line">                                                                                                                          (<span class="number">2</span>, <span class="string">&#x27;Rose&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;13900112223&#x27;</span>, <span class="string">&#x27;&#123;&quot;age&quot;: 19, &quot;intro&quot;: &quot;é’æ¶©å°‘å¥³&quot;, &quot;gender&quot;: &quot;female&quot;&#125;&#x27;</span>, <span class="number">1</span>, <span class="number">600</span>, <span class="string">&#x27;2023-05-19 21:00:23&#x27;</span>, <span class="string">&#x27;2023-06-19 21:00:23&#x27;</span>),</span><br><span class="line">                                                                                                                          (<span class="number">3</span>, <span class="string">&#x27;Hope&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;13900112222&#x27;</span>, <span class="string">&#x27;&#123;&quot;age&quot;: 25, &quot;intro&quot;: &quot;ä¸Šè¿›é’å¹´&quot;, &quot;gender&quot;: &quot;male&quot;&#125;&#x27;</span>, <span class="number">1</span>, <span class="number">100000</span>, <span class="string">&#x27;2023-06-19 22:37:44&#x27;</span>, <span class="string">&#x27;2023-06-19 22:37:44&#x27;</span>),</span><br><span class="line">                                                                                                                          (<span class="number">4</span>, <span class="string">&#x27;Thomas&#x27;</span>, <span class="string">&#x27;123&#x27;</span>, <span class="string">&#x27;17701265258&#x27;</span>, <span class="string">&#x27;&#123;&quot;age&quot;: 29, &quot;intro&quot;: &quot;ä¼åœ°é­”&quot;, &quot;gender&quot;: &quot;male&quot;&#125;&#x27;</span>, <span class="number">1</span>, <span class="number">800</span>, <span class="string">&#x27;2023-06-19 23:44:45&#x27;</span>, <span class="string">&#x27;2023-06-19 23:44:45&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>åœ¨application.ymlä¸­è®¾ç½®æ•°æ®åº“è¿æ¥ç›¸å…³ä¿¡æ¯</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line"><span class="comment">#    url: jdbc:mysql://127.0.0.1:3306/mp?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/mp</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®mybatisçš„æ—¥å¿—ä¿¡æ¯ï¼ŒæŒ‡å®šè¾“å‡ºè‡³æ§åˆ¶å°</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.example:</span> <span class="string">debug</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="attr">dateformat:</span> <span class="string">HH:mm:ss</span></span><br></pre></td></tr></table></figure>

<p>è®¾ç½®pom.xmlé…ç½®ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;project xmlns=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">         xsi:schemaLocation=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br><span class="line">    &lt;modelVersion&gt;<span class="number">4.0</span><span class="number">.0</span>&lt;/modelVersion&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;<span class="number">3.1</span><span class="number">.6</span>&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    &lt;groupId&gt;com.example&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mp-demo&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">0.0</span><span class="number">.1</span>-SNAPSHOT&lt;/version&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;java.version&gt;<span class="number">17</span>&lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.mysql&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;runtime&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">            &lt;optional&gt;<span class="literal">true</span>&lt;/optional&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;<span class="number">3.5</span><span class="number">.3</span><span class="number">.1</span>&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">                &lt;configuration&gt;</span><br><span class="line">                    &lt;excludes&gt;</span><br><span class="line">                        &lt;exclude&gt;</span><br><span class="line">                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class="line">                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class="line">                        &lt;/exclude&gt;</span><br><span class="line">                    &lt;/excludes&gt;</span><br><span class="line">                &lt;/configuration&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line"></span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<p>è®¾ç½®Mapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//public interface UserMapper extends BaseMapper&lt;User&gt; &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    User <span class="title function_">queryUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Long id)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; <span class="title function_">queryUserByIds</span><span class="params">(<span class="meta">@Param(&quot;ids&quot;)</span> List&lt;Long&gt; ids)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è®¾ç½®Userå®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·id</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">//æ³¨å†Œæ‰‹æœºå·</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="comment">//è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸2å†»ç»“ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç¼–å†™UserMapper.xmlå®ç°æ¥å£çš„sqlè¯­å¥</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.example.mapper.UserMapper&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;insert id=<span class="string">&quot;saveUser&quot;</span> parameterType=<span class="string">&quot;com.example.pojo.User&quot;</span>&gt;</span><br><span class="line">        insert into <span class="title function_">user</span><span class="params">(id, username, password, phone, info, balance)</span></span><br><span class="line">        values (#&#123;id&#125;, #&#123;username&#125;, #&#123;password&#125;, #&#123;phone&#125;, #&#123;info&#125;, #&#123;balance&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line">    &lt;update id=<span class="string">&quot;updateUser&quot;</span> parameterType=<span class="string">&quot;com.example.pojo.User&quot;</span>&gt;</span><br><span class="line">        update user</span><br><span class="line">        &lt;set&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;username != null&quot;</span>&gt;</span><br><span class="line">                username = #&#123;username&#125;,</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;password != null&quot;</span>&gt;</span><br><span class="line">                password = #&#123;password&#125;,</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;phone != null&quot;</span>&gt;</span><br><span class="line">                phone = #&#123;phone&#125;,</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;info != null&quot;</span>&gt;</span><br><span class="line">                info = #&#123;info&#125;,</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;status != null&quot;</span>&gt;</span><br><span class="line">                status = #&#123;status&#125;,</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">            &lt;<span class="keyword">if</span> test=<span class="string">&quot;balance != null&quot;</span>&gt;</span><br><span class="line">                balance = #&#123;balance&#125;</span><br><span class="line">            &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">        &lt;/set&gt;</span><br><span class="line">        <span class="type">where</span> <span class="variable">id</span> <span class="operator">=</span> #&#123;id&#125;;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">    &lt;delete id=<span class="string">&quot;deleteUser&quot;</span> parameterType=<span class="string">&quot;com.example.pojo.User&quot;</span>&gt;</span><br><span class="line">        delete</span><br><span class="line">        from user</span><br><span class="line">        <span class="type">where</span> <span class="variable">id</span> <span class="operator">=</span> #&#123;id&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=<span class="string">&quot;queryUserById&quot;</span> resultType=<span class="string">&quot;com.example.pojo.User&quot;</span>&gt;</span><br><span class="line">        select *</span><br><span class="line">        from user</span><br><span class="line">        <span class="type">where</span> <span class="variable">id</span> <span class="operator">=</span> #&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=<span class="string">&quot;queryUserByIds&quot;</span> resultType=<span class="string">&quot;com.example.pojo.User&quot;</span>&gt;</span><br><span class="line">        select * from user</span><br><span class="line">        &lt;<span class="keyword">if</span> test=<span class="string">&quot;ids != null&quot;</span>&gt;</span><br><span class="line">            where id in</span><br><span class="line">            &lt;foreach collection=<span class="string">&quot;ids&quot;</span> open=<span class="string">&quot;(&quot;</span> close=<span class="string">&quot;)&quot;</span> item=<span class="string">&quot;id&quot;</span> separator=<span class="string">&quot;,&quot;</span>&gt;</span><br><span class="line">                #&#123;id&#125;</span><br><span class="line">            &lt;/foreach&gt;</span><br><span class="line">        &lt;/<span class="keyword">if</span>&gt;</span><br><span class="line">        LIMIT <span class="number">10</span></span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨å•å…ƒæµ‹è¯•ä¸­ç¼–å†™ç›¸åº”çš„æµ‹è¯•æ–¹æ³•å®Œæˆæµ‹è¯•æ¡ˆä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MpDemoApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSaveUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="comment">//        user.setId(1L); // å‡è®¾IDæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹</span></span><br><span class="line">        user.setUsername(<span class="string">&quot;TestUser&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;password123&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line">        user.setInfo(<span class="string">&quot;&#123;\&quot;age\&quot;:30,\&quot;gender\&quot;:\&quot;male\&quot;&#125;&quot;</span>);</span><br><span class="line">        user.setBalance(<span class="number">1000</span>);</span><br><span class="line">        userMapper.saveUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDeleteUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å‡è®¾è¦åˆ é™¤çš„ç”¨æˆ·IDä¸º1</span></span><br><span class="line">        userMapper.deleteUser(<span class="number">5L</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testUpdateUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">1L</span>); <span class="comment">// æ›´æ–°IDä¸º1çš„ç”¨æˆ·</span></span><br><span class="line">        user.setUsername(<span class="string">&quot;UpdatedUser&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;newPassword123&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;0987654321&quot;</span>);</span><br><span class="line">        user.setInfo(<span class="string">&quot;&#123;\&quot;age\&quot;:31,\&quot;gender\&quot;:\&quot;male\&quot;&#125;&quot;</span>);</span><br><span class="line"><span class="comment">//        user.setBalance(1500);</span></span><br><span class="line">        user.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        userMapper.updateUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testQueryUserById</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢IDä¸º1çš„ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.queryUserById(<span class="number">5L</span>);</span><br><span class="line">        log.info(String.valueOf(user));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testQueryUserByIds</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢IDä¸º1å’Œ2çš„ç”¨æˆ·</span></span><br><span class="line">        List&lt;Long&gt; ids = Arrays.asList(<span class="number">1L</span>, <span class="number">2L</span>);</span><br><span class="line">        List&lt;User&gt; users = userMapper.queryUserByIds(ids);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="å¿«é€Ÿå¼€å§‹MybatisPlus"><a href="#å¿«é€Ÿå¼€å§‹MybatisPlus" class="headerlink" title="å¿«é€Ÿå¼€å§‹MybatisPlus"></a>å¿«é€Ÿå¼€å§‹MybatisPlus</h2><p>æˆ‘ä»¬è¦å®ç°Userè¡¨çš„CRUDï¼Œéœ€è¦ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ul>
<li>å¼•å…¥MybatisPlusä¾èµ–</li>
<li>å®šä¹‰Mapper</li>
</ul>
<h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><p>MybatisPlusæä¾›äº†starterï¼Œå®ç°äº†è‡ªåŠ¨Mybatisä»¥åŠMybatisPlusçš„è‡ªåŠ¨è£…é…åŠŸèƒ½ï¼Œåæ ‡å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç”±äºè¿™ä¸ªstarteråŒ…å«äº†å¯¹mybatisçš„è‡ªåŠ¨è£…é…ï¼Œå› æ­¤å®Œå…¨å¯ä»¥æ›¿æ¢æ‰Mybatisçš„starterã€‚</p>
<p>æœ€ç»ˆï¼Œé¡¹ç›®çš„ä¾èµ–å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mp-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>17<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="å®šä¹‰Mapperæ¥å£"><a href="#å®šä¹‰Mapperæ¥å£" class="headerlink" title="å®šä¹‰Mapperæ¥å£"></a>å®šä¹‰Mapperæ¥å£</h3><p>ä¸ºäº†ç®€åŒ–è¡¨CRUDï¼ŒMybatisPlusæä¾›äº†ä¸€ä¸ªåŸºç¡€çš„BaseMapperæ¥å£ï¼Œå…¶ä¸­å·²ç»å®ç°äº†è¡¨å•çš„CRUDï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218132852524.png" alt="image-20240218132852524"></p>
<p>å› æ­¤æˆ‘ä»¬å®šä¹‰çš„Mapperåªè¦å®ç°äº†è¿™ä¸ªBaseMapperï¼Œå°±æ— éœ€è‡ªå·±å®ç°è¡¨å•CRUDäº†ã€‚ä¿®æ”¹mp-demoä¸­çš„com.exampleåŒ…ä¸‹çš„UserMapperæ¥å£ï¼Œè®©å…¶ç»§æ‰¿BaseMapperï¼›</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt;&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨MPçš„sqlæ–¹æ³•å®ŒæˆåŠŸèƒ½</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MpDemoApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testInsert</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">6L</span>); <span class="comment">// å‡è®¾IDæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹</span></span><br><span class="line">        user.setUsername(<span class="string">&quot;TestUser2&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;password123&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line">        user.setInfo(<span class="string">&quot;&#123;\&quot;age\&quot;:30,\&quot;gender\&quot;:\&quot;male\&quot;&#125;&quot;</span>);</span><br><span class="line">        user.setBalance(<span class="number">1000</span>);</span><br><span class="line">        user.setCreateTime(LocalDateTime.now());</span><br><span class="line">        user.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testDeleteUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// å‡è®¾è¦åˆ é™¤çš„ç”¨æˆ·IDä¸º1</span></span><br><span class="line">        userMapper.deleteById(<span class="number">5L</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testUpdateUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">1L</span>); <span class="comment">// æ›´æ–°IDä¸º1çš„ç”¨æˆ·</span></span><br><span class="line">        user.setUsername(<span class="string">&quot;UpdatedUser&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;newPassword123&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;0987654321&quot;</span>);</span><br><span class="line">        user.setInfo(<span class="string">&quot;&#123;\&quot;age\&quot;:31,\&quot;gender\&quot;:\&quot;male\&quot;&#125;&quot;</span>);</span><br><span class="line">        user.setBalance(<span class="number">1500</span>);</span><br><span class="line">        user.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        userMapper.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSelectById</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢IDä¸º1çš„ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(<span class="number">5L</span>);</span><br><span class="line">        log.info(String.valueOf(<span class="string">&quot;user = &quot;</span> + user));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testQueryByIds</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢IDä¸º1å’Œ2çš„ç”¨æˆ·</span></span><br><span class="line">        List&lt;Long&gt; ids = Arrays.asList(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>, <span class="number">4L</span>);</span><br><span class="line">        List&lt;User&gt; users = userMapper.selectBatchIds(ids);</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“</strong></p>
<p>ä½¿ç”¨MybatisPlusçš„åŸºæœ¬æ­¥éª¤ï¼š</p>
<ol>
<li><p>å¼•å…¥MybatisPlusä¾èµ–ï¼Œä»£æ›¿Mybatisä¾èµ–</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218155025974.png" alt="image-20240218155025974"></p>
</li>
<li><p>å®šä¹‰Mapperæ¥å£å¹¶é›†æˆBaseMapper</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218155032709.png" alt="image-20240218155032709"></p>
</li>
</ol>
<h2 id="å¸¸è§æ³¨è§£"><a href="#å¸¸è§æ³¨è§£" class="headerlink" title="å¸¸è§æ³¨è§£"></a>å¸¸è§æ³¨è§£</h2><p>MyBatisPlusé€šè¿‡æ‰«æå®ä½“ç±»ï¼Œå¹¶åŸºäºåå°„è·å–å®ä½“ç±»ä¿¡æ¯ä½œä¸ºæ•°æ®åº“è¡¨ä¿¡æ¯ã€‚</p>
<p><font color="red">MPæ˜¯æ³›å‹ï¼Œå½“è¾“å…¥å…·ä½“çš„å®ä½“ç±»æ—¶ï¼Œä¼šé€šè¿‡åå°„è·å–è¯¥å®ä½“ç±»çš„ç›¸å…³ä¿¡æ¯ã€‚</font></p>
<p>é»˜è®¤çº¦å®šçš„å…·ä½“æ˜ å°„å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li>ç±»åé©¼å³°å‘½åï¼Œå¯¹åº”çš„è¡¨åæ˜¯ç±»åé©¼å³°è½¬ä¸‹åˆ’çº¿</li>
<li>è¡¨ä¸­åä¸ºidçš„å­—æ®µä½œä¸ºä¸»é”®</li>
<li>ç±»åçš„å±æ€§é©¼å³°å‘½åï¼Œå¯¹åº”çš„è¡¨åå­—æ®µæ˜¯ç±»åå±æ€§é©¼å³°è½¬ä¸‹åˆ’çº¿</li>
</ul>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218155556926.png" alt="image-20240218155556926"></p>
<p>å¦‚æœæ²¡æœ‰éµå¾ªé»˜è®¤çº¦å®šï¼Œè¦æ±‚æ˜¾å¼ç”¨æ³¨è§£æ¥æŒ‡å®šç›¸å…³è§„åˆ™</p>
<p>MybatisPlusä¸­æ¯”è¾ƒå¸¸è§çš„å‡ ä¸ªæ³¨è§£å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>@TableNameï¼šç”¨æ¥æŒ‡å®šè¡¨åï¼ˆå½“å®ä½“ç±»åå’Œè¡¨åä¸ç¬¦åˆè§„åˆ™æ—¶ï¼‰</p>
</li>
<li><p>@TableIdï¼šç”¨æ¥æŒ‡å®šè¡¨ä¸­çš„ä¸»é”®å­—æ®µä¿¡æ¯ï¼ˆå½“ç±»åä¸­ä¸å­˜åœ¨å€¼ä¸ºidçš„å±æ€§ï¼‰</p>
<p>@TableIdï¼ˆvalue&#x3D;â€idâ€, type&#x3D;â€¦)ï¼Œè¿™é‡Œçš„typeæ˜¯IdTypeæšä¸¾ç±»å‹</p>
<ul>
<li>AUTOï¼šæ•°æ®åº“è‡ªå¢é•¿ï¼ˆæ•°æ®åº“å†³å®šï¼‰</li>
<li>INPUTï¼šé€šè¿‡setæ–¹æ³•è‡ªè¡Œè¾“å…¥ï¼ˆç”¨æˆ·å†³å®šï¼‰</li>
<li>ASSIGN_IDï¼šåˆ†é…IDï¼Œæ¥å£IdentifierGeneratorçš„æ–¹æ³•nextIdæ¥ç”Ÿæˆidï¼Œé»˜è®¤å®ç°ç±»ä¸ºDefaultIdentifierGeneratoré›ªèŠ±ç®—æ³•ï¼ˆé»˜è®¤æ–¹æ³•ï¼‰</li>
</ul>
</li>
<li><p>@TableFieldï¼šç”¨æ¥æŒ‡å®šè¡¨ä¸­çš„æ™®é€šå­—æ®µä¿¡æ¯ï¼ˆä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼‰</p>
<ul>
<li>å½“æˆå‘˜å˜é‡åä¸æ•°æ®åº“å­—æ®µåä¸ä¸€è‡´</li>
<li>å½“æˆå‘˜å˜é‡åä»¥iså¼€å¤´ï¼Œä¸”æ˜¯å¸ƒå°”å€¼</li>
<li>å½“æˆå‘˜å˜é‡åä¸æ•°æ®åº“å…³é”®å­—å†²çª</li>
<li>å½“æˆå‘˜å˜é‡ä¸æ˜¯æ•°æ®åº“å­—æ®µ</li>
</ul>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218161312143.png" alt="image-20240218161312143"></p>
</li>
</ul>
<p><strong>æ€»ç»“</strong></p>
<p>MybatisPlusæ˜¯å¦‚ä½•è·å–å®ç°CRUDçš„æ•°æ®åº“è¡¨ä¿¡æ¯çš„ï¼Ÿ</p>
<blockquote>
<p> MPä¼šæ ¹æ®ä½ ç»™çš„å®ä½“ç±»ä¿¡æ¯ï¼Œè·å–æ•°æ®åº“çš„è¡¨ä¿¡æ¯ï¼Œä»è€Œå¸®æˆ‘ä»¬ç”Ÿæˆå•è¡¨æ•°æ®ã€‚</p>
<p>çº¦å®š</p>
<ul>
<li>ç±»çš„åç§°ä¸ºè¡¨åä¸‹åˆ’çº¿è½¬é©¼å³°</li>
<li>ç±»çš„æˆå‘˜å˜é‡ä¸ºå­—æ®µåä¸‹åˆ’çº¿è½¬é©¼å³°</li>
<li>ç±»ä¸­åä¸ºidçš„æˆå‘˜å˜é‡ä½œä¸ºä¸»é”®</li>
</ul>
</blockquote>
<p>MybatisPlusçš„å¸¸è§æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</p>
<blockquote>
<ul>
<li>@TableNameï¼šæŒ‡å®šè¡¨åç§°åŠç›¸å…³é…ç½®</li>
<li>@TableIdï¼šæŒ‡å®šidå­—æ®µåŠç›¸å…³é…ç½®</li>
<li>@TableFieldï¼šæŒ‡å®šæ™®é€šå­—æ®µåŠç›¸å…³é…ç½®</li>
</ul>
</blockquote>
<p>IdTypeçš„å¸¸è§ç±»å‹æœ‰å“ªäº›?</p>
<blockquote>
<p>AUTOã€ASSIGNï¼ˆé»˜è®¤æ–¹å¼ï¼‰ã€INPUT</p>
</blockquote>
<p>ä½¿ç”¨@TableFieldçš„å¸¸è§åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<blockquote>
<ul>
<li>å½“æˆå‘˜å˜é‡åä¸æ•°æ®åº“å­—æ®µåä¸ä¸€è‡´</li>
<li>å½“æˆå‘˜å˜é‡åä»¥iså¼€å¤´ï¼Œä¸”æ˜¯å¸ƒå°”å€¼</li>
<li>å½“æˆå‘˜å˜é‡åä¸æ•°æ®åº“å…³é”®å­—å†²çª</li>
<li>å½“æˆå‘˜å˜é‡ä¸æ˜¯æ•°æ®åº“å­—æ®µ</li>
</ul>
</blockquote>
<h2 id="å¸¸è§é…ç½®"><a href="#å¸¸è§é…ç½®" class="headerlink" title="å¸¸è§é…ç½®"></a>å¸¸è§é…ç½®</h2><p>åœ¨application.ymlä¸­æ·»åŠ MybatisPlusçš„é…ç½®é¡¹ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218164921377.png" alt="image-20240218164921377"></p>
<p>MybatisPlusçš„é…ç½®é¡¹ç»§æ‰¿äº†MybatisåŸç”Ÿé…ç½®å’Œè‡ªå·±ç‰¹æœ‰çš„é…ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">type-aliases-package:</span> <span class="string">com.itheima.mp.domain.po</span>  <span class="comment"># åˆ«åæ‰«æåŒ…</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">&quot;classpath*:/mapper/**/*.xml&quot;</span> <span class="comment"># Mapper.xmlæ–‡ä»¶åœ°å€ï¼Œå½“å‰è¿™ä¸ªæ˜¯é»˜è®¤å€¼ã€‚</span></span><br><span class="line">  <span class="string">configurationï¼š</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span> <span class="comment"># æ˜¯å¦å¼€å¯ä¸‹åˆ’çº¿å’Œé©¼å³°çš„æ˜ å°„</span></span><br><span class="line">    <span class="attr">cache-enable:</span> <span class="string">falase</span> <span class="comment"># æ˜¯å¦å¼€å¯äºŒçº§ç¼“å­˜</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span> <span class="comment"># idä¸ºé›ªèŠ±ç®—æ³•ç”Ÿæˆ</span></span><br><span class="line">      <span class="attr">update-strategy:</span> <span class="string">not_null</span> <span class="comment"># æ›´æ–°ç­–ç•¥ï¼šåªæ›´æ–°éç©ºå­—æ®µ</span></span><br></pre></td></tr></table></figure>

<ul>
<li>type-aliases-packageï¼Œç»™ç±»åèµ·åˆ«ç§°ï¼Œä»¥åä¸ç”¨å†™å…¨ç±»åï¼Œç›´æ¥å†™ç®€åŒ–å</li>
<li>mapper-locationsï¼šmapper.xmlçš„æ–‡ä»¶åœ°å€é»˜è®¤å€¼ï¼ˆmpé€‚åˆå•è¡¨æŸ¥è¯¢ï¼Œå¦‚æœæ˜¯å¤šè¡¨æŸ¥è¯¢ï¼Œè¿˜æ˜¯éœ€è¦mybatisï¼Œå…è®¸ç”¨æˆ·é€šè¿‡xmlè‡ªå®šä¹‰sqlè¯­å¥å®ç°å¤šè¡¨æŸ¥è¯¢ï¼‰</li>
<li>map-underscore-to-camel-case: true # æ˜¯å¦å¼€å¯ä¸‹åˆ’çº¿å’Œé©¼å³°çš„æ˜ å°„    </li>
<li>cache-enable: falase # æ˜¯å¦å¼€å¯äºŒçº§ç¼“å­˜</li>
<li>id-type: assign_id # idä¸ºé›ªèŠ±ç®—æ³•ç”Ÿæˆï¼ˆç›¸å½“äºä¿®æ”¹TableIdçš„typeçš„é»˜è®¤å€¼ï¼‰</li>
<li>update-strategy: not_null # æ›´æ–°ç­–ç•¥ï¼šåªæ›´æ–°éç©ºå­—æ®µ</li>
</ul>
<p>MyBatisPlusä½¿ç”¨çš„åŸºæœ¬æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ol>
<li>å¼•å…¥èµ·æ­¥ä¾èµ–</li>
<li>è‡ªå®šä¹‰MapperåŸºç¡€BaseMapper</li>
<li>åœ¨å®ä½“ç±»ä¸Šæ·»åŠ æ³¨è§£å£°æ˜ è¡¨ä¿¡æ¯</li>
<li>åœ¨application.ymlä¸­æ ¹æ®éœ€è¦æ·»åŠ é…ç½®ä¿¡æ¯</li>
</ol>
<h1 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a>æ ¸å¿ƒåŠŸèƒ½</h1><h2 id="æ¡ä»¶æ„é€ å™¨"><a href="#æ¡ä»¶æ„é€ å™¨" class="headerlink" title="æ¡ä»¶æ„é€ å™¨"></a>æ¡ä»¶æ„é€ å™¨</h2><p>MyBatisPlusæ”¯æŒå„ç§å¤æ‚çš„whereæ¡ä»¶ï¼Œå¯ä»¥æ»¡è¶³æ—¥å¸¸å¼€å‘çš„æ‰€æœ‰éœ€æ±‚ã€‚</p>
<p>Wrapperå°±æ˜¯æ¡ä»¶æ„é€ å™¨ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218172927436.png" alt="image-20240218172927436"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218172950865.png" alt="image-20240218172950865"></p>
<p>å…¶ä¸­çš„AbstractWrapperå†…å®¹å¦‚ä¸‹</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218173036392.png" alt="image-20240218173036392"></p>
<p>querywrapperå†…å®¹ï¼ˆæŸ¥è¯¢æ¡ä»¶ç›¸å…³ï¼‰</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218173210559.png" alt="image-20240218173210559"></p>
<p>updatewrapperå†…å®¹ï¼ˆsetéƒ¨åˆ†ï¼‰</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218173237833.png" alt="image-20240218173237833"></p>
<h3 id="æ¡ˆä¾‹ï¼šåŸºäºQueryWrapperçš„æŸ¥è¯¢"><a href="#æ¡ˆä¾‹ï¼šåŸºäºQueryWrapperçš„æŸ¥è¯¢" class="headerlink" title="æ¡ˆä¾‹ï¼šåŸºäºQueryWrapperçš„æŸ¥è¯¢"></a>æ¡ˆä¾‹ï¼šåŸºäºQueryWrapperçš„æŸ¥è¯¢</h3><p>éœ€æ±‚ï¼š</p>
<ol>
<li><p>æŸ¥è¯¢å‡ºåå­—ä¸­å¸¦oçš„ï¼Œå­˜æ¬¾å¤§äºç­‰äº1000å…ƒçš„äººçš„idã€usernameã€infoã€balanceå­—æ®µ</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,info,balance <span class="keyword">from</span> tb_user <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%o%&#x27;</span> <span class="keyword">and</span> balance <span class="operator">&gt;=</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1.æ„å»ºæŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;()</span><br><span class="line">        .select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;username&quot;</span>,<span class="string">&quot;info&quot;</span>,<span class="string">&quot;balance&quot;</span>)</span><br><span class="line">        .like(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;o&quot;</span>)</span><br><span class="line">        .ge(<span class="string">&quot;balance&quot;</span>,<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.æŸ¥è¯¢</span></span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line"></span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ›´æ–°ç”¨æˆ·åä¸ºjackçš„ç”¨æˆ·çš„ä½™é¢ä¸º2000</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> tb_user <span class="keyword">set</span> balance <span class="operator">=</span> <span class="number">2000</span> <span class="keyword">where</span> username <span class="operator">=</span> jack;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateByQueryWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 1. å¾…æ›´æ–°çš„æ•°æ®</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setBalance(<span class="number">2000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ›´æ–°çš„æ¡ä»¶</span></span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;User&gt;().eq(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;jack&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. æ‰§è¡Œæ›´æ–°</span></span><br><span class="line">    userMapper.update(user,wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="æ¡ˆä¾‹ï¼šåŸºäºUpdateWrapperçš„æ›´æ–°"><a href="#æ¡ˆä¾‹ï¼šåŸºäºUpdateWrapperçš„æ›´æ–°" class="headerlink" title="æ¡ˆä¾‹ï¼šåŸºäºUpdateWrapperçš„æ›´æ–°"></a>æ¡ˆä¾‹ï¼šåŸºäºUpdateWrapperçš„æ›´æ–°</h3><p>éœ€æ±‚ï¼šæ›´æ–°idä¸º1ï¼Œ2ï¼Œ4çš„ç”¨æˆ·çš„ä½™é¢ï¼Œæ‰£200</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">update</span> tb_user <span class="keyword">set</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">4L</span>);</span><br><span class="line"></span><br><span class="line">    UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;User&gt;()</span><br><span class="line">        .setSql(<span class="string">&quot;balance = balance - 200&quot;</span>)</span><br><span class="line">        .in(<span class="string">&quot;id&quot;</span>,ids);</span><br><span class="line"></span><br><span class="line">    userMapper.update(<span class="literal">null</span>,wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ¡ˆä¾‹ï¼šåŸºäºLambdaQueryWrapperçš„æŸ¥è¯¢"><a href="#æ¡ˆä¾‹ï¼šåŸºäºLambdaQueryWrapperçš„æŸ¥è¯¢" class="headerlink" title="æ¡ˆä¾‹ï¼šåŸºäºLambdaQueryWrapperçš„æŸ¥è¯¢"></a>æ¡ˆä¾‹ï¼šåŸºäºLambdaQueryWrapperçš„æŸ¥è¯¢</h3><p><font color="red">LambdaQueryWrapperé˜²æ­¢ç¡¬ç¼–ç ï¼Œç¡®ä¿selectè¯­å¥ä¼ å…¥çš„æ˜¯å‡½æ•°è€Œä¸æ˜¯å…·ä½“çš„å€¼ã€‚</font></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testLambdaQueryWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//1.æ„å»ºæŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;()</span><br><span class="line">        .select(User::getId, User::getUsername, User::getInfo, User::getBalance)</span><br><span class="line">        .like(User::getUsername, <span class="string">&quot;o&quot;</span>)</span><br><span class="line">        .ge(User::getBalance, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.æŸ¥è¯¢</span></span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line"></span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¡ä»¶æ„é€ å™¨çš„ç”¨æ³•ï¼š</p>
<ul>
<li>QueryWrapperå’ŒLambdaQueryWrapperé€šå¸¸æ˜¯ç”¨æ¥æ„å»ºselectã€deleteã€updateå’Œwhereæ¡ä»¶éƒ¨åˆ†</li>
<li>UpdateWrapperå’ŒLambdaUpdateWrapperé€šå¸¸åªæœ‰åœ¨setè¯­å¥æ¯”è¾ƒç‰¹æ®Šæ‰ä½¿ç”¨</li>
<li><font color="red">å°½é‡ä½¿ç”¨LamdbaQueryWrapperå’ŒLambdaUpdateWrapperï¼Œé¿å…ç¡¬ç¼–ç </font></li>
</ul>
<h2 id="è‡ªå®šä¹‰SQL"><a href="#è‡ªå®šä¹‰SQL" class="headerlink" title="è‡ªå®šä¹‰SQL"></a>è‡ªå®šä¹‰SQL</h2><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨MyBatisPlusä¸­çš„wrapperæ¥æ„å»ºå¤æ‚çš„whereæ¡ä»¶ï¼Œç„¶åè‡ªå·±å®šä¹‰SQLè¯­å¥ä¸­å‰©ä¸‹çš„éƒ¨åˆ†ã€‚</p>
<p>æ¡ˆä¾‹ï¼šè‡ªå®šä¹‰SQL</p>
<p>éœ€æ±‚ï¼šå°†idåœ¨æŒ‡å®šèŒƒå›´çš„ç”¨æˆ·ï¼ˆä¾‹å¦‚1ï¼Œ2ï¼Œ4ï¼‰çš„ä½™é¢æ‰£å‡æŒ‡å®šå€¼ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBalanceByIds&quot;</span>&gt;</span></span><br><span class="line">	UPDATE tb_user</span><br><span class="line">    SET balance = balance - #&#123;amount&#125;</span><br><span class="line">    WHERE id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">seperator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">end</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">    	#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateWrapper</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;Long&gt; ids = List.of(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">4L</span>);</span><br><span class="line"></span><br><span class="line">    UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;User&gt;()</span><br><span class="line">        .setSql(<span class="string">&quot;balance = balance - 200&quot;</span>)</span><br><span class="line">        .in(<span class="string">&quot;id&quot;</span>, ids);</span><br><span class="line"></span><br><span class="line">    userMapper.update(<span class="literal">null</span>, wrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/18/mybatisplus-day01/image-20240218181322133.png" alt="image-20240218181322133"></p>
<p>å¯¹äºå¤æ‚çš„sqlè¯­å¥ï¼Œwrapperä¸ä¸€å®šèƒ½å¤Ÿå®Œå…¨å®ç°ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨MyBatisPlusçš„wrapperæ¥æ„å»ºå¤æ‚çš„Whereæ¡ä»¶ï¼Œç„¶åè‡ªå·±è‡ªå®šä¹‰SQLè¯­å¥ä¸­å‰©ä¸‹çš„éƒ¨åˆ†ã€‚</p>
<ol>
<li><p>åŸºäºWrapperæ„å»ºwhereæ¡ä»¶</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218182806514.png" alt="image-20240218182806514"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">List&lt;Long&gt; ids = List.of(<span class="number">1L</span>,<span class="number">2L</span>,<span class="number">4L</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">amount</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1.æ„å»ºæ¡ä»¶</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;User&gt;.in(User::getId,ids);</span><br><span class="line"><span class="comment">//2.è‡ªå®šä¹‰SQLæ–¹æ³•è°ƒç”¨</span></span><br><span class="line">userMapper.updateBalanceByIds(wrapper,amount);</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨mapperæ–¹æ³•å‚æ•°ä¸­ç”¨Paramæ³¨è§£å£°æ˜wrapperå˜é‡åç§°ï¼Œå¿…é¡»æ˜¯ew</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218182832870.png" alt="image-20240218182832870"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">updateBalanceByIds</span><span class="params">(<span class="meta">@Param(&quot;ew&quot;)</span> LambdaQueryWrapper&lt;User&gt; wrapper, <span class="meta">@Param(&quot;amount&quot;)</span> <span class="type">int</span> amount)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è‡ªå®šä¹‰SQLï¼Œå¹¶ä½¿ç”¨Wrapperæ¡ä»¶</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218182855128.png" alt="image-20240218182855128"></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span> = <span class="string">&quot;updateBalanceByIds&quot;</span>&gt;</span></span><br><span class="line">	UPDATE tb_user SET balance = balance - #&#123;amount&#125; $&#123;ew.customSqlSegment&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Serviceæ¥å£"><a href="#Serviceæ¥å£" class="headerlink" title="Serviceæ¥å£"></a>Serviceæ¥å£</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p><strong>serviceæ¥å£æ±‡æ€»</strong></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218183050358.png" alt="image-20240218183050358"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218210152819.png" alt="image-20240218210152819"></p>
<p>åŸæ¥æˆ‘ä»¬æ˜¯å®šä¹‰UserServiceæ¥å£ï¼Œå†ç”¨UserServiceImplç»§æ‰¿å’Œå®ç°å…¶æ¥å£æ–¹æ³•ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è®©UserServiceæ¥å£å»ç»§æ‰¿IServiceæ¥å£ï¼Œï¼ˆIServiceæ¥å£å®šä¹‰äº†è®¸å¤šæœ‰ç”¨çš„serviceå±‚çš„æ–¹æ³•ï¼‰ï¼Œå†è®©UserServiceImplç±»å»ç»§æ‰¿ServiceImplç±»ï¼Œå®ç°UserServiceæ¥å£ï¼ˆServiceImplç±»å®ç°äº†IServiceæ¥å£å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼‰ï¼Œé€šè¿‡ç»§æ‰¿ServiceImplç±»ï¼ŒUserServiceImplæ‹¥æœ‰å’Œå®ç°äº†è®¸å¤šIServiceæ¥å£å®šä¹‰çš„æ–¹æ³•ï¼Œä»¥è‡³äºä»–ä¹Ÿèƒ½å¤Ÿå®ç°UserServiceæ¥å£çš„æ‰€æœ‰æ–¹æ³•ã€‚</p>
<ol>
<li><p>è®©UserServiceæ¥å£å»ç»§æ‰¿IServiceæ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserService</span>  <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è®©UserServiceImplç±»å»ç»§æ‰¿ServiceImplç±»ï¼Œå®ç°UserServiceæ¥å£ï¼ˆæ³›å‹ï¼Œè¦æŒ‡å®šå¯¹åº”çš„mapperç±»UserMapperå’Œè¦æ“ä½œçš„å®ä½“ç±»Userï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper,User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™æµ‹è¯•ç”¨ä¾‹æµ‹è¯•serviceç±»åŠŸèƒ½ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»å®ç°äº†ä¸ç”¨mapperå±‚ï¼Œç›´æ¥ç”¨serviceå±‚å³å¯è¿›è¡Œæ•°æ®åº“æ“ä½œï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IUserServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSaveUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="comment">//        user.setId(1L); // æ›´æ–°IDä¸º1çš„ç”¨æˆ·</span></span><br><span class="line">        user.setUsername(<span class="string">&quot;UpdatedUser&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;newPassword123&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;0987654321&quot;</span>);</span><br><span class="line">        user.setInfo(<span class="string">&quot;&#123;\&quot;age\&quot;:31,\&quot;gender\&quot;:\&quot;male\&quot;&#125;&quot;</span>);</span><br><span class="line">        user.setBalance(<span class="number">1500</span>);</span><br><span class="line">        user.setUpdateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        userService.save(user);</span><br><span class="line"><span class="comment">//        userMapper.updateById(user);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testQuery</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userService.listByIds(List.of(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">4L</span>));</span><br><span class="line">        users.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ€»ç»“</strong></p>
<p>MPçš„Serviceæ¥å£ä½¿ç”¨æµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p>
<ul>
<li><p>è‡ªå®šä¹‰Serviceæ¥å£ç»§æ‰¿IServiceæ¥å£ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218214647313.png" alt="image-20240218214647313"></p>
</li>
<li><p>è‡ªå®šä¹‰Serviceå®ç°ç±»ï¼Œå®ç°è‡ªå®šä¹‰æ¥å£å¹¶ç»§æ‰¿ServiceImplç±»ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240218214653369.png" alt="image-20240218214653369"></p>
</li>
</ul>
</li>
</ol>
<h3 id="åŸºç¡€ä¸šåŠ¡æ¥å£"><a href="#åŸºç¡€ä¸šåŠ¡æ¥å£" class="headerlink" title="åŸºç¡€ä¸šåŠ¡æ¥å£"></a>åŸºç¡€ä¸šåŠ¡æ¥å£</h3><p>éœ€æ±‚ï¼šåŸºäºRestfulé£æ ¼å®ç°ä¸‹é¢çš„æ¥å£ï¼š</p>
<table>
<thead>
<tr>
<th>ç¼–å·</th>
<th>æ¥å£</th>
<th>è¯·æ±‚æ–¹å¼</th>
<th>è¯·æ±‚è·¯å¾„</th>
<th>è¯·æ±‚å‚æ•°</th>
<th>è¿”å›å€¼</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>æ–°å¢ç”¨æˆ·</td>
<td>POST</td>
<td>&#x2F;users</td>
<td>ç”¨æˆ·è¡¨å•å®ä½“</td>
<td>æ— </td>
</tr>
<tr>
<td>2</td>
<td>åˆ é™¤ç”¨æˆ·</td>
<td>DELETE</td>
<td>&#x2F;users&#x2F;{id}</td>
<td>ç”¨æˆ·id</td>
<td>æ— </td>
</tr>
<tr>
<td>3</td>
<td>æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</td>
<td>GET</td>
<td>&#x2F;users&#x2F;{id}</td>
<td>ç”¨æˆ·id</td>
<td>ç”¨æˆ·V0</td>
</tr>
<tr>
<td>4</td>
<td>æ ¹æ®idæ‰¹é‡æŸ¥è¯¢</td>
<td>GET</td>
<td>&#x2F;users</td>
<td>ç”¨æˆ·idé›†åˆ</td>
<td>ç”¨æˆ·V0é›†åˆ</td>
</tr>
<tr>
<td>5</td>
<td>æ ¹æ®idæ‰£å‡ä½™é¢</td>
<td>GET</td>
<td>&#x2F;users&#x2F;{id}&#x2F;deduction&#x2F;{money}</td>
<td>ç”¨æˆ·id<br>æ‰£å‡é‡‘é¢</td>
<td>æ— </td>
</tr>
</tbody></table>
<p>é¦–å…ˆï¼Œåœ¨é¡¹ç›®pom.xmlä¸­å¼•å…¥ç›¸å…³ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--HuTool--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--web--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨application.yamlä¸­é…ç½®swaggerä¿¡æ¯</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">knife4j:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">openapi:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="string">ç”¨æˆ·ç®¡ç†æ¥å£æ–‡æ¡£</span></span><br><span class="line">    <span class="attr">description:</span> <span class="string">&quot;ç”¨æˆ·ç®¡ç†æ¥å£æ–‡æ¡£&quot;</span></span><br><span class="line">    <span class="attr">email:</span> <span class="string">zhanghuyi@itcast.cn</span></span><br><span class="line">    <span class="attr">concat:</span> <span class="string">è™å“¥</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://www.itcast.cn</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">v1.0.0</span></span><br><span class="line">    <span class="attr">group:</span></span><br><span class="line">      <span class="attr">default:</span></span><br><span class="line">        <span class="attr">group-name:</span> <span class="string">default</span></span><br><span class="line">        <span class="attr">api-rule:</span> <span class="string">package</span></span><br><span class="line">        <span class="attr">api-rule-resources:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">com.example.controller</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæ¥å£éœ€è¦ä¸¤ä¸ªå®ä½“ï¼š</p>
<ul>
<li>UserFormDTOï¼šä»£è¡¨æ–°å¢æ—¶çš„ç”¨æˆ·è¡¨å•</li>
<li>UserVOï¼šä»£è¡¨æŸ¥è¯¢çš„è¿”å›ç»“æœ</li>
</ul>
<p>é¦–å…ˆæ˜¯UserFormDTO</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;ç”¨æˆ·è¡¨å•å®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserFormDTO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;å¯†ç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ³¨å†Œæ‰‹æœºå·&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è¯¦ç»†ä¿¡æ¯ï¼ŒJSONé£æ ¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è´¦æˆ·ä½™é¢&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åæ˜¯UserVOï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;ç”¨æˆ·VOå®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserVO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è¯¦ç»†ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸ 2å†»ç»“ï¼‰&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è´¦æˆ·ä½™é¢&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ€åï¼ŒæŒ‰ç…§Restfulé£æ ¼ç¼–å†™Controlleræ¥å£æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.dto.UserFormDTO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiParam;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Api(tags=&quot;ç”¨æˆ·ç®¡ç†æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/users&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span>  <span class="comment">//å¯¹é‚£äº›å¯¹è±¡åˆå§‹åŒ–éœ€è¦åˆå§‹çš„æˆå‘˜å˜é‡åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IUserService userService;  <span class="comment">//finalä»£è¡¨å®ƒæ˜¯å¸¸é‡ï¼Œå¿…é¡»åœ¨ç±»çš„å¯¹è±¡åˆå§‹åŒ–æ—¶å°†è¯¥æˆå‘˜å˜é‡åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ–°å¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(<span class="meta">@RequestBody</span> UserFormDTO userFormDTO)</span>&#123; <span class="comment">//RequestBodyæ¥æ”¶æµè§ˆå™¨å‘é€æ¥çš„æ•°æ®</span></span><br><span class="line">        <span class="comment">// 1.æŠŠDTOæ‹·è´åˆ°POJO</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span>  BeanUtil.copyProperties(userFormDTO, User.class);  <span class="comment">//ä½¿ç”¨hutoolå·¥å…·ä¸­çš„é™æ€æ–¹æ³•å°†DTOè½¬åŒ–ä¸ºå®ä½“ç±»</span></span><br><span class="line">        <span class="comment">// 2.æ–°å¢</span></span><br><span class="line">        userService.save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;åˆ é™¤ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUserById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·id&quot;)</span> <span class="meta">@PathVariable</span> Long id)</span>&#123; <span class="comment">//PathVariableæ¥æ”¶æµè§ˆå™¨é¡µé¢è¯·æ±‚çš„id</span></span><br><span class="line">        userService.removeById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> UserVO <span class="title function_">queryUserById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·id&quot;)</span> <span class="meta">@PathVariable</span> Long id)</span>&#123; <span class="comment">//PathVariableæ¥æ”¶æµè§ˆå™¨é¡µé¢è¯·æ±‚çš„id</span></span><br><span class="line">        <span class="comment">//1.æŸ¥è¯¢ç”¨æˆ·POJO</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æŠŠPOæ‹·è´åˆ°VO</span></span><br><span class="line">        <span class="keyword">return</span> BeanUtil.copyProperties(user,UserVO.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®IDæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUserById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·idé›†åˆ&quot;)</span> <span class="meta">@RequestParam(&quot;ids&quot;)</span> List&lt;Long&gt; ids)</span>&#123; <span class="comment">//RequestParamä»£è¡¨æ•°ç»„</span></span><br><span class="line">        <span class="comment">//1.æŸ¥è¯¢ç”¨æˆ·é›†åˆPOJO</span></span><br><span class="line">        List&lt;User&gt; users = userService.listByIds(ids);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æŠŠPOæ‹·è´åˆ°VO</span></span><br><span class="line">        <span class="keyword">return</span> BeanUtil.copyToList(users,UserVO.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¤æ‚ä¸šåŠ¡æ¥å£"><a href="#å¤æ‚ä¸šåŠ¡æ¥å£" class="headerlink" title="å¤æ‚ä¸šåŠ¡æ¥å£"></a>å¤æ‚ä¸šåŠ¡æ¥å£</h3><p>æ‰£å‡é‡‘é¢ï¼šå…ˆæ ¹æ®statusåˆ¤æ–­æ˜¯å¦æ‰§è¡Œæ‰£å‡æ“ä½œï¼Œå†æ ¹æ®balanceåˆ¤æ–­é‡‘é¢æ˜¯å¦è¶³å¤Ÿæ‰£å‡</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219115537636.png" alt="image-20240219115537636"></p>
<p>controllerå±‚å®šä¹‰ç›¸åº”çš„å®ç°æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ‰£å‡ç”¨æˆ·ä½™é¢æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/&#123;id&#125;/deduction/&#123;money&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deductMoneyById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·id&quot;)</span> <span class="meta">@PathVariable(&quot;id&quot;)</span> Long id,</span></span><br><span class="line"><span class="params">                            <span class="meta">@ApiParam(&quot;æ‰£å‡çš„é‡‘é¢&quot;)</span> <span class="meta">@PathVariable(&quot;money&quot;)</span> Integer money)</span>&#123; <span class="comment">//RequestParamä»£è¡¨æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">    userService.deductBalance(id, money);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>serviceæ¥å£åˆ›å»ºå¯¹åº”çš„æ–¹æ³•å¤´</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserService</span>  <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deductBalance</span><span class="params">(Long id, Integer money)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>serviceå®ç°ç±»å®ç°è¯¥æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper,User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deductBalance</span><span class="params">(Long id, Integer money)</span> &#123;</span><br><span class="line">        <span class="comment">//1. æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> getById(id);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. æ ¡éªŒç”¨æˆ·çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span> || user.getStatus() != <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ç”¨æˆ·çŠ¶æ€å¼‚å¸¸ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. æ ¡éªŒä½™é¢æ˜¯å¦å……è¶³</span></span><br><span class="line">        <span class="keyword">if</span>(user.getBalance() &lt; money)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ç”¨æˆ·ä½™é¢ä¸è¶³ï¼&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. æ‰£å‡ä½™é¢ update tb_user set balance = balance = ?</span></span><br><span class="line">        baseMapper.deductBalance(id,money);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>mapperå±‚çš„UserMapperå®ç°deductBalanceæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.update.LambdaUpdateWrapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt;&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateBalanceByIds</span><span class="params">(<span class="meta">@Param(&quot;ew&quot;)</span> LambdaUpdateWrapper&lt;User&gt; wrapper,<span class="meta">@Param(&quot;amount&quot;)</span> <span class="type">int</span> amount)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;UPDATE tb_user SET balance = balance - #&#123;money&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deductBalance</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Long id,<span class="meta">@Param(&quot;money&quot;)</span> Integer money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œé¡¹ç›®</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219124424902.png" alt="image-20240219124424902"></p>
<p>è®¿é—®é¡µé¢localhost:8080&#x2F;doc.html#name</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219124457932.png" alt="image-20240219124457932"></p>
<p>æµ‹è¯•æ¥å£æ˜¯å¦æ­£å¸¸è¿è¡Œ</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219132003865.png" alt="image-20240219132003865"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219132013295.png" alt="image-20240219132013295"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219132043263.png" alt="image-20240219132043263"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219132123079.png" alt="image-20240219132123079"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219132140012.png" alt="image-20240219132140012"></p>
<h3 id="Lambdaæ–¹æ³•"><a href="#Lambdaæ–¹æ³•" class="headerlink" title="Lambdaæ–¹æ³•"></a>Lambdaæ–¹æ³•</h3><p>æ¡ˆä¾‹ï¼šIServiceçš„LambdaæŸ¥è¯¢</p>
<p>éœ€æ±‚ï¼šå®ç°ä¸€ä¸ªæ ¹æ®å¤æ‚æ¡ä»¶æŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼ŒæŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li>nameï¼šç”¨æˆ·åå…³é”®å­—ï¼Œå¯ä»¥ä¸ºç©º</li>
<li>statusï¼šç”¨æˆ·çŠ¶æ€ï¼Œå¯ä»¥ä¸ºç©º</li>
<li>minBalanceï¼šæœ€å°ä½™é¢ï¼Œå¯ä»¥ä¸ºç©º</li>
<li>maxBalanceï¼šæœ€å¤§ä½™é¢ï¼Œå¯ä»¥ä¸ºç©º</li>
</ul>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219133315138.png" alt="image-20240219133315138"></p>
<p><strong>controllerå±‚</strong>ï¼ˆå°†ä¼ å…¥çš„æ•°æ®å°è£…åˆ°UserQueryç±»ä¸­ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;ç”¨æˆ·æŸ¥è¯¢æ¡ä»¶å®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserQuery</span> &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·åå…³é”®å­—&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ2-å†»ç»“&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½™é¢æœ€å°å€¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer minBalance;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½™é¢æœ€å¤§å€¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer maxBalance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>controllerå±‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®å¤æ‚æ¡ä»¶æŸ¥è¯¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUsers</span><span class="params">(UserQuery query)</span>&#123;</span><br><span class="line">    <span class="comment">//1. æŸ¥è¯¢ç”¨æˆ·PO</span></span><br><span class="line">    List&lt;User&gt; users = userService.queryUsers(query.getName(),query.getStatus(),query.getMinBalance(),query.getMaxBalance());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æŠŠPOæ‹·è´åˆ°VO</span></span><br><span class="line">    <span class="keyword">return</span> BeanUtil.copyToList(users,UserVO.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨Serviceæ¥å£å±‚å£°æ˜å¯¹åº”çš„æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserService</span>  <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deductBalance</span><span class="params">(Long id, Integer money)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; <span class="title function_">queryUsers</span><span class="params">(String name, Integer status, Integer minBalance, Integer maxBalance)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨UserServiceæ¥å£å®ç°ç±»ä¸­å®ç°å¯¹åº”çš„æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">queryUsers</span><span class="params">(String name, Integer status, Integer minBalance, Integer maxBalance)</span> &#123;</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; users = lambdaQuery()  <span class="comment">//ä½¿ç”¨lambdaQuery()æ–¹æ³•å®ç°å¯¹åº”çš„å¢åˆ æ”¹æŸ¥æ“ä½œ</span></span><br><span class="line">            .like(name != <span class="literal">null</span>, User::getUsername, name)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .ge(minBalance != <span class="literal">null</span>, User::getBalance, minBalance)</span><br><span class="line">            .le(maxBalance != <span class="literal">null</span>, User::getBalance, maxBalance)</span><br><span class="line">            .list();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ¡ˆä¾‹ï¼šIServiceçš„Lambdaæ›´æ–°</p>
<p>éœ€æ±‚ï¼šæ”¹é€ æ ¹æ®idä¿®æ”¹ç”¨æˆ·ä½™é¢çš„æ¥å£ï¼ŒæŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>å®Œæˆå¯¹ç”¨æˆ·çŠ¶æ€æ ¡éªŒ</p>
</li>
<li><p>å®Œæˆå¯¹ç”¨æˆ·ä½™é¢æ ¡éªŒ</p>
</li>
<li><p>å¦‚æœæ‰£å‡åä½™é¢ä¸º0ï¼Œåˆ™å°†ç”¨æˆ·statusä¿®æ”¹ä¸ºå†»ç»“çŠ¶æ€</p>
</li>
</ul>
<p><strong>ä¿®æ”¹UserServiceæ¥å£å®ç°ç±»ä¸­å®ç°å¯¹åº”çš„æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deductBalance</span><span class="params">(Long id, Integer money)</span> &#123;</span><br><span class="line">    <span class="comment">//1. æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> getById(id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. æ ¡éªŒç”¨æˆ·çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">if</span> (user == <span class="literal">null</span> || user.getStatus() != <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ç”¨æˆ·çŠ¶æ€å¼‚å¸¸ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. æ ¡éªŒä½™é¢æ˜¯å¦å……è¶³</span></span><br><span class="line">    <span class="keyword">if</span> (user.getBalance() &lt; money) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ç”¨æˆ·ä½™é¢ä¸è¶³ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">remainBalance</span> <span class="operator">=</span> user.getBalance() - money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4. æ‰£å‡ä½™é¢ update tb_user set balance = balance = ?</span></span><br><span class="line">    lambdaUpdate()</span><br><span class="line">        .set(User::getBalance,remainBalance)</span><br><span class="line">        .set(remainBalance &lt;= <span class="number">0</span>,User::getStatus,<span class="number">2</span>)</span><br><span class="line">        .eq(User::getId,id)</span><br><span class="line">        .update();  <span class="comment">//åŠ updateå®è¡Œsqlæ“ä½œ</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="æ‰¹é‡æ–°å¢"><a href="#æ‰¹é‡æ–°å¢" class="headerlink" title="æ‰¹é‡æ–°å¢"></a>æ‰¹é‡æ–°å¢</h3><p>éœ€æ±‚ï¼šæ‰¹é‡æ’å…¥10ä¸‡æ¡ç”¨æˆ·æ•°æ®ï¼Œå¹¶ä½œå‡ºå¯¹æ¯”ï¼š</p>
<ul>
<li>æ™®é€šforå¾ªç¯æ’å…¥</li>
<li>IServiceçš„æ‰¹é‡æ’å…¥</li>
<li>å¼€å¯rewriteBatchedStatements&#x3D;trueå‚æ•°</li>
</ul>
<p>åœ¨testç›®å½•ä¸‹IUserServiceTestæµ‹è¯•ç±»ä¸­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSaveOneByOne</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">b</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">            userService.save(buildUser(i));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">e</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;è€—æ—¶ï¼š&quot;</span> + (e - b));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testSaveBatch</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//æˆ‘ä»¬æ¯æ¬¡æ‰¹é‡æ’å…¥1000æ¡ä»¶ï¼Œæ’å…¥100æ¬¡å³10ä¸‡æ¡æ•°æ®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.å‡†å¤‡ä¸€ä¸ªå®¹å™¨ä¸º1000çš„é›†åˆ</span></span><br><span class="line">        ArrayList&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">b</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">            <span class="comment">//2.æ·»åŠ ä¸€ä¸ªuser</span></span><br><span class="line">            list.add(buildUser(i));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//3.æ¯100æ¡æ‰¹é‡æ’å…¥ä¸€æ¬¡</span></span><br><span class="line">            <span class="keyword">if</span>(i % <span class="number">1000</span> == <span class="number">0</span>)&#123;</span><br><span class="line">                userService.saveBatch(list);</span><br><span class="line">                list.clear(); <span class="comment">//å°†é›†åˆå†æ¬¡æ¸…ç©º</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">e</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;è€—æ—¶ï¼š&quot;</span> + (e - b));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ™®é€šforå¾ªç¯æ’å…¥</strong></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219150341222.png" alt="image-20240219150341222"></p>
<p><strong>IServiceçš„æ‰¹é‡æ’å…¥</strong></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219150621143.png" alt="image-20240219150621143"></p>
<p><strong>å¼€å¯rewriteBatchedStatements&#x3D;true</strong>å‚æ•°</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219150701124.png" alt="image-20240219150701124"></p>
<p>åœ¨application.ymlé…ç½®ä¸­åœ¨æ•°æ®åº“é…ç½®é¡¹spring.datasource.urlååŠ ä¸ŠrewriteBatchedStatements&#x3D;true</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219151256254.png" alt="image-20240219151256254"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219151416654.png" alt="image-20240219151416654"></p>
<p>æ‰¹å¤„ç†æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ™®é€šforå¾ªç¯é€æ¡æ’å…¥ï¼Œé€Ÿåº¦æå·®ï¼Œä¸æ¨è</li>
<li>MPçš„æ‰¹é‡æ–°å¢ï¼ŒåŸºäºé¢„ç¼–è¯‘çš„æ‰¹å¤„ç†ï¼Œæ€§èƒ½ä¸é”™</li>
<li>é…ç½®jdbcå‚æ•°ï¼Œå¼€rewriteBatchedStatements&#x3D;trueï¼Œæ€§èƒ½æœ€å¥½</li>
</ul>
<h1 id="æ‰©å±•åŠŸèƒ½"><a href="#æ‰©å±•åŠŸèƒ½" class="headerlink" title="æ‰©å±•åŠŸèƒ½"></a>æ‰©å±•åŠŸèƒ½</h1><h2 id="ä»£ç ç”Ÿæˆ"><a href="#ä»£ç ç”Ÿæˆ" class="headerlink" title="ä»£ç ç”Ÿæˆ"></a>ä»£ç ç”Ÿæˆ</h2><p>ç›®å‰MPçš„ä½¿ç”¨æ–¹æ³•</p>
<ol>
<li><p>å¼•å…¥å¯¹åº”çš„MPä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å‡†å¤‡å®ä½“ç±»ï¼ˆè®¾ç½®TableNameå°†å®ä½“ç±»ä¸æ•°æ®åº“è¡¨åšæ˜ å°„ï¼‰</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219211202183.png" alt="image-20240219211202183"></p>
</li>
<li><p>è®¾ç½®mapperæ¥å£ç»§æ‰¿BaseMapper&lt;User&gt;æ¥å£ï¼ŒæŒ‡å®šæ³›å‹ç±»å‹</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219211348617.png" alt="image-20240219211348617"></p>
</li>
<li><p>è®¾ç½®serviceæ¥å£ç»§æ‰¿IService&lt;User&gt;æ¥å£ï¼ŒæŒ‡å®šæ³›å‹ç±»å‹</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219211501734.png" alt="image-20240219211501734"></p>
</li>
<li><p>ç¼–å†™Serviceå®ç°ç±»UserServiceImplï¼Œç»§æ‰¿ServiceImpl&lt;UserMapperï¼ŒUser&gt;ï¼ŒåŒæ—¶å®ç°IUserServiceæ¥å£</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219211714367.png" alt="image-20240219211714367"></p>
</li>
</ol>
<p>ä»£ç ç®€åŒ–æ“ä½œ</p>
<ol>
<li><p>ä¸‹è½½MyBatisPlusæ’ä»¶</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219212822585.png" alt="image-20240219212822585"></p>
</li>
<li><p>è¿æ¥æ•°æ®åº“</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219225926496.png" alt="image-20240219225926496"></p>
</li>
<li><p>ä»£ç ç”Ÿæˆè®¾ç½®ç•Œé¢</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219225448458.png" alt="image-20240219225448458"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219230651368.png" alt="image-20240219230651368"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240219233633273.png" alt="image-20240219233633273"></p>
</li>
</ol>
<h2 id="é™æ€å·¥å…·"><a href="#é™æ€å·¥å…·" class="headerlink" title="é™æ€å·¥å…·"></a>é™æ€å·¥å…·</h2><p><img src="/2024/02/18/mybatisplus-day01/image-20240219233757262.png" alt="image-20240219233757262"></p>
<p>ä¸IServiceæ¥å£åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯Dbæ˜¯é™æ€æ–¹æ³•ã€‚</p>
<p>IServiceæ¥å£æ˜¯éé™æ€çš„ï¼Œéœ€è¦è‡ªå®šä¹‰æ¥å£å»ç»§æ‰¿å®ƒï¼ŒåŒæ—¶è¿˜è¦åˆ›å»ºç±»å®ç°è¯¥æ¥å£çš„æ–¹æ³•ã€‚è€Œé™æ€çš„æ–¹æ³•æ˜¯æ²¡æ³•è¯»å–åˆ°ç±»ä¸Šçš„æ³›å‹ï¼Œå› è€Œæ— æ³•å¾—åˆ°å®ä½“ç±»çš„ç±»å‹ï¼Œè¿›è€Œæ— æ³•è·çŸ¥è¡¨ä¿¡æ¯ã€‚å› æ­¤å®ƒçš„æ–¹æ³•è¿˜è¦ç©¿ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼ŒClass&lt;T&gt;ï¼Œå³å®ä½“ç±»çš„å­—èŠ‚ç ã€‚åªæœ‰ä¼ äº†è¿™ä¸ªï¼Œæ‰èƒ½ç”¨åå°„æ‹¿åˆ°å®ä½“ç±»çš„ç›¸å…³ä¿¡æ¯ï¼Œä»è€Œå¾—åˆ°æ³¨è§£ä¸Šçš„ç±»åï¼Œè¡¨åï¼Œæ‰èƒ½å®ç°å¢åˆ æ”¹æŸ¥ã€‚</p>
<p>æ¡ˆä¾‹ï¼šé™æ€å·¥å…·æŸ¥è¯¢</p>
<p>éœ€æ±‚ï¼š</p>
<ol>
<li>æ”¹é€ æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŒæ—¶ï¼ŒæŸ¥è¯¢å‡ºç”¨æˆ·å¯¹åº”çš„æ‰€æœ‰åœ°å€</li>
<li>æ”¹é€ æ ¹æ®idæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŒæ—¶ï¼ŒæŸ¥è¯¢å‡ºç”¨æˆ·å¯¹åº”çš„æ‰€æœ‰åœ°å€</li>
<li>å®ç°æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢æ”¶è´§åœ°å€åŠŸèƒ½ï¼Œéœ€è¦éªŒè¯ç”¨æˆ·çŠ¶æ€ï¼Œå†»ç»“ç”¨æˆ·æŠ›å‡ºå¼‚å¸¸ï¼ˆç»ƒä¹ ï¼‰</li>
</ol>
<p>éœ€æ±‚1ï¼šæ”¹é€ æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŒæ—¶ï¼ŒæŸ¥è¯¢å‡ºç”¨æˆ·å¯¹åº”çš„æ‰€æœ‰åœ°å€</p>
<ol>
<li><p>æ·»åŠ AddressVOç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> è™å“¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-07-01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;æ”¶è´§åœ°å€VO&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AddressVO</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;çœ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String province;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;å¸‚&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String city;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;å¿/åŒº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String town;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ‰‹æœº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String mobile;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è¯¦ç»†åœ°å€&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String street;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è”ç³»äºº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ˜¯å¦æ˜¯é»˜è®¤ 1é»˜è®¤ 0å¦&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isDefault;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;å¤‡æ³¨&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String notes;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç»™UserVOä¸­æ·»åŠ æˆå‘˜å˜é‡ï¼šç”¨æˆ·çš„æ”¶è´§åœ°å€é›†åˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;ç”¨æˆ·VOå®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserVO</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·id&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è¯¦ç»†ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸ 2å†»ç»“ï¼‰&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è´¦æˆ·ä½™é¢&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer balance;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·çš„æ”¶è´§åœ°å€&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;AddressVO&gt; address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹UserControllerä¸­çš„queryUserByIdæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®IDæŸ¥è¯¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> UserVO <span class="title function_">queryUserById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·id&quot;)</span> <span class="meta">@PathVariable</span> Long id)</span>&#123; <span class="comment">//PathVariableæ¥æ”¶æµè§ˆå™¨é¡µé¢è¯·æ±‚çš„id</span></span><br><span class="line">    <span class="keyword">return</span> userService.queryUserAndAddressById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨IUserServiceä¸­å£°æ˜queryUserAndAddressByIdæ–¹æ³•ï¼ŒUserServiceImplä¸­å®ç°queryUserAndAddressByIdæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.Db;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.Address;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.AddressVO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UserVO <span class="title function_">queryUserAndAddressById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="comment">//1. æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> getById(id);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span> || user.getStatus() == <span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;ç”¨æˆ·çŠ¶æ€å¼‚å¸¸ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. æŸ¥è¯¢åœ°å€</span></span><br><span class="line">        List&lt;Address&gt; addresses = Db.lambdaQuery(Address.class).eq(Address::getUserId, id).list();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. å°è£…VO</span></span><br><span class="line">        <span class="comment">//3.1 è½¬Userçš„POä¸ºVO</span></span><br><span class="line">        <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> BeanUtil.copyProperties(user, UserVO.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.2 è½¬åœ°å€VO</span></span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isNotEmpty(addresses))&#123;</span><br><span class="line">            List&lt;AddressVO&gt; addressVOList = BeanUtil.copyToList(addresses, AddressVO.class);</span><br><span class="line">            userVO.setAddress(addressVOList);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userVO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æµ‹è¯•æ¥å£ä¸­æµ‹è¯•å¯¹åº”çš„æ¥å£æ˜¯å¦æ­£ç¡®</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220000823092.png" alt="image-20240220000823092"></p>
</li>
</ol>
<p>éœ€æ±‚2ï¼šæ”¹é€ æ ¹æ®idæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·çš„æ¥å£ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŒæ—¶ï¼ŒæŸ¥è¯¢å‡ºç”¨æˆ·å¯¹åº”çš„æ‰€æœ‰åœ°å€</p>
<ol>
<li><p>ä¿®æ”¹UserControllerä¸­çš„queryUserByIdæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®IDæ‰¹é‡æŸ¥è¯¢ç”¨æˆ·æ¥å£&quot;)</span></span><br><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUserById</span><span class="params">(<span class="meta">@ApiParam(&quot;ç”¨æˆ·idé›†åˆ&quot;)</span> <span class="meta">@RequestParam(&quot;ids&quot;)</span> List&lt;Long&gt; ids)</span>&#123; <span class="comment">//PathVariableæ¥æ”¶æµè§ˆå™¨é¡µé¢è¯·æ±‚çš„id</span></span><br><span class="line">    <span class="keyword">return</span> userService.queryUsersAndAddressesById(ids);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨IUserServiceä¸­å£°æ˜queryUsersAndAddressesByIdæ–¹æ³•ï¼ŒUserServiceImplä¸­å®ç°queryUsersAndAddressesByIdæ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.Db;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.Address;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.AddressVO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;UserVO&gt; <span class="title function_">queryUsersAndAddressesById</span><span class="params">(List&lt;Long&gt; ids)</span> &#123;</span><br><span class="line">        <span class="comment">//1. æŸ¥è¯¢ç”¨æˆ·</span></span><br><span class="line">        List&lt;User&gt; users = listByIds(ids);</span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isEmpty(users))&#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æŸ¥è¯¢åœ°å€</span></span><br><span class="line">        <span class="comment">//2.1 æŸ¥è¯¢ç”¨æˆ·idé›†åˆ</span></span><br><span class="line">        List&lt;Long&gt; userIds = users.stream().map(User::getId).collect(Collectors.toList());</span><br><span class="line">        <span class="comment">//2.2 æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢åœ°å€</span></span><br><span class="line">        List&lt;Address&gt; addresses = Db.lambdaQuery(Address.class).in(Address::getUserId, userIds).list();</span><br><span class="line">        <span class="comment">//2.3 è½¬æ¢åœ°å€VO</span></span><br><span class="line">        List&lt;AddressVO&gt; addressVOList = BeanUtil.copyToList(addresses, AddressVO.class);</span><br><span class="line">        <span class="comment">//2.4 åœ°å€é›†åˆåˆ†ç»„å¤„ç†ï¼Œç›¸åŒç”¨æˆ·æ”¾åˆ°ä¸€ä¸ªé›†åˆä¸­</span></span><br><span class="line">        Map&lt;Long, List&lt;AddressVO&gt;&gt; addressMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isNotEmpty(addressVOList))&#123;</span><br><span class="line">            addressMap = addressVOList.stream().collect(Collectors.groupingBy(AddressVO::getUserId));<span class="comment">//ç”¨ç”¨æˆ·idåˆ†ç»„</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è½¬æ¢VOè¿”å›</span></span><br><span class="line">        List&lt;UserVO&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(users.size());</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            <span class="comment">//3.1è½¬æ¢Userçš„POä¸ºVO</span></span><br><span class="line">            <span class="type">UserVO</span> <span class="variable">vo</span> <span class="operator">=</span> BeanUtil.copyProperties(user, UserVO.class);</span><br><span class="line">            list.add(vo);</span><br><span class="line">            <span class="comment">//3.2è½¬æ¢åœ°å€VO</span></span><br><span class="line">            vo.setAddress(addressMap.get(user.getId()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        // 1. æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment">//        List&lt;User&gt; users = lambdaQuery().in(User::getId, ids).list();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        // 2. å‡†å¤‡ä¸€ä¸ªç©ºçš„UserVOåˆ—è¡¨ç”¨äºè¿”å›ç»“æœ</span></span><br><span class="line"><span class="comment">//        List&lt;UserVO&gt; userVOList = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        // 3. éå†ç”¨æˆ·åˆ—è¡¨ï¼Œä¸ºæ¯ä¸ªç”¨æˆ·æŸ¥è¯¢åœ°å€å¹¶å°è£…æˆUserVO</span></span><br><span class="line"><span class="comment">//        for (User user : users) &#123;</span></span><br><span class="line"><span class="comment">//            // è·³è¿‡çŠ¶æ€ä¸º2çš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment">//            if (user.getStatus() == 2) &#123;</span></span><br><span class="line"><span class="comment">//                continue;</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            // 3.1 å°†Userè½¬æ¢ä¸ºUserVO</span></span><br><span class="line"><span class="comment">//            UserVO userVO = BeanUtil.copyProperties(user, UserVO.class);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            // 3.2 æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„åœ°å€åˆ—è¡¨</span></span><br><span class="line"><span class="comment">//            List&lt;Address&gt; addresses = Db.lambdaQuery(Address.class).eq(Address::getUserId, user.getId()).list();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            // 3.3 å°†åœ°å€åˆ—è¡¨è½¬æ¢ä¸ºAddressVOåˆ—è¡¨</span></span><br><span class="line"><span class="comment">//            List&lt;AddressVO&gt; addressVOList = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">//            for (Address address : addresses) &#123;</span></span><br><span class="line"><span class="comment">//                AddressVO addressVO = BeanUtil.copyProperties(address, AddressVO.class);</span></span><br><span class="line"><span class="comment">//                addressVOList.add(addressVO);</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            // 3.4 è®¾ç½®ç”¨æˆ·VOçš„åœ°å€ä¿¡æ¯</span></span><br><span class="line"><span class="comment">//            userVO.setAddress(addressVOList);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            // 3.5 å°†UserVOæ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­</span></span><br><span class="line"><span class="comment">//            userVOList.add(userVO);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        return userVOList;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨æµ‹è¯•æ¥å£ä¸­æµ‹è¯•å¯¹åº”çš„æ¥å£æ˜¯å¦æ­£ç¡®<img src="/2024/02/18/mybatisplus-day01/image-20240220002059865.png" alt="image-20240220002059865"></p>
</li>
</ol>
<h2 id="é€»è¾‘åˆ é™¤"><a href="#é€»è¾‘åˆ é™¤" class="headerlink" title="é€»è¾‘åˆ é™¤"></a>é€»è¾‘åˆ é™¤</h2><p>ä¸¾ä¾‹ï¼šæ·˜å®è´­ç‰©åä¼šå½¢æˆè®¢å•ï¼Œ åœ¨è®¢å•åˆ—è¡¨ä¸­æœ‰åˆ é™¤è®¢å•åŠŸèƒ½ï¼Œåœ¨åˆ é™¤æ•°æ®æ—¶ï¼Œè¿™ä¸ªè®¢å•åœ¨åå°çš„æ•°æ®ä¸­å¹¶æœªçœŸæ­£è¢«åˆ é™¤ã€‚</p>
<p><strong>é€»è¾‘åˆ é™¤</strong>å°±æ˜¯åŸºäºä»£ç é€»è¾‘æ¨¡æ‹Ÿåˆ é™¤æ•ˆæœï¼Œä½†å¹¶ä¸ä¼šçœŸæ­£åˆ é™¤æ•°æ®ã€‚æ€è·¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>åœ¨è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå­—æ®µæ ‡è®°æ•°æ®æ˜¯å¦è¢«åˆ é™¤</li>
<li>å½“åˆ é™¤æ•°æ®æ—¶æŠŠæ ‡è®°ç½®ä¸º1</li>
<li>æŸ¥è¯¢æ—¶åªæŸ¥è¯¢æ ‡è®°ä¸º0çš„æ•°æ®</li>
</ul>
<p>ä¾‹å¦‚é€»è¾‘åˆ é™¤å­—æ®µä¸ºdeletedï¼š</p>
<ul>
<li><p>åˆ é™¤æ“ä½œï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220105031798.png" alt="image-20240220105031798"></p>
</li>
<li><p>æŸ¥è¯¢æ“ä½œ</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220105156527.png" alt="image-20240220105156527"></p>
</li>
</ul>
<p>ç›®å‰çš„MPå®ƒæ‰§è¡Œçš„æ“ä½œè¯­å¥ä¸ä¼šé¢å¤–åœ¨æ¡ä»¶æŸ¥è¯¢å¤„åŠ ä¸Šè¿™ä¸ªåˆ¤æ–­ï¼Œå¦‚æœç”¨é€»è¾‘åˆ é™¤åŸå…ˆçš„MPéƒ½ä¸èƒ½ç”¨äº†ã€‚</p>
<p>Mybatisæä¾›äº†é€»è¾‘åˆ é™¤åŠŸèƒ½ï¼Œæ— éœ€æ”¹å˜æ–¹æ³•è°ƒç”¨çš„æ–¹å¼ï¼Œè€Œæ˜¯åœ¨åº•å±‚å¸®æˆ‘ä»¬è‡ªåŠ¨ä¿®æ”¹CRUDçš„è¯­å¥ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨application.yamlæ–‡ä»¶ä¸­é…ç½®é€»è¾‘åˆ é™¤çš„å­—æ®µåç§°å’Œå€¼å³å¯ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220105839937.png" alt="image-20240220105839937"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220105829649.png" alt="image-20240220105829649"></p>
<p>æ³¨æ„ï¼š</p>
<p>é€»è¾‘åˆ é™¤æœ¬èº«ä¹Ÿæœ‰è‡ªå·±çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>ä¼šå¯¼è‡´æ•°æ®åº“è¡¨åƒåœ¾æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡</li>
<li>SQLä¸­å…¨éƒ½éœ€è¦å¯¹é€»è¾‘åˆ é™¤å­—æ®µåšåˆ¤æ–­ï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡</li>
</ul>
<p>å› æ­¤ï¼Œæˆ‘ä¸å¤ªæ¨èé‡‡ç”¨é€»è¾‘åˆ é™¤åŠŸèƒ½ï¼Œå¦‚æœæ•°æ®ä¸èƒ½åˆ é™¤ï¼Œå¯ä»¥é‡‡ç”¨æŠŠæ•°æ®è¿ç§»åˆ°å…¶ä»–è¡¨çš„æ–¹æ³•ã€‚</p>
<h2 id="æšä¸¾å¤„ç†å™¨"><a href="#æšä¸¾å¤„ç†å™¨" class="headerlink" title="æšä¸¾å¤„ç†å™¨"></a>æšä¸¾å¤„ç†å™¨</h2><p>Userç±»ä¸­æœ‰ä¸€ä¸ªç”¨æˆ·çŠ¶æ€å­—æ®µï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220110745823.png" alt="image-20240220110745823"></p>
<p>å½“çŠ¶æ€æ•°é‡è¿‡å¤šæ—¶ï¼Œå¯¹åº”çš„æ•°å­—å’ŒçŠ¶æ€è¶Šå¤šï¼Œå¯¹ç¼–ç¨‹çš„è¦æ±‚å°±æ›´å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ã€‚</p>
<p>æ—¢ç„¶çŠ¶æ€æ˜¯æœ‰é™æ•°é‡çš„ï¼Œå¯ä»¥ç”¨æšä¸¾æ¥è¡¨ç¤ºã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220111021894.png" alt="image-20240220111021894"></p>
<p>è™½ç„¶ç”¨äº†æšä¸¾ç±»å‹ï¼Œä½†æ˜¯æˆ‘ä»¬çš„statusçŠ¶æ€è¿˜æ˜¯Integerç±»å‹ï¼Œè¿™å¯¼è‡´æˆ‘ä»¬åœ¨åšçŠ¶æ€æŸ¥è¯¢æ—¶ç”¨çš„è¿˜æ˜¯æ•°å­—ã€‚è§£å†³åŠæ³•ï¼Œä½¿ç”¨UserStatusæšä¸¾ç±»å‹çš„æ•°æ®æ¥è¡¨ç¤ºçŠ¶æ€ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220111232868.png" alt="image-20240220111232868"></p>
<p>è¿™æ ·æ“ä½œè™½ç„¶ä¸šåŠ¡ä¸Šæ–¹ä¾¿äº†ï¼Œä½†æ˜¯æˆ‘ä»¬åå°çš„æ•°æ®åº“è¡¨å½“ä¸­statuså­—æ®µçš„ç±»å‹ä»ç„¶æ˜¯INTï¼Œå®ƒæ¥å—çš„ä»ç„¶æ˜¯æ•°å­—ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220111540493.png" alt="image-20240220111540493"></p>
<p>Mybatiså¸®åŠ©æˆ‘ä»¬å®ç°äº†TypeHandlerç±»ï¼Œå¸¸è§çš„POJOä¸­å®ä½“ç±»æˆå‘˜å˜é‡çš„ç±»å‹å®ƒéƒ½æœ‰å¯¹åº”çš„å¤„ç†å™¨ï¼Œå› æ­¤å®ƒèƒ½è‡ªåŠ¨å®ç°Javaæ•°æ®ç±»å‹ä¸æ•°æ®åº“ç±»å‹çš„è½¬æ¢ã€‚å…¶ä¸­å°±åŒ…æ‹¬æšä¸¾ç±»å‹å¤„ç†å™¨EnumOrdinalTypeHandlerï¼Œç„¶è€Œï¼Œè¿™ä¸ªå¤„ç†å™¨å¯¹æšä¸¾ç±»å‹çš„æ•°æ®å¤„ç†æ•ˆæœä¸æ˜¯å¾ˆå¥½ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220111709228.png" alt="image-20240220111709228"></p>
<p>MPåœ¨æ­¤åŸºç¡€ä¸Šåšäº†è¿›ä¸€æ­¥æ‹“å±•ï¼Œå…¶ä¸­æ–°å¢äº†MyBatisEnumTypeHandlerå¤„ç†å™¨ç­‰ç­‰</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220111857384.png" alt="image-20240220111857384"></p>
<p>ä½¿ç”¨MyBatisEnumTypeHandlerå¤„ç†å™¨å¯ä»¥å°†å®ä½“ç±»ä¸­çš„æšä¸¾ç±»å‹UserStatusè½¬æ¢ä¸ºæ•°æ®åº“è¡¨ä¸­çš„æ•°å­—ç±»å‹INTã€‚å…·ä½“å®ç°æ“ä½œå¦‚ä¸‹ï¼š</p>
<ol>
<li><p>åˆ›å»ºå¹¶æ ‡è®°æšä¸¾ç±»å‹ï¼Œåœ¨æšä¸¾ç±»ä¸­å¯¹åº”çš„æ•°æ®åº“å­—æ®µçš„å€¼ä¸Šæ·»åŠ æ³¨é‡Š@EnumValue</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113205152.png" alt="image-20240220113205152"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220112222477.png" alt="image-20240220112222477"></p>
</li>
<li><p>è®©æšä¸¾å¤„ç†å™¨ç”Ÿæ•ˆï¼Œåœ¨application.ymlä¸­é…ç½®å…¨å±€æšä¸¾å¤„ç†å™¨ï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220112340573.png" alt="image-20240220112340573"></p>
</li>
<li><p>ä¿®æ”¹Userå’ŒUserVoç±»æˆå‘˜å˜é‡statusçš„ç±»å‹ç”±Integerä¸ºUserStatusã€‚</p>
</li>
<li><p>åŠ ä¸Š@JsonValueæ³¨è§£ï¼Œç¡®ä¿è¿”å›çš„æ˜¯æ­£å¸¸æˆ–å†»ç»“ï¼Œè€Œä¸æ˜¯NORMALæˆ–FROZENï¼›</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113640238.png" alt="image-20240220113640238"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113727515.png" alt="image-20240220113727515"></p>
</li>
</ol>
<p><strong>æ€»ç»“</strong></p>
<p>å¦‚ä½•å®ç°POç±»ä¸­çš„æšä¸¾ç±»å‹å˜é‡ä¸æ•°æ®åº“å­—æ®µçš„è½¬æ¢ï¼Ÿ</p>
<ol>
<li><p>ç»™æšä¸¾ä¸­çš„ä¸æ•°æ®åº“å¯¹åº”valueå€¼æ·»åŠ @EnumValueæ³¨è§£</p>
</li>
<li><p>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æšä¸¾å¤„ç†å™¨ï¼Œå®ç°ç±»å‹è½¬æ¢</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113838932.png" alt="image-20240220113838932"></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113858908.png" alt="image-20240220113858908"></p>
</li>
</ol>
<h2 id="JSONå¤„ç†å™¨"><a href="#JSONå¤„ç†å™¨" class="headerlink" title="JSONå¤„ç†å™¨"></a>JSONå¤„ç†å™¨</h2><p>MPè¿˜é¢å¤–æä¾›äº†AbstarctJsonTypeHandleræ•°æ®å¤„ç†å™¨ï¼Œå®ƒç”¨æ¥è§£å†³æ•°æ®åº“ä¸­çš„jsonæ•°æ®ç±»å‹ä¸Javaç±»å‹ä¹‹é—´çš„è½¬åŒ–ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220113944606.png" alt="image-20240220113944606"></p>
<p>æ•°æ®åº“userè¡¨ä¸­æœ‰ä¸€ä¸ªjsonç±»å‹çš„å­—æ®µï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220114120948.png" alt="image-20240220114120948"></p>
<p>åœ¨Javaä¸­æ²¡æœ‰å¯¹åº”çš„jsonæ•°æ®ç±»å‹ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯Stringï¼Œmybatisä¼šè‡ªåŠ¨å®ç°jsonå’Œstringçš„å¤„ç†ã€‚è¿™ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦è·å–stringä¸­çš„é”®å€¼å¯¹å‘¢ï¼Ÿä¸€ä¸ªæ¯”è¾ƒå¥½çš„å¤„ç†åŠæ³•æ˜¯åˆ›å»ºè¯¥JSONæ•°æ®å¯¹åº”çš„å®ä½“ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220114651876.png" alt="image-20240220114651876"></p>
<p>æˆå‘˜å˜é‡infoç”±stringè½¬æ¢ä¸ºè‡ªå®šä¹‰çš„UserInfoç±»ã€‚è¿™æ ·åšå¯ä»¥å®ç°infoæ•°æ®å†…éƒ¨æŸ¥è¯¢ï¼Œä½†éšç€è€Œæ¥çš„æ˜¯Mybatiså¹¶æœªå®ç°UserInfoç±»å’Œjsonæ ¼å¼çš„æ•°æ®è½¬æ¢ã€‚è¿™æ—¶å€™å°±è¦ç”¨åˆ°<font color="red">MPæä¾›çš„ç±»å‹å¤„ç†å™¨</font>ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220115012276.png" alt="image-20240220115012276"></p>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œå®ä½“ç±»UseråµŒå¥—äº†å®ä½“ç±»UserInfoã€‚å¹¶ä¸”åœ¨å…¶ä¸Šæ–¹åŠ å…¥äº†@TableFieldå­—æ®µï¼ŒæŒ‡å®šäº†typeHandlerï¼Œç¡®å®šäº†å¤„ç†è¯¥å­—æ®µçš„ç±»å‹å¤„ç†å™¨ã€‚<font color="red">ç„¶è€Œè¿™ç§å®ä½“ç±»çš„åµŒå¥—è¦æ±‚å®šä¹‰å¤æ‚çš„resultmapï¼Œå¦‚æœä¸æƒ³è¦çš„è¯ï¼Œå°±åœ¨TablenameåŠ ä¸Šå±æ€§autoResultMap &#x3D; false</font></p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220115508545.png" alt="image-20240220115508545"></p>
<p>å®æ“</p>
<ol>
<li><p>åˆ›å»ºUserInfoå®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.po;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor(staticName = &quot;of&quot;)</span>  <span class="comment">//åŠ äº†staticNameï¼Œå¯ä»¥é€šè¿‡é™æ€æ–¹æ³•UserInfo.of()åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserInfo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String Intro;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹Useræˆå‘˜å˜é‡å¯¹åº”ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.UserInfo;</span><br><span class="line"><span class="keyword">import</span> com.example.enums.UserStatus;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;tb_user&quot;, autoResultMap = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="comment">//ç”¨æˆ·id</span></span><br><span class="line">    <span class="meta">@TableId(type= IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="meta">@TableField(&quot;`username`&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">//æ³¨å†Œæ‰‹æœºå·</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="comment">//è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">    <span class="meta">@TableField(typeHandler = JacksonTypeHandler.class)</span></span><br><span class="line">    <span class="keyword">private</span> UserInfo info;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨çŠ¶æ€ï¼ˆ1æ­£å¸¸2å†»ç»“ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> UserStatus status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer balance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="æ’ä»¶åŠŸèƒ½"><a href="#æ’ä»¶åŠŸèƒ½" class="headerlink" title="æ’ä»¶åŠŸèƒ½"></a>æ’ä»¶åŠŸèƒ½</h1><p>MybatisPlusæä¾›çš„å†…ç½®æ‹¦æˆªå™¨æœ‰ä¸‹é¢è¿™äº›ï¼š</p>
<table>
<thead>
<tr>
<th>åºå·</th>
<th>æ‹¦æˆªå™¨</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>TenantLineInnerInterceptor</td>
<td>å¤šç§Ÿæˆ·æ’ä»¶</td>
</tr>
<tr>
<td>2</td>
<td>DynamicTableNameInnerInterceptor</td>
<td>åŠ¨æ€è¡¨åæ’ä»¶</td>
</tr>
<tr>
<td>3</td>
<td>PaginationInnerInterceptor</td>
<td>åˆ†é¡µæ’ä»¶</td>
</tr>
<tr>
<td>4</td>
<td>OptimisticLockerInnerInterceptor</td>
<td>ä¹è§‚é”æ’ä»¶</td>
</tr>
<tr>
<td>5</td>
<td>IllegalSQLInnerInterceptor</td>
<td>SQLæ€§èƒ½è§„èŒƒæ’ä»¶ï¼Œæ£€æµ‹å¹¶æ‹¦æˆªåƒåœ¾SQL</td>
</tr>
<tr>
<td>6</td>
<td>BlockAttackInnerInterceptor</td>
<td>é˜²æ­¢å…¨è¡¨æ›´æ–°å’Œåˆ é™¤çš„æ’ä»¶</td>
</tr>
</tbody></table>
<h2 id="åˆ†é¡µæ’ä»¶åŸºæœ¬ç”¨æ³•"><a href="#åˆ†é¡µæ’ä»¶åŸºæœ¬ç”¨æ³•" class="headerlink" title="åˆ†é¡µæ’ä»¶åŸºæœ¬ç”¨æ³•"></a>åˆ†é¡µæ’ä»¶åŸºæœ¬ç”¨æ³•</h2><p>é¦–å…ˆï¼Œè¦åœ¨é…ç½®ç±»ä¸­æ³¨å†ŒMybatisPlusçš„æ ¸å¿ƒæ’ä»¶ï¼ŒåŒæ—¶æ·»åŠ åˆ†é¡µæ’ä»¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">//å£°æ˜æ–¹æ³•ï¼Œé€šè¿‡è¿”å›ç¬¬ä¸‰æ–¹ç±»çš„å¯¹è±¡å®ç°IOCå®¹å™¨Beanå¯¹è±¡çš„æ³¨å…¥</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//1. åˆå§‹åŒ–æ ¸å¿ƒæ’ä»¶</span></span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">//2. æ·»åŠ åˆ†é¡µæ’ä»¶</span></span><br><span class="line">        <span class="type">PaginationInnerInterceptor</span> <span class="variable">paginationInnerInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL);</span><br><span class="line">        paginationInnerInterceptor.setMaxLimit(<span class="number">1000L</span>); <span class="comment">//è®¾ç½®åˆ†é¡µä¸Šé™</span></span><br><span class="line">        interceptor.addInnerInterceptor(paginationInnerInterceptor);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œå°±å¯ä»¥ä½¿ç”¨åˆ†é¡µçš„APIäº†ï¼ˆIServiceï¼ŒDbé™æ€å·¥å…·ï¼ŒLambdaQueryéƒ½æœ‰ç±»ä¼¼çš„åˆ†é¡µå·¥å…·ï¼‰ï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220132445037.png" alt="image-20240220132445037"></p>
<p> å®ƒæœ‰ä¸ªæ³›å‹Eï¼ŒEç»§æ‰¿è‡ªIPageæ¥å£åŠå…¶å­ç±»ï¼ˆPageå’ŒPageDTOï¼‰ï¼Œæˆ‘ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯Pageå¯¹è±¡ã€‚</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220133020397.png" alt="image-20240220133020397"></p>
<p>æ¥ç€ï¼Œå°±å¯ä»¥ä½¿ç”¨åˆ†é¡µçš„APIäº†ï¼š</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220133039514.png" alt="image-20240220133039514"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.UserInfo;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.jupiter.api.Assertions.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IUserServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testPageQuery</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//1.æŸ¥è¯¢</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>, pageSize=  <span class="number">5</span>;</span><br><span class="line">        <span class="comment">//1.1 åˆ†é¡µå‚æ•°</span></span><br><span class="line">        Page&lt;User&gt; page = Page.of(pageNo,pageSize);</span><br><span class="line">        <span class="comment">//1.2æ’åºå‚æ•°ï¼Œé€šè¿‡OrderItemæ¥æŒ‡å®š</span></span><br><span class="line">        page.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(<span class="string">&quot;balance&quot;</span>,<span class="literal">true</span>));</span><br><span class="line">        <span class="comment">//1.3åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        Page&lt;User&gt; p = userService.page(page);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.æ€»æ¡æ•°</span></span><br><span class="line">        System.out.println(<span class="string">&quot;total = &quot;</span> + p.getTotal());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. æ€»é¡µæ•°</span></span><br><span class="line">        System.out.println(<span class="string">&quot;pages = &quot;</span> + p.getPages());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. åˆ†é¡µæ•°æ®</span></span><br><span class="line">        List&lt;User&gt; records = p.getRecords();</span><br><span class="line">        records.forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="é€šç”¨åˆ†é¡µå®ä½“"><a href="#é€šç”¨åˆ†é¡µå®ä½“" class="headerlink" title="é€šç”¨åˆ†é¡µå®ä½“"></a>é€šç”¨åˆ†é¡µå®ä½“</h2><p>æ¡ˆä¾‹ï¼šç®€å•åˆ†é¡µæŸ¥è¯¢æ¡ˆä¾‹</p>
<p>éœ€æ±‚ï¼šéµå¾ªä¸‹é¢çš„æ¥å£è§„èŒƒï¼Œç¼–å†™ä¸€ä¸ªUserControlleræ¥å£ï¼Œå®ç°Userçš„åˆ†é¡µæŸ¥è¯¢</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220134455782.png" alt="image-20240220134455782"></p>
<p>è¿”å›å€¼</p>
<p><img src="/2024/02/18/mybatisplus-day01/image-20240220134554535.png" alt="image-20240220134554535"></p>
<p>å®ç°æ“ä½œ</p>
<ol>
<li><p>åˆ›å»ºPageQueryç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.query;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageQuery</span> &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é¡µç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageNo;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é¡µæ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageSize;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ’åºå­—æ®µ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sortyBy;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ˜¯å¦å‡åº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isAsc;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è®©UserQueryç»§æ‰¿PageQuery</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;ç”¨æˆ·æŸ¥è¯¢æ¡ä»¶å®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserQuery</span> <span class="keyword">extends</span> <span class="title class_">PageQuery</span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·åå…³é”®å­—&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer name;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ç”¨æˆ·çŠ¶æ€ï¼š1-æ­£å¸¸ï¼Œ2-å†»ç»“&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½™é¢æœ€å°å€¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer minBalance;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä½™é¢æœ€å¤§å€¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer maxBalance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨dtoåŒ…ä¸‹åˆ›å»ºè¿”å›ç»™å‰ç«¯çš„æ•°æ®ç±»å‹æ³›å‹ç±»PageDTO&lt;T&gt;</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.dto;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;åˆ†é¡µç»“æœ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageDTO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»æ¡æ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer total;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»é¡µæ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer pages;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é›†åˆ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºæµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.Db;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.dto.PageDTO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.Address;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.query.UserQuery;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.AddressVO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.enums.UserStatus;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageDTO&lt;UserVO&gt; <span class="title function_">queryUsersPage</span><span class="params">(UserQuery query)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> query.getName();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> query.getStatus();</span><br><span class="line">        <span class="comment">//1.æ„å»ºæŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        <span class="comment">//1.1 åˆ†é¡µæ¡ä»¶</span></span><br><span class="line">        Page&lt;User&gt; page = Page.of(query.getPageNo(),query.getPageSize());</span><br><span class="line">        <span class="comment">//1.2 æ’åºæ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span>(query.getSortyBy() != <span class="literal">null</span>)&#123;</span><br><span class="line">            page.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(query.getSortyBy(),query.getIsAsc()));</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//ä¸ºç©ºï¼Œé»˜è®¤æŒ‰ç…§æ›´æ–°æ—¶é—´é™åºæ’åº</span></span><br><span class="line">            page.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(<span class="string">&quot;update_time&quot;</span>,<span class="literal">false</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        Page&lt;User&gt; p = lambdaQuery().like(name != <span class="literal">null</span>, User::getUsername, name)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .page(page);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.å°è£…VOç»“æœ</span></span><br><span class="line">        PageDTO&lt;UserVO&gt; dto = <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//3.1 æ€»æ¡æ•°</span></span><br><span class="line">        dto.setTotal(p.getTotal());</span><br><span class="line">        <span class="comment">//3.2 æ€»é¡µæ•°</span></span><br><span class="line">        dto.setPages(p.getPages());</span><br><span class="line">        <span class="comment">//3.3 å½“å‰é¡µæ•°æ®</span></span><br><span class="line">        List&lt;User&gt; records = p.getRecords();</span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isEmpty(records))&#123;</span><br><span class="line">            dto.setList((Collections.emptyList()));</span><br><span class="line">            <span class="keyword">return</span> dto;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.4 æ‹·è´userçš„VO</span></span><br><span class="line">        List&lt;UserVO&gt; userVOS = BeanUtil.copyToList(p.getRecords(), UserVO.class);</span><br><span class="line">        dto.setList(userVOS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> dto;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="é€šç”¨åˆ†é¡µå®ä½“ä¸MPè½¬æ¢"><a href="#é€šç”¨åˆ†é¡µå®ä½“ä¸MPè½¬æ¢" class="headerlink" title="é€šç”¨åˆ†é¡µå®ä½“ä¸MPè½¬æ¢"></a>é€šç”¨åˆ†é¡µå®ä½“ä¸MPè½¬æ¢</h2><p>æ¡ˆä¾‹ï¼šé€šç”¨åˆ†é¡µå®ä½“</p>
<p>éœ€æ±‚ï¼š</p>
<ul>
<li><p>åœ¨PageQueryä¸­å®šä¹‰æ–¹æ³•ï¼Œå°†PageQueryå¯¹è±¡è½¬åŒ–ä¸ºMyBatisPlusä¸­çš„Pageå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.query;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;åˆ†é¡µæŸ¥è¯¢å®ä½“&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageQuery</span> &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é¡µç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é¡µæ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ’åºå­—æ®µ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String sortyBy;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ˜¯å¦å‡åº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Boolean</span> <span class="variable">isAsc</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPage</span><span class="params">(OrderItem... items)</span> &#123;</span><br><span class="line">        <span class="comment">//1.æ„å»ºæŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        <span class="comment">//1.1 åˆ†é¡µæ¡ä»¶</span></span><br><span class="line">        Page&lt;T&gt; page = Page.of(pageNo, pageSize);</span><br><span class="line">        <span class="comment">//1.2 æ’åºæ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (sortyBy != <span class="literal">null</span>) &#123;</span><br><span class="line">            page.addOrder(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(sortyBy, isAsc));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (items != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">//ä¸ºç©ºï¼Œé»˜è®¤æŒ‰ç…§æ›´æ–°æ—¶é—´é™åºæ’åº</span></span><br><span class="line">            page.addOrder(items);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> page;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPage</span><span class="params">(String defaultSortBy, Boolean defaultAsc)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toMpPage(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(defaultSortBy, defaultAsc));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPageDefaultSortByCreateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toMpPage(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(<span class="string">&quot;create_time&quot;</span>, <span class="literal">false</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; Page&lt;T&gt; <span class="title function_">toMpPageDefaultSortByUpdateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> toMpPage(<span class="keyword">new</span> <span class="title class_">OrderItem</span>(<span class="string">&quot;update_time&quot;</span>, <span class="literal">false</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨PageDTOä¸­å®šä¹‰æ–¹æ³•ï¼Œå°†MyBatisPlusä¸­çš„Pageç»“æœè½¬åŒ–ä¸ºPageDTOçš„ç»“æœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.domain.dto;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;åˆ†é¡µç»“æœ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageDTO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»æ¡æ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long total;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»é¡µæ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long pages;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é›†åˆ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; list;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;PO, VO&gt;  PageDTO&lt;VO&gt; <span class="title function_">of</span><span class="params">(Page&lt;PO&gt; p, Class&lt;VO&gt; clazz)</span>&#123;</span><br><span class="line">        <span class="comment">//3.å°è£…VOç»“æœ</span></span><br><span class="line">        PageDTO&lt;VO&gt; dto = <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//3.1 æ€»æ¡æ•°</span></span><br><span class="line">        dto.setTotal(p.getTotal());</span><br><span class="line">        <span class="comment">//3.2 æ€»é¡µæ•°</span></span><br><span class="line">        dto.setPages(p.getPages());</span><br><span class="line">        <span class="comment">//3.3 å½“å‰é¡µæ•°æ®</span></span><br><span class="line">        List&lt;PO&gt; records = p.getRecords();</span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isEmpty(records))&#123;</span><br><span class="line">            dto.setList((Collections.emptyList()));</span><br><span class="line">            <span class="keyword">return</span> dto;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.4 æ‹·è´userçš„VO</span></span><br><span class="line">        List&lt;VO&gt; userVOS = BeanUtil.copyToList(records, clazz);</span><br><span class="line">        dto.setList(userVOS);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> dto;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡æ–°æ”¹å†™æ ¹æ®æ¡ä»¶åˆ†é¡µæŸ¥è¯¢ç»“æœçš„æµ‹è¯•æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.Db;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.dto.PageDTO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.Address;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.query.PageQuery;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.query.UserQuery;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.AddressVO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.enums.UserStatus;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageDTO&lt;UserVO&gt; <span class="title function_">queryUsersPage</span><span class="params">(UserQuery query)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> query.getName();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> query.getStatus();</span><br><span class="line">        Page&lt;User&gt; page = query.toMpPageDefaultSortByUpdateTime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        Page&lt;User&gt; p = lambdaQuery().like(name != <span class="literal">null</span>, User::getUsername, name)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .page(page);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> PageDTO.of(p, UserVO.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>ç¼ºç‚¹ï¼š<code>BeanUtil.copyToList(records, clazz);</code>è¦æ±‚POå’ŒVOç±»å‹çš„å­—æ®µåä¸€è‡´ã€‚å¦‚æœå­—æ®µåä¸ä¸€è‡´ï¼Œæ— æ³•æ‹·è´ï¼Œå°±å¿…é¡»è‡ªå·±å®ŒæˆPOåˆ°VOçš„è½¬åŒ–ã€‚è§£å†³åŠæ³•ï¼Œä¼ é€’è½¬æ¢æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//pageDTO.java</span></span><br><span class="line"><span class="keyword">package</span> com.example.domain.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.function.Function;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> io.swagger.models.auth.In;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collector;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = &quot;åˆ†é¡µç»“æœ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageDTO</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»æ¡æ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long total;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ€»é¡µæ•°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long pages;</span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;é›†åˆ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; list;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;PO, VO&gt;  PageDTO&lt;VO&gt; <span class="title function_">of</span><span class="params">(Page&lt;PO&gt; p, Function&lt;PO,VO&gt; convertor)</span>&#123;</span><br><span class="line">        <span class="comment">//3.å°è£…VOç»“æœ</span></span><br><span class="line">        PageDTO&lt;VO&gt; dto = <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//3.1 æ€»æ¡æ•°</span></span><br><span class="line">        dto.setTotal(p.getTotal());</span><br><span class="line">        <span class="comment">//3.2 æ€»é¡µæ•°</span></span><br><span class="line">        dto.setPages(p.getPages());</span><br><span class="line">        <span class="comment">//3.3 å½“å‰é¡µæ•°æ®</span></span><br><span class="line">        List&lt;PO&gt; records = p.getRecords();</span><br><span class="line">        <span class="keyword">if</span>(CollUtil.isEmpty(records))&#123;</span><br><span class="line">            dto.setList((Collections.emptyList()));</span><br><span class="line">            <span class="keyword">return</span> dto;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.4 æ‹·è´userçš„VO</span></span><br><span class="line">        dto.setList(records.stream().map(convertor).collect(Collectors.toList()));</span><br><span class="line"><span class="comment">//        List&lt;VO&gt; userVOS = BeanUtil.copyToList(records, clazz);</span></span><br><span class="line"><span class="comment">//        dto.setList(userVOS);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> dto;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// UserServiceImpl.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.bean.BeanUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.collection.CollUtil;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.metadata.OrderItem;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.toolkit.Db;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.dto.PageDTO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.po.Address;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.query.PageQuery;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.query.UserQuery;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.AddressVO;</span><br><span class="line"><span class="keyword">import</span> com.example.domain.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.example.enums.UserStatus;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.User;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.service.IUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">IUserService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageDTO&lt;UserVO&gt; <span class="title function_">queryUsersPage</span><span class="params">(UserQuery query)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> query.getName();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> query.getStatus();</span><br><span class="line">        Page&lt;User&gt; page = query.toMpPageDefaultSortByUpdateTime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">        Page&lt;User&gt; p = lambdaQuery().</span><br><span class="line">            like(name != <span class="literal">null</span>, User::getUsername, name)</span><br><span class="line">            .eq(status != <span class="literal">null</span>, User::getStatus, status)</span><br><span class="line">            .page(page);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> PageDTO.of(p, user -&gt; &#123;</span><br><span class="line"><span class="comment">//            BeanUtil.copyProperties(user, UserVO.class)</span></span><br><span class="line">            <span class="type">UserVO</span> <span class="variable">vo</span> <span class="operator">=</span> BeanUtil.copyProperties(user,UserVO.class);</span><br><span class="line">            vo.setUsername(vo.getUsername().substring(<span class="number">0</span>,vo.getUsername().length() - <span class="number">2</span>) + <span class="string">&quot;**&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> vo;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>mybatisplus</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day09-mavené«˜çº§</title>
    <url>/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/</url>
    <content><![CDATA[<h1 id="åˆ†æ¨¡å—è®¾è®¡ä¸å¼€å‘"><a href="#åˆ†æ¨¡å—è®¾è®¡ä¸å¼€å‘" class="headerlink" title="åˆ†æ¨¡å—è®¾è®¡ä¸å¼€å‘"></a>åˆ†æ¨¡å—è®¾è®¡ä¸å¼€å‘</h1><ul>
<li><p>ä¸ºä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>ï¼ˆä¸€ä¸ªç”µå•†é¡¹ç›®å¯èƒ½åŒ…å«å¤šä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œå•†å“ã€æœç´¢ã€è´­ç‰©è½¦ã€è®¢å•ç­‰ç­‰æ¨¡å—ï¼Œæ‰€æœ‰çš„ä»£ç éƒ½åœ¨ä¸€ä¸ªjavaé¡¹ç›®ä¸­ï¼Œè¿™ä¸ªé¡¹ç›®çš„ç®¡ç†å’Œç»´æŠ¤ä¼šå¾ˆå›°éš¾ï¼‰</li>
<li>ï¼ˆåœ¨é¡¹ç›®ä¸­å®šä¹‰äº†é€šç”¨çš„å·¥å…·ç±»å’Œç»„ä»¶ï¼Œå…¬å¸å…¶ä»–é¡¹ç›®ç»„ä¹Ÿæƒ³ä½¿ç”¨è¿™äº›å·¥å…·ç±»å’Œç»„ä»¶ï¼Œè¿™ç§æƒ…å†µä¹Ÿä¸å¤ªæ–¹ä¾¿ï¼Œä»£ç éš¾ä»¥å¤ç”¨ï¼‰</li>
</ul>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216183352534.png" alt="image-20240216183352534"></p>
</li>
<li><p>åˆ†æ¨¡å—è®¾è®¡ï¼šå°†é¡¹ç›®æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªå­æ¨¡å—ï¼Œæ–¹ä¾¿é¡¹ç›®çš„ç®¡ç†ç»´æŠ¤ã€æ‹“å±•ï¼Œä¹Ÿæ–¹ä¾¿æ¨¡å—é—´çš„ç›¸äº’è°ƒç”¨ï¼Œèµ„æºå…±äº«ã€‚ï¼ˆå•†å“ã€æœç´¢ã€è´­ç‰©è½¦ã€è®¢å•ã€å®ä½“ç±»|é€šç”¨ç»„ä»¶æ¨¡å—ç­‰ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216183456409.png" alt="image-20240216183456409"></p>
</li>
<li><p>å®è·µ</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216213219458.png" alt="image-20240216213219458"></p>
</li>
<li><p>æ­¥éª¤</p>
<ul>
<li><p>åˆ›å»ºmavenæ¨¡å— tlias-pojoï¼Œå­˜æ”¾å®ä½“ç±»ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216214402332.png" alt="image-20240216214402332"></p>
<p>ç»™tlias-pojoçš„pom.xmlæ–‡ä»¶åŠ ä¸Šå¯¹åº”çš„ä¾èµ–ï¼Œç¡®ä¿å…¶ä¸­çš„pojoç±»æ–¹æ³•èƒ½æ­£å¸¸è¿è¡Œã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216214515180.png" alt="image-20240216214515180"></p>
</li>
<li><p>åˆ›å»ºmavenæ¨¡å—tlias-utilsï¼Œå­˜æ”¾ç›¸å…³å·¥å…·ç±»ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216214900547.png" alt="image-20240216214900547"></p>
</li>
<li><p>åœ¨ä¸»ç¨‹åºä¸­å¼•å…¥è¿™ä¸¤ä¸ªæ¨¡å—</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216215548913.png" alt="image-20240216215548913"></p>
<p><font color="red">æ³¨æ„äº‹é¡¹ï¼šåˆ†æ¨¡å—å¼€å‘éœ€è¦å…ˆé’ˆå¯¹æ¨¡å—åŠŸèƒ½è¿›è¡Œè®¾è®¡ï¼Œå†è¿›è¡Œç¼–ç ã€‚ä¸ä¼šå…ˆå°†å·¥ç¨‹å¼€å‘å®Œæ¯•ï¼Œç„¶åè¿›è¡Œæ‹†åˆ†ã€‚</font></p>
</li>
</ul>
</li>
</ul>
<h1 id="ç»§æ‰¿ä¸èšåˆ"><a href="#ç»§æ‰¿ä¸èšåˆ" class="headerlink" title="ç»§æ‰¿ä¸èšåˆ"></a>ç»§æ‰¿ä¸èšåˆ</h1><h2 id="ç»§æ‰¿å…³ç³»"><a href="#ç»§æ‰¿å…³ç³»" class="headerlink" title="ç»§æ‰¿å…³ç³»"></a>ç»§æ‰¿å…³ç³»</h2><p><strong>é—®é¢˜</strong></p>
<p>ä¸åŒæ¨¡å—çš„é…ç½®å¼•å…¥äº†å¤šä¸ªç›¸åŒä¾èµ–ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216220009702.png" alt="image-20240216220009702"></p>
<p><strong>ç»§æ‰¿</strong></p>
<ul>
<li>æ¦‚å¿µï¼šç»§æ‰¿æè¿°çš„æ˜¯ä¸¤ä¸ªå·¥ç¨‹é—´çš„å…³ç³»ï¼Œä¸Javaä¸­çš„ç»§æ‰¿ç›¸ä¼¼ï¼Œå­å·¥ç¨‹å¯ä»¥ç»§æ‰¿çˆ¶å·¥ç¨‹ä¸­çš„é…ç½®ä¿¡æ¯ï¼Œå¸¸è§äºä¾èµ–å…³ç³»çš„ç»§æ‰¿ã€‚ï¼ˆå°†å„ä¸ªå­å·¥ç¨‹ä¸­çš„å…¬å…±ä¾èµ–æ”¾åˆ°çˆ¶å·¥ç¨‹ä¾èµ–ä¸­ï¼‰ã€‚</li>
<li>ä½œç”¨ï¼šç®€åŒ–ä¾èµ–é…ç½®ï¼Œç»Ÿä¸€ç®¡ç†ä¾èµ–ã€‚</li>
<li>å®ç°ï¼š&lt;parent&gt; â€¦ &lt;&#x2F;parent&gt;</li>
</ul>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216220347887.png" alt="image-20240216220347887"></p>
<p><strong>æ­¥éª¤</strong></p>
<ol>
<li><p>åˆ›å»ºmavenæ¨¡å—tlias-parentï¼Œè¯¥å·¥ç¨‹ä¸ºçˆ¶å·¥ç¨‹ï¼Œè®¾ç½®æ‰“åŒ…æ–¹å¼pomï¼ˆé»˜è®¤jarï¼‰ã€‚</p>
<ul>
<li>jarï¼šæ™®é€šæ¨¡å—æ‰“åŒ…ï¼Œspringbooté¡¹ç›®åŸºæœ¬éƒ½æ˜¯jaråŒ…ï¼ˆå†…åµŒtomcatè¿è¡Œï¼‰</li>
<li>warï¼šæ™®é€šwebç¨‹åºæ‰“åŒ…ï¼Œéœ€è¦éƒ¨ç½²åœ¨å¤–éƒ¨çš„tomcatæœåŠ¡å™¨ä¸­è¿è¡Œ</li>
<li>pomï¼šçˆ¶å·¥ç¨‹æˆ–èšåˆå·¥ç¨‹ï¼Œè¯¥æ¨¡å—ä¸å†™ä»£ç ï¼Œä»…è¿›è¡Œä¾èµ–ç®¡ç†</li>
</ul>
<p>æ³¨æ„ï¼šåœ¨mavenå½“ä¸­ï¼Œä¸€ä¸ªå·¥ç¨‹åªèƒ½ç»§æ‰¿ä¸€ä¸ªçˆ¶å·¥ç¨‹ã€‚æˆ‘ä»¬åŸå§‹çš„tlias-web-managementå·²ç»æœ‰çˆ¶å·¥ç¨‹spring-boot-starter-parentã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216221111872.png" alt="image-20240216221111872"></p>
<p>è§£å†³åŠæ³•ï¼šè®©tlias-parentç»§æ‰¿spring-boot-starter-parentï¼Œå†è®©tlias-web-managementç»§æ‰¿tlias-parentã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216221158176.png" alt="image-20240216221158176"></p>
<p>è®¾ç½®tlias-parentçš„pom.xmlå†…å®¹ï¼Œè®¾ç½®äº†parentçˆ¶å·¥ç¨‹ï¼Œpackagingæ‰“åŒ…æ–¹å¼ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216221232706.png" alt="image-20240216221232706"></p>
</li>
<li><p>åœ¨å­å·¥ç¨‹çš„pom.xmlæ–‡ä»¶ä¸­ï¼Œé…ç½®ç»§æ‰¿å…³ç³»ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216223213319.png" alt="image-20240216223213319"></p>
<ul>
<li>åœ¨å­å·¥ç¨‹ä¸­ï¼Œé…ç½®äº†ç»§æ‰¿å…³ç³»ä¹‹åï¼Œåæ ‡ä¸­çš„groupIdæ˜¯å¯ä»¥çœç•¥çš„ï¼Œå› ä¸ºä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶å·¥ç¨‹çš„ã€‚</li>
<li>relativePathæŒ‡å®šçˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶çš„ç›¸å¯¹ä½ç½®ï¼ˆå¦‚æœä¸æŒ‡å®šï¼Œå°†ä»æœ¬åœ°ä»“åº“&#x2F;è¿œç¨‹ä»“åº“ä¸­æŸ¥æ‰¾è¯¥å·¥ç¨‹ï¼‰ã€‚</li>
</ul>
</li>
<li><p>åœ¨çˆ¶å·¥ç¨‹ä¸­é…ç½®å„ä¸ªå·¥ç¨‹å…±æœ‰çš„ä¾èµ–ï¼ˆå­å·¥ç¨‹ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶å·¥ç¨‹çš„ä¾èµ–ï¼‰ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216223346649.png" alt="image-20240216223346649"></p>
<ul>
<li><font color="red">è‹¥çˆ¶å­å·¥ç¨‹éƒ½é…ç½®äº†åŒä¸€ä¸ªä¾èµ–çš„ä¸åŒç‰ˆæœ¬ï¼Œä»¥å­å·¥ç¨‹çš„ä¸ºå‡†ã€‚</font></li>
</ul>
</li>
</ol>
<p><strong>å®æ“</strong></p>
<ol>
<li>åˆ›å»ºtlias-parentæ¨¡å—ä½œä¸ºçˆ¶å·¥ç¨‹ã€‚</li>
</ol>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216221627518.png" alt="image-20240216221627518"></p>
<ol start="2">
<li><p>è®¾ç½®tlias-parentæ¨¡å—çš„æ‰“åŒ…æ–¹å¼å’Œçˆ¶å·¥ç¨‹ï¼Œåˆ é™¤æ— ç”¨çš„srcç›®å½•ï¼ˆä»…åšä¾èµ–ç®¡ç†ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216221919180.png" alt="image-20240216221919180"></p>
</li>
<li><p>è®¾ç½®å­å·¥ç¨‹çš„pom.xml</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216222504798.png" alt="image-20240216222504798"></p>
</li>
<li><p>åœ¨çˆ¶å·¥ç¨‹ä¸­é…ç½®å­å·¥ç¨‹ä¸­ç›¸åŒçš„é…ç½®</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216222918026.png" alt="image-20240216222918026"></p>
</li>
</ol>
<p><strong>çœŸå®çš„é¡¹ç›®æ¨¡å—ç»“æ„</strong>ï¼ˆæœ‰å›¾æ‰€ç¤ºï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216223542356.png" alt="image-20240216223542356"></p>
<h2 id="ç‰ˆæœ¬é”å®š"><a href="#ç‰ˆæœ¬é”å®š" class="headerlink" title="ç‰ˆæœ¬é”å®š"></a>ç‰ˆæœ¬é”å®š</h2><p>åˆ†æ¨¡å—ä¹‹åï¼Œå­å·¥ç¨‹å¯ä»¥ç»§æ‰¿çˆ¶å·¥ç¨‹çš„ä¾èµ–ã€‚</p>
<p>é—®é¢˜ï¼šå­˜åœ¨å¤šä¸ªï¼ˆéå…¨éƒ¨ï¼‰å­å·¥ç¨‹ä½¿ç”¨åŒä¸€ä¸ªä¾èµ–ã€‚è¿™ä¸ªä¾èµ–æ— æ³•ç›´æ¥æ·»åŠ åˆ°çˆ¶å·¥ç¨‹ä¸­ã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216223913990.png" alt="image-20240216223913990"></p>
<p>è§£å†³åŠæ³•ï¼š</p>
<p>åœ¨mavenä¸­ï¼Œå¯ä»¥åœ¨çˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶ä¸­é€šè¿‡&lt;dependencyManagement&gt;æ¥ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬ã€‚ï¼ˆä»…ä»…ä»£è¡¨æˆ‘ä»¬è¦ç»Ÿä¸€ç®¡ç†è¿™ä¸ªä¾èµ–çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸å°†å…¶æ·»åŠ è‡³çˆ¶å·¥ç¨‹çš„ä¾èµ–ä¸­ï¼Œå®é™…ä¸Šé…ç½®æ—¶è¿˜æ˜¯åœ¨å­å·¥ç¨‹ä¸­é…ç½®ä¾èµ–ï¼Œä½†æ˜¯ä¸ç”¨å†åœ¨å­å·¥ç¨‹ä¸­æŒ‡å®šä¾èµ–ç‰ˆæœ¬ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216224152871.png" alt="image-20240216224152871"></p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>å­å·¥ç¨‹å¼•å…¥ä¾èµ–æ—¶ï¼Œæ— éœ€æŒ‡å®š&lt;version&gt;ç‰ˆæœ¬å·ï¼Œçˆ¶å·¥ç¨‹ç»Ÿä¸€ç®¡ç†ã€‚å˜æ›´ä¾èµ–ç‰ˆæœ¬ï¼Œåªéœ€åœ¨çˆ¶å·¥ç¨‹ä¸­ç»Ÿä¸€å˜æ›´ã€‚</li>
</ul>
<p><strong>è‡ªå®šä¹‰å±æ€§&#x2F;å¼•ç”¨å±æ€§</strong></p>
<p>åœ¨ymlæ–‡ä»¶çš„propertieså±æ€§ä¸­è®¾ç½®ä¾èµ–ç‰ˆæœ¬</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216225128520.png" alt="image-20240216225128520"></p>
<ol>
<li>&lt;dependencyManagement&gt;ä¸&lt;dependencies&gt;çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ol>
<ul>
<li>&lt;dependencies&gt;æ˜¯ç›´æ¥ä¾èµ–ï¼Œåœ¨çˆ¶å·¥ç¨‹é…ç½®äº†ä¾èµ–ï¼Œå­å·¥ç¨‹ä¼šç›´æ¥ç»§æ‰¿ä¸‹æ¥ã€‚</li>
<li>&lt;dependencyManagement&gt;æ˜¯ç»Ÿä¸€ç®¡ç†ä¾èµ–ç‰ˆæœ¬ï¼Œä¸ä¼šç›´æ¥ä¾èµ–ï¼Œè¿˜éœ€è¦åœ¨å­å·¥ç¨‹ä¸­å¼•å…¥æ‰€éœ€ä¾èµ–ï¼ˆæ— éœ€æŒ‡å®šç‰ˆæœ¬ï¼‰</li>
</ul>
<h2 id="èšåˆ"><a href="#èšåˆ" class="headerlink" title="èšåˆ"></a>èšåˆ</h2><p>é—®é¢˜ï¼šè¦å°†tlias-web-managementæ‰“åŒ…ï¼Œå¾—å…ˆå°†tlias-parentï¼Œtlias-pojoï¼Œtlias-utilsæ‰§è¡Œinstallï¼Œç„¶åæ‰èƒ½æ‰“åŒ…tlias-web-managementã€‚</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216231527264.png" alt="image-20240216231527264"></p>
<p>mavençš„èšåˆæ“ä½œå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šä¸€é”®ç¼–è¯‘ã€æ‰“åŒ…ã€å®‰è£…ã€‚</p>
<ul>
<li><p>èšåˆ</p>
<p>å°†å¤šä¸ªæ¨¡å—ç»„ç»‡æˆä¸€ä¸ªæ•´ä½“ï¼ŒåŒæ—¶è¿›è¡Œé¡¹ç›®çš„æ„å»ºã€‚</p>
</li>
<li><p>èšåˆå·¥ç¨‹</p>
<p>ä¸€ä¸ªä¸å…·æœ‰ä¸šåŠ¡åŠŸèƒ½çš„â€œç©ºâ€å·¥ç¨‹ï¼ˆæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªpomæ–‡ä»¶ï¼‰ï¼ˆç›®å‰é¡¹ç›®ä¸­å°±æœ‰ï¼Œæ˜¯tlias-parentï¼Œå› æ­¤tlias-parentæ—¢æ˜¯çˆ¶å·¥ç¨‹ï¼Œä¹Ÿæ˜¯èšåˆå·¥ç¨‹ï¼‰</p>
</li>
<li><p>ä½œç”¨</p>
<p>å¿«é€Ÿæ„å»ºé¡¹ç›®ï¼ˆæ— éœ€æ ¹æ®ä¾èµ–å…³ç³»æ‰‹åŠ¨æ„å»ºï¼Œç›´æ¥åœ¨èšåˆå·¥ç¨‹ä¸Šæ„å»ºå³å¯ï¼‰</p>
</li>
</ul>
<p>mavenå¯ä»¥é€šè¿‡åœ¨pom.xmlä¸­è®¾ç½®&lt;modules&gt;ï¼Œä»è€Œè®¾ç½®å½“å‰èšåˆå·¥ç¨‹æ‰€åŒ…å«çš„å­æ¨¡å—åç§°</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216231953596.png" alt="image-20240216231953596"></p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>èšåˆå·¥ç¨‹ä¸­æ‰€åŒ…å«çš„æ¨¡å—ï¼Œåœ¨æ„å»ºæ—¶ï¼Œä¼šæ ¹æ®æ¨¡å—é—´çš„ä¾èµ–å…³ç³»è®¾ç½®æ„å»ºé¡ºåºï¼Œä¸èšåˆå·¥ç¨‹ä¸­æ¨¡å—çš„é…ç½®ä¹¦å†™ä½ç½®æ— å…³ã€‚</li>
</ul>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240216232244285.png" alt="image-20240216232244285"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>ä½œç”¨<ul>
<li>èšåˆç”¨äºå¿«é€Ÿæ„å»ºé¡¹ç›®</li>
<li>ç»§æ‰¿ç”¨äºç®€åŒ–ä¾èµ–é…ç½®ã€ç»Ÿä¸€ç®¡ç†ä¾èµ–</li>
</ul>
</li>
<li>ç›¸åŒç‚¹<ul>
<li>èšåˆä¸ç»§æ‰¿çš„pom.xmlæ–‡ä»¶æ‰“åŒ…æ–¹å¼å‡ä¸ºpomï¼Œå¯ä»¥å°†ä¸¤ç§å…³ç³»åˆ¶ä½œåˆ°åŒä¸€ä¸ªpomæ–‡ä»¶ä¸­</li>
<li>èšåˆä¸ç»§æ‰¿å‡å±äºè®¾è®¡å‹æ¨¡å—ï¼Œ å¹¶æ— å®é™…çš„æ¨¡å—å†…å®¹</li>
</ul>
</li>
<li>ä¸åŒç‚¹<ul>
<li>èšåˆæ˜¯åœ¨èšåˆå·¥ç¨‹ä¸­é…ç½®å…³ç³»ï¼Œèšåˆå¯ä»¥æ„ŸçŸ¥åˆ°å‚ä¸èšåˆçš„æ¨¡å—æœ‰å“ªäº›</li>
<li>ç»§æ‰¿æ˜¯åœ¨å­æ¨¡å—ä¸­é…ç½®å…³ç³»ï¼Œçˆ¶æ¨¡å—æ— æ³•æ„ŸçŸ¥å“ªäº›å­æ¨¡å—ç»§æ‰¿äº†è‡ªå·±</li>
</ul>
</li>
</ul>
<h1 id="ç§æœ"><a href="#ç§æœ" class="headerlink" title="ç§æœ"></a>ç§æœ</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217011547756.png" alt="image-20240217011547756"></p>
<p>é—®é¢˜ï¼šæ€ä¹ˆå°†Aä¸­çš„jaråŒ…å¯¼å…¥è‡³Bçš„é¡¹ç›®ä¸­ï¼Ÿ</p>
<p>è§£å†³åŠæ³•ï¼šæ­å»ºç§æœã€‚ç§æœä»ä¸­å¤®ä»“åº“ä¸‹è½½ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œç¡®ä¿Aå’ŒBèƒ½ä½¿ç”¨å¯¹æ–¹çš„ä¾èµ–å’Œä¸­å¤®ä»“åº“çš„ä¾èµ–ã€‚</p>
<ul>
<li><p>ç§æœæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿œç¨‹ä»“åº“ï¼Œå®ƒæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘å†…çš„ä»“åº“æœåŠ¡ï¼Œç”¨æ¥ä»£ç†ä½äºå¤–éƒ¨çš„ä¸­å¤®ä»“åº“ï¼Œç”¨äºè§£å†³å›¢é˜Ÿå†…éƒ¨çš„èµ„æºå…±äº«ä¸èµ„æºåŒæ­¥é—®é¢˜ã€‚</p>
</li>
<li><p>ä¾èµ–æŸ¥æ‰¾é¡ºåºï¼š</p>
<ul>
<li>æœ¬åœ°ä»“åº“</li>
<li>ç§æœ</li>
<li>ä¸­å¤®ä»“åº“</li>
</ul>
</li>
<li><p>æ³¨æ„äº‹é¡¹ï¼šç§æœåœ¨ä¼ä¸šé¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€ä¸ªé¡¹ç›®&#x2F;å…¬å¸ï¼Œåªéœ€è¦ä¸€å°å³å¯ï¼ˆ<font color="red">æ— éœ€æˆ‘ä»¬æ­å»ºï¼Œä¼šä½¿ç”¨å³å¯</font>ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217011926163.png" alt="image-20240217011926163"></p>
</li>
</ul>
<h2 id="èµ„æºä¸Šä¼ ä¸ä¸‹è½½"><a href="#èµ„æºä¸Šä¼ ä¸ä¸‹è½½" class="headerlink" title="èµ„æºä¸Šä¼ ä¸ä¸‹è½½"></a>èµ„æºä¸Šä¼ ä¸ä¸‹è½½</h2><p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217012323930.png" alt="image-20240217012323930"></p>
<p><strong>ç§æœçš„ä»“åº“</strong></p>
<ul>
<li>RELEASE(å‘è¡Œç‰ˆæœ¬)ï¼šåŠŸèƒ½è¶‹äºç¨³å®šï¼Œå½“å‰æ›´æ–°åœæ­¢ï¼Œå¯ä»¥ç”¨äºå‘è¡Œçš„ç‰ˆæœ¬ï¼Œå­˜å‚¨åœ¨ç§æœçš„RELEASEä»“åº“ä¸­ã€‚</li>
<li>SNAPSHOTï¼ˆå¿«ç…§ç‰ˆæœ¬ï¼‰ï¼šåŠŸèƒ½ä¸ç¨³å®šã€å°šå¤„äºå¼€å‘ä¸­çš„ç‰ˆæœ¬ï¼Œå³å¿«ç…§ç‰ˆæœ¬ï¼Œå­˜å‚¨åœ¨ç§æœçš„SNAPSHOTä»“åº“ä¸­ã€‚</li>
</ul>
<ol>
<li><p>é…ç½®è®¿é—®ç§æœçš„ç”¨æˆ·å&#x2F;å¯†ç ï¼ˆsettings.xmlä¸­çš„serversä¸­é…ç½®ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013612624.png" alt="image-20240217013612624"></p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013535822.png" alt="image-20240217013535822"></p>
</li>
<li><p>IDEAçš„mavenå·¥ç¨‹çš„pomæ–‡ä»¶ä¸­é…ç½®ä¸Šä¼ ï¼ˆå‘å¸ƒï¼‰åœ°å€</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013625786.png" alt="image-20240217013625786"></p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013643914.png" alt="image-20240217013643914"></p>
</li>
<li><p>è®¾ç½®ç§æœä¾èµ–ä¸‹è½½çš„ä»“åº“ç»„åœ°å€ï¼ˆä»“åº“ç»„æŒ‚è½½äº†æ‰€æœ‰ä»“åº“ï¼Œsettings.xmlä¸­çš„mirrorsã€profilesä¸­é…ç½®ï¼‰</p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013820947.png" alt="image-20240217013820947"></p>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217013850809.png" alt="image-20240217013850809"></p>
</li>
</ol>
<h2 id="ç§æœé…ç½®è¯´æ˜"><a href="#ç§æœé…ç½®è¯´æ˜" class="headerlink" title="ç§æœé…ç½®è¯´æ˜"></a>ç§æœé…ç½®è¯´æ˜</h2><p>è®¿é—®ç§æœï¼š<a href="http://192.168.150.101:8081/">http://192.168.150.101:8081</a></p>
<p>è®¿é—®å¯†ç ï¼šadmin&#x2F;admin</p>
<p>ä½¿ç”¨ç§æœï¼Œéœ€è¦åœ¨mavençš„settings.xmlé…ç½®æ–‡ä»¶ä¸­ï¼Œåšå¦‚ä¸‹é…ç½®ï¼š</p>
<ol>
<li><p>éœ€è¦åœ¨ <strong>servers</strong> æ ‡ç­¾ä¸­ï¼Œé…ç½®è®¿é—®ç§æœçš„ä¸ªäººå‡­è¯(è®¿é—®çš„ç”¨æˆ·åå’Œå¯†ç )</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">server</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">server</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>åœ¨ <strong>mirrors</strong> ä¸­åªé…ç½®æˆ‘ä»¬è‡ªå·±ç§æœçš„è¿æ¥åœ°å€(å¦‚æœä¹‹å‰é…ç½®è¿‡é˜¿é‡Œäº‘ï¼Œéœ€è¦ç›´æ¥æ›¿æ¢æ‰)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-public<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.150.101:8081/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>éœ€è¦åœ¨ <strong>profiles</strong> ä¸­ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼Œæ¥æŒ‡å®šsnapshotå¿«ç…§ç‰ˆæœ¬çš„ä¾èµ–ï¼Œä¾ç„¶å…è®¸ä½¿ç”¨</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>allow-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-public<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.150.101:8081/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">releases</span>&gt;</span></span><br><span class="line">            	<span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">releases</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">snapshots</span>&gt;</span></span><br><span class="line">            	<span class="tag">&lt;<span class="name">enabled</span>&gt;</span>true<span class="tag">&lt;/<span class="name">enabled</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">snapshots</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>å¦‚æœéœ€è¦ä¸Šä¼ è‡ªå·±çš„é¡¹ç›®åˆ°ç§æœä¸Šï¼Œéœ€è¦åœ¨é¡¹ç›®çš„pom.xmlæ–‡ä»¶ä¸­ï¼Œå¢åŠ å¦‚ä¸‹é…ç½®ï¼Œæ¥é…ç½®é¡¹ç›®å‘å¸ƒçš„åœ°å€(ä¹Ÿå°±æ˜¯ç§æœçš„åœ°å€)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">distributionManagement</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- releaseç‰ˆæœ¬çš„å‘å¸ƒåœ°å€ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-releases<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.150.101:8081/repository/maven-releases/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- snapshotç‰ˆæœ¬çš„å‘å¸ƒåœ°å€ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>maven-snapshots<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://192.168.150.101:8081/repository/maven-snapshots/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">snapshotRepository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>å‘å¸ƒé¡¹ç›®ï¼Œç›´æ¥è¿è¡Œ deploy ç”Ÿå‘½å‘¨æœŸå³å¯ (å‘å¸ƒæ—¶ï¼Œå»ºè®®è·³è¿‡å•å…ƒæµ‹è¯•)</p>
</li>
</ol>
<p>â€‹		</p>
<h2 id="å¯åŠ¨æœ¬åœ°ç§æœ"><a href="#å¯åŠ¨æœ¬åœ°ç§æœ" class="headerlink" title="å¯åŠ¨æœ¬åœ°ç§æœ"></a>å¯åŠ¨æœ¬åœ°ç§æœ</h2><ol>
<li><p>è§£å‹ï¼š apache-maven-nexus.zip</p>
</li>
<li><p>è¿›å…¥ç›®å½•ï¼š apache-maven-nexus\nexus-3.39.0-01\bin</p>
</li>
<li><p>å¯åŠ¨æœåŠ¡ï¼šåŒå‡» start.bat </p>
</li>
<li><p>è®¿é—®æœåŠ¡ï¼šlocalhost:8081</p>
</li>
<li><p>ç§æœé…ç½®è¯´æ˜ï¼šå°†ä¸Šè¿°é…ç½®ç§æœä¿¡æ¯çš„ 192.168.150.101 æ”¹ä¸º localhost</p>
</li>
</ol>
<h1 id="Webå¼€å‘å®Œç»“"><a href="#Webå¼€å‘å®Œç»“" class="headerlink" title="Webå¼€å‘å®Œç»“"></a>Webå¼€å‘å®Œç»“</h1><p>æ¥ä¸‹æ¥çš„å­¦ä¹ è·¯çº¿</p>
<ol>
<li>MyBatis-Plus</li>
<li>ç‘å‰å¤–å–é¡¹ç›®</li>
<li>å¾®æœåŠ¡æŠ€æœ¯æ ˆ</li>
<li>å­¦æˆåœ¨çº¿é¡¹ç›®</li>
</ol>
<p><img src="/2024/02/16/javaweb-day09-maven%E9%AB%98%E7%BA%A7/image-20240217015500978.png" alt="image-20240217015500978"></p>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day08-springbootåŸç†ç¯‡</title>
    <url>/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/</url>
    <content><![CDATA[<h1 id="é…ç½®ä¼˜å…ˆçº§"><a href="#é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="é…ç½®ä¼˜å…ˆçº§"></a>é…ç½®ä¼˜å…ˆçº§</h1><ul>
<li><p>springbootä¸­æ”¯æŒä¸‰ç§æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼š</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215195245829.png" alt="image-20240215195245829"></p>
<p>propertiesçš„ä¼˜å…ˆçº§æœ€é«˜</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215195550412.png" alt="image-20240215195550412"></p>
<p>ymlçš„ä¼˜å…ˆçº§æ¬¡ä¹‹</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215195629992.png" alt="image-20240215195629992"></p>
<p>yamlçš„ä¼˜å…ˆçº§æœ€å</p>
</li>
<li><p>æ³¨æ„äº‹é¡¹ï¼šè™½ç„¶springbootæ”¯æŒå¤šç§æ ¼å¼é…ç½®æ–‡ä»¶ï¼Œä½†æ˜¯åœ¨é¡¹ç›®å¼€å‘æ—¶ï¼Œæ¨èç»Ÿä¸€ä½¿ç”¨ä¸€ç§æ ¼å¼çš„é…ç½®ï¼ˆymlæ˜¯ä¸»æµï¼‰</p>
</li>
<li><p>springbooté™¤äº†æ”¯æŒé…ç½®æ–‡ä»¶å±æ€§é…ç½®ï¼Œè¿˜æ”¯æŒ<font color="red">Javaç³»ç»Ÿå±æ€§</font>å’Œ<font color="red">å‘½ä»¤è¡Œå‚æ•°</font>çš„æ–¹æ³•è¿›è¡Œå±æ€§é…ç½®ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215195946438.png" alt="image-20240215195946438"></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215200530374.png" alt="image-20240215200530374"></p>
<p><font color="red">å‘½ä»¤è¡Œå‚æ•°ï¼ˆProgram argumentï¼‰çš„ä¼˜å…ˆçº§è¦é«˜äºJavaç³»ç»Ÿå±æ€§ï¼ˆVM optionï¼‰è®¾ç½®ã€‚</font></p>
</li>
</ul>
<p>ç›®å‰çš„è®¾ç½®æ˜¯åœ¨ideaä¸­ï¼Œå‡å¦‚æˆ‘ä»¬ä½¿ç”¨çš„ä¸æ˜¯ideaï¼Œæˆ–è€…æˆ‘ä»¬çš„é¡¹ç›®å·²ç»æ‰“åŒ…ä¸Šçº¿äº†ï¼Œæˆ‘ä»¬åˆå¦‚ä½•è®¾ç½®javaç³»ç»Ÿå±æ€§å’Œå‘½ä»¤è¡Œå‚æ•°å‘¢ï¼Ÿæ¥ä¸‹æ¥è¿è¡Œé¡¹ç›®æ‰“åŒ…åè¿è¡Œæ—¶å¦‚ä½•æŒ‡å®šjavaç³»ç»Ÿå±æ€§å’Œå‘½ä»¤è¡Œå‚æ•°ã€‚</p>
<ol>
<li><p>æ‰§è¡Œmavenæ‰“åŒ…æŒ‡ä»¤package</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215201417286.png" alt="image-20240215201417286"></p>
</li>
<li><p>æ‰§è¡ŒjavaæŒ‡ä»¤ï¼Œè¿è¡ŒjaråŒ…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java -Dserver.port=<span class="number">9000</span> -jar tlias-web-management-<span class="number">0.0</span><span class="number">.1</span>-SNAPSHOT.jar --server.port=<span class="number">10010</span></span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼šspringbooté¡¹ç›®è¿›è¡Œæ‰“åŒ…æ—¶ï¼Œéœ€è¦å¼•å…¥æ’ä»¶spring-boot-maven-pluginï¼ˆåŸºäºå®˜ç½‘éª¨æ¶åˆ›å»ºé¡¹ç›®ï¼Œä¼šè‡ªåŠ¨æ·»åŠ è¯¥æ’ä»¶ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215201808877.png" alt="image-20240215201808877"></p>
</li>
</ol>
<p>é…ç½®ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰</p>
<ul>
<li>javaç³»ç»Ÿå±æ€§ï¼ˆ-Dxxx&#x3D;xxxï¼‰</li>
<li>å‘½ä»¤è¡Œå‚æ•°ï¼ˆâ€“xxx&#x3D;xxxï¼‰</li>
<li>application.properties</li>
<li>application.yml</li>
<li>application.yamlï¼ˆå¿½ç•¥ï¼‰</li>
</ul>
<h1 id="Beanç®¡ç†"><a href="#Beanç®¡ç†" class="headerlink" title="Beanç®¡ç†"></a>Beanç®¡ç†</h1><h2 id="è·å–bean"><a href="#è·å–bean" class="headerlink" title="è·å–bean"></a>è·å–bean</h2><ul>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpringé¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šæŠŠbeanéƒ½åˆ›å»ºå¥½æ”¾åœ¨IOCå®¹å™¨ä¸­ï¼Œå¦‚æœæƒ³è¦ä¸»åŠ¨è·å–è¿™äº›beanï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼š</p>
<ul>
<li>æ ¹æ®nameè·å–beanï¼š<code>Object getBean(String name)</code></li>
<li>æ ¹æ®ç±»å‹è·å–beanï¼š<code>&lt;T&gt; T getBean(Class&lt;T&gt; requiredType)</code></li>
<li>æ ¹æ®nameè·å–beanï¼ˆå¸¦ç±»å‹è½¬æ¢ï¼‰ï¼š<code>&lt;T&gt; T getBean(String name, Class&lt;T&gt; requiredType)</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TliasWebManagementApplicationTests</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptService deptService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext; <span class="comment">//IOCå®¹å™¨å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetBean</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//æ ¹æ®beançš„åç§°è·å–</span></span><br><span class="line">        <span class="type">DeptController</span> <span class="variable">bean1</span> <span class="operator">=</span> (DeptController) applicationContext.getBean(<span class="string">&quot;deptController&quot;</span>);</span><br><span class="line">		System.out.println(bean1);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ ¹æ®beançš„ç±»å‹è·å–</span></span><br><span class="line">		<span class="type">DeptController</span> <span class="variable">bean2</span> <span class="operator">=</span> applicationContext.getBean(DeptController.class);</span><br><span class="line">		System.out.println(bean2);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//æ ¹æ®beançš„åç§°åŠç±»å‹è·å–</span></span><br><span class="line">		<span class="type">DeptController</span> <span class="variable">bean3</span> <span class="operator">=</span> applicationContext.getBean(<span class="string">&quot;deptController&quot;</span>, DeptController.class);</span><br><span class="line">		System.out.println(bean3);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼šä¸Šè¿°æ‰€è¯´çš„[Springé¡¹ç›®å¯åŠ¨æ—¶ï¼Œä¼šæŠŠå…¶ä¸­çš„beanéƒ½åˆ›å»ºå¥½]è¿˜ä¼šæ”¶åˆ°ä½œç”¨åŸŸåŠå»¶è¿Ÿåˆå§‹åŒ–å½±å“ï¼Œè¿™é‡Œä¸»è¦é’ˆå¯¹é»˜è®¤çš„å•ä¾‹éå»¶è¿ŸåŠ è½½çš„beanè€Œè¨€ã€‚</p>
</li>
</ul>
<h2 id="beanä½œç”¨åŸŸ"><a href="#beanä½œç”¨åŸŸ" class="headerlink" title="beanä½œç”¨åŸŸ"></a>beanä½œç”¨åŸŸ</h2><ul>
<li><p>Springæ”¯æŒäº”ç§ä½œç”¨åŸŸï¼Œåä¸‰ç§åœ¨webç¯å¢ƒæ‰ä¼šç”Ÿæ•ˆ</p>
<table>
<thead>
<tr>
<th>ä½œç”¨åŸŸ</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><font color="red">singleton</font></td>
<td><font color="red">å®¹å™¨å†…å£°æ˜çš„beanåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆå•ä¾‹ï¼‰ï¼ˆé»˜è®¤ï¼‰</font></td>
</tr>
<tr>
<td><font color="red">prototype</font></td>
<td><font color="red">æ¯æ¬¡ä½¿ç”¨è¯¥beanæ—¶éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆéå•ä¾‹ï¼‰</font></td>
</tr>
<tr>
<td>request</td>
<td>æ¯ä¸ªè¯·æ±‚èŒƒå›´å†…éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td>
</tr>
<tr>
<td>session</td>
<td>æ¯ä¸ªä¼šè¯èŒƒå›´å†…éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td>
</tr>
<tr>
<td>application</td>
<td>æ¯ä¸ªåº”ç”¨èŒƒå›´å†…éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ï¼ˆwebç¯å¢ƒä¸­ï¼Œäº†è§£ï¼‰</td>
</tr>
</tbody></table>
</li>
<li><p>å¯ä»¥é€šè¿‡@Scopeæ³¨è§£æ¥è¿›è¡Œé…ç½®ä½œç”¨åŸŸï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/depts&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>é»˜è®¤singletonçš„beanï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶è¢«åˆ›å»ºï¼Œå¯ä»¥é€šè¿‡@Lazyæ³¨è§£æ¥å»¶è¿Ÿåˆå§‹åŒ–ï¼ˆå»¶è¿Ÿåˆ°ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ï¼‰ã€‚</li>
<li>prototypeçš„beanï¼Œæ¯ä¸€æ¬¡ä½¿ç”¨è¯¥beançš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</li>
<li>å®é™…å¼€å‘å½“ä¸­ï¼Œç»å¤§éƒ¨åˆ†çš„Beanéƒ½æ˜¯å•ä¾‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç»å¤§éƒ¨åˆ†Beanä¸éœ€è¦é…ç½®scopeå±æ€§ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ç¬¬ä¸‰æ–¹bean"><a href="#ç¬¬ä¸‰æ–¹bean" class="headerlink" title="ç¬¬ä¸‰æ–¹bean"></a>ç¬¬ä¸‰æ–¹bean</h2><p>åŸç”ŸBean</p>
<ul>
<li>@Controller</li>
<li>@Service</li>
<li>@Repositoryï¼ˆ@Mapperï¼‰</li>
<li>@Component</li>
</ul>
<p>ç°åœ¨æœ‰ä»¥ä¸‹æƒ…å†µï¼Œéœ€è¦åˆå§‹åŒ–æŸäº›ç¬¬ä¸‰æ–¹jaråŒ…ä¸­çš„æŸäº›ç±»å¯¹è±¡ï¼Œè€Œè¿™äº›ç¬¬ä¸‰æ–¹jaråŒ…çš„åŸç é»˜è®¤æ˜¯read-onlyçš„ï¼Œä¸èƒ½åœ¨å…¶ç±»ä¸ŠåŠ æ³¨è§£@Componentã€‚</p>
<ul>
<li><p>å¦‚æœè¦ç®¡ç†çš„beanå¯¹è±¡æ¥è‡ªäºç¬¬ä¸‰æ–¹ï¼ˆä¸æ˜¯è‡ªå®šä¹‰çš„ï¼‰ï¼Œæ˜¯æ— æ³•ç”¨@ComponentåŠè¡ç”Ÿæ³¨è§£å£°æ˜beançš„ï¼Œå°±éœ€è¦ç”¨åˆ°@Beanæ³¨è§£ã€‚</p>
</li>
<li><p>è‹¥è¦ç®¡ç†çš„ç¬¬ä¸‰æ–¹beanå¯¹è±¡ï¼Œå»ºè®®å¯¹è¿™äº›beanè¿›è¡Œé›†ä¸­åˆ†ç±»é…ç½®ï¼Œå¯ä»¥é€šè¿‡@Configurationæ³¨è§£å£°æ˜ä¸€ä¸ªé…ç½®ç±»ã€‚</p>
</li>
<li><p>å°†å½“å‰æ–¹æ³•çš„è¿”å›å€¼å¯¹è±¡äº¤ç»™IOCå®¹å™¨ç®¡ç†ï¼Œç§°ä¸ºIOCå®¹å™¨çš„beanï¼Œé€šè¿‡@Beanæ³¨è§£çš„&#x2F;name&#x2F;valueå±æ€§æŒ‡å®šbeanåç§°ï¼Œå¦‚æœä¸ºæŒ‡å®šï¼Œé»˜è®¤æ–¹æ³•åå³ä¸ºè¯¥ç¬¬ä¸‰æ–¹beanå¯¹è±¡ã€‚ï¼ˆå®Œæˆäº†æ§åˆ¶åè½¬ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215223531608.png" alt="image-20240215223531608"></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215224343513.png" alt="image-20240215224343513"></p>
</li>
<li><p>å®Œæˆäº†ä¾èµ–æ³¨å…¥</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215225225131.png" alt="image-20240215225225131"></p>
</li>
<li><p>å¦‚æœç¬¬ä¸‰æ–¹beanéœ€è¦ä¾èµ–å…¶ä»–beanå¯¹è±¡ï¼Œç›´æ¥å†beanå®šä¹‰æ–¹æ³•ä¸­è®¾ç½®å½¢å‚å³å¯ï¼Œå®¹å™¨ä¼šæ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215225407697.png" alt="image-20240215225407697"></p>
</li>
</ul>
<h1 id="SpringBootåŸç†"><a href="#SpringBootåŸç†" class="headerlink" title="SpringBootåŸç†"></a>SpringBootåŸç†</h1><p>Springå…¨å®¶æ¡¶éƒ½åŸºäºSpring Frameworkï¼Œè¿™ä¸ªæ¡†æ¶æ¯”è¾ƒç¹çï¼ˆé…ç½®pom.xmlå¤æ‚ï¼‰ï¼ŒåŸºäºæ­¤ï¼Œåœ¨Spring Framework4.0ä¹‹åï¼Œæ¨å‡ºäº†Spring Bootæ¡†æ¶ï¼ˆç®€åŒ–Spring Frameworkçš„å¼€å‘ï¼‰ã€‚</p>
<p>Spring Bootæä¾›äº†èµ·æ­¥ä¾èµ–å’Œè‡ªåŠ¨é…ç½®ã€‚</p>
<ul>
<li>èµ·æ­¥ä¾èµ–ï¼šå¤§å¤§ç®€åŒ–pom.xmlä¸­ä¾èµ–é…ç½®ï¼Œè§£å†³spring frameworkä¸­ä¾èµ–é…ç½®ç¹ççš„é—®é¢˜ã€‚</li>
<li>è‡ªåŠ¨é…ç½®ï¼šç®€åŒ–spring frameworkä½¿ç”¨æ—¶beançš„å£°æ˜å’Œé…ç½®ã€‚</li>
</ul>
<h2 id="èµ·æ­¥ä¾èµ–"><a href="#èµ·æ­¥ä¾èµ–" class="headerlink" title="èµ·æ­¥ä¾èµ–"></a>èµ·æ­¥ä¾èµ–</h2><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215230254400.png" alt="image-20240215230254400"></p>
<p>springæ¡†åŠ è¿›è¡Œwebç¨‹åºå¼€å‘è¦å¼•å…¥ä¸Šè¿°æ¯ä¸ªä¾èµ–ï¼Œè€Œspringbootåªéœ€è¦å¼•å…¥ä¸€ä¸ªä¾èµ–ï¼Œ<font color="red">æ”¶ç›Šäºmavençš„ä¾èµ–ä¼ é€’ï¼ˆå¦‚æœaä¾èµ–äº†bï¼Œbä¾èµ–äº†cï¼Œé‚£ä¹ˆåœ¨å¼•å…¥aä¹‹åï¼Œbå’Œcè¿™ä¸¤ä¸ªä¾èµ–ä¹Ÿéƒ½ä¼šå¼•å…¥ï¼‰</font>ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215230457232.png" alt="image-20240215230457232"></p>
<h2 id="è‡ªåŠ¨é…ç½®"><a href="#è‡ªåŠ¨é…ç½®" class="headerlink" title="è‡ªåŠ¨é…ç½®"></a>è‡ªåŠ¨é…ç½®</h2><ul>
<li><p>SpringBootçš„è‡ªåŠ¨é…ç½®å°±æ˜¯å½“springå®¹å™¨å¯åŠ¨åï¼Œä¸€äº›é…ç½®ç±»ã€beanå¯¹è±¡å°±ä¼šè‡ªåŠ¨å­˜å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å£°æ˜ï¼Œä»è€Œç®€åŒ–äº†å¼€å‘ï¼Œçœå»äº†ç¹ççš„é…ç½®æ“ä½œã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215231251757.png" alt="image-20240215231251757"></p>
</li>
</ul>
<h3 id="è‡ªåŠ¨é…ç½®åŸç†"><a href="#è‡ªåŠ¨é…ç½®åŸç†" class="headerlink" title="è‡ªåŠ¨é…ç½®åŸç†"></a>è‡ªåŠ¨é…ç½®åŸç†</h3><p>springbootå½“ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥å¯¹åº”çš„ä¾èµ–ï¼Œæ˜¯å¦‚ä½•å°†ä¾èµ–ä¸­jaråŒ…å½“ä¸­æ‰€æä¾›çš„è¿™äº›beanä»¥åŠé…ç½®ç±»ç›´æ¥åŠ è½½åˆ°å½“å‰é¡¹ç›®çš„spring iocå®¹å™¨å½“ä¸­ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215231450566.png" alt="image-20240215231450566"></p>
<ul>
<li><p>æ–¹æ¡ˆä¸€ï¼š@ComponentScanç»„ä»¶æ‰«æ</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215232814762.png" alt="image-20240215232814762"></p>
</li>
<li><p>æ–¹æ¡ˆäºŒï¼š@Importå¯¼å…¥ã€‚ä½¿ç”¨@Importå¯¼å…¥çš„ç±»ä¼šè¢«SpringåŠ è½½åˆ°IOCå®¹å™¨ä¸­ï¼Œå¯¼å…¥å½¢å¼ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li><p>å¯¼å…¥æ™®é€šç±»</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215233345565.png" alt="image-20240215233345565"></p>
</li>
<li><p>å¯¼å…¥é…ç½®ç±»ï¼ˆ@Configurationï¼Œè¿™ä¸ªç±»ä¸­æ‰€æœ‰çš„åŠ äº†@Beanæ–¹æ³•è¿”å›çš„å¯¹è±¡éƒ½ä¼šåŠ è½½åˆ°IOCå®¹å™¨ä¸­ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215233510157.png" alt="image-20240215233510157"></p>
</li>
<li><p>å¯¼å…¥ImportSelectoræ¥å£å®ç°ç±»(<font color="red">selectImportsæ–¹æ³•ï¼Œæå…¶é‡è¦ï¼Œå†³å®šå“ªäº›ç±»å¯ä»¥ä½œä¸ºBeanå¯¹è±¡å¯¼å…¥åˆ°IOCå®¹å™¨ä¸­</font>)</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215234724430.png" alt="image-20240215234724430"></p>
</li>
<li><p>@EnableXxxxæ³¨è§£ï¼Œå°è£…@Importæ³¨è§£ï¼Œè®©ç¬¬ä¸‰æ–¹åº“ä½œè€…æ¥è®¾ç½®è¦å®ç°å“ªäº›beanå¯¹è±¡ï¼ˆæ¨èï¼Œæ–¹ä¾¿ï¼Œä¼˜é›…ï¼‰</p>
<p>ä¸ºå¯åŠ¨ç¨‹åºåŠ ä¸Š@EnableXxxxæ³¨è§£ï¼Œå†åˆ›å»ºEnablexxxæ¥å£ï¼Œåœ¨è¯¥æ¥å£åŠ ä¸Šæ³¨è§£@Import(Xxxx.class)ï¼ŒæŒ‡å®šçš„è¿™ä¸ªXxxx.classå®ç°ImportSelectoræ¥å£çš„selectImportsæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›äº†å…·ä½“å“ªäº›ç±»ä¼šæ³¨å…¥åˆ°iocå®¹å™¨ä¸­ã€‚è¿™æ ·ç¬¬ä¸‰æ–¹ä½œè€…å¯ä»¥å¿«é€Ÿæ–¹ä¾¿çš„è‡ªåŠ¨å†³å®šå“ªäº›ç±»è¦åŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215235112424.png" alt="image-20240215235112424"></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240215235235351.png" alt="image-20240215235235351"></p>
</li>
</ul>
</li>
</ul>
<h3 id="æºç è·Ÿè¸ª"><a href="#æºç è·Ÿè¸ª" class="headerlink" title="æºç è·Ÿè¸ª"></a>æºç è·Ÿè¸ª</h3><p>é‡ç‚¹&#x2F;å…³é”®ï¼š@SpringBootApplication(SpringBootä¸­æœ€ä¸ºé‡è¦çš„æ³¨è§£)</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216002845192.png" alt="image-20240216002845192"></p>
<p>æŠ€å·§ï¼šæŠ“å…³é”®ç‚¹ï¼Œæ‰¾å…³é”®æµç¨‹</p>
<ol>
<li><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216003918693.png" alt="image-20240216003918693"></p>
</li>
<li><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216004027562.png" alt="image-20240216004027562"></p>
</li>
<li><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216004154608.png" alt="image-20240216004154608"></p>
</li>
<li><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216004548571.png" alt="image-20240216004548571"></p>
</li>
<li><p>æ‰¾åˆ°äº†å¯¹åº”çš„selectImportsæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›è¦å°è£…åˆ°IOCå®¹å™¨çš„beanå¯¹è±¡çš„å…¨ç±»åçš„æ•°ç»„ã€‚ç°åœ¨è¦æŸ¥æ˜æ•°ç»„çš„å…·ä½“å†…å®¹æ˜¯ä»€ä¹ˆï¼Œå…ˆè¿›å…¥getAutoConfigurationEntryæ‰¾åˆ°å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚<img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216004713347.png" alt="image-20240216004713347"></p>
</li>
<li><p>Entryé‡Œé¢è¿”å›äº†å“ªäº›ä¿¡æ¯ï¼Œåœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œç›´æ¥returnäº†ä¸€ä¸ªentryå¯¹è±¡ï¼Œnew  entryå¯¹è±¡æ—¶é‡Œé¢ä¼ é€’äº†ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯configurationsï¼Œexclusionsï¼Œé€šè¿‡å›¾5å¯ä»¥çŸ¥é“æœ€ç»ˆè°ƒç”¨çš„æ˜¯configurationsã€‚æˆ‘ä»¬è¦å»çœ‹ä¸€ä¸‹è¿™ä¸ªconfigurationså¦‚ä½•è·å–çš„ï¼Œæ˜¯é€šè¿‡è°ƒç”¨getCandidateConfigurationsæ–¹æ³•ã€‚<img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216005719506.png" alt="image-20240216005719506"></p>
</li>
<li><p>getCandidateConfigurationsçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œé€šè¿‡è°ƒç”¨loadFactoryNamesè·å¾—configurationsï¼Œå®ƒçš„å…·ä½“å®ç°ç»†èŠ‚æš‚æ—¶å¯è·³è¿‡ï¼Œé‡ç‚¹æ³¨æ„ä¸‹é¢çš„æ–­è¨€ï¼Œå¦‚æœconfigurationsæ˜¯ç©ºçš„ï¼Œå°±ä¼šæç¤ºä¿¡æ¯ï¼Œä¿¡æ¯æè¿°æ˜¯è¯´å½“æ²¡æœ‰è‡ªåŠ¨é…ç½®çš„ç±»è¢«å‘ç°æ—¶å°±ä¼šæŠ¥é”™ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œé¦–å…ˆï¼Œç¬¬ä¸€ä¸ªæ–‡ä»¶æ˜¯META-INFä¸‹çš„spring.factoryæ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ˜¯META-INF&#x2F;spring&#x2F;org.springframework.boot.autoconfigure.AutoConfiguration.importsï¼Œé‚£ä¹Ÿå°±æ˜¯è¯´ï¼Œspringbootåœ¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åŠ è½½è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­é…ç½®çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶å°è£…åˆ°listé›†åˆï¼Œæœ€ç»ˆå°†listé›†åˆçš„å†…å®¹å°è£…åˆ°stringç±»å‹çš„æ•°ç»„ä¸­ï¼Œè¿™äº›æ•°æ®æœ€ç»ˆåŠ è½½åˆ°IOCå®¹å™¨çš„Beanæˆ–è€…é…ç½®ç±»ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216010055187.png" alt="image-20240216010055187"></p>
</li>
<li><p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216010605951.png" alt="image-20240216010605951"></p>
</li>
<li><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸‹çš„å†…å®¹éƒ½æ˜¯å„ä¸ªç±»çš„å…¨ç±»å<img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216010704636.png" alt="image-20240216010704636"></p>
</li>
</ol>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216010819685.png" alt="image-20240216010819685"></p>
<p>@SpringBootApplication</p>
<ul>
<li>è¯¥æ³¨è§£è¡¨ç¤ºåœ¨SpringBootå·¥ç¨‹å¼•å¯¼ç±»ä¸Šï¼Œæ˜¯springbootæœ€æœ€æœ€é‡è¦çš„æ³¨è§£ï¼Œè¯¥æ³¨è§£ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆã€‚<ul>
<li>@SpringBootConfigurationï¼šè¯¥æ³¨è§£ä¸@Configurationæ³¨è§£ä½œç”¨ç›¸åŒï¼Œç”¨æ¥å£°æ˜å½“å‰ä¹Ÿæ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚</li>
<li>@ComponentScanï¼šç»„ä»¶æ‰«æï¼Œé»˜è®¤æ‰«æå½“å‰å¼•å¯¼ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ã€‚</li>
<li>@EnableAutoConfigurationï¼šSpringBootå®ç°è‡ªåŠ¨åŒ–é…ç½®çš„æ ¸å¿ƒæ³¨è§£ã€‚</li>
</ul>
</li>
</ul>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„@Beanéƒ½ä¼šæ³¨å†Œä¸ºbeanå¯¹è±¡ï¼Œ@ConditionalOnMissingBeanå°±æ˜¯ç”¨æ¥å†³å®šå“ªäº›åŠ äº†@Beançš„æ–¹æ³•è¿”å›çš„å¯¹è±¡å¯ä»¥æˆä¸ºbeanå¯¹è±¡ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216011245608.png" alt="image-20240216011245608"></p>
<p>@Conditional</p>
<ul>
<li>ä½œç”¨ï¼šæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œåœ¨æ»¡è¶³ç»™å®šæ¡ä»¶åæ‰ä¼šæ³¨å†Œå¯¹åº”çš„beanå¯¹è±¡åˆ°Spring IOCå®¹å™¨ä¸­ã€‚</li>
<li>ä½ç½®ï¼šæ–¹æ³•ã€ç±»ã€‚</li>
<li>@Conditionalæœ¬èº«æ˜¯ä¸€ä¸ªçˆ¶æ³¨è§£ï¼Œ æ´¾ç”Ÿå‡ºå¤§é‡çš„å­æ³¨è§£ï¼›<ul>
<li>@ConditionalOnClassï¼šåˆ¤æ–­ç¯å¢ƒä¸­æ˜¯å¦æœ‰å¯¹åº”çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li>
<li>@ConditionalOnMissingBeanï¼šåˆ¤æ–­ç¯å¢ƒä¸­æ²¡æœ‰å¯¹åº”çš„beanï¼ˆç±»å‹æˆ–åç§°ï¼‰ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li>
<li>@ConditionalOnPropertyï¼šåˆ¤æ–­é…ç½®æ–‡ä»¶ä¸­æœ‰å¯¹åº”å±æ€§å’Œå€¼ï¼Œæ‰æ³¨å†Œbeanåˆ°IOCå®¹å™¨ã€‚</li>
</ul>
</li>
</ul>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216011800342.png" alt="image-20240216011800342"></p>
<ol>
<li>ä¸åŠ @ConditionalOnClassæ³¨è§£çš„ç»“æœ</li>
</ol>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216135152532.png" alt="image-20240216135152532"></p>
<ol start="2">
<li><p>åŠ äº†@ConditionalOnMissingBeanæ³¨è§£ï¼ˆå¦‚æœç”¨æˆ·æ²¡æœ‰å®šä¹‰å¯¹åº”çš„ç¬¬ä¸‰æ–¹ç±»åæˆ–æ–¹æ³•ï¼Œæ‰ä¼šå°†å…¶æ³¨å…¥åˆ°Beanå¯¹è±¡ä¸­ï¼‰</p>
</li>
<li><p>åŠ äº†@ConditionalOnClassæ³¨è§£ï¼ˆ<font color="red">å½“pom.xmlæ–‡ä»¶ä¸­å¼•å…¥å½“å‰nameæŒ‡å®šçš„å…¨ç±»å¯¹åº”çš„ä¾èµ–æ—¶ï¼Œæ‰ä¼šå°†å¯¹è±¡åŠ å…¥åˆ°beanå¯¹è±¡ä¸­</font>ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216135356633.png" alt="image-20240216135356633"></p>
</li>
<li><p>åŠ äº†@ConditionalOnPropertyæ³¨è§£ï¼ˆåˆ¤æ–­é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¯¹åº”çš„å±æ€§å’Œå±æ€§å€¼ï¼Œå¦‚æœå­˜åœ¨ï¼Œæ‰ä¼šå°†è¿™ä¸ªbeanæ³¨å†Œåˆ°iocå®¹å™¨ä¸­ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216142834334.png" alt="image-20240216142834334"></p>
</li>
</ol>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216142936518.png" alt="image-20240216142936518"></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216143403666.png" alt="image-20240216143403666"></p>
<h3 id="æ¡ˆä¾‹ï¼ˆè‡ªå®šä¹‰starterï¼‰"><a href="#æ¡ˆä¾‹ï¼ˆè‡ªå®šä¹‰starterï¼‰" class="headerlink" title="æ¡ˆä¾‹ï¼ˆè‡ªå®šä¹‰starterï¼‰"></a>æ¡ˆä¾‹ï¼ˆè‡ªå®šä¹‰starterï¼‰</h3><p><strong>åœºæ™¯</strong></p>
<ul>
<li>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šå®šä¹‰ä¸€äº›å…¬å…±ç»„ä»¶ï¼Œæä¾›ç»™å„ä¸ªé¡¹ç›®å›¢é˜Ÿä½¿ç”¨ã€‚è€Œåœ¨SpringBootçš„é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬ä¼šå°†è¿™äº›å…¬å…±ç»„ä»¶å°è£…ä¸ºSpringBootçš„starterã€‚</li>
</ul>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216144308670.png" alt="image-20240216144308670"></p>
<p><strong>éœ€æ±‚</strong></p>
<ul>
<li>éœ€æ±‚ï¼šè‡ªå®šä¹‰aliyun-oss-spring-boot-starterï¼Œå®Œæˆé˜¿é‡Œäº‘OSSæ“ä½œå·¥å…·ç±»AliyunOSSUtilsçš„è‡ªåŠ¨é…ç½®ã€‚</li>
<li>ç›®æ ‡ï¼šå¼•å…¥èµ·æ­¥ä¾èµ–ä¹‹åï¼Œè¦æƒ³ä½¿ç”¨é˜¿é‡Œäº‘OSSï¼Œæ³¨å…¥AliyunOSSUtilsç›´æ¥ä½¿ç”¨å³å¯ã€‚</li>
</ul>
<p>åŸå§‹çš„ä½¿ç”¨é˜¿é‡Œäº‘OSSçš„æ­¥éª¤</p>
<ol>
<li>éœ€è¦åœ¨pom.xmlæ–‡ä»¶ä¸­å¼•å…¥é˜¿é‡Œäº‘OSSçš„ä¸€å †ä¾èµ–</li>
<li>å‚ç…§å®˜æ–¹æä¾›çš„SDKæ”¹é€ å·¥å…·ç±»ï¼Œå°†å®˜æ–¹çš„SDK demoç¤ºä¾‹æ”¹é€ æˆå·¥å…·ç±»ï¼Œç„¶ååœ¨ymlä¸­é…ç½®aliyunOSSéœ€è¦çš„é…ç½®å‚æ•°ï¼Œç„¶ååœ¨é€šè¿‡AliyunOSSçš„å®ä½“ç±»æ¥åŠ è½½ymlé…ç½®æ–‡ä»¶å½“ä¸­çš„é…ç½®é¡¹ï¼Œæœ€åæ‰å¯ä»¥åœ¨AliyunOSSUtilsä¸­è·å–è¿™äº›å‚æ•°ï¼Œæœ€åå†å°†è¿™ä¸ªç±»äº¤ç»™SpringIOCå®¹å™¨ç®¡ç†ï¼Œç§°ä¸ºIOCå®¹å™¨å½“ä¸­çš„Beanå¯¹è±¡ã€‚</li>
</ol>
<p>æ­¥éª¤</p>
<ol>
<li>åˆ›å»ºaliyun-oss-spring-boot-starteræ¨¡å—</li>
<li>åˆ›å»ºaliyun-oss-spring-boot-autoconfigureæ¨¡å—ï¼Œåœ¨starterä¸­å¼•å…¥è¯¥æ¨¡å—</li>
<li>åœ¨aliyun-oss-spring-boot-autoconfigureæ¨¡å—ä¸­å®šä¹‰è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œ å¹¶å®šä¹‰è‡ªåŠ¨é…ç½®æ–‡ä»¶ META-INF&#x2F;spring&#x2F;xxxx.imports</li>
</ol>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216145204597.png" alt="image-20240216145204597"></p>
<p><strong>åˆ›å»ºaliyun-oss-spring-boot-starteræ¨¡å—</strong></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216145946840.png" alt="image-20240216145946840"></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216150000745.png" alt="image-20240216150000745"></p>
<p>ä¿®æ”¹pom.xmlæ–‡ä»¶ï¼Œå¯ä»¥åˆ é™¤ä¸‹è¿°ä¸‰ä¸ªçº¢æ¡†ä½ç½®çš„å†…å®¹ã€‚<img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216150040587.png" alt="image-20240216150040587"></p>
<p>åˆ é™¤æ‰€æœ‰æ–‡ä»¶è‡³ç•™ä¸‹ä»¥ä¸‹ä¸¤é¡¹ï¼ˆå¦‚æœåˆ›å»ºçš„mavené¡¹ç›®æ²¡æœ‰imiæ–‡ä»¶ï¼Œè§£å†³åŠæ³•ï¼š<a href="https://blog.csdn.net/helloearth121/article/details/118168244">IDEAä½¿ç”¨Mavenç”Ÿæˆæ™®é€šé¡¹ç›®æ²¡æœ‰ç”Ÿæˆimlæ–‡ä»¶è§£å†³æ–¹æ³•_åˆ›å»ºjavaä¸è‡ªåŠ¨åˆ›å»ºiml-CSDNåšå®¢</a>ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216150441995.png" alt="image-20240216150441995"></p>
<p><strong>åˆ›å»ºaliyun-oss-spring-boot-autoconfigureæ¨¡å—</strong></p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216150711921.png" alt="image-20240216150711921"></p>
<p>ç²¾ç®€è‡³å¦‚ä¸‹ç»“æœ</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216151112174.png" alt="image-20240216151112174"></p>
<ol>
<li><p>å°†autoconfigureä¾èµ–å¯¼å…¥starterçš„pom.xml</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216151300776.png" alt="image-20240216151300776"></p>
</li>
<li><p>åœ¨autoconfigureæ¨¡å—ä¸­é…ç½®å¥½AliyunOSSUtilsï¼ˆåœ¨autoconfigureæ¨¡å—çš„pom.xmlä¸­å¼•å…¥é˜¿é‡Œäº‘OSSä¾èµ–ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216151802968.png" alt="image-20240216151802968"></p>
</li>
<li><p>å°†å¯¹åº”AliOSSPropertiesç±»å’ŒAliOSSUtilsç±»å¤åˆ¶åˆ°autoconfigureæ¨¡å—çš„com.aliyun.ossåŒ…ä¸‹ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216152055856.png" alt="image-20240216152055856"></p>
</li>
<li><p>è¡¥å…¨è¿™ä¸¤ä¸ªç±»éœ€è¦çš„ä¾èµ–å’Œä»£ç ï¼ˆgetterå’Œsetteræ–¹æ³•ï¼‰</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216152347046.png" alt="image-20240216152347046"></p>
</li>
<li><p>ç”±äºè¿™ä¸¤ä¸ªæ–¹æ³•ä¸­åŠ äº†@Componentï¼Œä½†æ˜¯å®ƒä»¬éƒ½ä¸æ˜¯é¡¹ç›®å¯åŠ¨æ—¶åŠ å…¥çš„Beanå¯¹è±¡ï¼Œå› æ­¤è¦å°†æ³¨è§£åˆ é™¤ã€‚ä¸ºäº†å®ç°ä¾èµ–æ³¨å…¥ï¼Œè¦ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ç¬¬ä¸‰æ–¹é¡¹ç›®åˆ›å»ºé…ç½®ç±»ï¼Œå£°æ˜AliyunOSSUtilsè¿™ä¸ªBean.å› æ­¤è¿™ä¸€æ­¥çš„æ“ä½œæ˜¯å£°æ˜é…ç½®ç±»ã€‚</p>
<p>å…ˆåˆ›å»ºAliOSSAutoConfigurationç±»ï¼ŒåŠ @Configurationä½¿å…¶æˆä¸ºé…ç½®ç±»ï¼ŒåŠ @Beanæ–¹æ³•ï¼Œè¿”å›å€¼AliOSSUtilsç±»ï¼Œæ–¹æ³•åä¸ºaliOSSUtilsï¼Œä½¿å¾—è¿”å›çš„ä¸æ–¹æ³•ååŒåçš„AliOSSUtilsç±»å‹çš„å¯¹è±¡æ³¨å†Œä¸ºBeanå¯¹è±¡ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216152851187.png" alt="image-20240216152851187"></p>
</li>
<li><p>é€šè¿‡@EnableConfigurationPropertieså°†AliOSSPropertieså¯¼å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œä½¿å…¶ç§°ä¸ºBeanå¯¹è±¡ï¼ŒåŒæ—¶å°†å…¶ä½œä¸ºaliOSSUtilsçš„å‚æ•°è¾“å…¥ï¼ˆé»˜è®¤å°†IOCå®¹å™¨çš„Beanå¯¹è±¡ä¼ å…¥ï¼‰ï¼Œç»™AliOSSUtilsç±»æ·»åŠ AliOSSPropertiesçš„å¯¹è±¡å±æ€§ï¼Œé‡æ„å¯¹åº”çš„AliOSSUtilsçš„æ„é€ å‡½æ•°ï¼Œç¡®ä¿å…¶å±æ€§èƒ½æ¥æ”¶åˆ°å‚æ•°ä¼ å…¥çš„Beanå¯¹è±¡ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216154218655.png" alt="image-20240216154218655"></p>
</li>
<li><p>é…ç½®å¯¹åº”çš„é…ç½®æ–‡ä»¶META-INF&#x2F;spring&#x2F;xxxx.importsï¼ˆåœ¨resourceç›®å½•ä¸‹åˆ›å»ºMETA-INF.springç›®å½•ï¼Œåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºorg.springframework.boot.autoconfigure.AutoConfiguration.importsæ–‡ä»¶ï¼Œå¹¶å°†é…ç½®ç±»çš„å…¨ç±»åcom.aliyun.oss.AliOSSAutoConfigurationå†™å…¥å…¶ä¸­ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216155040246.png" alt="image-20240216155040246"></p>
</li>
<li><p>è‡³æ­¤ï¼Œå®Œæˆï¼</p>
</li>
</ol>
<p><strong>å°ç»“</strong></p>
<p>æˆ‘ä»¬ä¸»è¦å®šä¹‰äº†starterå’Œautoconfigureä¸¤ä¸ªæ¨¡å—ï¼Œstarteræ¨¡å—ä¸»è¦è¿›è¡Œä¾èµ–ç®¡ç†ï¼Œautoconfigureæ¨¡å—å®ç°è‡ªåŠ¨é…ç½®ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»ï¼Œå°†éœ€è¦è‡ªåŠ¨é…ç½®çš„Beanéƒ½å®šä¹‰åœ¨è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»å½“ä¸­ï¼Œæ¥ç€åœ¨org.springframework.boot.autoconfigure.AutoConfiguration.importsä¸‹å¯¼å…¥å¯åŠ¨ç±»ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216160946664.png" alt="image-20240216160946664"></p>
<h1 id="Webåç«¯å¼€å‘æ€»ç»“"><a href="#Webåç«¯å¼€å‘æ€»ç»“" class="headerlink" title="Webåç«¯å¼€å‘æ€»ç»“"></a>Webåç«¯å¼€å‘æ€»ç»“</h1><p>Webåç«¯å¼€å‘åŸºäºä¸‰å±‚æ¶æ„å¼€å‘</p>
<ul>
<li>Controlleræ§åˆ¶å™¨å±‚ï¼Œè´Ÿè´£æ¥å—è¯·æ±‚ï¼Œå“åº”æ•°æ®</li>
<li>Serviceä¸šåŠ¡å±‚ï¼Œè´Ÿè´£ä¸šåŠ¡é€»è¾‘å¤„ç†</li>
<li>Daoæ•°æ®è®¿é—®å±‚&#x2F;æŒä¹…å±‚ï¼Œè´Ÿè´£å¤„ç†æ•°æ®è®¿é—®æ“ä½œï¼Œå®Œæˆæ•°æ®åº“å¢åˆ æ”¹æŸ¥</li>
</ul>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216161332789.png" alt="image-20240216161332789"></p>
<p>å¦‚æœæˆ‘ä»¬åœ¨æ‰§è¡Œå…·ä½“ä¸šåŠ¡ä¹‹å‰è¦è¿›è¡Œé€šç”¨çš„ä¸šåŠ¡å¤„ç†ï¼Œæ¯”å¦‚è¦è¿›è¡Œç™»å½•æ ¡éªŒï¼Œè¦è¿›è¡Œç»Ÿä¸€çš„å­—ç¬¦ç¼–ç ã€‚æ­¤æ—¶å¯ä»¥å€ŸåŠ©äºJavaWebä¸‰å¤§ç»„ä»¶ä¹‹ä¸€çš„è¿‡æ»¤å™¨Filteræˆ–Springå½“ä¸­æä¾›çš„æ‹¦æˆªå™¨Interceptorå®ç°ã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216161633213.png" alt="image-20240216161633213"></p>
<p>ä¸ºäº†å®ç°ä¸‰å±‚æ¶æ„å±‚ä¸å±‚ä¹‹é—´çš„è§£è€¦ï¼Œæˆ‘ä»¬å­¦ä¹ äº†springæ¡†æ¶çš„ç¬¬ä¸€å¤§æ ¸å¿ƒIOCæ§åˆ¶åè½¬å’ŒDIä¾èµ–æ³¨å…¥ã€‚</p>
<p>IOCæ§åˆ¶åè½¬ï¼šå°†å¯¹è±¡åˆ›å»ºçš„æ§åˆ¶æƒç”±åº”ç”¨ç¨‹åºè‡ªèº«äº¤ç»™å¤–éƒ¨å®¹å™¨ï¼Œå¹¶å°†å¯¹è±¡å£°æ˜ä¸ºIOCå®¹å™¨çš„Beanå¯¹è±¡ã€‚</p>
<p>DIä¾èµ–æ³¨å…¥ï¼šå®¹å™¨ä¸ºç¨‹åºæä¾›è¿è¡Œæ—¶éœ€è¦çš„èµ„æºã€‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216161940142.png" alt="image-20240216161940142"></p>
<ul>
<li><p>AOPé¢å‘åˆ‡é¢ç¼–ç¨‹</p>
</li>
<li><p>äº‹åŠ¡ç®¡ç†</p>
</li>
<li><p>å…¨å±€å¼‚å¸¸å¤„ç†</p>
</li>
<li><p>ä¼ ç»Ÿä¼šè¯æŠ€æœ¯ï¼šCookieã€Session</p>
</li>
<li><p>æ–°çš„ä¼šè¯è·Ÿè¸ªè§£å†³æ–¹æ¡ˆï¼šJWT</p>
</li>
<li><p>é˜¿é‡Œäº‘OSSå¯¹è±¡å­˜å‚¨æœåŠ¡</p>
</li>
<li><p>MyBatisæŒä¹…å±‚æ¡†æ¶æ“ä½œæ•°æ®åº“</p>
</li>
</ul>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216162200217.png" alt="image-20240216162200217"></p>
<p>å„ä¸ªæŠ€æœ¯åˆ†å±ç»†èŠ‚</p>
<p><img src="/2024/02/15/javaweb-day08-springboot%E5%8E%9F%E7%90%86%E7%AF%87/image-20240216162502383.png" alt="image-20240216162502383"></p>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day07-äº‹åŠ¡ç®¡ç† &amp; AOP</title>
    <url>/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/</url>
    <content><![CDATA[<h1 id="äº‹åŠ¡ç®¡ç†"><a href="#äº‹åŠ¡ç®¡ç†" class="headerlink" title="äº‹åŠ¡ç®¡ç†"></a>äº‹åŠ¡ç®¡ç†</h1><h2 id="äº‹åŠ¡å›é¡¾"><a href="#äº‹åŠ¡å›é¡¾" class="headerlink" title="äº‹åŠ¡å›é¡¾"></a>äº‹åŠ¡å›é¡¾</h2><ul>
<li><p>æ¦‚å¿µ</p>
<p>äº‹åŠ¡æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</p>
</li>
<li><p>æ“ä½œ</p>
<ul>
<li>å¼€å¯äº‹åŠ¡ï¼ˆä¸€ç»„æ“ä½œå¼€å§‹å‰ï¼Œå¼€å¯äº‹åŠ¡ï¼‰ï¼šstart transaction &#x2F; beginï¼›</li>
<li>æäº¤äº‹åŠ¡ï¼ˆè¿™ç»„æ“ä½œå…¨éƒ¨æˆåŠŸåï¼Œæäº¤äº‹åŠ¡ï¼‰ï¼šcommitï¼›</li>
<li>å›æ»šäº‹åŠ¡ï¼ˆä¸­é—´ä»»ä½•ä¸€ä¸ªæ“ä½œå‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡ï¼‰ï¼šrollbackï¼›</li>
</ul>
</li>
</ul>
<h2 id="Springäº‹åŠ¡ç®¡ç†"><a href="#Springäº‹åŠ¡ç®¡ç†" class="headerlink" title="Springäº‹åŠ¡ç®¡ç†"></a>Springäº‹åŠ¡ç®¡ç†</h2><p>æ¡ˆä¾‹éœ€æ±‚ï¼šè§£æ•£éƒ¨é—¨ï¼Œåˆ é™¤éƒ¨é—¨ï¼ŒåŒæ—¶åˆ é™¤è¯¥éƒ¨é—¨ä¸‹çš„å‘˜å·¥ã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214122907385.png" alt="image-20240214122907385"></p>
<p>é—®é¢˜ï¼ˆæ•°æ®åº“æ“ä½œä¸­é—´æŠ¥é”™ï¼Œå¯¼è‡´åç»­æ•°æ®åº“æ“ä½œæœªæ­£å¸¸æ‰§è¡Œï¼‰</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214122932665.png" alt="image-20240214122932665"></p>
<p>è§£å†³åŠæ³•Springäº‹åŠ¡ç®¡ç†</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214123058600.png" alt="image-20240214123058600"></p>
<ul>
<li><p>æ³¨è§£ï¼š@Transactional</p>
</li>
<li><p>ä½ç½®ï¼šä¸šåŠ¡ï¼ˆserviceï¼‰å±‚çš„æ–¹æ³•ä¸Šã€ç±»ä¸Šã€æ¥å£ä¸Š</p>
<p>ï¼ˆä½œç”¨åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºå½“å‰æ–¹æ³•äº¤ç”±springäº‹åŠ¡ç®¡ç†ï¼›ä½œç”¨åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºå½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•äº¤ç”±springäº‹åŠ¡ç®¡ç†ï¼›ä½œç”¨åœ¨æ¥å£ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªæ¥å£ä¸‹æ‰€æœ‰å®ç°ç±»çš„æ‰€æœ‰å®ç°æ–¹æ³•éƒ½äº¤ç”±springäº‹åŠ¡ç®¡ç†ï¼‰</p>
</li>
<li><p>ä½œç”¨ï¼šå°†å½“å‰æ–¹æ³•äº¤ç»™springè¿›è¡Œäº‹åŠ¡ç®¡ç†ï¼Œæ–¹æ³•æ‰§è¡Œå‰ï¼Œå¼€å¯äº‹åŠ¡ï¼›æˆåŠŸæ‰§è¡Œå®Œæ¯•ï¼Œæäº¤äº‹åŠ¡ï¼›å‡ºç°å¼‚å¸¸ï¼Œå›æ»šäº‹åŠ¡</p>
</li>
<li><p>å¸¸è§ç”¨æ³•ï¼šåœ¨æ‰§è¡Œå¤šæ¬¡æ•°æ®è®¿é—®æ“ä½œçš„ä¸šåŠ¡æ–¹æ³•ä¸ŠåŠ ä¸ŠTransactionalæ³¨è§£ã€‚</p>
</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214124025970.png" alt="image-20240214124025970"></p>
<p><strong>å¼€å¯äº‹åŠ¡æ—¥å¿—</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¼€å¯äº‹åŠ¡ç®¡ç†æ—¥å¿—</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">org.springframework.jdbc.support.JdbcTransactionManager :</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>

<h2 id="äº‹åŠ¡è¿›é˜¶"><a href="#äº‹åŠ¡è¿›é˜¶" class="headerlink" title="äº‹åŠ¡è¿›é˜¶"></a>äº‹åŠ¡è¿›é˜¶</h2><h3 id="rollbackFor"><a href="#rollbackFor" class="headerlink" title="rollbackFor"></a>rollbackFor</h3><ul>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å‡ºç°RuntimeExceptionæ‰å›æ»šå¼‚å¸¸ã€‚rollbackForå±æ€§ç”¨äºæ§åˆ¶å‡ºç°ä½•ç§å¼‚å¸¸ç±»å‹ï¼Œå›æ»šäº‹åŠ¡ã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214125021300.png" alt="image-20240214125021300"></p>
<p>å¢åŠ ä»£ç </p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214124800658.png" alt="image-20240214124800658"></p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214125224998.png" alt="image-20240214125224998"></p>
</li>
</ul>
<h3 id="propagation"><a href="#propagation" class="headerlink" title="propagation"></a>propagation</h3><ul>
<li><p>äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼šæŒ‡çš„æ˜¯å½“ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªäº‹åŠ¡æ–¹æ³•åº”è¯¥å¦‚ä½•è¿›è¡Œäº‹åŠ¡æ§åˆ¶ã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214125400853.png" alt="image-20240214125400853"></p>
<table>
<thead>
<tr>
<th>å±æ€§å€¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><font color="red">REQUIRED</font></td>
<td><font color="red">ã€é»˜è®¤å€¼ã€‘éœ€è¦äº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ— åˆ™åˆ›å»ºæ–°äº‹åŠ¡</font></td>
</tr>
<tr>
<td><font color="red">REQUIRES_NEW</font></td>
<td><font color="red">éœ€è¦æ–°äº‹åŠ¡ï¼Œæ— è®ºæœ‰æ— ï¼Œæ€»æ˜¯åˆ›å»ºæ–°äº‹åŠ¡</font></td>
</tr>
<tr>
<td>SUPPORTS</td>
<td>æ”¯æŒäº‹åŠ¡ï¼Œæœ‰åˆ™åŠ å…¥ï¼Œæ— åˆ™åœ¨æ— äº‹åŠ¡çŠ¶æ€ä¸­è¿è¡Œ</td>
</tr>
<tr>
<td>NOT_SUPPORTED</td>
<td>ä¸æ”¯æŒäº‹åŠ¡ï¼Œåœ¨æ— äº‹åŠ¡çŠ¶æ€ä¸‹è¿è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨å·²æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å½“å‰äº‹åŠ¡</td>
</tr>
<tr>
<td>MANDATORY</td>
<td>å¿…é¡»æœ‰äº‹åŠ¡ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</td>
</tr>
<tr>
<td>NEVER</td>
<td>å¿…é¡»æ²¡äº‹åŠ¡ï¼Œå¦åˆ™æŠ›å¼‚å¸¸</td>
</tr>
<tr>
<td>â€¦</td>
<td>â€¦</td>
</tr>
</tbody></table>
</li>
</ul>
<p>æ¡ˆä¾‹ï¼šè§£æ•£éƒ¨é—¨æ—¶ï¼Œè®°å½•æ“ä½œæ—¥å¿—</p>
<p>éœ€æ±‚ï¼šè§£æ•£éƒ¨é—¨æ—¶ï¼Œæ— è®ºæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦è®°å½•æ“ä½œæ—¥å¿—ã€‚</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>è§£æ•£éƒ¨é—¨ï¼šåˆ é™¤éƒ¨é—¨ã€åˆ é™¤éƒ¨é—¨ä¸‹çš„å‘˜å·¥</li>
<li>è®°å½•æ—¥å¿—åˆ°æ•°æ®åº“è¡¨ä¸­</li>
</ol>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214132730521.png" alt="image-20240214132730521"></p>
<ul>
<li>REQUIREDï¼šå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ç”¨è¯¥ä¼ æ’­è¡Œä¸ºå³å¯ã€‚</li>
<li>REQUIRES_NEWï¼šå½“æˆ‘ä»¬ä¸å¸Œæœ›äº‹åŠ¡ä¹‹é—´ç›¸äº’å½±å“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥ä¼ æ’­è¡Œä¸ºã€‚ä¾‹å¦‚ï¼šä¸‹è®¢å•å‰éœ€è¦è®°å½•æ—¥å¿—ï¼Œä¸è®ºè®¢å•ä¿å­˜æˆåŠŸä¸å¦ï¼Œéƒ½éœ€è¦ä¿è¯æ—¥å¿—è®°å½•èƒ½å¤Ÿè®°å½•æˆåŠŸã€‚</li>
</ul>
<h1 id="AOPåŸºç¡€"><a href="#AOPåŸºç¡€" class="headerlink" title="AOPåŸºç¡€"></a>AOPåŸºç¡€</h1><h2 id="AOPæ¦‚è¿°"><a href="#AOPæ¦‚è¿°" class="headerlink" title="AOPæ¦‚è¿°"></a>AOPæ¦‚è¿°</h2><ul>
<li><p>AOPï¼šAspect Oriented Programmingï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ã€é¢å‘æ–¹é¢ç¼–ç¨‹ï¼‰ï¼Œå…¶å®å°±æ˜¯é¢å‘ç‰¹å®šæ–¹æ³•ç¼–ç¨‹ã€‚</p>
</li>
<li><p>åœºæ™¯</p>
<ul>
<li><p>æ¡ˆä¾‹éƒ¨åˆ†åŠŸèƒ½è¿è¡Œè¾ƒæ…¢ï¼Œå®šä½æ‰§è¡Œè€—æ—¶è¾ƒé•¿çš„ä¸šåŠ¡æ–¹æ³•ï¼Œæ­¤æ—¶éœ€è¦ç»Ÿè®¡æ¯ä¸ªä¸šåŠ¡æ–¹æ³•çš„æ‰§è¡Œè€—æ—¶</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214135211983.png" alt="image-20240214135211983"></p>
</li>
<li><p>å®ç°ï¼š</p>
<ul>
<li>åŠ¨æ€ä»£ç†æ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹æœ€ä¸»æµçš„å®ç°ã€‚è€ŒSpringAOPæ˜¯Springæ¡†æ¶çš„é«˜çº§æŠ€æœ¯ï¼Œæ—¨åœ¨ç®¡ç†beanå¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦é€šè¿‡åº•å±‚çš„åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œå¯¹ç‰¹å®šçš„æ–¹æ³•è¿›è¡Œç¼–ç¨‹ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="AOPå¿«é€Ÿå…¥é—¨"><a href="#AOPå¿«é€Ÿå…¥é—¨" class="headerlink" title="AOPå¿«é€Ÿå…¥é—¨"></a>AOPå¿«é€Ÿå…¥é—¨</h2><p>æ¡ˆä¾‹ï¼šSpring AOPå¿«é€Ÿå…¥é—¨ï¼šç»Ÿè®¡å„ä¸ªä¸šåŠ¡å±‚æ–¹æ³•æ‰§è¡Œè€—æ—¶</p>
<ul>
<li><p>å¯¼å…¥ä¾èµ–ï¼šåœ¨pom.xmlä¸­å¯¼å…¥AOPçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- pom.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™AOPç¨‹åºï¼šé’ˆå¯¹äºç‰¹å®šæ–¹æ³•æ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œç¼–ç¨‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span> <span class="comment">//å½“å‰ç±»æ˜¯AOPç±»</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimeAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.example.service.*.*(..))&quot;)</span>  <span class="comment">//è¿è¡ŒserviceåŒ…ä¸‹æ‰€æœ‰ç±»æˆ–æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œåˆ‡å…¥ç‚¹è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordTime</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//1. è®°å½•å¼€å§‹æ—¶é—´</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. è°ƒç”¨åŸå§‹æ–¹æ³•è¿è¡Œ</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> joinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è®°å½•ç»“æŸæ—¶é—´ï¼Œè®¡ç®—æ–¹æ³•æ‰§è¡Œè€—æ—¶</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        log.info(joinPoint.getSignature() + <span class="string">&quot;æ–¹æ³•æ‰§è¡Œè€—æ—¶ï¼š&#123;&#125;ms&quot;</span>,end-begin);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214144033685.png" alt="image-20240214144033685"></p>
<h2 id="AOPæ ¸å¿ƒæ¦‚å¿µ"><a href="#AOPæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="AOPæ ¸å¿ƒæ¦‚å¿µ"></a>AOPæ ¸å¿ƒæ¦‚å¿µ</h2><ul>
<li><p>è¿æ¥ç‚¹ï¼šJoinPointï¼Œå¯ä»¥è¢«AOPæ§åˆ¶çš„æ–¹æ³•ï¼ˆæš—å«æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼‰</p>
</li>
<li><p>é€šçŸ¥ï¼šAdviceï¼ŒæŒ‡é‚£äº›é‡å¤çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯å…±æ€§åŠŸèƒ½ï¼ˆæœ€ç»ˆä½“ç°ä¸ºä¸€ä¸ªæ–¹æ³•ï¼‰</p>
</li>
<li><p>åˆ‡å…¥ç‚¹ï¼šPointCutï¼ŒåŒ¹é…è¿æ¥ç‚¹çš„æ¡ä»¶ï¼Œé€šçŸ¥ä»…ä¼šåœ¨åˆ‡å…¥ç‚¹æ–¹æ³•æ‰§è¡Œæ—¶è¢«åº”ç”¨</p>
</li>
<li><p>åˆ‡é¢ï¼šAspectï¼Œæè¿°é€šçŸ¥ä¸åˆ‡å…¥ç‚¹çš„å¯¹åº”å…³ç³»ï¼ˆé€šçŸ¥+åˆ‡å…¥ç‚¹ï¼‰</p>
</li>
<li><p>ç›®æ ‡å¯¹è±¡ï¼šTargetï¼Œé€šçŸ¥æ‰€åº”ç”¨çš„å¯¹è±¡</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214144744583.png" alt="image-20240214144744583"></p>
</li>
<li><p>AOPæ‰§è¡Œæµç¨‹</p>
<p>ç¨‹åºè¿è¡Œæ—¶ï¼Œä¼šè‡ªåŠ¨ä¸ºç›®æ ‡å¯¹è±¡ç”Ÿæˆå¯¹åº”çš„ä»£ç†å¯¹è±¡ï¼Œåœ¨ä»£ç†å¯¹è±¡ä¸­ï¼Œå°±ä¼šå¯¹ç›®æ ‡å¯¹è±¡ä¸­çš„åŸå§‹æ–¹æ³•è¿›è¡ŒåŠŸèƒ½å¢å¼ºã€‚å¢å¼ºé€»è¾‘å–å†³äºAspectå®šä¹‰çš„å¢å¼ºåŠŸèƒ½ã€‚AOPæœ¬è´¨è¿˜æ˜¯åŸºäºåŠ¨æ€ä»£ç†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214145040852.png" alt="image-20240214145040852"></p>
</li>
</ul>
<h1 id="AOPè¿›é˜¶"><a href="#AOPè¿›é˜¶" class="headerlink" title="AOPè¿›é˜¶"></a>AOPè¿›é˜¶</h1><h2 id="é€šçŸ¥ç±»å‹"><a href="#é€šçŸ¥ç±»å‹" class="headerlink" title="é€šçŸ¥ç±»å‹"></a>é€šçŸ¥ç±»å‹</h2><ol>
<li>@Aroundï¼šç¯ç»•é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰ã€åéƒ½è¢«æ‰§è¡Œ</li>
<li>@Beforeï¼šå‰ç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•å‰è¢«æ‰§è¡Œ</li>
<li>@Afterï¼šåç½®é€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</li>
<li>@AfterReturningï¼šè¿”å›åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•åœ¨ç›®æ ‡æ–¹æ³•åè¢«æ‰§è¡Œï¼Œæœ‰å¼‚å¸¸ä¸ä¼šæ‰§è¡Œ</li>
<li>@AfterThrowingï¼šå¼‚å¸¸åé€šçŸ¥ï¼Œæ­¤æ³¨è§£æ ‡æ³¨çš„é€šçŸ¥æ–¹æ³•å‘ç”Ÿå¼‚å¸¸åæ‰§è¡Œ</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect1</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.example.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;before ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.example.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        log.info(<span class="string">&quot;around before ...&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> proceedingJoinPoint.proceed();</span><br><span class="line">        log.info(<span class="string">&quot;around after ...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.example.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;after ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(* com.example.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;afterReturning ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(* com.example.service.impl.DeptServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowing</span><span class="params">()</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;afterThrowing ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œé¡ºåºå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214151512139.png" alt="image-20240214151512139"></p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>@Aroundç¯ç»•é€šçŸ¥éœ€è¦è‡ªå·±è°ƒç”¨proceedingJoinPoint.proceed()æ¥è®©åŸå§‹æ–¹æ³•æ‰§è¡Œï¼Œå…¶ä»–é€šçŸ¥ä¸éœ€è¦è€ƒè™‘ç›®æ ‡æ–¹æ³•æ‰§è¡Œ</li>
<li>@Aroundç¯ç»•é€šçŸ¥æ–¹æ³•çš„è¿”å›å€¼ï¼Œå¿…é¡»æŒ‡å®šä¸ºObjectï¼Œæ¥æ¥æ”¶åŸå§‹æ–¹æ³•çš„è¿”å›å€¼ã€‚</li>
</ul>
<p>@PointCut</p>
<ul>
<li><p>è¯¥æ³¨è§£çš„ä½œç”¨æ—¶å°†å…¬å…±çš„åˆ‡ç‚¹è¡¨è¾¾å¼æŠ½å–å‡ºæ¥ï¼Œéœ€è¦ç”¨åˆ°æ—¶å¼•ç”¨è¯¥åˆ‡ç‚¹è¡¨è¾¾å¼å³å¯ã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214152457184.png" alt="image-20240214152457184"></p>
</li>
</ul>
<p><strong>å°ç»“</strong></p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214152524439.png" alt="image-20240214152524439"></p>
<h2 id="é€šçŸ¥é¡ºåº"><a href="#é€šçŸ¥é¡ºåº" class="headerlink" title="é€šçŸ¥é¡ºåº"></a>é€šçŸ¥é¡ºåº</h2><p>å½“æœ‰å¤šä¸ªåˆ‡é¢çš„åˆ‡å…¥ç‚¹éƒ½åŒ¹é…åˆ°äº†ç›®æ ‡æ–¹æ³•ï¼Œç›®æ ‡æ–¹æ³•è¿è¡Œæ—¶ï¼Œå¤šä¸ªé€šçŸ¥æ–¹æ³•éƒ½ä¼šè¢«æ‰§è¡Œã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214152933743.png" alt="image-20240214152933743"></p>
<p>æ‰§è¡Œé¡ºåº</p>
<ol>
<li><p>ä¸åŒåˆ‡é¢ç±»ä¸­ï¼Œé»˜è®¤æŒ‰ç…§åˆ‡é¢ç±»çš„ç±»åå­—æ¯æ’åº</p>
<ul>
<li>ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„å…ˆæ‰§è¡Œ</li>
<li>ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šå­—æ¯æ’åé å‰çš„åæ‰§è¡Œ</li>
</ul>
</li>
<li><p>ç”¨@Order(æ•°å­—)åŠ è½½åˆ‡é¢ç±»ä¸Šæ¥æ§åˆ¶é¡ºåº</p>
<ul>
<li>ç›®æ ‡æ–¹æ³•å‰çš„é€šçŸ¥æ–¹æ³•ï¼šæ•°å­—å°çš„å…ˆæ‰§è¡Œ</li>
<li>ç›®æ ‡æ–¹æ³•åçš„é€šçŸ¥æ–¹æ³•ï¼šæ•°å­—å°çš„åæ‰§è¡Œ</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214153232022.png" alt="image-20240214153232022"></p>
</li>
</ol>
<h2 id="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"><a href="#åˆ‡å…¥ç‚¹è¡¨è¾¾å¼" class="headerlink" title="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼"></a>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼</h2><ul>
<li>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼šæè¿°åˆ‡å…¥ç‚¹æ–¹æ³•çš„ä¸€ç§è¡¨è¾¾å¼</li>
<li>ä½œç”¨ï¼šä¸»è¦ç”¨æ¥å†³å®šé¡¹ç›®ä¸­çš„å“ªäº›æ–¹æ³•éœ€è¦åŠ å…¥é€šçŸ¥</li>
<li>å¸¸è§å½¢å¼ï¼š<ul>
<li>execution(â€¦)ï¼šæ ¹æ®æ–¹æ³•çš„ç­¾åæ¥åŒ¹é…</li>
<li>@annotation(â€¦)ï¼šæ ¹æ®æ³¨è§£åŒ¹é…</li>
</ul>
</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214153640323.png" alt="image-20240214153640323"></p>
<h3 id="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-execution"><a href="#åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-execution" class="headerlink" title="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ - execution"></a>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ - execution</h3><p>executionä¸»è¦æ ¹æ®æ–¹æ³•çš„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€æ–¹æ³•å‚æ•°ç­‰ä¿¡æ¯æ¥åŒ¹é…ï¼Œè¯­æ³•ä¸ºï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">execution(è®¿é—®ä¿®é¥°ç¬¦? è¿”å›å€¼ åŒ…å.ç±»å.?æ–¹æ³•å(æ–¹æ³•å‚æ•°) <span class="keyword">throws</span> å¼‚å¸¸?)</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214153831045.png" alt="image-20240214153831045"></p>
<ul>
<li><p>å…¶ä¸­å¸¦ï¼Ÿçš„è¡¨ç¤ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†</p>
<ul>
<li>è®¿é—®ä¿®é¥°ç¬¦ï¼šå¯çœç•¥ï¼ˆæ¯”å¦‚ï¼špublicã€protectedï¼‰</li>
<li>åŒ…å.ç±»åï¼šå¯çœç•¥</li>
<li>throws å¼‚å¸¸ï¼šå¯çœç•¥ï¼ˆæ³¨æ„æ˜¯æ–¹æ³•ä¸Šå£°æ˜æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä¸æ˜¯å®é™…æŠ›å‡ºçš„å¼‚å¸¸ï¼‰</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214153959965.png" alt="image-20240214153959965"></p>
</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214155556329.png" alt="image-20240214155556329"></p>
<ul>
<li><p>å¯ä»¥ä½¿ç”¨é€šé…ç¬¦æè¿°åˆ‡å…¥åº—</p>
<ul>
<li><p>*ï¼šå•ä¸ªç‹¬ç«‹çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„è¿”å›å€¼ã€åŒ…åã€ç±»åã€æ–¹æ³•åã€ä»»æ„ç±»å‹çš„ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šé…åŒ…ã€ç±»ã€æ–¹æ³•åçš„ä¸€éƒ¨åˆ†</p>
<p>å¦‚ä¸‹æ‰€ç¤ºï¼šåŒ¹é…ä»»æ„è¿”å›ç±»å‹ï¼Œä»»æ„äºŒçº§åŒ…åï¼Œä»»æ„ç±»&#x2F;æ¥å£ï¼Œupdateåç»­ä»»æ„éƒ¨åˆ†çš„ä»»æ„å•ä¸ªå‚æ•°</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214155710577.png" alt="image-20240214155710577"></p>
</li>
<li><p>.. : å¤šä¸ªè¿ç»­çš„ä»»æ„ç¬¦å·ï¼Œå¯ä»¥é€šé…ä»»æ„å±‚çº§çš„åŒ…ï¼Œæˆ–ä»»æ„ç±»å‹ã€ä»»æ„ä¸ªæ•°çš„å‚æ•°</p>
<p>å¦‚ä¸‹æ‰€ç¤ºï¼šåŒ¹é…ä»»æ„è¿”å›ç±»å‹ï¼Œä»»æ„å±‚çº§çš„åŒ…ï¼Œä»»æ„æ–¹æ³•åï¼Œä»»æ„æ•°é‡çš„å‚æ•°</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214155744813.png" alt="image-20240214155744813"></p>
</li>
</ul>
</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214160336308.png" alt="image-20240214160336308"></p>
<p>åŒ¹é…ï¼šcomåŒ…ä¸‹ä»»æ„ä¸€çº§å­åŒ…çš„serviceåŒ…çš„implåŒ…çš„ä»¥ServiceImplç»“å°¾çš„ç±»çš„ä»¥deleteå¼€å¤´ä¸”å«æœ‰ä¸€ä¸ªå‚æ•°çš„æ–¹æ³•ã€‚</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214161042187.png" alt="image-20240214161042187"></p>
<p><font color="red">åŒ¹é…å¤šä¸ªä¸åŒåä¸åŒå‚æ•°çš„æ–¹æ³•ã€‚</font></p>
<p>ä¹¦å†™è§„èŒƒ</p>
<ul>
<li>æ‰€æœ‰ä¸šåŠ¡æ–¹æ³•ååœ¨å‘½åæ—¶åº”è¯¥å°½é‡è§„èŒƒè›®æ–¹ä¾¿åˆ‡å…¥ç‚¹è¡¨è¾¾å¼å¿«é€ŸåŒ¹é…ã€‚å¦‚ï¼šæŸ¥è¯¢ç±»æ–¹æ³•éƒ½æ˜¯findå¼€å¤´ï¼Œæ›´æ–°ç±»æ–¹æ³•éƒ½ä»¥updateå¼€å¤´ã€‚</li>
<li>æè¿°åˆ‡å…¥ç‚¹æ–¹æ³•æ—¶é€šå¸¸åŸºäºæ¥å£æè¿°ï¼Œè€Œä¸æ˜¯ç›´æ¥æè¿°å®ç°ç±»ï¼Œå¢å¼ºæ‹“å±•æ€§ã€‚</li>
<li>åœ¨æ»¡è¶³ä¸šåŠ¡éœ€è¦çš„å‰æä¸‹ï¼Œå°½é‡ç¼©å°åˆ‡å…¥ç‚¹çš„åŒ¹é…èŒƒå›´ã€‚å¦‚ï¼šåŒ…ååŒ¹é…å°½é‡ä¸è¦ä½¿ç”¨..,ä½¿ç”¨*åŒ¹é…å•ä¸ªåŒ…ã€‚</li>
</ul>
<h3 id="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-anotation"><a href="#åˆ‡å…¥ç‚¹è¡¨è¾¾å¼-anotation" class="headerlink" title="åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ - @anotation"></a>åˆ‡å…¥ç‚¹è¡¨è¾¾å¼ - @anotation</h3><ul>
<li><p>@annotationåˆ‡å…¥ç‚¹è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…æ ‡è¯†æœ‰ç‰¹å®šæ³¨è§£çš„æ–¹æ³•</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214164136474.png" alt="image-20240214164136474"></p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214164149820.png" alt="image-20240214164149820"></p>
</li>
</ul>
<h2 id="è¿æ¥ç‚¹"><a href="#è¿æ¥ç‚¹" class="headerlink" title="è¿æ¥ç‚¹"></a>è¿æ¥ç‚¹</h2><ul>
<li><p>åœ¨Springä¸­ç”¨JoinPointæŠ½è±¡äº†è¿æ¥ç‚¹ï¼Œç”¨å®ƒå¯ä»¥è·å¾—æ–¹æ³•æ‰§è¡Œæ—¶çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç›®æ ‡ç±»åï¼Œæ–¹æ³•åï¼Œæ–¹æ³•å‚æ•°ç­‰ã€‚</p>
<ul>
<li>å¯¹äº@Around é€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨ProceedingJoinPoint</li>
<li>å¯¹äºå…¶ä»–å››ç§é€šçŸ¥ï¼Œè·å–è¿æ¥ç‚¹ä¿¡æ¯åªèƒ½ä½¿ç”¨JointPointï¼Œå®ƒæ˜¯ProceedingJoinPointçš„çˆ¶ç±»å‹</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214170831453.png" alt="image-20240214170831453"></p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214170900363.png" alt="image-20240214170900363"></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">//@Order(3)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyAspect7</span> &#123; </span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.example.service.DeptService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pt</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;MyAspect8 ... before ...&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;pt()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        log.info(<span class="string">&quot;MyAspect8 around before ...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. è·å–ç›®æ ‡å¯¹è±¡çš„ç±»å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> proceedingJoinPoint.getTarget().getClass().getName();</span><br><span class="line">        log.info(<span class="string">&quot;ç›®æ ‡å¯¹è±¡çš„ç±»åï¼š&#123;&#125;&quot;</span>,className);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. è·å–ç›®æ ‡æ–¹æ³•çš„æ–¹æ³•å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> proceedingJoinPoint.getSignature().getName();</span><br><span class="line">        log.info(<span class="string">&quot;ç›®æ ‡æ–¹æ³•çš„æ–¹æ³•å:&#123;&#125;&quot;</span>,methodName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è·å–ç›®æ ‡æ–¹æ³•è¿è¡Œæ—¶ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">        Object[] args = proceedingJoinPoint.getArgs();</span><br><span class="line">        log.info(<span class="string">&quot;ç›®æ ‡æ–¹æ³•è¿è¡Œæ—¶ä¼ å…¥çš„å‚æ•°ï¼š&#123;&#125;&quot;</span>, Arrays.toString(args));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. è·å–ç›®æ ‡æ–¹æ³•æ‰§è¡Œ</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> proceedingJoinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è·å–ç›®æ ‡æ–¹æ³•è¿è¡Œçš„è¿”å›å€¼</span></span><br><span class="line">        log.info(<span class="string">&quot;ç›®æ ‡æ–¹æ³•è¿è¡Œçš„è¿”å›å€¼ï¼š&#123;&#125;&quot;</span>,result);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="AOPæ¡ˆä¾‹"><a href="#AOPæ¡ˆä¾‹" class="headerlink" title="AOPæ¡ˆä¾‹"></a>AOPæ¡ˆä¾‹</h1><p>æ¡ˆä¾‹ï¼šå°†æ¡ˆä¾‹ä¸­å¢åˆ æ”¹æŸ¥ç›¸å…³æ¥å£çš„æ“ä½œæ—¥å¿—è®°å½•åˆ°æ•°æ®åº“è¡¨ä¸­</p>
<p>æ“ä½œæ—¥å¿—</p>
<p>æ—¥å¿—ä¿¡æ¯åŒ…å«ï¼šæ“ä½œäººã€æ“ä½œæ—¶é—´ã€æ‰§è¡Œæ–¹æ³•çš„å…¨ç±»åã€æ‰§è¡Œæ–¹æ³•åã€æ–¹æ³•è¿è¡Œæ—¶å‚æ•°ã€è¿”å›å€¼ã€æ–¹æ³•æ‰§è¡Œæ—¶é•¿</p>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214172708047.png" alt="image-20240214172708047"></p>
<p>æ€è·¯åˆ†æ</p>
<ul>
<li>éœ€è¦å¯¹æ‰€æœ‰ä¸šåŠ¡ç±»ä¸­çš„å¢åˆ æ”¹æŸ¥æ–¹æ³•æ·»åŠ ç»Ÿä¸€åŠŸèƒ½ï¼Œä½¿ç”¨AOPæŠ€æœ¯æœ€ä¸ºæ–¹ä¾¿ã€‚</li>
</ul>
<p><img src="/2024/02/14/javaweb-day07-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-AOP/image-20240214173033257.png" alt="image-20240214173033257"></p>
<p>æ­¥éª¤</p>
<ul>
<li><p>å‡†å¤‡ï¼š</p>
<ul>
<li><p>åœ¨æ¡ˆä¾‹å·¥ç¨‹ä¸­å¼•å…¥AOPçš„èµ·æ­¥ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- pom.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¯¼å…¥èµ„æ–™ä¸­å‡†å¤‡å¥½çš„æ•°æ®åº“è¡¨ç»“æ„ï¼Œå¹¶å¼•å…¥å¯¹åº”çš„å®ä½“ç±»</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> operate_log</span><br><span class="line">(</span><br><span class="line">    id            <span class="type">int</span> unsigned auto_increment comment <span class="string">&#x27;ID&#x27;</span></span><br><span class="line">        <span class="keyword">primary</span> key,</span><br><span class="line">    operate_user  <span class="type">int</span> unsigned  <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œäººID&#x27;</span>,</span><br><span class="line">    operate_time  datetime      <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œæ—¶é—´&#x27;</span>,</span><br><span class="line">    class_name    <span class="type">varchar</span>(<span class="number">100</span>)  <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œçš„ç±»å&#x27;</span>,</span><br><span class="line">    method_name   <span class="type">varchar</span>(<span class="number">100</span>)  <span class="keyword">null</span> comment <span class="string">&#x27;æ“ä½œçš„æ–¹æ³•å&#x27;</span>,</span><br><span class="line">    method_params <span class="type">varchar</span>(<span class="number">1000</span>) <span class="keyword">null</span> comment <span class="string">&#x27;æ–¹æ³•å‚æ•°&#x27;</span>,</span><br><span class="line">    return_value  <span class="type">varchar</span>(<span class="number">2000</span>) <span class="keyword">null</span> comment <span class="string">&#x27;è¿”å›å€¼&#x27;</span>,</span><br><span class="line">    cost_time     <span class="type">bigint</span>        <span class="keyword">null</span> comment <span class="string">&#x27;æ–¹æ³•æ‰§è¡Œè€—æ—¶, å•ä½:ms&#x27;</span></span><br><span class="line">)</span><br><span class="line">    comment <span class="string">&#x27;æ“ä½œæ—¥å¿—è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OperateLog</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id; <span class="comment">//ID</span></span><br><span class="line">    <span class="keyword">private</span> Integer operateUser; <span class="comment">//æ“ä½œäººID</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime operateTime; <span class="comment">//æ“ä½œæ—¶é—´</span></span><br><span class="line">    <span class="keyword">private</span> String className; <span class="comment">//æ“ä½œç±»å</span></span><br><span class="line">    <span class="keyword">private</span> String methodName; <span class="comment">//æ“ä½œæ–¹æ³•å</span></span><br><span class="line">    <span class="keyword">private</span> String methodParams; <span class="comment">//æ“ä½œæ–¹æ³•å‚æ•°</span></span><br><span class="line">    <span class="keyword">private</span> String returnValue; <span class="comment">//æ“ä½œæ–¹æ³•è¿”å›å€¼</span></span><br><span class="line">    <span class="keyword">private</span> Long costTime; <span class="comment">//æ“ä½œè€—æ—¶</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ç¼–ç ï¼š</p>
<ul>
<li><p>è‡ªå®šä¹‰æ³¨è§£@Log</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.anno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Log &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®šä¹‰åˆ‡é¢ç±»ï¼Œå®Œæˆè®°å½•æ“ä½œæ—¥å¿—çš„é€»è¾‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.example.mapper.OperateLogMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.OperateLog;</span><br><span class="line"><span class="keyword">import</span> com.example.utils.JwtUtils;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspect</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OperateLogMapper operateLogMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HttpServletRequest httpServletRequest;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;@annotation(com.example.anno.Log)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">recordLog</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œäººå‘˜ID - å½“å‰ç™»å½•å‘˜å·¥ID</span></span><br><span class="line">        <span class="comment">//è·å–è¯·æ±‚å¤´ä¸­çš„JWTä»¤ç‰Œï¼Œè§£æä»¤ç‰Œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> httpServletRequest.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> JwtUtils.parseJWT(jwt);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">operatorUser</span> <span class="operator">=</span> (Integer) claims.get(<span class="string">&quot;id&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œæ—¶é—´</span></span><br><span class="line">        <span class="type">LocalDateTime</span> <span class="variable">operateTime</span> <span class="operator">=</span> LocalDateTime.now();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œç±»å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> proceedingJoinPoint.getTarget().getClass().getName();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œæ–¹æ³•å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> proceedingJoinPoint.getSignature().getName();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œæ–¹æ³•å‚æ•°</span></span><br><span class="line">        Object[] args = proceedingJoinPoint.getArgs();</span><br><span class="line">        <span class="type">String</span> <span class="variable">methodParams</span> <span class="operator">=</span> Arrays.toString(args);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œè€—æ—¶</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">begin</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨åŸå§‹ç›®æ ‡æ–¹æ³•è¿è¡Œ</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> proceedingJoinPoint.proceed();</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ“ä½œæ–¹æ³•è¿”å›å€¼</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">returnValue</span> <span class="operator">=</span> JSONObject.toJSONString(result);</span><br><span class="line"></span><br><span class="line">        <span class="type">Long</span> <span class="variable">costTime</span> <span class="operator">=</span> end - begin;</span><br><span class="line"></span><br><span class="line">        <span class="type">OperateLog</span> <span class="variable">operateLog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OperateLog</span>(<span class="literal">null</span>, operatorUser, operateTime, className, methodName, methodParams, returnValue, costTime);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®°å½•æ“ä½œæ—¥å¿—</span></span><br><span class="line">        operateLogMapper.insert(operateLog);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;AOPè®°å½•æ“ä½œæ—¥å¿—ï¼š&#123;&#125;&quot;</span>, operateLog);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®šä¹‰operateLogMapperæ¥å£ï¼Œåˆ›å»ºå¯¹åº”çš„æ’å…¥æ“ä½œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.DeptLog;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptLogMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Insert(&quot;insert into dept_log(create_time,description) values(#&#123;createTime&#125;,#&#123;description&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(DeptLog deptLog)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>è·å–å½“å‰ç™»å½•ç”¨æˆ·</p>
<ul>
<li>è·å–requestå¯¹è±¡ï¼Œä»è¯·æ±‚å¤´ä¸­è·å–åˆ°jwtä»¤ç‰Œï¼Œè§£æä»¤ç‰Œè·å–å‡ºå½“å‰ç”¨æˆ·çš„idã€‚</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javeweb-day06-ç™»å½•è®¤è¯</title>
    <url>/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/</url>
    <content><![CDATA[<h1 id="åŸºç¡€ç™»å½•åŠŸèƒ½"><a href="#åŸºç¡€ç™»å½•åŠŸèƒ½" class="headerlink" title="åŸºç¡€ç™»å½•åŠŸèƒ½"></a>åŸºç¡€ç™»å½•åŠŸèƒ½</h1><p>åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213121002402.png" alt="image-20240213121002402"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213121908243.png" alt="image-20240213121908243"></p>
<h1 id="ç™»å½•æ ¡éªŒï¼ˆé‡ç‚¹ï¼‰"><a href="#ç™»å½•æ ¡éªŒï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="ç™»å½•æ ¡éªŒï¼ˆé‡ç‚¹ï¼‰"></a>ç™»å½•æ ¡éªŒï¼ˆé‡ç‚¹ï¼‰</h1><p><strong>è”è°ƒæµ‹è¯•</strong></p>
<p><strong>é—®é¢˜</strong></p>
<ul>
<li>åœ¨æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®éƒ¨é—¨ç®¡ç†ã€å‘˜å·¥ç®¡ç†ç­‰åŠŸèƒ½ã€‚</li>
</ul>
<p><strong>ç†æƒ³å®ç°æ“ä½œ</strong></p>
<ul>
<li>åœ¨æœåŠ¡å™¨æ¥æ”¶åˆ°æµè§ˆå™¨å‘é€è¿‡æ¥çš„è¯·æ±‚ä¹‹åï¼Œè¦å…ˆæ ¡éªŒç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œå¦‚æœç”¨æˆ·å·²ç»ç™»å½•äº†ï¼Œç›´æ¥æ‰§è¡Œä¸šåŠ¡æ“ä½œå³å¯ã€‚</li>
<li>å¦‚æœç”¨æˆ·å¹¶æ²¡æœ‰ç™»å½•ï¼Œæ­¤æ—¶ä¸å…è®¸æ‰§è¡Œç›¸å…³æ“ä½œï¼Œç›´æ¥ç»™å‰ç«¯å“åº”ä¸€ä¸ªé”™è¯¯çš„ç»“æœï¼Œæœ€ç»ˆè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œè¦æ±‚ç™»å½•æˆåŠŸä¹‹åå†æ¥è®¿é—®ç›¸åº”çš„æ•°æ®ã€‚</li>
</ul>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213122931243.png" alt="image-20240213122931243"></p>
<p>HTTPè¯·æ±‚æ˜¯æ— çŠ¶æ€çš„ï¼Œå³ä¸Šä¸€æ¬¡ä¸šåŠ¡æ“ä½œä¸ä¸‹ä¸€æ¬¡ä¸šåŠ¡æ“ä½œæ˜¯ç›¸äº’åˆ†éš”çš„ã€‚æ‰€ä»¥æœåŠ¡å™¨æ— æ³•åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚</p>
<p>è§£å†³åŠæ³•ï¼šåœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨ç™»å½•æ ‡è®°ï¼Œä¸€æ—¦å‘˜å·¥ç™»å½•æˆåŠŸï¼Œå°±å­˜å‚¨ç›¸åº”çš„ç™»å½•æ ‡è®°ã€‚æ ¹æ®ç”¨æˆ·æ˜¯å¦ç™»å½•æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213123143360.png" alt="image-20240213123143360"></p>
<p>æ¯æ¬¡æ“ä½œéƒ½è¦åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œä¼šå¯¼è‡´åç«¯çš„ä»£ç é‡ä¸Šå‡ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬äº§ç”Ÿäº†ç»Ÿä¸€æ‹¦æˆªçš„æŠ€æœ¯ã€‚é€šè¿‡ç»Ÿä¸€æ‹¦æˆªï¼Œæˆ‘ä»¬å¯ä»¥æ‹¦æˆªæµè§ˆå™¨å‘é€çš„æ‰€æœ‰è¯·æ±‚ï¼Œæ‹¦æˆªåˆ°ä¹‹åï¼Œå°±å¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒå‘˜å·¥æ˜¯å¦ç™»å½•ã€‚å¦‚æœæ‹¦æˆªåˆ°è¯·æ±‚åï¼Œæ²¡æœ‰è·å–åˆ°å¯¹åº”çš„ç™»å½•æ ‡è®°ï¼Œæˆ–è€…ç™»å½•æ ‡è®°æ˜¯æœ‰é—®é¢˜çš„ï¼Œåˆ™ç›´æ¥ç»™å‰ç«¯å“åº”é”™è¯¯ä¿¡æ¯ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213123345266.png" alt="image-20240213123345266"></p>
<p><strong>ç™»é™†æ ‡è®°</strong></p>
<ul>
<li>ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œæ¯ä¸€æ¬¡è¯·æ±‚åï¼Œéƒ½å¯ä»¥è·å–åˆ°è¯¥æ ‡è®°ã€‚ï¼ˆä¼šè¯æŠ€æœ¯ï¼‰</li>
</ul>
<p><strong>ç»Ÿä¸€æ‹¦æˆª</strong></p>
<ul>
<li>è¿‡æ»¤å™¨Filterï¼ˆservletæŠ€æœ¯ï¼‰</li>
<li>æ‹¦æˆªå™¨Interceptorï¼ˆspringæŠ€æœ¯ï¼‰</li>
</ul>
<h2 id="ä¼šè¯æŠ€æœ¯"><a href="#ä¼šè¯æŠ€æœ¯" class="headerlink" title="ä¼šè¯æŠ€æœ¯"></a>ä¼šè¯æŠ€æœ¯</h2><ul>
<li><p>ä¼šè¯ï¼šç”¨æˆ·æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®webæµè§ˆå™¨çš„èµ„æºï¼Œä¼šè¯å»ºç«‹ï¼Œç›´åˆ°æœ‰ä»»ä½•ä¸€æ–¹æ–­å¼€è¿æ¥ï¼Œä¼šè¯ç»“æŸã€‚åœ¨ä¸€æ¬¡ä¼šè¯ä¸­å¯ä»¥åŒ…å«å¤šæ¬¡è¯·æ±‚å’Œå“åº”ã€‚</p>
</li>
<li><p>ä¼šè¯è·Ÿè¸ªï¼šä¸€ç§ç»´æŠ¤æµè§ˆå™¨çŠ¶æ€çš„æ–¹æ³•ï¼ŒæœåŠ¡å™¨éœ€è¦è¯†åˆ«å¤šæ¬¡è¯·æ±‚æ˜¯å¦æ¥è‡ªäºåŒä¸€æµè§ˆå™¨ï¼Œä»¥ä¾¿åœ¨åŒä¸€æ¬¡ä¼šè¯çš„å¤šæ¬¡è¯·æ±‚é—´å…±äº«æ•°æ®ã€‚</p>
</li>
<li><p>ä¼šè¯è·Ÿè¸ªæ–¹æ¡ˆï¼š</p>
<ul>
<li>å®¢æˆ·ç«¯ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ï¼šCookieï¼ˆæµè§ˆå™¨ï¼‰</li>
<li>æœåŠ¡ç«¯ä¼šè¯è·Ÿè¸ªæŠ€æœ¯ï¼šSessionï¼ˆæœåŠ¡å™¨ï¼‰</li>
<li>ä»¤ç‰ŒæŠ€æœ¯</li>
</ul>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213123837098.png" alt="image-20240213123837098"></p>
</li>
</ul>
<p><strong>ä¼šè¯è·Ÿè¸ªæ–¹æ¡ˆå¯¹æ¯”</strong></p>
<p> æœåŠ¡å™¨é€šè¿‡å“åº”å¤´ç›´æ¥è®¾ç½®Set-cookie:name&#x3D;valueï¼Œå“åº”å¤´è¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è§£æè¿™ä¸ªå“åº”å¤´ï¼Œç„¶åæ‹¿åˆ°å“åº”å¤´å¯¹åº”çš„cookieï¼Œå°†å…¶å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œåœ¨åç»­çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œæµè§ˆå™¨éƒ½ä¼šå°†å­˜å‚¨çš„cookieå€¼é€šè¿‡è¯·æ±‚å¤´æºå¸¦åˆ°æœåŠ¡ç«¯ï¼Œåœ¨Tomcatä¸­ï¼Œæä¾›äº†cookieæ“ä½œçš„apiï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¾ç½®ã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213130050761.png" alt="image-20240213130050761"></p>
<p><strong>SessionControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®Cookieï¼ˆæœåŠ¡å™¨ç»™æµè§ˆå™¨è®¾ç½®å“åº”æ•°æ®ï¼‰</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/c1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">cookie1</span><span class="params">(HttpServletResponse response)</span>&#123;</span><br><span class="line">        response.addCookie(<span class="keyword">new</span> <span class="title class_">Cookie</span>(<span class="string">&quot;login_username&quot;</span>,<span class="string">&quot;itheima&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/c2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">cookie2</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">            <span class="keyword">if</span>(cookie.getName().equals(<span class="string">&quot;login_username&quot;</span>))&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;login_username:&quot;</span> + cookie.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼˜ç‚¹ï¼šHTTPåè®®ä¸­æ”¯æŒçš„æŠ€æœ¯</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç§»åŠ¨ç«¯APPæ— æ³•ä½¿ç”¨Cookie</li>
<li>ä¸å®‰å…¨ï¼Œç”¨æˆ·å¯ä»¥è‡ªå·±ç¦ç”¨Cookie</li>
<li>Cookieä¸èƒ½è·¨åŸŸ</li>
</ul>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213131523089.png" alt="image-20240213131523089"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213131651459.png" alt="image-20240213131651459"></p>
<p>ä¼˜ç‚¹ï¼šå­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œå®‰å…¨</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li><p>ç°åœ¨å¼€å‘çš„æœåŠ¡å™¨ä¸€èˆ¬éƒ½éƒ¨ç½²åœ¨é›†ç¾¤ä¸Šï¼ŒåŒä¸€ä¸ªé¡¹ç›®éƒ¨ç½²å¤šä»½ï¼Œç”¨æˆ·è®¿é—®è´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨ï¼Œå®ƒè´Ÿè´£å°†è¯·æ±‚å‡åŒ€çš„å‘é€ç»™åç«¯çš„æœåŠ¡å™¨ã€‚å¦‚æœä½¿ç”¨sessionï¼Œå‡ºç°å•ç‚¹æ•…éšœå°±å¯„äº†ã€‚</p>
</li>
<li><p>Cookieå½“ä¸­çš„ç¼ºç‚¹ã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213132732677.png" alt="image-20240213132732677"></p>
</li>
</ul>
<p><strong>SessionControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SessionController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/s1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">session1</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;HttpSession-s1:&#123;&#125;&quot;</span>,session.hashCode());</span><br><span class="line"></span><br><span class="line">        session.setAttribute(<span class="string">&quot;loginUser&quot;</span>,<span class="string">&quot;tom&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/s2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">session2</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        log.info(<span class="string">&quot;HttpSession-s2:&#123;&#125;&quot;</span>,session.hashCode());</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">loginUser</span> <span class="operator">=</span> session.getAttribute(<span class="string">&quot;loginUser&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;logUser:&#123;&#125;&quot;</span>,loginUser);</span><br><span class="line">        <span class="keyword">return</span> Result.success(loginUser);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="JWTä»¤ç‰Œï¼ˆä¸»æµï¼‰"><a href="#JWTä»¤ç‰Œï¼ˆä¸»æµï¼‰" class="headerlink" title="JWTä»¤ç‰Œï¼ˆä¸»æµï¼‰"></a>JWTä»¤ç‰Œï¼ˆä¸»æµï¼‰</h2><p>ä»¤ç‰Œå°±æ˜¯ç”¨æˆ·èº«ä»½çš„æ ‡è¯†ï¼Œæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šè¿‡ä»¤ç‰ŒæŠ€æœ¯è·Ÿè¸ªä¼šè¯ï¼Œæµè§ˆå™¨å‘é€è¯·æ±‚ï¼Œåœ¨è¯·æ±‚ç™»å½•æ¥å£çš„æ—¶å€™ï¼Œå¦‚æœç™»å½•æˆåŠŸï¼Œå°±ç”Ÿæˆä¸€ä¸ªä»¤ç‰Œï¼Œä»¤ç‰Œå°±æ˜¯ç”¨æˆ·çš„åˆæ³•èº«ä»½å‡­è¯ï¼Œåœ¨å“åº”æ•°æ®çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªä»¤ç‰Œå“åº”ç»™å‰ç«¯ï¼Œæ¥ä¸‹æ¥å‰ç«¯ç¨‹åºæ¥æ”¶åˆ°è¿™ä¸ªä»¤ç‰Œä¹‹åï¼Œå°±éœ€è¦å°†è¿™ä¸ªä»¤ç‰Œå­˜å‚¨èµ·æ¥ï¼Œä»¤ç‰Œå¯ä»¥å­˜å‚¨åœ¨cookieæˆ–è€…å…¶ä»–å­˜å‚¨ç©ºé—´ï¼Œåç»­çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½éœ€è¦å°†ä»¤ç‰Œæºå¸¦åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯éœ€è¦æ ¡éªŒä»¤ç‰Œæœ‰æ•ˆæ€§ï¼Œå¦‚æœä»¤ç‰Œæœ‰æ•ˆï¼Œåˆ™è¯´æ˜ç”¨æˆ·å·²ç»æ‰§è¡Œäº†ç™»å½•æ“ä½œï¼Œå¦‚æœä»¤ç‰Œæ˜¯æ— æ•ˆçš„ï¼Œåˆ™ç”¨æˆ·ä¹‹å‰å¹¶æœªæ‰§è¡Œç™»å½•æ“ä½œã€‚</p>
<p>å¦‚æœæƒ³è¦åœ¨å¤šæ¬¡ä¼šè¯ä¹‹é—´å…±äº«æ•°æ®ï¼Œå¯ä»¥å°†æ•°æ®å­˜å‚¨åœ¨ä»¤ç‰Œå½“ä¸­ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ”¯æŒPCï¼Œç§»åŠ¨ç«¯</li>
<li>è§£å†³é›†ç¾¤ç¯å¢ƒä¸‹çš„è®¤è¯é—®é¢˜</li>
<li>å‡è½»æœåŠ¡å™¨ç«¯å­˜å‚¨å‹åŠ›</li>
</ul>
<p>ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±ç¼–ç¨‹å®ç°</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213133400789.png" alt="image-20240213133400789"></p>
<ul>
<li><p>å…¨ç§°ï¼šJSON Web Tokenï¼ˆ<a href="https://jwt.io/%EF%BC%89">https://jwt.io/ï¼‰</a></p>
</li>
<li><p>å®šä¹‰äº†ä¸€ç§ç®€æ´çš„ã€è‡ªåŒ…å«çš„æ ¼å¼ï¼Œç”¨äºåœ¨é€šä¿¡åŒæ–¹ä»¥jsonæ•°æ®æ ¼å¼å®‰å…¨çš„ä¼ è¾“ä¿¡æ¯ã€‚ç”±äºæ•°å­—ç­¾åçš„å­˜åœ¨ï¼Œè¿™äº›ä¿¡æ¯æ˜¯å¯é çš„ã€‚</p>
</li>
<li><p>ç»„æˆï¼š</p>
<ul>
<li><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šHeaderï¼ˆå¤´ï¼‰ï¼šè®°å½•ä»¤ç‰Œç±»å‹ã€ç­¾åç®—æ³•ç­‰ã€‚ä¾‹å¦‚ï¼š{â€œalgâ€:â€HS256â€,â€typeâ€:â€JWTâ€}</p>
<p>åœ¨ç”ŸæˆJWTçš„æ—¶å€™ï¼Œè¦å…ˆè¿›è¡ŒBase64ç¼–ç ï¼ˆæ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆA-Z a-Z 0-9 + &#x2F;ï¼‰æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„ç¼–ç æ–¹å¼ã€‚</p>
</li>
<li><p>ç¬¬äºŒéƒ¨åˆ†ï¼šPayloadï¼ˆæœ‰æ•ˆè½½è·ï¼‰ï¼Œæºå¸¦äº†ä¸€äº›è‡ªå®šä¹‰ä¿¡æ¯ã€é»˜è®¤ä¿¡æ¯ç­‰ã€‚ä¾‹å¦‚:{â€œidâ€:â€1â€,â€usernameâ€:â€Tomâ€}ï¼Œä¹Ÿè¿›è¡Œäº†Base64ç¼–ç ã€‚</p>
</li>
<li><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šSignatureï¼ˆç­¾åï¼‰ï¼Œé˜²æ­¢Tokenè¢«ç¯¡æ”¹ã€ç¡®ä¿å®‰å…¨æ€§ã€‚å°†headerï¼Œpayloadï¼Œå¹¶åŠ å…¥æŒ‡å®šå¯†é’¥ï¼Œé€šè¿‡æŒ‡å®šç­¾åç®—æ³•è®¡ç®—è€Œæ¥ã€‚</p>
</li>
</ul>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213134135704.png" alt="image-20240213134135704"></p>
</li>
<li><p>åœºæ™¯ï¼šç™»å½•è®¤è¯ã€‚</p>
<ul>
<li><p>ç™»å½•æˆåŠŸåï¼Œç”Ÿæˆä»¤ç‰Œã€‚</p>
</li>
<li><p>åç»­æ¯ä¸ªè¯·æ±‚ï¼Œéƒ½è¦æºå¸¦JWTä»¤ç‰Œï¼Œç³»ç»Ÿåœ¨æ¯æ¬¡è¯·æ±‚å¤„ç†ä¹‹å‰ï¼Œå…ˆæ ¡éªŒä»¤ç‰Œï¼Œé€šè¿‡åï¼Œå†å¤„ç†</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213134329360.png" alt="image-20240213134329360"></p>
</li>
</ul>
</li>
</ul>
<p><strong>JWT-ç”Ÿæˆ</strong></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213134519464.png" alt="image-20240213134519464"></p>
<p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>testå•å…ƒæµ‹è¯•ï¼ˆç”ŸæˆJWTä»¤ç‰Œï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGenJwt</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; claims = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    claims.put(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    claims.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;tom&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> Jwts.builder()</span><br><span class="line">        .signWith(SignatureAlgorithm.HS256, <span class="string">&quot;itheima&quot;</span>) <span class="comment">//ç­¾åç®—æ³•ï¼Œå…¶ä¸­itheimaæ˜¯å¯†é’¥ï¼Œç”¨äºç¬¬ä¸‰éƒ¨åˆ†åŠ å¯†</span></span><br><span class="line">        .setClaims(claims)  <span class="comment">//è‡ªå®šä¹‰å†…å®¹ï¼ˆè½½è·ï¼‰</span></span><br><span class="line">        .setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis()) <span class="comment">// è®¾ç½®JWTä»¤ç‰Œçš„æœ‰æ•ˆæœŸä¸º1h</span></span><br><span class="line">        .compact();</span><br><span class="line"></span><br><span class="line">    System.out.println(jwt);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆè§£æJWTä»¤ç‰Œï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testParseJwt</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> Jwts.parser().setSigningKey(<span class="string">&quot;itheima&quot;</span>).parseClaimsJws(<span class="string">&quot;eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoidG9tIiwiaWQiOjEsImV4cCI6MTcwNzgwNDA5Mn0.KCv1P2sm4hAMjEfW1OSDhk9iitL-oBlCvotb2OLWavo&quot;</span>).getBody();</span><br><span class="line"></span><br><span class="line">	System.out.println(claims);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ€è·¯</p>
<ul>
<li>ä»¤ç‰Œç”Ÿæˆï¼šç™»å½•æˆåŠŸåï¼Œç”ŸæˆJWTä»¤ç‰Œï¼Œå¹¶è¿”å›ç»™å‰ç«¯ã€‚</li>
<li>ä»¤ç‰Œæ ¡éªŒï¼šåœ¨è¯·æ±‚åˆ°è¾¾æœåŠ¡ç«¯åï¼Œå¯¹ä»¤ç‰Œè¿›è¡Œç»Ÿä¸€æ‹¦æˆªï¼Œæ ¡éªŒã€‚</li>
</ul>
<p><strong>ç™»å½•-ç”Ÿæˆä»¤ç‰Œ</strong></p>
<p>æ­¥éª¤</p>
<ul>
<li>å¼•å…¥JWTä»¤ç‰Œæ“ä½œå·¥å…·ç±»ã€‚</li>
<li>ç™»å½•å®Œæˆåï¼Œè°ƒç”¨å·¥å…·ç±»ç”ŸæˆJWTä»¤ç‰Œï¼Œå¹¶è¿”å›ã€‚</li>
</ul>
<p><strong>JwtUtils.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Jwts;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.SignatureAlgorithm;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">signKey</span> <span class="operator">=</span> <span class="string">&quot;itheima&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Long</span> <span class="variable">expire</span> <span class="operator">=</span> <span class="number">43200000L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”ŸæˆJWTä»¤ç‰Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> claims JWTç¬¬äºŒéƒ¨åˆ†è´Ÿè½½ payload ä¸­å­˜å‚¨çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateJwt</span><span class="params">(Map&lt;String, Object&gt; claims)</span>&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> Jwts.builder()</span><br><span class="line">                .addClaims(claims)</span><br><span class="line">                .signWith(SignatureAlgorithm.HS256, signKey)</span><br><span class="line">                .setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + expire))</span><br><span class="line">                .compact();</span><br><span class="line">        <span class="keyword">return</span> jwt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£æJWTä»¤ç‰Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jwt JWTä»¤ç‰Œ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> JWTç¬¬äºŒéƒ¨åˆ†è´Ÿè½½ payload ä¸­å­˜å‚¨çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Claims <span class="title function_">parseJWT</span><span class="params">(String jwt)</span>&#123;</span><br><span class="line">        <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> Jwts.parser()</span><br><span class="line">                .setSigningKey(signKey)</span><br><span class="line">                .parseClaimsJws(jwt)</span><br><span class="line">                .getBody();</span><br><span class="line">        <span class="keyword">return</span> claims;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213142444360.png" alt="image-20240213142444360"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213142542418.png" alt="image-20240213142542418"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213142641695.png" alt="image-20240213142641695"></p>
<h2 id="è¿‡æ»¤å™¨Filter"><a href="#è¿‡æ»¤å™¨Filter" class="headerlink" title="è¿‡æ»¤å™¨Filter"></a>è¿‡æ»¤å™¨Filter</h2><ul>
<li><p>æ¦‚å¿µï¼šFilterè¿‡æ»¤å™¨ï¼Œæ˜¯JavaWebä¸‰å¤§ç»„ä»¶ï¼ˆServletã€Filterã€Linstenerï¼‰ä¹‹ä¸€ã€‚</p>
</li>
<li><p>è¿‡æ»¤å™¨å¯ä»¥æŠŠå¯¹èµ„æºçš„è¯·æ±‚æ‹¦æˆªä¸‹æ¥ï¼Œä»è€Œå®ç°ä¸€äº›æ¯”è¾ƒç‰¹æ®Šçš„åŠŸèƒ½ã€‚</p>
</li>
<li><p>è¿‡æ»¤å™¨ä¸€èˆ¬å®Œæˆä¸€äº›é€šç”¨çš„æ“ä½œï¼Œæ¯”å¦‚ï¼šç™»å½•æ ¡éªŒã€ç»Ÿä¸€ç¼–ç å¤„ç†ã€æ•æ„Ÿå­—ç¬¦å¤„ç†ç­‰ã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213143033277.png" alt="image-20240213143033277"></p>
</li>
</ul>
<h3 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h3><ol>
<li><p>å®šä¹‰Filterï¼šå®šä¹‰ä¸€ä¸ªç±»ï¼Œå®ç°Filteræ¥å£ï¼Œå¹¶é‡å†™å…¶æ‰€æœ‰æ–¹æ³•ã€‚</p>
</li>
<li><p>é…ç½®Filterï¼šFilterç±»ä¸ŠåŠ @WebFilteræ³¨è§£ï¼Œé…ç½®æ‹¦æˆªèµ„æºçš„è·¯å¾„ã€‚å¼•å¯¼ç±»ä¸ŠåŠ @ServletComponentScanå¼€å¯Servletç»„ä»¶æ”¯æŒã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213143454407.png" alt="image-20240213143454407"></p>
</li>
</ol>
<h3 id="è¯¦è§£-æ‰§è¡Œæµç¨‹ã€æ‹¦æˆªè·¯å¾„ã€è¿‡æ»¤å™¨é“¾"><a href="#è¯¦è§£-æ‰§è¡Œæµç¨‹ã€æ‹¦æˆªè·¯å¾„ã€è¿‡æ»¤å™¨é“¾" class="headerlink" title="è¯¦è§£(æ‰§è¡Œæµç¨‹ã€æ‹¦æˆªè·¯å¾„ã€è¿‡æ»¤å™¨é“¾)"></a>è¯¦è§£(æ‰§è¡Œæµç¨‹ã€æ‹¦æˆªè·¯å¾„ã€è¿‡æ»¤å™¨é“¾)</h3><p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213153026983.png" alt="image-20240213153026983"></p>
<p>å…ˆæ‰§è¡Œæ”¾è¡Œå‰é€»è¾‘â€”â€”æ”¾è¡Œâ€”â€”æ‰§è¡ŒæœåŠ¡å™¨ä»£ç â€”â€”æ‰§è¡Œæ”¾è¡Œåé€»è¾‘ã€‚</p>
<p>ç–‘é—®</p>
<ul>
<li>æ”¾è¡Œåä¼šè®¿é—®å¯¹åº”èµ„æºï¼Œèµ„æºè®¿é—®å®Œæˆåï¼Œè¿˜ä¼šå›åˆ°Filterä¸­å—ï¼Ÿä¼š</li>
<li>å¦‚æœå›åˆ°Filterä¸­ï¼Œæ˜¯é‡æ–°æ‰§è¡Œè¿˜æ˜¯æ‰§è¡Œæ”¾è¡Œä¹‹åçš„é€»è¾‘å‘¢ï¼Ÿæ‰§è¡Œæ”¾è¡Œåé€»è¾‘</li>
</ul>
<p><strong>Filteræ‹¦æˆªè·¯å¾„</strong></p>
<ul>
<li><p>Filterå¯ä»¥æ ¹æ®éœ€æ±‚ï¼Œé…ç½®ä¸åŒçš„æ‹¦æˆªèµ„æºè·¯å¾„</p>
<table>
<thead>
<tr>
<th>æ‹¦æˆªè·¯å¾„</th>
<th>urlPatternså€¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>æ‹¦æˆªå…·ä½“è·¯å¾„</td>
<td>&#x2F;login</td>
<td>åªæœ‰è®¿é—®&#x2F;loginè·¯å¾„æ—¶ï¼Œæ‰ä¼šè¢«æ‹¦æˆª</td>
</tr>
<tr>
<td>ç›®å½•æ‹¦æˆª</td>
<td>&#x2F;emps&#x2F;*</td>
<td>è®¿é—®&#x2F;empsä¸‹çš„æ‰€æœ‰èµ„æºï¼Œéƒ½ä¼šè¢«æ‹¦æˆª</td>
</tr>
<tr>
<td>æ‹¦æˆªæ‰€æœ‰</td>
<td>&#x2F;*</td>
<td>è®¿é—®æ‰€æœ‰èµ„æºï¼Œéƒ½ä¼šè¢«æ‹¦æˆª</td>
</tr>
</tbody></table>
</li>
</ul>
<p><strong>è¿‡æ»¤å™¨é“¾</strong></p>
<ul>
<li><p>ä»‹ç»ï¼šä¸€ä¸ªwebåº”ç”¨ä¸­ï¼Œå¯ä»¥é…ç½®å¤šä¸ªè¿‡æ»¤å™¨ï¼Œè¿™å¤šä¸ªè¿‡æ»¤å™¨å°±å½¢æˆäº†ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ã€‚</p>
</li>
<li><p>é¡ºåºï¼šæ³¨è§£é…ç½®çš„filterï¼Œä¼˜å…ˆçº§é»˜è®¤æ˜¯æŒ‰ç…§è¿‡æ»¤å™¨ç±»åï¼ˆå­—ç¬¦ä¸²ï¼‰çš„è‡ªç„¶æ’åºã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213154743954.png" alt="image-20240213154743954"></p>
</li>
</ul>
<p><strong>å°ç»“</strong></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213154815641.png" alt="image-20240213154815641"></p>
<h3 id="ç™»å½•æ ¡éªŒ-Filter"><a href="#ç™»å½•æ ¡éªŒ-Filter" class="headerlink" title="ç™»å½•æ ¡éªŒ-Filter"></a>ç™»å½•æ ¡éªŒ-Filter</h3><p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213154957750.png" alt="image-20240213154957750"></p>
<p>æ€è€ƒ</p>
<ul>
<li>æ‰€æœ‰çš„è¯·æ±‚ï¼Œæ‹¦æˆªåˆ°äº†ä¹‹åï¼Œéƒ½éœ€è¦æ ¡éªŒä»¤ç‰Œå—ï¼Ÿæœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œç™»å½•è¯·æ±‚</li>
<li>æ‹¦æˆªåˆ°è¯·æ±‚åï¼Œä»€ä¹ˆæƒ…å†µä¸‹æ‰å¯ä»¥æ”¾è¡Œï¼Œæ‰§è¡Œä¸šåŠ¡æ“ä½œï¼Ÿæœ‰ä»¤ç‰Œï¼Œä¸”ä»¤ç‰Œæ ¡éªŒé€šè¿‡ï¼ˆåˆæ³•ï¼‰ï¼›å¦åˆ™éƒ½è¿”å›æœªç™»å½•é”™è¯¯ç»“æœ</li>
</ul>
<p>æ­¥éª¤</p>
<ul>
<li>è·å–è¯·æ±‚urlã€‚</li>
<li>åˆ¤æ–­è¯·æ±‚urlä¸­æ˜¯å¦åŒ…å«loginï¼Œå¦‚æœåŒ…å«ï¼Œè¯´æ˜æ˜¯ç™»å½•æ“ä½œï¼Œæ”¾è¡Œã€‚</li>
<li>è·å–è¯·æ±‚å¤´ä¸­çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚</li>
<li>åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</li>
<li>è§£ætokenï¼Œå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</li>
<li>æ”¾è¡Œã€‚</li>
</ul>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213155513342.png" alt="image-20240213155513342"></p>
<p><strong>LoginCheckFilterç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.utils.JwtUtils;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.util.StringUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> netscape.javascript.JSObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(urlPatterns =  &quot;/*&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">//1. è·å–è¯·æ±‚urlã€‚</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) servletRequest;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">resp</span> <span class="operator">=</span> (HttpServletResponse) servletResponse;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. åˆ¤æ–­è¯·æ±‚urlä¸­æ˜¯å¦åŒ…å«loginï¼Œå¦‚æœåŒ…å«ï¼Œè¯´æ˜æ˜¯ç™»å½•æ“ä½œï¼Œæ”¾è¡Œã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> req.getRequestURI().toString();</span><br><span class="line">        log.info(<span class="string">&quot;è¯·æ±‚çš„urlï¼š&#123;&#125;&quot;</span>,url);</span><br><span class="line">        <span class="keyword">if</span>(url.contains(<span class="string">&quot;login&quot;</span>))&#123;</span><br><span class="line">            log.info(<span class="string">&quot;ç™»å½•æ“ä½œï¼Œæ”¾è¡Œ....&quot;</span>);</span><br><span class="line">            filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è·å–è¯·æ±‚å¤´ä¸­çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.hasLength(jwt))&#123;</span><br><span class="line">            log.info(<span class="string">&quot;è¯·æ±‚å¤´tokenä¸ºç©ºï¼Œè¿”å›æœªç™»å½•çš„ä¿¡æ¯&quot;</span>);</span><br><span class="line">            <span class="type">Result</span> <span class="variable">error</span> <span class="operator">=</span> Result.error(<span class="string">&quot;NOT_LOGIN&quot;</span>);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨è½¬æ¢ å¯¹è±¡ --é˜¿é‡Œå·´å·´fastjson</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">notlogin</span> <span class="operator">=</span> JSONObject.toJSONString(error);</span><br><span class="line">            resp.getWriter().write(notlogin);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è§£ætokenï¼Œå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JwtUtils.parseJWT(jwt);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123; <span class="comment">//jwtè§£æå¤±è´¥</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.info(<span class="string">&quot;è§£æä»¤ç‰Œå¤±è´¥ã€‚è¿”å›æœªç™»å½•é”™è¯¯ä¿¡æ¯&quot;</span>);</span><br><span class="line">            <span class="type">Result</span> <span class="variable">error</span> <span class="operator">=</span> Result.error(<span class="string">&quot;NOT_LOGIN&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">notlogin</span> <span class="operator">=</span> JSONObject.toJSONString(error);</span><br><span class="line">            resp.getWriter().write(notlogin);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6. æ”¾è¡Œã€‚</span></span><br><span class="line">        log.info(<span class="string">&quot;ä»¤ç‰Œåˆæ³•ï¼Œæ”¾è¡Œ&quot;</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ‹¦æˆªå™¨Interceptor"><a href="#æ‹¦æˆªå™¨Interceptor" class="headerlink" title="æ‹¦æˆªå™¨Interceptor"></a>æ‹¦æˆªå™¨Interceptor</h2><h3 id="ç®€ä»‹-å¿«é€Ÿå…¥é—¨"><a href="#ç®€ä»‹-å¿«é€Ÿå…¥é—¨" class="headerlink" title="ç®€ä»‹ &amp; å¿«é€Ÿå…¥é—¨"></a>ç®€ä»‹ &amp; å¿«é€Ÿå…¥é—¨</h3><ul>
<li>æ¦‚å¿µï¼šæ˜¯ä¸€ç§åŠ¨æ€æ‹¦æˆªæ–¹æ³•è°ƒç”¨çš„æœºåˆ¶ï¼Œç±»ä¼¼äºè¿‡æ»¤å™¨ã€‚Springæ¡†æ¶ä¸­æä¾›çš„ï¼Œç”¨æ¥åŠ¨æ€æ‹¦æˆªæ§åˆ¶å™¨æ–¹æ³•çš„æ‰§è¡Œã€‚</li>
<li>ä½œç”¨ï¼šæ‹¦æˆªè¯·æ±‚ï¼Œåœ¨è¯·æ±‚çš„æ–¹æ³•è°ƒç”¨å‰åï¼Œæ ¹æ®ä¸šåŠ¡éœ€è¦æ‰§è¡Œé¢„å…ˆè®¾å®šçš„ä»£ç ã€‚</li>
</ul>
<ol>
<li><p>å®šä¹‰æ‹¦æˆªå™¨ï¼Œå®ç°HandlerInterceptoræ¥å£ï¼Œå¹¶é‡å†™å…¶ä¸­æ‰€æœ‰æ–¹æ³•ã€‚</p>
</li>
<li><p>æ³¨å†Œæ‹¦æˆªå™¨ã€‚</p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213194352886.png" alt="image-20240213194352886"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213194419268.png" alt="image-20240213194419268"></p>
<p><strong>LoginCheckInterceptor.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œå‰è¿è¡Œï¼Œè¿”å›trueï¼›æ”¾è¡Œï¼Œè¿”å›falseï¼Œä¸æ”¾è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;preHandle...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œåè¿è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postHandle...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// è§†å›¾æ¸²æŸ“å®Œæ¯•åè¿è¡Œï¼Œæœ€åè¿è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterCompletion...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WebConfig.java</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.interceptor.LoginCheckInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">//é…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginCheckInterceptor loginCheckInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(loginCheckInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>æ‹¦æˆªå™¨å¯ä»¥æ ¹æ®éœ€æ±‚ï¼Œé…ç½®ä¸åŒçš„æ‹¦æˆªè·¯å¾„ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.interceptor.LoginCheckInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">//é…ç½®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginCheckInterceptor loginCheckInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;       registry.addInterceptor(loginCheckInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>).excludePathPatterns(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>æ‹¦æˆªè·¯å¾„</th>
<th>å«ä¹‰</th>
<th>ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;*</td>
<td>ä¸€çº§è·¯å¾„</td>
<td>èƒ½åŒ¹é…&#x2F;depts,&#x2F;emps,&#x2F;loginï¼Œä¸èƒ½åŒ¹é…&#x2F;depts&#x2F;1</td>
</tr>
<tr>
<td>&#x2F;**</td>
<td>ä»»æ„çº§è·¯å¾„</td>
<td>èƒ½åŒ¹é…&#x2F;depts,&#x2F;depts&#x2F;1,&#x2F;depts&#x2F;1&#x2F;2</td>
</tr>
<tr>
<td>&#x2F;depts&#x2F;*</td>
<td>&#x2F;deptsä¸‹çš„ä¸€çº§è·¯å¾„</td>
<td>èƒ½åŒ¹é…&#x2F;depts&#x2F;1ï¼Œä¸èƒ½åŒ¹é…&#x2F;depts&#x2F;1&#x2F;2ï¼Œ&#x2F;depts</td>
</tr>
<tr>
<td>&#x2F;depts&#x2F;**</td>
<td>&#x2F;deptsä¸‹çš„ä»»æ„çº§è·¯å¾„</td>
<td>èƒ½åŒ¹é…&#x2F;depts,&#x2F;depts&#x2F;1,depts&#x2F;1&#x2F;2;ä¸èƒ½åŒ¹é…&#x2F;emps</td>
</tr>
</tbody></table>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213202921519.png" alt="image-20240213202921519"></p>
</li>
</ul>
<p><strong>Filterä¸Interceptor</strong></p>
<ul>
<li>æ¥å£è§„èŒƒä¸åŒï¼šè¿‡æ»¤å™¨éœ€è¦å®ç°Filteræ¥å£ï¼Œè€Œæ‹¦æˆªå™¨éœ€è¦å®ç°HandlerInterceptoræ¥å£ã€‚</li>
<li>æ‹¦æˆªèŒƒå›´ä¸åŒï¼šè¿‡æ»¤å™¨Filterä¼šæ‹¦æˆªæ‰€æœ‰èµ„æºï¼Œè€ŒInterceptoråªä¼šæ‹¦æˆªSpringç¯å¢ƒä¸­çš„èµ„æºã€‚</li>
</ul>
<h3 id="ç™»å½•æ ¡éªŒ-Interceptor"><a href="#ç™»å½•æ ¡éªŒ-Interceptor" class="headerlink" title="ç™»å½•æ ¡éªŒ - Interceptor"></a>ç™»å½•æ ¡éªŒ - Interceptor</h3><p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213203640091.png" alt="image-20240213203640091"></p>
<p><strong>LoginCheckInterceptorç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.utils.JwtUtils;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginCheckInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œå‰è¿è¡Œï¼Œè¿”å›trueï¼›æ”¾è¡Œï¼Œè¿”å›falseï¼Œä¸æ”¾è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;preHandle...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1. è·å–è¯·æ±‚urlã€‚</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">req</span> <span class="operator">=</span> (HttpServletRequest) request;</span><br><span class="line">        <span class="type">HttpServletResponse</span> <span class="variable">resp</span> <span class="operator">=</span> (HttpServletResponse) response;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. åˆ¤æ–­è¯·æ±‚urlä¸­æ˜¯å¦åŒ…å«loginï¼Œå¦‚æœåŒ…å«ï¼Œè¯´æ˜æ˜¯ç™»å½•æ“ä½œï¼Œæ”¾è¡Œã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> req.getRequestURI().toString();</span><br><span class="line">        log.info(<span class="string">&quot;è¯·æ±‚çš„urlï¼š&#123;&#125;&quot;</span>,url);</span><br><span class="line">        <span class="keyword">if</span>(url.contains(<span class="string">&quot;login&quot;</span>))&#123;</span><br><span class="line">            log.info(<span class="string">&quot;ç™»å½•æ“ä½œï¼Œæ”¾è¡Œ....&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. è·å–è¯·æ±‚å¤´ä¸­çš„ä»¤ç‰Œï¼ˆtokenï¼‰ã€‚</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">jwt</span> <span class="operator">=</span> req.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4. åˆ¤æ–­ä»¤ç‰Œæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.hasLength(jwt))&#123;</span><br><span class="line">            log.info(<span class="string">&quot;è¯·æ±‚å¤´tokenä¸ºç©ºï¼Œè¿”å›æœªç™»å½•çš„ä¿¡æ¯&quot;</span>);</span><br><span class="line">            <span class="type">Result</span> <span class="variable">error</span> <span class="operator">=</span> Result.error(<span class="string">&quot;NOT_LOGIN&quot;</span>);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨è½¬æ¢ å¯¹è±¡ --é˜¿é‡Œå·´å·´fastjson</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">notlogin</span> <span class="operator">=</span> JSONObject.toJSONString(error);</span><br><span class="line">            resp.getWriter().write(notlogin);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5. è§£ætokenï¼Œå¦‚æœè§£æå¤±è´¥ï¼Œè¿”å›é”™è¯¯ç»“æœï¼ˆæœªç™»å½•ï¼‰ã€‚</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JwtUtils.parseJWT(jwt);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123; <span class="comment">//jwtè§£æå¤±è´¥</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.info(<span class="string">&quot;è§£æä»¤ç‰Œå¤±è´¥ã€‚è¿”å›æœªç™»å½•é”™è¯¯ä¿¡æ¯&quot;</span>);</span><br><span class="line">            <span class="type">Result</span> <span class="variable">error</span> <span class="operator">=</span> Result.error(<span class="string">&quot;NOT_LOGIN&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">notlogin</span> <span class="operator">=</span> JSONObject.toJSONString(error);</span><br><span class="line">            resp.getWriter().write(notlogin);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6. æ”¾è¡Œã€‚</span></span><br><span class="line">        log.info(<span class="string">&quot;ä»¤ç‰Œåˆæ³•ï¼Œæ”¾è¡Œ&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//ç›®æ ‡èµ„æºæ–¹æ³•è¿è¡Œåè¿è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postHandle...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// è§†å›¾æ¸²æŸ“å®Œæ¯•åè¿è¡Œï¼Œæœ€åè¿è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterCompletion...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h1><p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213205958788.png" alt="image-20240213205958788"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240213210058206.png" alt="image-20240213210058206"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240214120014045.png" alt="image-20240214120014045"></p>
<p><img src="/2024/02/12/javeweb-day06-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81/image-20240214120254171.png" alt="image-20240214120254171"></p>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day05-springbootæ¡ˆä¾‹</title>
    <url>/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/</url>
    <content><![CDATA[<h1 id="SpringBootWebæ¡ˆä¾‹"><a href="#SpringBootWebæ¡ˆä¾‹" class="headerlink" title="SpringBootWebæ¡ˆä¾‹"></a>SpringBootWebæ¡ˆä¾‹</h1><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209151042104.png" alt="image-20240209151042104"></p>
<p>ç¯å¢ƒæ­å»º</p>
<ul>
<li><p>å‡†å¤‡æ•°æ®åº“è¡¨ï¼ˆdeptï¼Œempï¼‰</p>
</li>
<li><p>åˆ›å»ºspringbootå·¥ç¨‹ï¼Œå¼•å…¥å¯¹åº”çš„èµ·æ­¥ä¾èµ–ï¼ˆwebã€mybatisã€mysqlé©±åŠ¨ã€lombokï¼‰</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209152041678.png" alt="image-20240209152041678"></p>
</li>
<li><p>åœ¨application.propertiesä¸­é…ç½®æ•°æ®åº“ä¿¡æ¯ï¼Œå¼•å…¥mybatisçš„é…ç½®ä¿¡æ¯ï¼Œå‡†å¤‡å¯¹åº”çš„å®ä½“ç±»</p>
</li>
<li><p>å‡†å¤‡ä¸‰å±‚æ¶æ„çš„åŸºç¡€ä»£ç ï¼ˆcontrollerã€serviceï¼ˆæ¥å£ï¼Œå®ç°ç±»ï¼‰ã€mapperï¼ˆdaoå±‚ï¼‰ï¼‰</p>
</li>
</ul>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209151547313.png" alt="image-20240209151547313"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209152929582.png" alt="image-20240209152929582"></p>
<p>æ•°æ®åº“</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- éƒ¨é—¨ç®¡ç†</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">    id <span class="type">int</span> unsigned <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;ä¸»é”®ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;éƒ¨é—¨åç§°&#x27;</span>,</span><br><span class="line">    create_time datetime <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    update_time datetime <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;éƒ¨é—¨è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept (id, name, create_time, update_time) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;å­¦å·¥éƒ¨&#x27;</span>,now(),now()),(<span class="number">2</span>,<span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>,now(),now()),(<span class="number">3</span>,<span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span>,now(),now()), (<span class="number">4</span>,<span class="string">&#x27;å°±ä¸šéƒ¨&#x27;</span>,now(),now()),(<span class="number">5</span>,<span class="string">&#x27;äººäº‹éƒ¨&#x27;</span>,now(),now());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å‘˜å·¥ç®¡ç†(å¸¦çº¦æŸ)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp (</span><br><span class="line">  id <span class="type">int</span> unsigned <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">  username <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">  password <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">default</span> <span class="string">&#x27;123456&#x27;</span> comment <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">  gender tinyint unsigned <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ€§åˆ«, è¯´æ˜: 1 ç”·, 2 å¥³&#x27;</span>,</span><br><span class="line">  image <span class="type">varchar</span>(<span class="number">300</span>) comment <span class="string">&#x27;å›¾åƒ&#x27;</span>,</span><br><span class="line">  job tinyint unsigned comment <span class="string">&#x27;èŒä½, è¯´æ˜: 1 ç­ä¸»ä»»,2 è®²å¸ˆ, 3 å­¦å·¥ä¸»ç®¡, 4 æ•™ç ”ä¸»ç®¡, 5 å’¨è¯¢å¸ˆ&#x27;</span>,</span><br><span class="line">  entrydate <span class="type">date</span> comment <span class="string">&#x27;å…¥èŒæ—¶é—´&#x27;</span>,</span><br><span class="line">  dept_id <span class="type">int</span> unsigned comment <span class="string">&#x27;éƒ¨é—¨ID&#x27;</span>,</span><br><span class="line">  create_time datetime <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">  update_time datetime <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;å‘˜å·¥è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp</span><br><span class="line">	(id, username, password, name, gender, image, job, entrydate,dept_id, create_time, update_time) <span class="keyword">VALUES</span></span><br><span class="line">	(<span class="number">1</span>,<span class="string">&#x27;jinyong&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;é‡‘åº¸&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;1.jpg&#x27;</span>,<span class="number">4</span>,<span class="string">&#x27;2000-01-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">2</span>,<span class="string">&#x27;zhangwuji&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å¼ æ— å¿Œ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2015-01-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">3</span>,<span class="string">&#x27;yangxiao&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;æ¨é€&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;3.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2008-05-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">4</span>,<span class="string">&#x27;weiyixiao&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;4.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2007-01-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">5</span>,<span class="string">&#x27;changyuchun&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å¸¸é‡æ˜¥&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;5.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2012-12-05&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">6</span>,<span class="string">&#x27;xiaozhao&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å°æ˜­&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;6.jpg&#x27;</span>,<span class="number">3</span>,<span class="string">&#x27;2013-09-05&#x27;</span>,<span class="number">1</span>,now(),now()),</span><br><span class="line">	(<span class="number">7</span>,<span class="string">&#x27;jixiaofu&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;çºªæ™“èŠ™&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;7.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2005-08-01&#x27;</span>,<span class="number">1</span>,now(),now()),</span><br><span class="line">	(<span class="number">8</span>,<span class="string">&#x27;zhouzhiruo&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å‘¨èŠ·è‹¥&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;8.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2014-11-09&#x27;</span>,<span class="number">1</span>,now(),now()),</span><br><span class="line">	(<span class="number">9</span>,<span class="string">&#x27;dingminjun&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;ä¸æ•å›&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;9.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2011-03-11&#x27;</span>,<span class="number">1</span>,now(),now()),</span><br><span class="line">	(<span class="number">10</span>,<span class="string">&#x27;zhaomin&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;èµµæ•&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;10.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2013-09-05&#x27;</span>,<span class="number">1</span>,now(),now()),</span><br><span class="line">	(<span class="number">11</span>,<span class="string">&#x27;luzhangke&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;é¹¿æ–å®¢&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;11.jpg&#x27;</span>,<span class="number">5</span>,<span class="string">&#x27;2007-02-01&#x27;</span>,<span class="number">3</span>,now(),now()),</span><br><span class="line">	(<span class="number">12</span>,<span class="string">&#x27;hebiweng&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;é¹¤ç¬”ç¿&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;12.jpg&#x27;</span>,<span class="number">5</span>,<span class="string">&#x27;2008-08-18&#x27;</span>,<span class="number">3</span>,now(),now()),</span><br><span class="line">	(<span class="number">13</span>,<span class="string">&#x27;fangdongbai&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;13.jpg&#x27;</span>,<span class="number">5</span>,<span class="string">&#x27;2012-11-01&#x27;</span>,<span class="number">3</span>,now(),now()),</span><br><span class="line">	(<span class="number">14</span>,<span class="string">&#x27;zhangsanfeng&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å¼ ä¸‰ä¸°&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;14.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2002-08-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">15</span>,<span class="string">&#x27;yulianzhou&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;ä¿è²èˆŸ&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;15.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2011-05-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">16</span>,<span class="string">&#x27;songyuanqiao&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;å®‹è¿œæ¡¥&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;16.jpg&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;2007-01-01&#x27;</span>,<span class="number">2</span>,now(),now()),</span><br><span class="line">	(<span class="number">17</span>,<span class="string">&#x27;chenyouliang&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;é™ˆå‹è°…&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;17.jpg&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2015-03-21&#x27;</span>,<span class="keyword">NULL</span>,now(),now());</span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/tlias</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># é…ç½®mybatisçš„æ—¥å¿—ï¼ŒæŒ‡å®šå…¶è¾“å‡ºåˆ°æ§åˆ¶å°</span></span><br><span class="line"><span class="attr">mybatis.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># å¼€å¯mybatisçš„é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„å¼€å…³</span></span><br><span class="line"><span class="attr">mybatis.configuration.map-underscore-to-camel-case</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>



<h2 id="å¼€å‘è§„èŒƒ"><a href="#å¼€å‘è§„èŒƒ" class="headerlink" title="å¼€å‘è§„èŒƒ"></a>å¼€å‘è§„èŒƒ</h2><p>æ¡ˆä¾‹åŸºäºå½“å‰æœ€ä¸»æµçš„å‰åç«¯åˆ†ç¦»æ¨¡å¼è¿›è¡Œå¼€å‘ã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209154811663.png" alt="image-20240209154811663"></p>
<ul>
<li><p>RESTï¼ˆREpresentational State Transferï¼‰ï¼Œè¡¨è¿°æ€§çŠ¶æ€è½¬æ¢ï¼Œå®ƒæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209155135828.png" alt="image-20240209155135828"></p>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>RESTæ˜¯é£æ ¼ï¼Œæ˜¯çº¦å®šæ–¹å¼ï¼Œçº¦å®šä¸æ˜¯è§„å®šï¼Œå¯ä»¥æ‰“ç ´ã€‚</li>
<li>æè¿°æ¨¡å—çš„åŠŸèƒ½é€šå¸¸ä½¿ç”¨å¤æ•°ï¼Œä¹Ÿå°±æ˜¯åŠ sçš„æ ¼å¼æ¥æè¿°ï¼Œè¡¨ç¤ºæ­¤ç±»èµ„æºï¼Œè€Œéå•ä¸ªèµ„æºã€‚å¦‚ï¼šusersã€empsã€booksâ€¦</li>
</ul>
</li>
<li><p>æ‰€æœ‰çš„å¢åˆ æ”¹æŸ¥æ¥å£éƒ½è¦è¿”å›ç»Ÿä¸€çš„å“åº”ç»“æœResultï¼ˆcodeï¼Œmsgï¼Œdataï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;<span class="comment">//å“åº”ç ï¼Œ1 ä»£è¡¨æˆåŠŸ; 0 ä»£è¡¨å¤±è´¥</span></span><br><span class="line">    <span class="keyword">private</span> String msg;  <span class="comment">//å“åº”ä¿¡æ¯ æè¿°å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">private</span> Object data; <span class="comment">//è¿”å›çš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¢åˆ æ”¹ æˆåŠŸå“åº”</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">success</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">1</span>,<span class="string">&quot;success&quot;</span>,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢ æˆåŠŸå“åº”</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">success</span><span class="params">(Object data)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">1</span>,<span class="string">&quot;success&quot;</span>,data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¤±è´¥å“åº”</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">error</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Result</span>(<span class="number">0</span>,msg,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209155326662.png" alt="image-20240209155326662"></p>
</li>
</ul>
<h2 id="å¼€å‘æµç¨‹"><a href="#å¼€å‘æµç¨‹" class="headerlink" title="å¼€å‘æµç¨‹"></a>å¼€å‘æµç¨‹</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209155531746.png" alt="image-20240209155531746"></p>
<h1 id="éƒ¨é—¨ç®¡ç†"><a href="#éƒ¨é—¨ç®¡ç†" class="headerlink" title="éƒ¨é—¨ç®¡ç†"></a>éƒ¨é—¨ç®¡ç†</h1><h2 id="æŸ¥è¯¢éƒ¨é—¨"><a href="#æŸ¥è¯¢éƒ¨é—¨" class="headerlink" title="æŸ¥è¯¢éƒ¨é—¨"></a>æŸ¥è¯¢éƒ¨é—¨</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209160429415.png" alt="image-20240209160429415"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209160528223.png" alt="image-20240209160528223"></p>
<ol>
<li><p>ç¼–å†™DeptControllerç±»ä¸­ä»£ç </p>
<ol>
<li>@RestControllerï¼Œè®©DeptControllerè¿”å›restfulå½¢å¼çš„ç»Ÿä¸€å“åº”ç»“æœ</li>
<li>@Slf4jï¼Œè‡ªåŠ¨ä¸ºæ³¨é‡Šçš„ç±»åˆ›å»ºlogå¯¹è±¡</li>
<li>@GetMappingï¼Œè®¾ç½®è¯¥è¯·æ±‚ä»…å›å¤getå“åº”</li>
<li>è®¾ç½®deptServiceï¼ˆ<font color="red">serviceå±‚æ¥å£å¯¹è±¡</font>ï¼‰ï¼Œæ–¹ä¾¿æ§åˆ¶åè½¬</li>
<li>è®¾ç½®ç›¸åº”çš„è¿”å›æ–¹æ³•</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// DeptController</span></span><br><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éƒ¨é—¨ç®¡ç†Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span>  <span class="comment">//è¯¥æ³¨é‡Šä¼šä¸ºç›¸åº”ç±»ç”Ÿæˆå¯¹åº”çš„logå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span> &#123;</span><br><span class="line">    <span class="comment">//private static Logger log = LoggerFactory.getLogger(DeptController.class);</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptService deptService;</span><br><span class="line"><span class="comment">//    @RequestMapping(value = &quot;/depts&quot;,method = RequestMethod.GET)  //RequestMappingæ˜ å°„é¡µé¢è¯·æ±‚å’Œå¤„ç†æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/depts&quot;)</span>  <span class="comment">//RequestMappingæ˜ å°„é¡µé¢è¯·æ±‚å’Œå¤„ç†æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">list</span><span class="params">()</span>&#123;  <span class="comment">//Controllerå±‚æŸ¥è¯¢ç»“æœï¼Œè¿”å›çš„æ˜¯Resultå¯¹è±¡</span></span><br><span class="line">        log.info(<span class="string">&quot;æŸ¥è¯¢å…¨éƒ¨éƒ¨é—¨æ•°æ®&quot;</span>);</span><br><span class="line">        List&lt;Dept&gt; deptList =  deptService.list();</span><br><span class="line">        <span class="keyword">return</span> Result.success(deptList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™servicesä»£ç æŸ¥è¯¢æ•°æ®</p>
<ol>
<li>è®¾ç½®serviceå±‚æ¥å£åŠå…¶å®ç°ç±»å¯¹è±¡ï¼ˆå®ç°ç±»å¯¹è±¡è¦åŠ @Serviceï¼Œæ–¹ä¾¿ä¾èµ–æ³¨å…¥ï¼‰</li>
<li>è®¾ç½®deptMapper(<font color="red">daoå±‚æ¥å£å¯¹è±¡</font>)ï¼Œæ–¹ä¾¿æ§åˆ¶åè½¬</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//DeptService.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptService</span> &#123;</span><br><span class="line">    List&lt;Dept&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//DeptServiceImpl.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.DeptMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DeptService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptMapper deptMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> deptMapper.list();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™daoå±‚ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from dept&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Dept&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="å‰åç«¯è”è°ƒ"><a href="#å‰åç«¯è”è°ƒ" class="headerlink" title="å‰åç«¯è”è°ƒ"></a>å‰åç«¯è”è°ƒ</h2><p><font color="red">å‰ç«¯æ¥å£é€šè¿‡nginxæœåŠ¡å™¨ä¸åç«¯çš„tomcatæœåŠ¡å™¨å®ç°ç«¯å£æ˜ å°„ã€‚</font></p>
<p>æ¦‚å¿µï¼šå°†å‰ç«¯å·¥ç¨‹å’Œåç«¯å·¥ç¨‹éƒ½å¯åŠ¨èµ·æ¥ï¼Œç„¶åè®¿é—®å‰ç«¯å·¥ç¨‹ï¼Œé€šè¿‡å‰ç«¯å·¥ç¨‹è®¿é—®æœåŠ¡å™¨ç¨‹åºï¼Œè¿›è€Œè°ƒè¯•ç»“æœã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209165501994-17074689029111.png" alt="image-20240209165501994"></p>
<h2 id="åˆ é™¤éƒ¨é—¨"><a href="#åˆ é™¤éƒ¨é—¨" class="headerlink" title="åˆ é™¤éƒ¨é—¨"></a>åˆ é™¤éƒ¨é—¨</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209170144724.png" alt="image-20240209170144724"></p>
<p>ä½¿ç”¨@PathVariableè·å–idå‚æ•°å€¼</p>
<p><strong>controllerå±‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éƒ¨é—¨ç®¡ç†Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span>  <span class="comment">//è¯¥æ³¨é‡Šä¼šä¸ºç›¸åº”ç±»ç”Ÿæˆå¯¹åº”çš„logå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span> &#123;</span><br><span class="line">    <span class="comment">//private static Logger log = LoggerFactory.getLogger(DeptController.class);</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptService deptService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * åˆ é™¤éƒ¨é—¨</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@DeleteMapping(value = &quot;/depts/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">delete</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ ¹æ®idåˆ é™¤æŒ‡å®šéƒ¨é—¨:&#123;&#125;&quot;</span>,id);</span><br><span class="line">        deptService.delete(id);</span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptService</span> &#123;</span><br><span class="line">    List&lt;Dept&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Delete(&quot;delete from dept where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æ–°å¢éƒ¨é—¨"><a href="#æ–°å¢éƒ¨é—¨" class="headerlink" title="æ–°å¢éƒ¨é—¨"></a>æ–°å¢éƒ¨é—¨</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209175909231.png" alt="image-20240209175909231"></p>
<p><strong>controllerå±‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éƒ¨é—¨ç®¡ç†Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span>  <span class="comment">//è¯¥æ³¨é‡Šä¼šä¸ºç›¸åº”ç±»ç”Ÿæˆå¯¹åº”çš„logå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span> &#123;</span><br><span class="line">    <span class="comment">//private static Logger log = LoggerFactory.getLogger(DeptController.class);</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptService deptService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/depts&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> Dept dept)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ–°å¢éƒ¨é—¨ï¼š&#123;&#125;&quot;</span>,dept);</span><br><span class="line"></span><br><span class="line">        deptService.add(dept);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.DeptMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DeptService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptMapper deptMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Dept dept)</span> &#123;</span><br><span class="line">        dept.setCreateTime(LocalDateTime.now());</span><br><span class="line">        dept.setUpdateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        deptMapper.insert(dept);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptMapper</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Insert(&quot;insert into dept(name,create_time, update_time) values(#&#123;name&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Dept dept)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨@RequestMappingç®€åŒ–Controllerç±»ä¸­æ–¹æ³•çš„ç¼–å†™è¿‡ç¨‹</strong></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209181608222.png" alt="image-20240209181608222"></p>
<ul>
<li>ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚è·¯å¾„ï¼Œåº”è¯¥æ˜¯ç±»ä¸Šçš„@RequestMappingçš„valueå±æ€§+æ–¹æ³•ä¸Šçš„@RequestMappingçš„valueå±æ€§ã€‚</li>
</ul>
<h2 id="ä¿®æ”¹éƒ¨é—¨"><a href="#ä¿®æ”¹éƒ¨é—¨" class="headerlink" title="ä¿®æ”¹éƒ¨é—¨"></a>ä¿®æ”¹éƒ¨é—¨</h2><p><strong>controllerå±‚</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éƒ¨é—¨ç®¡ç†Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span>  <span class="comment">//è¯¥æ³¨é‡Šä¼šä¸ºç›¸åº”ç±»ç”Ÿæˆå¯¹åº”çš„logå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptController</span> &#123;</span><br><span class="line">    <span class="comment">//private static Logger log = LoggerFactory.getLogger(DeptController.class);</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptService deptService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/depts&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> Dept dept)</span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ›´æ–°éƒ¨é—¨:&#123;&#125;&quot;</span>,dept);</span><br><span class="line"></span><br><span class="line">        deptService.update(dept);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>serviceå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.DeptMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> com.example.service.DeptService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeptServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">DeptService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DeptMapper deptMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Dept dept)</span> &#123;</span><br><span class="line">        dept.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        dept.setCreateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">        deptMapper.update(dept);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>mapperå±‚ä»£ç </strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Dept;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DeptMapper</span> &#123;    </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update(&quot;update dept set name = #&#123;name&#125; where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Dept dept)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="å‘˜å·¥ç®¡ç†"><a href="#å‘˜å·¥ç®¡ç†" class="headerlink" title="å‘˜å·¥ç®¡ç†"></a>å‘˜å·¥ç®¡ç†</h1><h2 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240209185704327.png" alt="image-20240209185704327"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240210002309264.png" alt="image-20240210002309264"></p>
<p><strong>å®šä¹‰å®ä½“ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PageBean</span></span><br><span class="line"><span class="keyword">package</span> com.example.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long total; <span class="comment">// æ€»è®°å½•æ•°</span></span><br><span class="line">    <span class="keyword">private</span> List rows; <span class="comment">//æ•°æ®åˆ—è¡¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>EmpControllerç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.service.EmpService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‘˜å·¥ç®¡ç†Controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpService empService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/emps&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">page</span><span class="params">(<span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer page, <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;åˆ†é¡µæŸ¥è¯¢ï¼Œå‚æ•°ï¼š&#123;&#125;,&#123;&#125;&quot;</span>,page,pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="type">PageBean</span> <span class="variable">pageBean</span> <span class="operator">=</span>  empService.page(page,pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Result.success(pageBean);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>EmpServiceç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.EmpMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.example.service.EmpService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageBean <span class="title function_">page</span><span class="params">(Integer page, Integer pageSize)</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">num</span> <span class="operator">=</span> empMapper.count();</span><br><span class="line">        List&lt;Emp&gt; emp = empMapper.page((page - <span class="number">1</span>) * pageSize, pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageBean</span>(num, emp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>EmpMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select count(*) from emp&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">count</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;select * from emp limit #&#123;start&#125;,#&#123;pageSize&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">page</span><span class="params">(Integer start, Integer pageSize)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240210003718951.png" alt="image-20240210003718951"></p>
<h2 id="åˆ†é¡µæ’ä»¶PageHelper"><a href="#åˆ†é¡µæ’ä»¶PageHelper" class="headerlink" title="åˆ†é¡µæ’ä»¶PageHelper"></a>åˆ†é¡µæ’ä»¶PageHelper</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240210005329151.png" alt="image-20240210005329151"></p>
<p>å¼•å…¥pageHelperä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- PageHelperåˆ†é¡µæ’ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240210005505728.png" alt="image-20240210005505728"></p>
<p><strong>EmpServiceImplç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.EmpMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.PageBean;</span><br><span class="line"><span class="keyword">import</span> com.example.service.EmpService;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">EmpService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Override</span></span><br><span class="line"><span class="comment">//    public PageBean page(Integer page, Integer pageSize) &#123;</span></span><br><span class="line"><span class="comment">//        Long num = empMapper.count();</span></span><br><span class="line"><span class="comment">//        List&lt;Emp&gt; emp = empMapper.page((page - 1) * pageSize, pageSize);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        return new PageBean(num, emp);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageBean <span class="title function_">page</span><span class="params">(Integer page, Integer pageSize)</span>&#123;</span><br><span class="line">        <span class="comment">// 1. è®¾ç½®åˆ†é¡µå‚æ•°</span></span><br><span class="line">        PageHelper.startPage(page,pageSize);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line">        List&lt;Emp&gt; empList = empMapper.list();</span><br><span class="line">        Page&lt;Emp&gt; p = (Page&lt;Emp&gt;) empList;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å°è£…PageBeanå¯¹è±¡</span></span><br><span class="line">        <span class="type">PageBean</span> <span class="variable">pageBean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageBean</span>(p.getTotal(),p.getResult());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pageBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>EmpMapperç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpMapper</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Select(&quot;select count(*) from emp&quot;)</span></span><br><span class="line"><span class="comment">//    public Long count();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    @Select(&quot;select * from emp limit #&#123;start&#125;,#&#123;pageSize&#125;&quot;)</span></span><br><span class="line"><span class="comment">//    public List&lt;Emp&gt; page(Integer start, Integer pageSize);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘˜å·¥ä¿¡æ¯æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from emp&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red">æ³¨æ„ï¼Œè¿™é‡Œå¯èƒ½ä¼šå‡ºç°ç‰ˆæœ¬é€‚é…é—®é¢˜ï¼Œå³springbootå’Œå¯¹åº”çš„PageHelperæ’ä»¶ç‰ˆæœ¬ä¸åŒï¼Œå¯¼è‡´æœ€ç»ˆç¨‹åºæ— æ³•æ­£ç¡®è¿è¡Œã€‚</font></p>
<p><strong>pom.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">		 <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tlias-web-management<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>tlias-web-management<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">java.version</span>&gt;</span>11<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--webèµ·æ­¥ä¾èµ–--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--mybatisèµ·æ­¥ä¾èµ–--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--mysqlé©±åŠ¨--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--springbootå•å…ƒæµ‹è¯•--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--PageHelperåˆ†é¡µæ’ä»¶--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">exclude</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="åˆ†é¡µæ¡ä»¶æŸ¥è¯¢"><a href="#åˆ†é¡µæ¡ä»¶æŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæ¡ä»¶æŸ¥è¯¢"></a>åˆ†é¡µæ¡ä»¶æŸ¥è¯¢</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212122859658.png" alt="image-20240212122859658"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212124618865.png" alt="image-20240212124618865"></p>
<h2 id="åˆ é™¤å‘˜å·¥"><a href="#åˆ é™¤å‘˜å·¥" class="headerlink" title="åˆ é™¤å‘˜å·¥"></a>åˆ é™¤å‘˜å·¥</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212132059565.png" alt="image-20240212132059565"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212132905480.png" alt="image-20240212132905480"></p>
<h2 id="æ–°å¢å‘˜å·¥"><a href="#æ–°å¢å‘˜å·¥" class="headerlink" title="æ–°å¢å‘˜å·¥"></a>æ–°å¢å‘˜å·¥</h2><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212145401473.png" alt="image-20240212145401473"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212145955119.png" alt="image-20240212145955119"></p>
<h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><ul>
<li>æ–‡ä»¶ä¸Šä¼ ï¼Œæ˜¯æŒ‡å°†æœ¬åœ°å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œä¾›å…¶ä»–ç”¨æˆ·æµè§ˆæˆ–ä¸‹è½½çš„è¿‡ç¨‹ã€‚</li>
<li>æ–‡ä»¶ä¸Šä¼ åœ¨é¡¹ç›®ä¸­åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæˆ‘ä»¬ç»å¸¸å‘å¾®åšã€å‘å¾®ä¿¡æœ‹å‹åœˆéƒ½ç”¨åˆ°äº†æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€‚</li>
</ul>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212152007551.png" alt="image-20240212152007551"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212153024176.png" alt="image-20240212153024176"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212153040779.png" alt="image-20240212153040779"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212155104185.png" alt="image-20240212155104185"></p>
<h3 id="æœ¬åœ°å­˜å‚¨"><a href="#æœ¬åœ°å­˜å‚¨" class="headerlink" title="æœ¬åœ°å­˜å‚¨"></a>æœ¬åœ°å­˜å‚¨</h3><p>åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ¥æ”¶åˆ°ä¸Šä¼ ä¸Šæ¥çš„æ–‡ä»¶ä¹‹åï¼Œå°†æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°æœåŠ¡å™¨ç£ç›˜ä¸­ã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212160650537.png" alt="image-20240212160650537"></p>
<p>åœ¨Springbootä¸­ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œé»˜è®¤å•ä¸ªæ–‡ä»¶å…è®¸æœ€å¤§å¤§å°ä¸º1Mã€‚å¦‚æœéœ€è¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œå¯ä»¥åœ¨application.propertiesä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å•ä¸ªæ–‡ä»¶æœ€å¤§ä¸Šä¼ å¤§å°</span></span><br><span class="line"><span class="attr">spring.servlet.multipart.max-file-size</span>=<span class="string">10MB</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># é…ç½®å•ä¸ªè¯·æ±‚æœ€å¤§ä¸Šä¼ å¤§å°ï¼ˆä¸€æ¬¡è¯·æ±‚å¯ä»¥ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="attr">spring.servlet.multipart.max-request-size</span>=<span class="string">100MB</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212163506732.png" alt="image-20240212163506732"></p>
<p>multipartfileçš„å¸¸ç”¨åŠŸèƒ½</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212163755305.png" alt="image-20240212163755305"></p>
<h3 id="é˜¿é‡Œäº‘OSS"><a href="#é˜¿é‡Œäº‘OSS" class="headerlink" title="é˜¿é‡Œäº‘OSS"></a>é˜¿é‡Œäº‘OSS</h3><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨OSSï¼ˆObject Storage Serviceï¼‰ï¼Œæ˜¯ä¸€æ¬¾æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚ä½¿ç”¨OSSï¼Œæ‚¨å¯ä»¥é€šè¿‡ç½‘ç»œéšæ—¶å­˜å‚¨å’Œè°ƒç”¨åŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘å’Œè§†é¢‘åœ¨å†…çš„å„ç§æ–‡ä»¶ã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212164038792.png" alt="image-20240212164038792"></p>
<p>ç¬¬ä¸‰æ–¹æœåŠ¡-é€šç”¨æ€è·¯</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212164215124.png" alt="image-20240212164215124"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212164305194.png" alt="image-20240212164305194"></p>
<p>Bucketï¼šå­˜å‚¨ç©ºé—´æ˜¯ç”¨æˆ·ç”¨äºå­˜å‚¨å¯¹è±¡ï¼ˆObjectï¼Œå°±æ˜¯æ–‡ä»¶ï¼‰çš„å®¹å™¨ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½å¿…é¡»éš¶å±äºæŸä¸ªå­˜å‚¨ç©ºé—´ã€‚</p>
<p>SDKï¼šSoftware Development Kitçš„ç¼©å†™ï¼Œè½¯ä»¶å¼€å‘å·¥å…·åŒ…ï¼ŒåŒ…æ‹¬è¾…åŠ©è½¯ä»¶å¼€å‘çš„ä¾èµ–ï¼ˆjaråŒ…ï¼‰,ä»£ç ç¤ºä¾‹ç­‰ï¼Œéƒ½å¯ä»¥å«åšSDKã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212175938569.png" alt="image-20240212175938569"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212180022852.png" alt="image-20240212180022852"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212180106893.png" alt="image-20240212180106893"></p>
<p><a href="https://blog.csdn.net/qq_59621600/article/details/134859770">03_é˜¿é‡Œäº‘_é…ç½®OSSç¯å¢ƒå˜é‡_ä»ç¯å¢ƒå˜é‡ä¸­è·å–è®¿é—®å‡­è¯ã€‚è¿è¡Œæœ¬ä»£ç ç¤ºä¾‹ä¹‹å‰,è¯·ç¡®ä¿å·²è®¾ç½®ç¯å¢ƒå˜é‡oss_access_-CSDNåšå®¢</a></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212180508466.png" alt="image-20240212180508466"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212181243549.png" alt="image-20240212181243549"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212182131820.png" alt="image-20240212182131820"></p>
<h2 id="ä¿®æ”¹å‘˜å·¥"><a href="#ä¿®æ”¹å‘˜å·¥" class="headerlink" title="ä¿®æ”¹å‘˜å·¥"></a>ä¿®æ”¹å‘˜å·¥</h2><h3 id="æŸ¥è¯¢å›æ˜¾"><a href="#æŸ¥è¯¢å›æ˜¾" class="headerlink" title="æŸ¥è¯¢å›æ˜¾"></a>æŸ¥è¯¢å›æ˜¾</h3><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212182543275.png" alt="image-20240212182543275"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212183024576.png" alt="image-20240212183024576"></p>
<h3 id="ä¿®æ”¹å‘˜å·¥-1"><a href="#ä¿®æ”¹å‘˜å·¥-1" class="headerlink" title="ä¿®æ”¹å‘˜å·¥"></a>ä¿®æ”¹å‘˜å·¥</h3><p> <img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212183219286.png" alt="image-20240212183219286"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212183659370.png" alt="image-20240212183659370"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212184349123.png" alt="image-20240212184349123"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212184809216.png" alt="image-20240212184809216"></p>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="å‚æ•°é…ç½®åŒ–"><a href="#å‚æ•°é…ç½®åŒ–" class="headerlink" title="å‚æ•°é…ç½®åŒ–"></a>å‚æ•°é…ç½®åŒ–</h3><p>æ¯æ¬¡æ¶‰åŠåˆ°ç¬¬ä¸‰æ–¹å‚æ•°ï¼Œéƒ½è¦é‡æ–°ç¼–å†™javaä»£ç ï¼Œæ˜¯æ¯”è¾ƒç¹ççš„ã€‚ä¸”ç¬¬ä¸‰æ–¹å‚æ•°åœ¨å„ä¸ªæ–‡ä»¶ä¸­ï¼Œè¦ä¿®æ”¹çš„åœ°æ–¹å¤ªå¤šï¼Œ</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212185212846.png" alt="image-20240212185212846"></p>
<p>pom.xmlæ–‡ä»¶æ˜¯mavenç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œapplication.propertiesæ˜¯springbootçš„é…ç½®æ–‡ä»¶ã€‚å°†ç¬¬ä¸‰æ–¹å‚æ•°é…ç½®åˆ°application.propertiesä¸­ã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212185659858.png" alt="image-20240212185659858"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212185831938.png" alt="image-20240212185831938"></p>
<h3 id="ymlé…ç½®æ–‡ä»¶"><a href="#ymlé…ç½®æ–‡ä»¶" class="headerlink" title="ymlé…ç½®æ–‡ä»¶"></a>ymlé…ç½®æ–‡ä»¶</h3><ul>
<li><p>springbootæä¾›äº†å¤šç§å±æ€§é…ç½®æ–¹å¼</p>
<ul>
<li><p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="attr">server.address</span>=<span class="string">127.0.0.1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application.yml</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">	<span class="string">port:8080</span></span><br><span class="line">	<span class="string">address:127.0.0.1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>application.yaml</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">	<span class="string">port:8080</span></span><br><span class="line">	<span class="string">address:127.0.0.1</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å¸¸è§é…ç½®æ–‡ä»¶æ ¼å¼å¯¹æ¯”</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212190404086.png" alt="image-20240212190404086"></p>
</li>
<li><p>YmlåŸºæœ¬è¯­æ³•</p>
<ul>
<li>å¤§å°å†™æ•æ„Ÿ</li>
<li>æ•°å€¼å‰å¿…é¡»æœ‰ç©ºæ ¼ï¼Œä½œä¸ºåˆ†éš”ç¬¦</li>
<li>ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œç¼©è¿›å¼ï¼Œä¸å…è®¸ä½¿ç”¨Tabé”®ï¼Œåªèƒ½ä½¿ç”¨ç©ºæ ¼ï¼ˆideaä¼šè‡ªåŠ¨å°†Tabè½¬åŒ–ä¸ºç©ºæ ¼ï¼‰</li>
<li>ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦ä¾§å¯¹é½å³å¯</li>
<li>#è¡¨ç¤ºæ³¨é‡Šï¼Œä»è¿™ä¸ªå­—ç¬¦ä¸€ç›´åˆ°è¡Œå°¾ï¼Œéƒ½ä¼šè¢«è§£æå™¨å¿½ç•¥</li>
</ul>
</li>
</ul>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212190610849.png" alt="image-20240212190610849"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212190644684.png" alt="image-20240212190644684"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212191542372.png" alt="image-20240212191542372"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212191559992.png" alt="image-20240212191559992"></p>
<h3 id="ConfigurationProperties"><a href="#ConfigurationProperties" class="headerlink" title="@ConfigurationProperties"></a>@ConfigurationProperties</h3><p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212191836626.png" alt="image-20240212191836626"></p>
<p>é—®é¢˜ï¼šå¾…æ³¨å…¥çš„å±æ€§å€¼è¿‡å¤šã€‚</p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212192057758.png" alt="image-20240212192057758"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212193223494.png" alt="image-20240212193223494"></p>
<p><img src="/2024/02/09/javaweb-day05-springboot%E6%A1%88%E4%BE%8B/image-20240212193244630.png" alt="image-20240212193244630"></p>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day04-mybatis</title>
    <url>/2024/02/08/javaweb-day04-mybatis/</url>
    <content><![CDATA[<h1 id="MyBatisæ¦‚è¿°"><a href="#MyBatisæ¦‚è¿°" class="headerlink" title="MyBatisæ¦‚è¿°"></a>MyBatisæ¦‚è¿°</h1><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208175300104.png" alt="image-20240208175300104"></p>
<p>åœ¨é¡¹ç›®ä¸­é€šè¿‡Javaç¨‹åºæ“ä½œæ•°æ®åº“ï¼Œå…¶ä¸­æœ€ä¸»æµçš„æŠ€æœ¯åˆ™æ˜¯MyBatisã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208175438494.png" alt="image-20240208175438494"></p>
<ul>
<li><font color="red">MyBatisæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œç”¨äºç®€åŒ–JDBCçš„å¼€å‘ã€‚</font></li>
<li>MyBatisåŸæœ¬æ˜¯Apacheçš„ä¸€ä¸ªå¼€æºé¡¹ç›®iBatisï¼Œ2010å¹´è¿™ä¸ªé¡¹ç›®ç”±apacheè¿ç§»åˆ°äº†google codeï¼Œå¹¶ä¸”æ”¹åä¸ºMyBatisã€‚2013å¹´11æœˆè¿ç§»åˆ°Githubã€‚</li>
<li>å®˜ç½‘ï¼š<a href="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a></li>
</ul>
<h1 id="MyBatiså…¥é—¨"><a href="#MyBatiså…¥é—¨" class="headerlink" title="MyBatiså…¥é—¨"></a>MyBatiså…¥é—¨</h1><p>æ¡ˆä¾‹ï¼šä½¿ç”¨MyBatisæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·æ•°æ®</p>
<ol>
<li>å‡†å¤‡å·¥ä½œï¼ˆåˆ›å»ºspringbootå·¥ç¨‹ï¼Œæ•°æ®åº“è¡¨userï¼Œå®ä½“ç±»Userï¼‰</li>
<li>å¼•å…¥Mybatisçš„ç›¸å…³ä¾èµ–ï¼Œé…ç½®Mybatisï¼ˆæ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼‰</li>
<li>ç¼–å†™SQLè¯­å¥ï¼ˆæ³¨è§£&#x2F;XMLï¼‰</li>
</ol>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208180807585.png" alt="image-20240208180807585"></p>
<ol>
<li><p>é…ç½®springbootå·¥ç¨‹çš„ç›¸å…³ä¾èµ–åŒ…ã€‚</p>
</li>
<li><p>åœ¨application.propertiesä¸­è®¾ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€‚</p>
</li>
<li><p>è®¾ç½®æ³¨è§£@Mapperï¼Œä¸ºæ¥å£UserMapperå®šä¹‰æ–¹æ³•list()ï¼Œå†åŠ ä¸Šæ³¨è§£@Selectï¼ŒæŒ‡å®šå½“å‰æ–¹æ³•æ˜¯æŸ¥è¯¢æ“ä½œï¼Œåœ¨æ³¨è§£ä¸­æŒ‡å®šè¦æ‰§è¡Œçš„sqlè¯­å¥ã€‚æœ€ç»ˆåœ¨æ‰§è¡Œsqlè¯­å¥ï¼Œåªéœ€è¦è°ƒç”¨UserMapperä¸­çš„listæ–¹æ³•å³å¯ï¼Œæ­¤æ—¶æ¡†æ¶å°±ä¼šè‡ªåŠ¨æ‰§è¡Œsqlè¯­å¥ï¼Œå¹¶å°†sqlè¯­å¥çš„æ‰§è¡Œç»“æœè¿”å›åˆ°æ–¹æ³•çš„è¿”å›å€¼ä¸­ã€‚</p>
</li>
<li><p>åœ¨Mybatisçš„è®¾è®¡ä¸­ï¼Œåªéœ€è¦è®¾è®¡æ¥å£ï¼Œä¸éœ€è¦å®šä¹‰å®ç°ç±»ï¼Œç¨‹åºè¿è¡Œæ—¶ï¼Œæ¡†æ¶åº•å±‚ä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥å®ç°ç±»å¯¹è±¡ã€‚</p>
</li>
</ol>
<p><strong>å‡†å¤‡å·¥ä½œ</strong></p>
<ol>
<li><p>é…ç½®springbootå·¥ç¨‹åŠç›¸å…³ä¾èµ–åŒ…ã€‚<img src="/2024/02/08/javaweb-day04-mybatis/image-20240208181512518.png" alt="image-20240208181512518"></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208181638813.png" alt="image-20240208181638813"></p>
</li>
<li><p>æ•°æ®åº“è¡¨userçš„å»ºç«‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">    id <span class="type">int</span> unsigned <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">100</span>) comment <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">    age tinyint unsigned comment <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">    gender tinyint unsigned comment <span class="string">&#x27;æ€§åˆ«, 1:ç”·, 2:å¥³&#x27;</span>,</span><br><span class="line">    phone <span class="type">varchar</span>(<span class="number">11</span>) comment <span class="string">&#x27;æ‰‹æœºå·&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;ç™½çœ‰é¹°ç‹&#x27;</span>,<span class="number">55</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;18800000000&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;é‡‘æ¯›ç‹®ç‹&#x27;</span>,<span class="number">45</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;18800000001&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;é’ç¿¼è ç‹&#x27;</span>,<span class="number">38</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;18800000002&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;ç´«è¡«é¾™ç‹&#x27;</span>,<span class="number">42</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;18800000003&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;å…‰æ˜å·¦ä½¿&#x27;</span>,<span class="number">37</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;18800000004&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(id, name, age, gender, phone) <span class="keyword">VALUES</span> (<span class="keyword">null</span>,<span class="string">&#x27;å…‰æ˜å³ä½¿&#x27;</span>,<span class="number">48</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;18800000005&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºå®ä½“ç±»User</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208182232317.png" alt="image-20240208182232317"></p>
<p>åœ¨pojoç›®å½•ä¸‹åˆ›å»ºå®ä½“ç±»</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Short age;</span><br><span class="line">    <span class="keyword">private</span> Short gender;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(Integer id, String name, Short age, Short gender, String phone)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">        <span class="built_in">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">            <span class="string">&quot;, gender=&quot;</span> + gender +</span><br><span class="line">            <span class="string">&quot;, phone=&#x27;&quot;</span> + phone + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Short <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Short age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Short <span class="title function_">getGender</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGender</span><span class="params">(Short gender)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPhone</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> phone;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPhone</span><span class="params">(String phone)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.phone = phone;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨resouresç›®å½•ä¸‹é…ç½®æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"># é…ç½®mybatisçš„æ—¥å¿—ä¿¡æ¯ï¼ŒæŒ‡å®šè¾“å‡ºè‡³æ§åˆ¶å°</span></span><br><span class="line"><span class="attr">mybatis.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™SQLè¯­å¥ï¼ˆæ³¨è§£&#x2F;XMLï¼‰</p>
<p>åœ¨mapperç›®å½•ä¸‹åˆ›å»ºUserMapper</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojp.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span> <span class="comment">//åœ¨è¿è¡Œæ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆè¯¥æ¥å£çš„å®ç°ç±»å¯¹è±¡ï¼ˆä»£ç†å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”å°†è¯¥å¯¹è±¡äº¤ç»™IOCå®¹å™¨ç®¡ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å…¨éƒ¨çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨testç›®å½•çš„æµ‹è¯•ç±»ä¸­æµ‹è¯•ç¼–å†™å¥½çš„ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojp.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span> <span class="comment">//springbootæ•´åˆå•å…ƒæµ‹è¯•çš„æ³¨è§£</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringbootMybatisQuickstartApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span>  UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testListUser</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.list();</span><br><span class="line">        userList.stream().forEach(user-&gt;&#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font color="red">ç”±äºåŠ äº†SpringBootTestçš„æ³¨è§£ï¼Œè¿è¡Œæ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨åŠ è½½æ•´ä¸ªspringbootçš„ç¯å¢ƒï¼Œå¹¶ä¸”åˆ›å»ºspringbootçš„iocå®¹å™¨ï¼Œiocå®¹å™¨åˆ›å»ºä¹‹åï¼Œç”±äºåŠ äº†@Autowiredï¼Œå®ç°äº†ä¾èµ–æ³¨å…¥ï¼Œå› è€ŒuserMapperè‡ªåŠ¨ä»iocå®¹å™¨ä¸­è·å–ç›¸åº”çš„beanå¯¹è±¡ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªbeanå¯¹è±¡å½“ä¸­çš„listæ–¹æ³•ï¼Œè¿›è€Œå®ç°sqlè¯­å¥çš„æŸ¥è¯¢ã€‚</font></p>
</li>
</ol>
<h1 id="é…ç½®SQLæç¤º"><a href="#é…ç½®SQLæç¤º" class="headerlink" title="é…ç½®SQLæç¤º"></a>é…ç½®SQLæç¤º</h1><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208184500656.png" alt="image-20240208184500656"></p>
<p>å­˜åœ¨æŠ¥é”™ä¿¡æ¯</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208184604448.png" alt="image-20240208184604448"></p>
<p>å¥½å¤„ï¼šç¼–å†™çš„sqlè¯­å¥å¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥åœ¨ç¼–ç é˜¶æ®µå°±å‘ç°é—®é¢˜ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶æ‰èƒ½æ˜¾ç¤ºé—®é¢˜ã€‚</p>
<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><ul>
<li><p>JDBCï¼ˆJava DataBase Connectivityï¼‰ï¼Œå°±æ˜¯Javaè¯­è¨€æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ä¸€å¥—APIã€‚</p>
<p>JDBCä»…ä»…å®ç°äº†æ¥å£ï¼Œæ²¡æœ‰å®ç°å…·ä½“çš„å®ç°æœºåˆ¶ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208185018446.png" alt="image-20240208185018446"></p>
</li>
<li><p>JDBC vs MyBatis</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208185543665.png" alt="image-20240208185543665"></p>
<p>MyBatiså•ç‹¬æç‚¼å‡ºè¿æ¥æ•°æ®åº“çš„é…ç½®ï¼ŒåŒæ—¶èŠ‚çœäº†æ•°æ®æŸ¥è¯¢ç»“æœçš„å°è£…è¿‡ç¨‹ï¼Œæ­¤å¤–ï¼Œé‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯å­˜å‚¨è¿æ¥è¿‡ç¨‹ä¸­åˆ›å»ºçš„connectionå¯¹è±¡ï¼ŒèŠ‚çœäº†é¢‘ç¹å¼€é”€å¸¦æ¥çš„æ€§èƒ½æŸå¤±ã€‚</p>
</li>
<li><p>MyBatisçš„å®ç°å…³æ³¨é‡ç‚¹</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208185621056.png" alt="image-20240208185621056"></p>
</li>
</ul>
<h1 id="æ•°æ®åº“è¿æ¥æ± "><a href="#æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="æ•°æ®åº“è¿æ¥æ± "></a>æ•°æ®åº“è¿æ¥æ± </h1><ul>
<li><p>æ•°æ®åº“è¿æ¥æ± æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œè´Ÿè´£åˆ†é…ã€ç®¡ç†æ•°æ®åº“è¿æ¥ï¼ˆConnectionï¼‰</p>
</li>
<li><p>å®ƒå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“å¯¹è±¡ï¼Œè€Œä¸æ˜¯é‡æ–°å»ºç«‹ä¸€ä¸ª</p>
</li>
<li><p>é‡Šæ”¾ç©ºé—´æ—¶é—´è¶…è¿‡æœ€å¤§ç©ºé—²æ—¶é—´çš„é“¾æ¥ï¼Œæ¥é¿å…å› ä¸ºæ²¡æœ‰é‡Šæ”¾è¿æ¥å¼•èµ·çš„æ•°æ®åº“è¿æ¥é—æ¼ï¼ˆå¦‚æœç”¨æˆ·è·å–æ•°æ®åº“å¯¹è±¡ååœ¨ä¸€å®šæ—¶é—´æœªå¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼Œè¶…å‡ºæ—¶é—´åï¼Œè¿æ¥æ± ä¼šæ”¶å›è¯¥å¯¹è±¡ï¼‰</p>
</li>
</ul>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208190243297.png" alt="image-20240208190243297"></p>
<p>ä¼˜åŠ¿</p>
<ul>
<li>èµ„æºé‡ç”¨</li>
<li>æå‡ç³»ç»Ÿå“åº”é€Ÿåº¦</li>
<li>é¿å…æ•°æ®åº“è¿æ¥æ³„éœ²</li>
</ul>
<p>æ ‡å‡†æ¥å£ï¼šDataSource</p>
<ul>
<li><p>å®˜æ–¹ï¼ˆsunï¼‰æä¾›çš„æ•°æ®åº“è¿æ¥æ± æ¥å£ï¼Œç”±ç¬¬ä¸‰æ–¹ç»„ç»‡å®ç°æ­¤æ¥å£ã€‚</p>
</li>
<li><p>åŠŸèƒ½ï¼šè·å–é“¾æ¥ <code>Connection getConnection() throws SQLException;</code></p>
</li>
<li><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208190417420.png" alt="image-20240208190417420"></p>
</li>
<li><p>Druidå’ŒHiKariçš„è¿æ¥æ± éƒ½ä¸é”™</p>
<ul>
<li>Druidè¿æ¥æ± æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„æ•°æ®åº“è¿æ¥æ± é¡¹ç›®</li>
<li>åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½ä¼˜ç§€ï¼Œæ˜¯Javaè¯­è¨€æœ€å¥½çš„æ•°æ®åº“è¿æ¥æ± ä¹‹ä¸€</li>
</ul>
</li>
<li><p>åˆ‡æ¢Druidæ•°æ®åº“è¿æ¥æ± </p>
<p>å®˜æ–¹åœ°å€ï¼š<a href="https://github.com/alibaba/druid/tree/master/druid-spring-boot-starter">https://github.com/alibaba/druid/tree/master/druid-spring-boot-starter</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- pom.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># æŒ‡å®šæ•°æ®æºç±»å‹ä¸ºDruid</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="lombok"><a href="#lombok" class="headerlink" title="lombok"></a>lombok</h1><p>é—®é¢˜ï¼šåŸæœ‰çš„ç±»è¿‡äºè‡ƒè‚¿ï¼Œæ¯ä¸ªå±æ€§éƒ½è¦åˆ›å»ºå¯¹åº”çš„getï¼Œsetæ–¹æ³•ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208193220097.png" alt="image-20240208193220097"></p>
<ul>
<li><p>Lombokæ˜¯ä¸€ä¸ªå®ç”¨çš„Javaç±»åº“ï¼Œèƒ½é€šè¿‡æ³¨è§£çš„å½¢å¼è‡ªåŠ¨ç”Ÿæˆæ„é€ å™¨ã€getter&#x2F;setterã€equalsã€hashcodeã€toStringç­‰æ–¹æ³•ï¼Œå¹¶å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆæ—¥å¿—å˜é‡ï¼Œç®€åŒ–javaå¼€å‘ï¼Œæé«˜æ•ˆç‡ã€‚</p>
<table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>@Getter&#x2F;@Setter</td>
<td>ä¸ºæ‰€æœ‰çš„å±æ€§æä¾›get&#x2F;setæ–¹æ³•</td>
</tr>
<tr>
<td>@ToString</td>
<td>ä¼šä¸ºç±»è‡ªåŠ¨ç”Ÿæˆæ˜“é˜…è¯»çš„toStringæ–¹æ³•</td>
</tr>
<tr>
<td>@EqualsAndHashCode</td>
<td>æ ¹æ®ç±»æ‰€æ‹¥æœ‰çš„éé™æ€å­—æ®µè‡ªåŠ¨é‡å†™equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•</td>
</tr>
<tr>
<td>@Data</td>
<td>æä¾›æ›´ç»¼åˆçš„ç”Ÿæˆä»£ç åŠŸèƒ½ï¼ˆ@Getter+@Setter+@ToString+@EqualsAndHashCodeï¼‰</td>
</tr>
<tr>
<td>@NoArgsConstructor</td>
<td>ä¸ºå®ä½“ç±»ç”Ÿæˆæ— å‚çš„æ„é€ å™¨æ–¹æ³•</td>
</tr>
<tr>
<td>@AllArgsConstructor</td>
<td>ä¸ºå®ä½“ç±»ç”Ÿæˆé™¤äº†staticä¿®é¥°çš„å­—æ®µä¹‹å¤–å¸¦æœ‰å„å‚æ•°çš„æ„é€ å™¨æ–¹æ³•</td>
</tr>
</tbody></table>
</li>
<li><p>å¼•å…¥lambokçš„ä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ä¾‹ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.pojp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Short age;</span><br><span class="line">    <span class="keyword">private</span> Short gender;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><p>lombokåœ¨ç¼–è¯‘æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„javaä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨lombokæ—¶ï¼Œè¿˜éœ€è¦å®‰è£…ä¸€ä¸ªlombokçš„æ’ä»¶ï¼ˆideaè‡ªå¸¦ï¼‰ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208194835391.png" alt="image-20240208194835391"></p>
</li>
</ul>
</li>
</ul>
<h1 id="MybatisåŸºç¡€æ“ä½œ"><a href="#MybatisåŸºç¡€æ“ä½œ" class="headerlink" title="MybatisåŸºç¡€æ“ä½œ"></a>MybatisåŸºç¡€æ“ä½œ</h1><p>å‡†å¤‡å·¥ä½œ</p>
<ul>
<li><p>å‡†å¤‡æ•°æ®åº“è¡¨emp</p>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„springbootå·¥ç¨‹ï¼Œé€‰æ‹©å¼•å…¥å¯¹åº”çš„èµ·æ­¥ä¾èµ–ï¼ˆmybatisã€mysqlã€lombokï¼‰</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208212225283.png" alt="image-20240208212225283"></p>
</li>
<li><p>application.propertiesä¸­å¼•å…¥æ•°æ®åº“è¿æ¥ä¿¡æ¯</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring.datasource.driver-class-name</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.url</span>=<span class="string">jdbc:mysql://localhost:3306/mybatis</span></span><br><span class="line"><span class="attr">spring.datasource.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span>=<span class="string">123456</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># åˆ‡æ¢ä¸ºDruid</span></span><br><span class="line"><span class="attr">spring.datasource.type</span>=<span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ›å»ºå¯¹åº”çš„å®ä½“ç±»Empï¼ˆå®ä½“ç±»å±æ€§é‡‡ç”¨é©¼å³°å‘½åæ³•ï¼‰</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208212425880.png" alt="image-20240208212425880"></p>
</li>
<li><p>å‡†å¤‡Mapperæ¥å£EmpMapper</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208212434113.png" alt="image-20240208212434113"></p>
</li>
</ul>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208214036989.png" alt="image-20240208214036989"></p>
<p>åˆ é™¤æ—¶ç‚¹å‡»åˆ é™¤æŒ‰é’®ï¼Œæœ€ç»ˆä¼šå‘åå°å‘é€è¯¥æ•°æ®å¯¹åº”çš„ä¸»é”®idï¼Œäº¤ç»™åç«¯å¤„ç†ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EmpMapper</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpMapper</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¹æ®IDåˆ é™¤æ•°æ®ï¼ˆè¯¥å‡½æ•°æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œè¿”å›çš„æ˜¯åˆ é™¤æ“ä½œå½±å“çš„è®°å½•æ•°ï¼‰</span></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from emp where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SpringbootMybatisCrudApplicationTests</span></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.EmpMapper;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringbootMybatisCrudApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span>&#123;</span><br><span class="line">        empMapper.delete(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<p>å¦‚æœmapperæ¥å£æ–¹æ³•å½¢å‚åªæœ‰ä¸€ä¸ªæ™®é€šç±»å‹çš„å‚æ•°ï¼Œ#{â€¦}é‡Œé¢çš„å±æ€§åå¯ä»¥éšä¾¿å†™ï¼Œå¦‚ï¼š#{id}ï¼Œ#{value}ã€‚</p>
<p><strong>æ—¥å¿—è¾“å‡º</strong></p>
<ul>
<li><p>å¯ä»¥åœ¨application.propertiesä¸­ï¼Œæ‰“å¼€mybatisçš„æ—¥å¿—ï¼Œå¹¶æŒ‡å®šè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®mybatisçš„æ—¥å¿—ä¿¡æ¯ï¼ŒæŒ‡å®šè¾“å‡ºè‡³æ§åˆ¶å°</span></span><br><span class="line"><span class="attr">mybatis.configuration.log-impl</span>=<span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è¿è¡Œä¹‹åå¾—åˆ°é¢„ç¼–è¯‘SQLæ“ä½œä¿¡æ¯ï¼ˆåœ¨è¿è¡Œå‰ï¼Œåå°†Parameterå†™å…¥Preparingä¸­çš„å‚æ•°ï¼‰</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208215940314.png" alt="image-20240208215940314"></p>
<p>ä½¿ç”¨#{id}ï¼Œä»£è¡¨å ä½ç¬¦ï¼Œæœ€ç»ˆæ‰§è¡Œæ—¶ï¼Œï¼Ÿä¼šç”¨å‚æ•°å ä½ç¬¦çš„å®é™…å†…å®¹16ä»£æ›¿ï¼Œå‘é€åˆ°æ•°æ®åº“æ‰§è¡Œè¯­å¥ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208220029626.png" alt="image-20240208220029626"></p>
</li>
</ul>
<p><strong>MySQLè¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹ | é¢„ç¼–è¯‘SQL</strong></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208220327688.png" alt="image-20240208220327688"></p>
<p>æ™®é€šçš„javaè¯­å¥-&gt;sqlè¯­æ³•è§£ææ£€æŸ¥-&gt;ä¼˜åŒ–SQL-&gt;ç¼–è¯‘sql-&gt;æ‰§è¡Œsql</p>
<p>å…¶ä¸­ï¼Œé¢„ç¼–è¯‘ä¼šå°†â€œsqlè¯­æ³•è§£ææ£€æŸ¥-&gt;ä¼˜åŒ–SQL-&gt;ç¼–è¯‘sqlâ€è¿™å‡ æ­¥<strong>ç¼“å­˜</strong>èµ·æ¥ï¼Œåç»­å¦‚æœæœ‰å¤§é‡çš„SQLè¯­å¥ï¼Œåˆ™ä»<strong>ç¼“å­˜</strong>ä¸­æ‰¾æ˜¯å¦æœ‰å¯¹åº”çš„é¢„ç¼–è¯‘å¥½çš„æŒ‡ä»¤ï¼Œå¦‚æœæœ‰ï¼Œå°±çœç•¥è¿™ä¸‰æ­¥æ“ä½œï¼Œç›´æ¥å»æ‰§è¡ŒSQLè¯­å¥ï¼Œå¦åˆ™ï¼Œéœ€è¦å†æ¬¡æ‰§è¡Œæ“ä½œã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¦æ‰§è¡Œä»¥ä¸‹ä¸‰æ¡è¯­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>åˆ™è¿™ä¸‰æ¡è¯­å¥éƒ½è¦è¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œä¼˜åŒ–ï¼Œç¼–è¯‘ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬å®é™…æ‰§è¡Œçš„æ˜¯</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="operator">=</span> ?;</span><br></pre></td></tr></table></figure>

<p>åˆ™å¯¹åº”çš„åä¸¤æ¡åˆ é™¤è¯­å¥å¯ä»¥ç›´æ¥å°†å‚æ•°å¸¦å…¥ï¼Œç›´æ¥æ‰§è¡ŒSQLè¯­å¥ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208220901168.png" alt="image-20240208220901168"></p>
<p><strong>é˜²æ­¢SQLæ³¨å…¥çš„å…·ä½“ä¾‹å­ï¼š</strong></p>
<ul>
<li><p><strong>SQLæ³¨å…¥</strong>æ˜¯é€šè¿‡æ“ä½œè¾“å…¥çš„æ•°æ®æ¥ä¿®æ”¹å®ç°å®šä¹‰å¥½çš„SQLè¯­å¥ï¼Œä»¥è¾¾åˆ°æ‰§è¡Œä»£ç å¯¹æœåŠ¡å™¨è¿›è¡Œ<strong>æ”»å‡»</strong>çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>ä¾‹å¦‚ ç”¨æˆ·è¾“å…¥çš„æ˜¯â€™waterdanceâ€™ï¼Œpasswordè¾“å…¥çš„æ˜¯ â€˜ or  â€˜1â€™ &#x3D; â€˜1</p>
</li>
<li><p>å‚æ•°å ä½ç¬¦ç±»åˆ«</p>
<table>
<thead>
<tr>
<th>#{â€¦}</th>
<th>${â€¦}</th>
</tr>
</thead>
<tbody><tr>
<td>æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œä¼šå°†#{â€¦}æ›¿æ¢ä¸ºï¼Ÿï¼Œç”Ÿæˆé¢„ç¼–è¯‘çš„SQLï¼Œä¼šè‡ªåŠ¨è®¾ç½®å‚æ•°å€¼</td>
<td>æ‹¼æ¥SQLã€‚ç›´æ¥å°† å‚æ•°æ‹¼æ¥åœ¨SQLè¯­å¥ä¸­ï¼Œå­˜åœ¨SQLæ³¨å…¥é—®é¢˜ã€‚</td>
</tr>
<tr>
<td>ä½¿ç”¨æ—¶æœºï¼šå‚æ•°ä¼ é€’ï¼Œéƒ½ä½¿ç”¨#{}</td>
<td>ä½¿ç”¨æ—¶æœºï¼šå¦‚æœå¯¹è¡¨åã€åˆ—è¡¨è¿›è¡ŒåŠ¨æ€è®¾ç½®æ—¶ä½¿ç”¨ã€‚</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EmpMapper</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Insert(&quot;insert into emp(username, name, gender, image, job, entrydate, dept_id, create_time, update_time)&quot; +</span></span><br><span class="line"><span class="meta">        &quot;values (#&#123;username&#125;, #&#123;name&#125;, #&#123;gender&#125;, #&#123;image&#125;, #&#123;job&#125;, #&#123;entrydate&#125;, #&#123;deptId&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;)&quot;)</span>  # å±æ€§åè¦æ±‚æŒ‰ç…§ç±»è®¾è®¡çš„å±æ€§åæ¥ç¼–å†™</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Emp emp)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SpringbootMybatisCrudApplicationTests</span></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.EmpMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.LocalDateTime.now;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.LocalDateTime.of;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringbootMybatisCrudApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testInsert</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>();</span><br><span class="line">        emp.setUsername(<span class="string">&quot;Jerry&quot;</span>);</span><br><span class="line">        emp.setName(<span class="string">&quot;æ°ç‘&quot;</span>);</span><br><span class="line">        emp.setImage(<span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line">        emp.setGender((<span class="type">short</span>)<span class="number">1</span>);</span><br><span class="line">        emp.setJob((<span class="type">short</span>)<span class="number">1</span>);</span><br><span class="line">        emp.setEntrydate(LocalDate.of(<span class="number">2000</span>,<span class="number">1</span>,<span class="number">1</span>));</span><br><span class="line">        emp.setCreateTime(LocalDateTime.now());</span><br><span class="line">        emp.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        emp.setDeptId(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">insertNum</span> <span class="operator">=</span> empMapper.insert(emp);</span><br><span class="line">        System.out.println(insertNum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208223618549.png" alt="image-20240208223618549"></p>
<p><strong>æ–°å¢ï¼ˆä¸»é”®è¿”å›ï¼‰</strong></p>
<ul>
<li><p>æè¿°ï¼šåœ¨æ•°æ®æ·»åŠ æˆåŠŸåï¼Œéœ€è¦è·å–æ’å…¥æ•°æ®åº“æ•°æ®çš„ä¸»é”®ã€‚</p>
<p>å¦‚ï¼šæ·»åŠ å¥—é¤æ•°æ®æ—¶ï¼Œè¿˜éœ€è¦ç»´æŠ¤å¥—é¤èœå“å…³ç³»è¡¨æ•°æ®ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208223935524.png" alt="image-20240208223935524"></p>
<ul>
<li><p>å®ç°</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208224223342.png" alt="image-20240208224223342"></p>
</li>
</ul>
</li>
</ul>
<p><strong>å°ç»“</strong></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208224506667.png" alt="image-20240208224506667"></p>
<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EmpMapper</span></span><br><span class="line"><span class="keyword">package</span> com.example.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmpMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Update(&quot;update emp set username = #&#123;username&#125;, name = #&#123;name&#125;, gender = #&#123;gender&#125;, image = #&#123;image&#125; ,&quot; +</span></span><br><span class="line"><span class="meta">           &quot; job = #&#123;job&#125;, entrydate = #&#123;entrydate&#125;, dept_id = #&#123;deptId&#125;, update_time = #&#123;updateTime&#125; where id = #&#123;id&#125; &quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Emp emp)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SpringbootMybatisCrudApplicationTests</span></span><br><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.mapper.EmpMapper;</span><br><span class="line"><span class="keyword">import</span> com.example.pojo.Emp;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.LocalDateTime.now;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.time.LocalDateTime.of;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SpringbootMybatisCrudApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> EmpMapper empMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Emp</span>();</span><br><span class="line">        emp.setId(<span class="number">18</span>);</span><br><span class="line">        emp.setUsername(<span class="string">&quot;Jerrysdasdasdasdas2&quot;</span>);</span><br><span class="line">        emp.setName(<span class="string">&quot;æ±¤å§†adasdas&quot;</span>);</span><br><span class="line">        emp.setImage(<span class="string">&quot;1sadasd.jpg&quot;</span>);</span><br><span class="line">        emp.setGender((<span class="type">short</span>) <span class="number">1</span>);</span><br><span class="line">        emp.setJob((<span class="type">short</span>) <span class="number">1</span>);</span><br><span class="line">        emp.setEntrydate(LocalDate.of(<span class="number">2000</span>, <span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">        emp.setUpdateTime(LocalDateTime.now());</span><br><span class="line">        emp.setDeptId(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        empMapper.update(emp);</span><br><span class="line">        System.out.println(emp.getId());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EmpMapper</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Select(&quot;select * from emp where id = #&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Emp <span class="title function_">getById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SpringbootMybatisCrudApplicationTests</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetById</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Emp</span> <span class="variable">emp</span> <span class="operator">=</span> empMapper.getById(<span class="number">1</span>);</span><br><span class="line">    System.out.println(emp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208230825297.png" alt="image-20240208230825297"></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208230900933.png" alt="image-20240208230900933"></p>
<p><font color="red">å…¶ä¸­deptIdï¼ŒcreateTimeï¼ŒupdateTimeå­—æ®µå€¼å‡ä¸ºnullï¼Œæœªæ­£ç¡®å°è£…æ•°æ®å†…å®¹ã€‚</font></p>
<p><font color="red">åŸå› ï¼š</font></p>
<ul>
<li><p><font color="red">å®ä½“ç±»å±æ€§åå’Œæ•°æ®åº“æŸ¥è¯¢è¿”å›çš„å­—æ®µåä¸€è‡´ï¼Œmybatisä¼šè‡ªåŠ¨å°è£…ã€‚</font></p>
</li>
<li><p><font color="red">å¦‚æœå®ä½“ç±»å±æ€§åå’Œæ•°æ®åº“è¡¨æŸ¥è¯¢è¿”å›çš„å­—æ®µåä¸ä¸€æ ·ï¼Œä¸èƒ½è‡ªåŠ¨å°è£…ã€‚</font></p>
</li>
</ul>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208231100003.png" alt="image-20240208231100003"></p>
<ul>
<li><p>ä¸ºäº†è§£å†³å®ä½“ç±»ä¸æ•°æ®åº“è¡¨å‘½åä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æ–¹æ¡ˆã€‚</p>
<ul>
<li><p>æ–¹æ¡ˆä¸€ï¼šç»™å­—æ®µèµ·åˆ«åï¼Œè®©åˆ«åä¸å®ä½“ç±»å±æ€§ä¸€è‡´ï¼ˆä¿®æ”¹empmapperç±»ä¸­çš„selectæ–¹æ³•ï¼‰</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ ¹æ®IDæŸ¥è¯¢å‘˜å·¥</span></span><br><span class="line">   <span class="meta">@Select(&quot;select id, username, password, name, gender, image, job,  entrydate, &quot; +</span></span><br><span class="line"><span class="meta">       &quot; dept_id deptId, create_time createTime, update_time updateTime from emp where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Emp <span class="title function_">getById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–¹æ¡ˆäºŒï¼šé€šè¿‡MyBatis,@Resultæ³¨é‡Šæ‰‹åŠ¨æ˜ å°„å°è£…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Results(&#123;</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;dept_id&quot;,property = &quot;deptId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;update_time&quot;,property = &quot;updateTime&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;create_time&quot;,property = &quot;createTime&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from emp where id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Emp <span class="title function_">getById</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ï¼ˆæ¨èä½¿ç”¨ï¼‰æ–¹æ¡ˆä¸‰</strong>ï¼šå¼€å¯mybatisçš„é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„å¼€å…³ï¼ˆå°†a_columnè¿™æ ·çš„æ•°æ®è¡¨å­—æ®µè‡ªåŠ¨æ˜ å°„åˆ°å®ä½“ç±»çš„å±æ€§aColumnä¸­,è¦ä¸¥æ ¼éµå¾ªæ•°æ®è¡¨å­—æ®µæ˜¯ä¸‹åˆ’çº¿åˆ†å‰²ï¼Œç±»ä¸­çš„å±æ€§åæ˜¯é©¼å³°å‘½åï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/mybatis</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123456</span><br><span class="line"># é…ç½®mybatisçš„æ—¥å¿—ï¼ŒæŒ‡å®šå…¶è¾“å‡ºåˆ°æ§åˆ¶å°</span><br><span class="line">mybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl</span><br><span class="line"></span><br><span class="line"># å¼€å¯mybatisçš„é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„å¼€å…³</span><br><span class="line">mybatis.configuration.map-underscore-to-camel-case=true</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208231533437.png" alt="image-20240208231533437"></p>
</li>
</ul>
</li>
</ul>
<h2 id="æ¡ä»¶æŸ¥è¯¢"><a href="#æ¡ä»¶æŸ¥è¯¢" class="headerlink" title="æ¡ä»¶æŸ¥è¯¢"></a>æ¡ä»¶æŸ¥è¯¢</h2><ul>
<li><p>åœ¨empMapperç±»ä¸­ç¼–å†™æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EmpMapper</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Select(&quot;select * from emp where name like &#x27;%$&#123;name&#125;%&#x27; and gender = #&#123;gender&#125; and &quot; +</span></span><br><span class="line"><span class="meta">        &quot;entrydate between #&#123;begin&#125; and #&#123;end&#125; order by update_time desc ;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">list</span><span class="params">(String name, Short gender, LocalDate begin, LocalDate end)</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨testç±»ä¸­æµ‹è¯•æ¥å£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// SpringbootMybatisCrudApplicationTests</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testList</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Emp&gt; empList = empMapper.list(<span class="string">&quot;å¼ &quot;</span>, (<span class="type">short</span>) <span class="number">1</span>, LocalDate.of(<span class="number">2010</span>, <span class="number">1</span>, <span class="number">1</span>), LocalDate.of(<span class="number">2020</span>, <span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">    System.out.println(empList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208233621106.png" alt="image-20240208233621106"></p>
<p>å› ä¸ºnameä½¿ç”¨çš„æ˜¯${}è€Œä¸æ˜¯#{}ï¼Œå¯èƒ½å­˜åœ¨SQLæ³¨å…¥é—®é¢˜ã€‚è§£å†³åŠæ³•ï¼šempMapperç±»ä¸­ç¼–å†™çš„æ¥å£ä½¿ç”¨mysqlçš„concatå‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ¡ä»¶æŸ¥è¯¢å‘˜å·¥</span></span><br><span class="line"><span class="meta">@Select(&quot;select * from emp where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;) and gender = #&#123;gender&#125; and &quot; +</span></span><br><span class="line"><span class="meta">        &quot;entrydate between #&#123;begin&#125; and #&#123;end&#125; order by update_time desc ;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title function_">list</span><span class="params">(String name, Short gender, LocalDate begin, LocalDate end)</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208233536664.png" alt="image-20240208233536664"></p>
</li>
</ul>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208233800310.png" alt="image-20240208233800310"></p>
<p>springbootçš„1.xç‰ˆæœ¬å’Œ2.xç‰ˆæœ¬çš„å‚æ•°è®¾ç½®æœ‰ä¸€ç‚¹åŒºåˆ«ï¼ŒåŒºåˆ«å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240208234015102.png" alt="image-20240208234015102"></p>
<h1 id="XMLæ˜ å°„æ–‡ä»¶"><a href="#XMLæ˜ å°„æ–‡ä»¶" class="headerlink" title="XMLæ˜ å°„æ–‡ä»¶"></a>XMLæ˜ å°„æ–‡ä»¶</h1><p>ä¹‹å‰çš„æ–¹å¼æ˜¯é€šè¿‡æ³¨è§£çš„æ–¹å¼é…ç½®sqlè¯­å¥ï¼Œè¿™æ˜¯é€šè¿‡xmlæ¥é…ç½®sqlè¯­å¥ã€‚</p>
<ul>
<li><strong>å®é™…å¼€å‘æ—¶ï¼Œé€‰æ‹©æ³¨è§£æ¥æ˜ å°„ç®€å•è¯­å¥ï¼Œå¦‚æœéœ€è¦å®ç°å¤æ‚çš„SQLåŠŸèƒ½ï¼Œè¿˜æ˜¯è¦é€šè¿‡xmlæ¥å®Œæˆã€‚</strong></li>
</ul>
<h2 id="è§„èŒƒ"><a href="#è§„èŒƒ" class="headerlink" title="è§„èŒƒ"></a>è§„èŒƒ</h2><ul>
<li><p>XMLæ˜ å°„æ–‡ä»¶çš„åç§°ä¸Mapperæ¥å£åç§°ä¸€è‡´ï¼Œå¹¶ä¸”å°†XMLæ˜ å°„æ–‡ä»¶å’ŒMapperæ¥å£æ”¾ç½®åœ¨<strong>ç›¸åŒåŒ…</strong>ä¸‹(åŒåŒ…åŒå)ã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209120818270.png" alt="image-20240209120818270"></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209122155859.png" alt="image-20240209122155859"></p>
</li>
<li><p>XMLæ˜ å°„æ–‡ä»¶çš„namespaceå±æ€§ä¸Mapperæ¥å£<strong>å…¨é™å®šå</strong>ä¸€è‡´ã€‚resultTypeå±æ€§è¦å¡«å†™çš„å•æ¡è®°å½•è¦å°è£…çš„ç±»å‹çš„<strong>å…¨é™å®šå</strong>ã€‚ï¼ˆä¸‹å›¾ä¸­EmpMapperä¸namespaceä¸­çš„å†…å®¹ä¸€è‡´ï¼‰</p>
</li>
<li><p>XMLæ˜ å°„æ–‡ä»¶ä¸­sqlè¯­å¥çš„idä¸Mapperæ¥å£ä¸­çš„æ–¹æ³•åä¸€è‡´ï¼Œå¹¶ä¿æŒè¿”å›ç±»å‹ä¸€è‡´ã€‚ï¼ˆä¸‹å›¾ä¸­æ–¹æ³•ålistä¸idçš„å†…å®¹ä¸€è‡´ï¼ŒresultTypeæ˜¯å•æ¡è®°å½•å°è£…çš„ç±»å‹çš„å…¨ç±»åï¼‰</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209120946411.png" alt="image-20240209120946411"></p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209122759826.png" alt="image-20240209122759826"></p>
</li>
<li><p>ä¾‹å­ï¼š</p>
</li>
</ul>
<p>åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºä¸EmpMapperæƒ³é€šåŒ…çš„æ–‡ä»¶EmpMapper.xmlï¼Œå…¶ä¸­çš„é…ç½®å¦‚ä¸‹æ‰€ç¤º</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.pojo.Emp&quot;</span>&gt;</span></span><br><span class="line">        select * from emp where name like concat(&#x27;%&#x27;,#&#123;name&#125;,&#x27;%&#x27;) and gender = #&#123;gender&#125; and  + entrydate between #&#123;begin&#125; and #&#123;end&#125; order by update_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæˆ‘ä»¬æŒ‰ç…§è¿™ä¸‰ç‚¹è§„èŒƒå®šä¹‰äº†XMLæ˜ å°„æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬åœ¨è°ƒç”¨EmpMapperçš„listæ–¹æ³•æ—¶ï¼ŒMyBatiså°±ä¼šè‡ªåŠ¨æŸ¥æ‰¾namespaceå±æ€§å€¼ä¸è¿™ä¸ªæ¥å£å…¨ç±»åçš„ç›¸åŒçš„XMLæ˜ å°„æ–‡ä»¶ï¼Œå¹¶åœ¨XMLæ˜ å°„æ–‡ä»¶ä¸­æ‰¾åˆ°idå±æ€§å€¼ä¸æ–¹æ³•åç›¸åŒçš„è¿™æ¡sqlè¯­å¥ï¼Œæœ€ç»ˆè¿è¡Œsqlè¯­å¥ï¼Œä»è€Œå®Œæˆæ•°æ®åº“çš„æ“ä½œã€‚</p>
<ul>
<li>å®‰è£…mybatisXæ’ä»¶ï¼Œmapperç±»ä¼šå’Œå¯¹åº”çš„xmlå»ºç«‹è¿æ¥ã€‚</li>
</ul>
<h1 id="MyBatisåŠ¨æ€SQL"><a href="#MyBatisåŠ¨æ€SQL" class="headerlink" title="MyBatisåŠ¨æ€SQL"></a>MyBatisåŠ¨æ€SQL</h1><p><strong>åŠ¨æ€SQL</strong></p>
<p>éšç€ç”¨æˆ·çš„è¾“å…¥æˆ–å¤–éƒ¨æ¡ä»¶çš„å˜åŒ–è€Œå˜åŒ–çš„SQLè¯­å¥ï¼Œæˆ‘ä»¬ç§°ä¸ºåŠ¨æ€SQLã€‚</p>
<p> <img src="/2024/02/08/javaweb-day04-mybatis/image-20240209132846618.png" alt="image-20240209132846618"></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬è®¾å®šæ­»äº†è¦æ±‚è¾“å…¥ä¸‰ä¸ªå‚æ•°æ¥è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ã€‚å…¶å®åŠŸèƒ½è¦æ³›åŒ–ï¼Œå®ç°å•ä¸ªæˆ–è€…ä»»æ„ä¸¤ä¸ªå‚æ•°ä¹Ÿèƒ½å®ç°ç›¸åº”çš„æŸ¥è¯¢ç»“æœã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209133959066.png" alt="image-20240209133959066"></p>
<h2 id="if-where-set"><a href="#if-where-set" class="headerlink" title="if | where | set"></a>if | where | set</h2><ul>
<li><p>&lt;if&gt;ï¼šç”¨äºåˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚ä½¿ç”¨testå±æ€§è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœæ¡ä»¶ä¸ºtrueï¼Œåˆ™æ‹¼æ¥SQLã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- EmpMapper.xml --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.pojo.Emp&quot;</span>&gt;</span></span><br><span class="line">        select *</span><br><span class="line">        from emp</span><br><span class="line">        where</span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> =<span class="string">&quot;name != null&quot;</span>&gt;</span></span><br><span class="line">                name like concat(&quot;%&quot;,#&#123;name&#125;,&quot;%&quot;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gender != null&quot;</span>&gt;</span></span><br><span class="line">                and gender = #&#123;gender&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;begin != null and end != null&quot;</span>&gt;</span></span><br><span class="line">                and entrydate between #&#123;begin&#125; and #&#123;end&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        order by update_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ‰bugï¼Œå½“nameå±æ€§çš„å€¼ä¸ºnullæ—¶ï¼Œä¼šæŠ¥é”™ã€‚æ”¹è¿›æªæ–½ï¼ŒåŠ ä¸Š&lt;where&gt;æ ‡ç­¾</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- EmpMapper.xml --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.pojo.Emp&quot;</span>&gt;</span></span><br><span class="line">        select *</span><br><span class="line">        from emp</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> =<span class="string">&quot;name != null&quot;</span>&gt;</span></span><br><span class="line">                name like concat(&quot;%&quot;,#&#123;name&#125;,&quot;%&quot;)</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;gender != null&quot;</span>&gt;</span></span><br><span class="line">                and gender = #&#123;gender&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;begin != null and end != null&quot;</span>&gt;</span></span><br><span class="line">                and entrydate between #&#123;begin&#125; and #&#123;end&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by update_time desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>&lt;where&gt;ï¼šæ ¹æ®whereä¸­çš„å­æ ‡ç­¾åˆ¤æ–­æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸æˆç«‹ï¼Œå°±ä¸ä¼šç”Ÿäº§whereå­å¥ï¼Œå¦åˆ™ä¼šç”Ÿæˆwhereå­å¥ï¼Œè€Œä¸”ä¼šè‡ªåŠ¨å»é™¤å­å¥çš„å¼€å¤´çš„ANDæˆ–è€…ORã€‚</p>
<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209135153909.png" alt="image-20240209135153909"></p>
</li>
<li><p>&lt;set&gt;ï¼šåŠ¨æ€åœ¨è¡Œé¦–æ’å…¥setå…³é”®å­—ï¼Œå¹¶ä¼šåˆ é™¤æ‰é¢å¤–çš„é€—å·ã€‚ï¼ˆç”¨åœ¨updateè¯­å¥ä¸­ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- EmpMapper.xml --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update2&quot;</span>&gt;</span></span><br><span class="line">        update emp</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;username != null&quot;</span>&gt;</span> username = #&#123;username&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;name != null&quot;</span>&gt;</span> name        = #&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;gender != null&quot;</span>&gt;</span> gender      = #&#123;gender&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;image != null&quot;</span>&gt;</span> image       = #&#123;image&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;job != null&quot;</span>&gt;</span>job         = #&#123;job&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;entrydate != null&quot;</span>&gt;</span>entrydate   = #&#123;entrydate&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;deptId != null&quot;</span>&gt;</span>dept_id     = #&#123;deptId&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span> = <span class="string">&quot;updateTime != null&quot;</span>&gt;</span>update_time = #&#123;updateTime&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209142712475.png" alt="image-20240209142712475"></p>
</li>
</ul>
<h2 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h2><p><strong>sqlè¯­å¥</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> emp <span class="keyword">where</span> id <span class="keyword">in</span>(<span class="number">20</span>,<span class="number">22</span>,<span class="number">23</span>);</span><br></pre></td></tr></table></figure>

<p><strong>æ¥å£æ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDeleteByIds</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;Integer&gt;  ids = Arrays.asList(<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>);</span><br><span class="line">    empMapper.deleteByIds(ids);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>XMLæ˜ å°„æ–‡ä»¶</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.EmpMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- æ‰¹é‡åˆ é™¤æ ‡ç­¾ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        collection : éå†çš„é›†åˆ</span></span><br><span class="line"><span class="comment">        item:éå†å‡ºæ¥çš„å…ƒç´ </span></span><br><span class="line"><span class="comment">        seperator:åˆ†éš”ç¬¦</span></span><br><span class="line"><span class="comment">        open:éå†å¼€å§‹æ‹¼æ¥çš„SQLç‰‡æ®µ</span></span><br><span class="line"><span class="comment">        close:éå†ç»“æŸæ‹¼æ¥çš„SQLç‰‡æ®µ</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteByIds&quot;</span>&gt;</span></span><br><span class="line">        delete from emp where id in</span><br><span class="line">        <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">            #&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209144453692.png" alt="image-20240209144453692"></p>
<h2 id="sql-include"><a href="#sql-include" class="headerlink" title="sql | include"></a>sql | include</h2><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209144709292.png" alt="image-20240209144709292"></p>
<p>é—®é¢˜ï¼š</p>
<ul>
<li><p>åœ¨æ˜ å°„é…ç½®æ–‡ä»¶ä¸­selectéƒ¨åˆ†å­˜åœ¨å¤§é‡é‡å¤å­—æ®µï¼Œå¦‚æœä¿®æ”¹äº†æ•°æ®è¡¨ä¸­çš„å­—æ®µåï¼Œæ˜ å°„é…ç½®æ–‡ä»¶xmlä¸­è¦ä¿®æ”¹éƒ¨åˆ†å¤ªå¤šï¼Œä»£ç å¤ç”¨æ€§è¾ƒå·®ã€‚javaå®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå°†é‡å¤éƒ¨åˆ†çš„ä»£ç å°è£…åˆ°æ–¹æ³•ä¸­ï¼Œå“ªé‡Œéœ€è¦å°±è°ƒç”¨è¿™ä¸ªæ–¹æ³•å³å¯ã€‚</p>
</li>
<li><p>å®ç°æœºåˆ¶ï¼Œç”¨sqlæ ‡ç­¾æŠ½å–é‡å¤ç‰‡æ®µï¼Œç»™sqlåˆ†é…å”¯ä¸€æ ‡è¯†ï¼ˆå®šä¹‰idå±æ€§ï¼‰ï¼Œincludeæ ‡ç­¾å¼•å…¥sqlç‰‡æ®µï¼Œç”¨refidæŒ‡å®šå¼•ç”¨ç‰‡æ®µã€‚</p>
<ul>
<li>sqlï¼šå®šä¹‰å¯é‡ç”¨çš„SQLç‰‡æ®µã€‚</li>
<li>include:é€šè¿‡å±æ€§refidï¼ŒæŒ‡å®šåŒ…å«çš„sqlç‰‡æ®µã€‚</li>
</ul>
</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><img src="/2024/02/08/javaweb-day04-mybatis/image-20240209145633455.png" alt="image-20240209145633455"></p>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
      <tags>
        <tag>mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title>javaweb-day03-mysql</title>
    <url>/2024/02/06/javaweb-day03-mysql/</url>
    <content><![CDATA[<p>ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ</p>
<ul>
<li><p>æ•°æ®åº“ï¼šDataBaseï¼ˆDBï¼‰ï¼Œæ˜¯å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ã€‚</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206125606781.png" alt="image-20240206125606781"></p>
</li>
<li><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼šDataBase Management System(DBMS)ï¼Œæ“çºµå’Œç®¡ç†æ•°æ®åº“çš„å¤§å‹è½¯ä»¶ã€‚</p>
</li>
<li><p>SQLï¼šStructured Query Languageï¼Œæ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®šä¹‰äº†ä¸€å¥—æ“ä½œå…³ç³»å‹æ•°æ®åº“ç»Ÿä¸€æ ‡å‡†ã€‚</p>
</li>
</ul>
<p>æ•°æ®åº“äº§å“</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206130010075.png" alt="image-20240206130010075"></p>
<h1 id="MySQLæ¦‚è¿°"><a href="#MySQLæ¦‚è¿°" class="headerlink" title="MySQLæ¦‚è¿°"></a>MySQLæ¦‚è¿°</h1><h2 id="å®‰è£…ã€é…ç½®"><a href="#å®‰è£…ã€é…ç½®" class="headerlink" title="å®‰è£…ã€é…ç½®"></a>å®‰è£…ã€é…ç½®</h2><h2 id="ä¸€ã€ä¸‹è½½"><a href="#ä¸€ã€ä¸‹è½½" class="headerlink" title="ä¸€ã€ä¸‹è½½"></a>ä¸€ã€ä¸‹è½½</h2><p>ç‚¹å¼€ä¸‹é¢çš„é“¾æ¥ï¼š<a href="https://dev.mysql.com/downloads/mysql/">https://dev.mysql.com/downloads/mysql/</a></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20221020012302873.png" alt="image-20221020012302873"> </p>
<p>ç‚¹å‡»Download å°±å¯ä»¥ä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…äº†, å®‰è£…åŒ…å¦‚ä¸‹: <img src="/2024/02/06/javaweb-day03-mysql/image-20221020012428839.png" alt="image-20221020012428839">  </p>
<h2 id="äºŒã€è§£å‹"><a href="#äºŒã€è§£å‹" class="headerlink" title="äºŒã€è§£å‹"></a>äºŒã€è§£å‹</h2><p>ä¸‹è½½å®Œæˆåæˆ‘ä»¬å¾—åˆ°çš„æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå°†å…¶è§£å‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°MySQL 8.0.31 çš„è½¯ä»¶æœ¬ä½“äº†(å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹)ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åœ¨ä½ æƒ³å®‰è£…çš„ä½ç½® ã€‚</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20221020013011737.png" alt="image-20221020013011737"> </p>
<h2 id="ä¸‰ã€é…ç½®"><a href="#ä¸‰ã€é…ç½®" class="headerlink" title="ä¸‰ã€é…ç½®"></a>ä¸‰ã€é…ç½®</h2><h3 id="1-æ·»åŠ ç¯å¢ƒå˜é‡"><a href="#1-æ·»åŠ ç¯å¢ƒå˜é‡" class="headerlink" title="1. æ·»åŠ ç¯å¢ƒå˜é‡"></a>1. æ·»åŠ ç¯å¢ƒå˜é‡</h3><blockquote>
<p>ç¯å¢ƒå˜é‡é‡Œé¢æœ‰å¾ˆå¤šé€‰é¡¹ï¼Œè¿™é‡Œæˆ‘ä»¬åªç”¨åˆ°<code>Path</code>è¿™ä¸ªå‚æ•°ã€‚ä¸ºä»€ä¹ˆåœ¨åˆå§‹åŒ–çš„å¼€å§‹è¦æ·»åŠ ç¯å¢ƒå˜é‡å‘¢ï¼Ÿ</p>
<p>åœ¨é»‘æ¡†(å³CMD)ä¸­è¾“å…¥ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºçš„åå­—ï¼ŒWindowsä¼šå…ˆåœ¨ç¯å¢ƒå˜é‡ä¸­çš„<code>Path</code>æ‰€æŒ‡çš„è·¯å¾„ä¸­å¯»æ‰¾ä¸€éï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ç›´æ¥æ‰§è¡Œï¼Œæ²¡æ‰¾åˆ°å°±åœ¨å½“å‰å·¥ä½œç›®å½•æ‰¾ï¼Œå¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼Œå°±æŠ¥é”™ã€‚æˆ‘ä»¬æ·»åŠ ç¯å¢ƒå˜é‡çš„ç›®çš„å°±æ˜¯èƒ½å¤Ÿåœ¨ä»»æ„ä¸€ä¸ªé»‘æ¡†ç›´æ¥è°ƒç”¨MySQLä¸­çš„ç›¸å…³ç¨‹åºè€Œä¸ç”¨æ€»æ˜¯ä¿®æ”¹å·¥ä½œç›®å½•ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œã€‚</p>
</blockquote>
<p>å³é”®<code>æ­¤ç”µè„‘</code>â†’<code>å±æ€§</code>ï¼Œç‚¹å‡»<code>é«˜çº§ç³»ç»Ÿè®¾ç½®</code></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181220220242472-524708778.png" alt="img"> </p>
<p>ç‚¹å‡»<code>ç¯å¢ƒå˜é‡</code></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181220220359609-736422950.png" alt="img"> </p>
<p>åœ¨<code>ç³»ç»Ÿå˜é‡</code>ä¸­æ–°å»ºMYSQL_HOME</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20221020013128323.png" alt="image-20221020013128323">  </p>
<p>åœ¨<code>ç³»ç»Ÿå˜é‡</code>ä¸­æ‰¾åˆ°å¹¶<strong>åŒå‡»</strong><code>Path</code></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181220220551145-1198958872.png" alt="img"> </p>
<p>ç‚¹å‡»<code>æ–°å»º</code></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20201109135248104.png" alt="image-20201109135248104"> </p>
<p>æœ€åç‚¹å‡»ç¡®å®šã€‚</p>
<p><strong>å¦‚ä½•éªŒè¯æ˜¯å¦æ·»åŠ æˆåŠŸï¼Ÿ</strong></p>
<p>å³é”®å¼€å§‹èœå•(å°±æ˜¯å±å¹•å·¦ä¸‹è§’)ï¼Œé€‰æ‹©<code>å‘½ä»¤æç¤ºç¬¦(ç®¡ç†å‘˜)</code>ï¼Œæ‰“å¼€é»‘æ¡†ï¼Œæ•²å…¥<code>mysql</code>ï¼Œå›è½¦ã€‚</p>
<img src="/2024/02/06/javaweb-day03-mysql/image-20221020013302450.png" alt="image-20221020013302450" style="zoom:67%;"> 

<p>å¦‚æœæç¤º<code>Can&#39;t connect to MySQL server on &#39;localhost&#39;</code>åˆ™è¯æ˜æ·»åŠ æˆåŠŸï¼›</p>
<img src="/2024/02/06/javaweb-day03-mysql/image-20221020013335596.png" alt="image-20221020013335596" style="zoom:80%;"> 

<p>å¦‚æœæç¤º<code>mysqlä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åºæˆ–æ‰¹å¤„ç†æ–‡ä»¶</code>åˆ™è¡¨ç¤ºæ·»åŠ æ·»åŠ å¤±è´¥ï¼Œè¯·é‡æ–°æ£€æŸ¥æ­¥éª¤å¹¶é‡è¯•ã€‚</p>
<h3 id="2-åˆå§‹åŒ–MySQL"><a href="#2-åˆå§‹åŒ–MySQL" class="headerlink" title="2. åˆå§‹åŒ–MySQL"></a>2. åˆå§‹åŒ–MySQL</h3><p>&#x3D;&#x3D;ä»¥ç®¡ç†å‘˜èº«ä»½ï¼Œè¿è¡Œå‘½ä»¤è¡Œçª—å£ï¼š&#x3D;&#x3D;</p>
<img src="/2024/02/06/javaweb-day03-mysql/image-20220518172922780.png" alt="image-20220518172922780" style="zoom: 80%;">

<p>åœ¨åˆšæ‰çš„å‘½ä»¤è¡Œä¸­ï¼Œè¾“å…¥å¦‚ä¸‹çš„æŒ‡ä»¤ï¼š </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqld --initialize-insecure</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/image-20201109140955772.png" alt="image-20201109140955772"> </p>
<p>ç¨å¾®ç­‰å¾…ä¸€ä¼šï¼Œå¦‚æœå‡ºç°æ²¡æœ‰å‡ºç°æŠ¥é”™ä¿¡æ¯ï¼Œåˆ™è¯æ˜dataç›®å½•åˆå§‹åŒ–æ²¡æœ‰é—®é¢˜ï¼Œæ­¤æ—¶å†æŸ¥çœ‹MySQLç›®å½•ä¸‹å·²ç»æœ‰dataç›®å½•ç”Ÿæˆã€‚</p>
<p>tipsï¼šå¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20201109135848054.png" alt="image-20201109135848054"> </p>
<p>æ˜¯ç”±äºæƒé™ä¸è¶³å¯¼è‡´çš„ï¼Œä»¥ç®¡ç†å‘˜æ–¹å¼è¿è¡Œ cmd</p>
<img src="/2024/02/06/javaweb-day03-mysql/image-20220518172922780.png" alt="image-20220518172922780" style="zoom: 80%;"> 

<h3 id="3-æ³¨å†ŒMySQLæœåŠ¡"><a href="#3-æ³¨å†ŒMySQLæœåŠ¡" class="headerlink" title="3. æ³¨å†ŒMySQLæœåŠ¡"></a>3. æ³¨å†ŒMySQLæœåŠ¡</h3><p>å‘½ä»¤è¡Œï¼ˆæ³¨æ„å¿…é¡»ä»¥ç®¡ç†å‘˜èº«ä»½å¯åŠ¨ï¼‰ä¸­ï¼Œè¾“å…¥å¦‚ä¸‹çš„æŒ‡ä»¤ï¼Œå›è½¦æ‰§è¡Œï¼š </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqld -install</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/image-20201109141325810.png" alt="image-20201109141325810"> </p>
<p>ç°åœ¨ä½ çš„è®¡ç®—æœºä¸Šå·²ç»å®‰è£…å¥½äº†MySQLæœåŠ¡äº†ã€‚</p>
<h3 id="4-å¯åŠ¨MySQLæœåŠ¡"><a href="#4-å¯åŠ¨MySQLæœåŠ¡" class="headerlink" title="4. å¯åŠ¨MySQLæœåŠ¡"></a>4. å¯åŠ¨MySQLæœåŠ¡</h3><p>åœ¨é»‘æ¡†é‡Œæ•²å…¥<code>net start mysql</code>ï¼Œå›è½¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">net start mysql  <span class="comment">// å¯åŠ¨mysqlæœåŠ¡</span></span><br><span class="line">    </span><br><span class="line">net stop mysql  <span class="comment">// åœæ­¢mysqlæœåŠ¡</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/image-20220518183747072.png" alt="image-20220518183747072"> </p>
<h3 id="5-ä¿®æ”¹é»˜è®¤è´¦æˆ·å¯†ç "><a href="#5-ä¿®æ”¹é»˜è®¤è´¦æˆ·å¯†ç " class="headerlink" title="5. ä¿®æ”¹é»˜è®¤è´¦æˆ·å¯†ç "></a>5. ä¿®æ”¹é»˜è®¤è´¦æˆ·å¯†ç </h3><p>åœ¨é»‘æ¡†é‡Œæ•²å…¥<code>mysqladmin -u root password 1234</code>ï¼Œè¿™é‡Œçš„<code>1234</code>å°±æ˜¯æŒ‡é»˜è®¤ç®¡ç†å‘˜(å³rootè´¦æˆ·)çš„å¯†ç ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹æˆä½ å–œæ¬¢çš„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqladmin -u root password 1234</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181221093251250-819416425.png" alt="img"> </p>
<h2 id="å››ã€ç™»å½•MySQL"><a href="#å››ã€ç™»å½•MySQL" class="headerlink" title="å››ã€ç™»å½•MySQL"></a>å››ã€ç™»å½•MySQL</h2><p>å³é”®å¼€å§‹èœå•ï¼Œé€‰æ‹©<code>å‘½ä»¤æç¤ºç¬¦</code>ï¼Œæ‰“å¼€é»‘æ¡†ã€‚<br>åœ¨é»‘æ¡†ä¸­è¾“å…¥ï¼Œ<code>mysql -uroot -p1234</code>ï¼Œå›è½¦ï¼Œå‡ºç°ä¸‹å›¾ä¸”å·¦ä¸‹è§’ä¸º<code>mysql&gt;</code>ï¼Œåˆ™ç™»å½•æˆåŠŸã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p1234</span><br></pre></td></tr></table></figure>

<img src="/2024/02/06/javaweb-day03-mysql/image-20221020013540957.png" alt="image-20221020013540957" style="zoom:80%;">   

<p><strong>åˆ°è¿™é‡Œä½ å°±å¯ä»¥å¼€å§‹ä½ çš„MySQLä¹‹æ—…äº†ï¼</strong></p>
<p>é€€å‡ºmysqlï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exit</span><br><span class="line">quit</span><br></pre></td></tr></table></figure>

<p>ç™»é™†å‚æ•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uç”¨æˆ·å -på¯†ç  -hè¦è¿æ¥çš„mysqlæœåŠ¡å™¨çš„ipåœ°å€(é»˜è®¤127.0.0.1) -Pç«¯å£å·(é»˜è®¤3306)</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€å¸è½½MySQL"><a href="#äº”ã€å¸è½½MySQL" class="headerlink" title="äº”ã€å¸è½½MySQL"></a>äº”ã€å¸è½½MySQL</h2><p>å¦‚æœä½ æƒ³å¸è½½MySQLï¼Œä¹Ÿå¾ˆç®€å•ã€‚</p>
<p>ç‚¹å‡»å¼€å§‹èœå•ï¼Œè¾“å…¥cmdï¼Œé€‰æ‹© â€œå‘½ä»¤æç¤ºç¬¦â€ï¼Œé€‰æ‹©å³ä¾§çš„ â€œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œâ€ã€‚</p>
<img src="/2024/02/06/javaweb-day03-mysql/image-20220611083741275.png" alt="image-20220611083741275" style="zoom:80%;"> 

<ol>
<li>æ•²å…¥<code>net stop mysql</code>ï¼Œå›è½¦ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net stop mysql</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181220222924783-57600848.png" alt=" "> </p>
<ol start="2">
<li>å†æ•²å…¥<code>mysqld -remove mysql</code>ï¼Œå›è½¦ã€‚</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysqld -remove mysql</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/1556823-20181220223025128-587235464.png" alt="img"> </p>
<ol start="3">
<li>æœ€ååˆ é™¤MySQLç›®å½•åŠç›¸å…³çš„ç¯å¢ƒå˜é‡ã€‚</li>
</ol>
<p><strong>è‡³æ­¤ï¼ŒMySQLå¸è½½å®Œæˆï¼</strong></p>
<h2 id="æ•°æ®æ¨¡å‹"><a href="#æ•°æ®æ¨¡å‹" class="headerlink" title="æ•°æ®æ¨¡å‹"></a>æ•°æ®æ¨¡å‹</h2><ul>
<li><p>å…³ç³»å‹æ•°æ®åº“ï¼ˆRDBMSï¼‰ï¼šå»ºç«‹åœ¨å…³ç³»æ¨¡å‹åŸºç¡€ä¸Šï¼Œç”±å¤šå¼ ç›¸äº’è¿æ¥çš„äºŒç»´è¡¨ç»„æˆçš„æ•°æ®åº“ã€‚</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä½¿ç”¨è¡¨å­˜å‚¨æ•°æ®ï¼Œæ ¼å¼ç»Ÿä¸€ï¼Œä¾¿äºç»´æŠ¤</li>
<li>ä½¿ç”¨SQLè¯­è¨€æ“ä½œï¼Œæ ‡å‡†ç»Ÿä¸€ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œå¯ä»¥ç”¨å¤æ‚æŸ¥è¯¢</li>
</ul>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206131607795.png" alt="image-20240206131607795"></p>
</li>
</ul>
<h2 id="SQLä»‹ç»"><a href="#SQLä»‹ç»" class="headerlink" title="SQLä»‹ç»"></a>SQLä»‹ç»</h2><ul>
<li><p>SQLï¼šä¸€é—¨æ“ä½œå…³ç³»å‹æ•°æ®åº“çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®šä¹‰æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„ç»Ÿä¸€æ ‡å‡†ã€‚</p>
<table>
<thead>
<tr>
<th>SQLè¯­å¥å¯ä»¥å•è¡Œæˆ–è€…å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ã€‚</th>
<th>show databases;</th>
</tr>
</thead>
<tbody><tr>
<td>SQLè¯­å¥å¯ä»¥ä½¿ç”¨ç©ºæ ¼&#x2F;ç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ã€‚</td>
<td>show  databases;</td>
</tr>
<tr>
<td>MySQLæ•°æ®åº“çš„SQLè¯­å¥ä¸åŒºåˆ†å¤§å°å†™ã€‚</td>
<td>SHOW DATABASES;</td>
</tr>
<tr>
<td>æ³¨é‡Šï¼š å•è¡Œæ³¨é‡Šï¼šâ€“ æ³¨é‡Šå†…å®¹ æˆ– # æ³¨é‡Šå†…å®¹ï¼ˆMySQLç‰¹æœ‰ï¼‰</td>
<td>â€“show databases;</td>
</tr>
<tr>
<td>å¤šè¡Œæ³¨é‡Šï¼š&#x2F;* æ³¨é‡Šå†…å®¹ *&#x2F;</td>
<td>&#x2F;* show database; *&#x2F;</td>
</tr>
</tbody></table>
</li>
<li><p>SQLè¯­å¥é€šå¸¸è¢«åˆ†ä¸ºå››å¤§ç±»ï¼š</p>
<table>
<thead>
<tr>
<th>åˆ†ç±»</th>
<th>å…¨ç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>DDL</td>
<td>Data Definition Language</td>
<td>æ•°æ®å®šä¹‰è¯­è¨€ï¼Œç”¨æ¥å®šä¹‰æ•°æ®åº“å¯¹è±¡ï¼ˆæ•°æ®åº“ï¼Œè¡¨ï¼Œå­—æ®µï¼‰</td>
</tr>
<tr>
<td>DML</td>
<td>Data Manipulation Language</td>
<td>æ•°æ®æ“ä½œè¯­è¨€ï¼Œç”¨æ¥å¯¹æ•°æ®è¡¨ä¸­çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹</td>
</tr>
<tr>
<td>DQL</td>
<td>Data Query Language</td>
<td>æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼Œç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­è¡¨çš„è®°å½•</td>
</tr>
<tr>
<td>DCL</td>
<td>Data Control Language</td>
<td>æ•°æ®æ§åˆ¶è¯­è¨€ï¼Œç”¨æ¥åˆ›å»ºæ•°æ®åº“ç”¨æˆ·ï¼Œæ§åˆ¶æ•°æ®åº“çš„è®¿é—®æƒé™</td>
</tr>
</tbody></table>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206132230078.png" alt="image-20240206132230078"></p>
</li>
</ul>
<h1 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h1><h2 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h2><p>â€“ æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“<br>show databases;</p>
<p>â€“ åˆ›å»ºæ•°æ®åº“<br>create database if not exists db02;</p>
<p>â€“åˆ é™¤æ•°æ®åº“</p>
<p>drop database if exists db02;</p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>ä¸Šè¿°è¯­æ³•ä¸­çš„databseï¼Œä¹Ÿå¯ä»¥æ›¿æ¢æˆschemaã€‚å¦‚ create schema db01;</li>
</ul>
<h2 id="å›¾å½¢åŒ–å·¥å…·"><a href="#å›¾å½¢åŒ–å·¥å…·" class="headerlink" title="å›¾å½¢åŒ–å·¥å…·"></a>å›¾å½¢åŒ–å·¥å…·</h2><p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206135040052.png" alt="image-20240206135040052"></p>
<p>jetbrainå·²ç»å°†datagripä¸­çš„åŠŸèƒ½é›†æˆåˆ°äº†intellij ideaä¸­ã€‚</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206134857300.png" alt="image-20240206134857300"></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206135024009.png" alt="image-20240206135024009"></p>
<h2 id="æ•°æ®è¡¨æ“ä½œ"><a href="#æ•°æ®è¡¨æ“ä½œ" class="headerlink" title="æ•°æ®è¡¨æ“ä½œ"></a>æ•°æ®è¡¨æ“ä½œ</h2><ul>
<li><p>åˆ›å»º</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> è¡¨å&#123;</span><br><span class="line">	å­—æ®µ<span class="number">1</span> å­—æ®µç±»å‹ [çº¦æŸ] [comment å­—æ®µ<span class="number">1</span>æ³¨é‡Š],</span><br><span class="line">	...</span><br><span class="line">    å­—æ®µn å­—æ®µç±»å‹ [çº¦æŸ] [comment å­—æ®µnæ³¨é‡Š],	</span><br><span class="line">&#125;[comment è¡¨æ³¨é‡Š];</span><br></pre></td></tr></table></figure>
</li>
<li><p>çº¦æŸ</p>
<ul>
<li>æ¦‚å¿µï¼šçº¦æŸæ˜¯ä½œç”¨äºè¡¨ä¸­å­—æ®µä¸Šçš„è§„åˆ™ï¼Œç”¨äºé™åˆ¶å­˜å‚¨åœ¨è¡¨ä¸­çš„æ•°æ®</li>
<li>ç›®çš„ï¼šä¿è¯æ•°æ®åº“ä¸­çš„æ•°æ®æ­£ç¡®æ€§ï¼Œæœ‰æ•ˆæ€§å’Œå®Œæ•´æ€§ã€‚</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>çº¦æŸ</th>
<th>æè¿°</th>
<th>å…³é”®å­—</th>
</tr>
</thead>
<tbody><tr>
<td>éç©ºçº¦æŸ</td>
<td>é™åˆ¶è¯¥å­—æ®µå€¼ä¸èƒ½ä¸ºnull</td>
<td>not null</td>
</tr>
<tr>
<td>å”¯ä¸€çº¦æŸ</td>
<td>ä¿è¯å­—æ®µçš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯å”¯ä¸€ã€ä¸é‡å¤çš„</td>
<td>unique</td>
</tr>
<tr>
<td>ä¸»é”®çº¦æŸ</td>
<td>ä¸»é”®æ˜¯ä¸€è¡Œæ•°æ®çš„å”¯ä¸€æ ‡è¯†ã€è¦æ±‚éç©ºä¸”å”¯ä¸€</td>
<td>primary keyï¼ˆauto_increment)</td>
</tr>
<tr>
<td>é»˜è®¤çº¦æŸ</td>
<td>ä¿å­˜æ•°æ®æ—¶ï¼Œå¦‚æœæœªæŒ‡å®šè¯¥å­—æ®µå€¼ï¼Œè¿™é‡‡ç”¨é»˜è®¤å€¼</td>
<td>default</td>
</tr>
<tr>
<td>å¤–é”®çº¦æŸ</td>
<td>è®©ä¸¤å¼ è¡¨çš„æ•°æ®å»ºç«‹è¿æ¥ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§</td>
<td>foreign key</td>
</tr>
</tbody></table>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206140150269.png" alt="image-20240206140150269"></p>
<h1 id="DDLï¼ˆè¡¨æ“ä½œï¼‰"><a href="#DDLï¼ˆè¡¨æ“ä½œï¼‰" class="headerlink" title="DDLï¼ˆè¡¨æ“ä½œï¼‰"></a>DDLï¼ˆè¡¨æ“ä½œï¼‰</h1><ul>
<li><p>æ•°æ®ç±»å‹</p>
<p>MySQLä¸­çš„æ•°æ®ç±»å‹æœ‰å¾ˆå¤šï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ç±»å‹ã€å­—ç¬¦ä¸²ç±»å‹ã€æ—¥æœŸæ—¶é—´ç±»å‹ã€‚</p>
<p>æ•°å€¼ç±»å‹ï¼š</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206140956703.png" alt="image-20240206140956703"></p>
<p>å­—ç¬¦ä¸²ç±»å‹ï¼š</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206141713907.png" alt="image-20240206141713907"></p>
<p>æ—¥æœŸæ—¶é—´ç±»å‹ï¼š</p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20231102151145540.png" alt="image-20231102151145540"></p>
</li>
</ul>
<h2 id="å›¾å½¢åŒ–æ–¹å¼å»ºè¡¨"><a href="#å›¾å½¢åŒ–æ–¹å¼å»ºè¡¨" class="headerlink" title="å›¾å½¢åŒ–æ–¹å¼å»ºè¡¨"></a>å›¾å½¢åŒ–æ–¹å¼å»ºè¡¨</h2><p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206142527606.png" alt="image-20240206142527606"></p>
<hr>

<ul>
<li><p>æŸ¥è¯¢</p>
<ul>
<li>æŸ¥è¯¢å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨ï¼šshow tables;</li>
<li>æŸ¥è¯¢è¡¨ç»“æ„ï¼šdesc è¡¨åï¼›</li>
<li>æŸ¥è¯¢å»ºè¡¨è¯­å¥ï¼šshow create table è¡¨åï¼›</li>
</ul>
</li>
</ul>
<hr>

<ul>
<li><p>ä¿®æ”¹</p>
<ul>
<li><p>æ·»åŠ å­—æ®µï¼šalter table è¡¨å add å­—æ®µå ç±»å‹ï¼ˆé•¿åº¦ï¼‰ [comment æ³¨é‡Š] [çº¦æŸ];</p>
</li>
<li><p>ä¿®æ”¹å­—æ®µç±»å‹ï¼šalter table è¡¨å modify å­—æ®µå æ–°æ•°æ®ç±»å‹ï¼ˆé•¿åº¦ï¼‰;</p>
</li>
<li><p>ä¿®æ”¹å­—æ®µåå’Œå­—æ®µç±»å‹ï¼šalter table è¡¨å change æ—§å­—æ®µå æ–°å­—æ®µå ç±»å‹ï¼ˆé•¿åº¦ï¼‰ [comment æ³¨é‡Š] [çº¦æŸ];</p>
</li>
<li><p>åˆ é™¤å­—æ®µï¼šalter table è¡¨å drop column å­—æ®µå;</p>
</li>
<li><p>ä¿®æ”¹è¡¨åï¼šrename table è¡¨å to æ–°è¡¨å;</p>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- DDLï¼šä¿®æ”¹è¡¨ç»“æ„</span></span><br><span class="line"><span class="comment">-- ä¿®æ”¹ï¼šä¸ºè¡¨ tb_empæ·»åŠ å­—æ®µ qq varchar(11)</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_emp <span class="keyword">add</span> qq <span class="type">varchar</span>(<span class="number">11</span>) comment <span class="string">&#x27;QQ&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹ï¼šä¿®æ”¹è¡¨ tb_empå­—æ®µç±»å‹ qq varchar(13)</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_emp modify qq <span class="type">varchar</span>(<span class="number">11</span>) comment <span class="string">&#x27;QQ&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹ï¼š ä¿®æ”¹è¡¨ tb_emp å­—æ®µå qqä¸º qq_num  varchar(13)</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_emp change qq qq_num <span class="type">varchar</span>(<span class="number">13</span>) comment <span class="string">&#x27;QQ&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹ï¼šåˆ é™¤tb_empçš„qq_numå­—æ®µ</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_emp <span class="keyword">drop</span> <span class="keyword">column</span>  qq_num;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹ï¼šå°†tb_empè¡¨ä¿®æ”¹ä¸º emp</span></span><br><span class="line">rename <span class="keyword">table</span> tb_emp <span class="keyword">to</span> emp;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<hr>

<ul>
<li><p>åˆ é™¤</p>
<ul>
<li>åˆ é™¤è¡¨ï¼šdrop table[if  exists] è¡¨å;</li>
</ul>
</li>
</ul>
<h1 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h1><ul>
<li><p>æ’å…¥æ•°æ®ï¼ˆINSERTï¼‰</p>
<ul>
<li>æŒ‡å®šå­—æ®µæ·»åŠ æ•°æ®ï¼š insert into è¡¨å ï¼ˆå­—æ®µå1ï¼Œå­—æ®µå2ï¼‰values(å€¼1ï¼Œå€¼2);</li>
<li>å…¨éƒ¨å­—æ®µæ·»åŠ æ•°æ®ï¼š insert into è¡¨å valuesï¼ˆå€¼1ï¼Œå€¼2ï¼Œã€‚ã€‚ã€‚)</li>
<li>æ‰¹é‡æ·»åŠ æ•°æ®ï¼ˆæŒ‡å®šå­—æ®µï¼‰ï¼šinsert into è¡¨åï¼ˆå­—æ®µå 1ï¼Œå­—æ®µå2ï¼‰ valuesï¼ˆå€¼1ï¼Œå€¼2ï¼‰ï¼ˆå€¼1ï¼Œå€¼2ï¼‰;</li>
<li>æ‰¹é‡æ·»åŠ æ•°æ®ï¼ˆå…¨éƒ¨å­—æ®µï¼‰ï¼šinsert into è¡¨å valuesï¼ˆå€¼1ï¼Œå€¼2ï¼Œâ€¦)ï¼Œï¼ˆå€¼1ï¼Œå€¼2ï¼Œâ€¦);</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- DML: æ•°æ®æ“ä½œè¯­è¨€</span></span><br><span class="line"><span class="comment">-- DMLï¼šæ’å…¥æ•°æ® - insert</span></span><br><span class="line"><span class="comment">-- 1. ä¸º emp è¡¨çš„username, name, genderå­—æ®µæ’å…¥å€¼</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp (username,name,gender,create_time,update_time) <span class="keyword">values</span> (<span class="string">&#x27;wuji&#x27;</span>,<span class="string">&#x27;å¼ æ— å¿Œ&#x27;</span>,<span class="number">1</span>,now(),now());</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. ä¸ºempè¡¨çš„æ‰€æœ‰å­—æ®µæ’å…¥å€¼</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(id, username, password, name, gender, image, job, entrydate, create_time, update_time) <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;zhiruo&#x27;</span>,<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;å‘¨èŠ·è‹¥&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;1.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2010-01-01&#x27;</span>,now(),now());</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span> (<span class="keyword">null</span>, <span class="string">&#x27;zhiruo2&#x27;</span>,<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;å‘¨èŠ·è‹¥2&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;1.jpg&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;2010-01-01&#x27;</span>,now(),now());</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æ‰¹é‡ä¸ºempè¡¨çš„username, name, genderå­—æ®µæ’å…¥å€¼</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp(username, name, image,  create_time, update_time) <span class="keyword">values</span> (<span class="string">&#x27;weifuwang&#x27;</span>,<span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>,<span class="number">1</span>,now(),now()),(<span class="string">&#x27;xieshiwang&#x27;</span>,<span class="string">&#x27;è°¢é€Š&#x27;</span>,<span class="number">1</span>,now(),now());</span><br></pre></td></tr></table></figure>



<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li><p>æ’å…¥æ•°æ®æ—¶ï¼ŒæŒ‡å®šçš„å­—æ®µé¡ºåºéœ€è¦ä¸å€¼çš„é¡ºåºä¸€ä¸€å¯¹åº”</p>
</li>
<li><p>å­—ç¬¦ä¸²å’Œæ—¥æœŸå‹æ•°æ®åº”è¯¥åŒ…å«åœ¨å¼•å·ä¸­</p>
</li>
<li><p>æ’å…¥çš„æ•°æ®å¤§å°ï¼Œåº”åœ¨å­—æ®µçš„è§„å®šèŒƒå›´å†…</p>
</li>
</ol>
</li>
</ul>
<hr>

<ul>
<li><p>æ›´æ–°æ•°æ®ï¼ˆUPDATEï¼‰</p>
<ul>
<li><p>ä¿®æ”¹æ•°æ®ï¼š update è¡¨å set å­—æ®µ1&#x3D;å€¼1ï¼Œå­—æ®µ2&#x3D;å€¼2ï¼Œâ€¦ [where æ¡ä»¶]ï¼›</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- DMLï¼šæ›´æ–°æ•°æ® - update</span></span><br><span class="line"><span class="comment">-- 1. å°†empè¡¨çš„IDä¸º1çš„å‘˜å·¥ï¼Œå§“ånameå­—æ®µæ›´æ–°ä¸ºâ€˜å¼ ä¸‰â€™</span></span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> name<span class="operator">=</span><span class="string">&#x27;å¼ ä¸‰&#x27;</span>,update_time<span class="operator">=</span>now() <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. å°†tb_empè¡¨çš„æ‰€æœ‰å‘˜å·¥çš„å…¥èŒæ—¥æœŸæ›´æ”¹ä¸ºâ€˜2020-01-01â€™</span></span><br><span class="line"><span class="keyword">update</span> emp <span class="keyword">set</span> entrydate <span class="operator">=</span> <span class="string">&#x27;2010-01-01&#x27;</span>, update_time <span class="operator">=</span> now();</span><br></pre></td></tr></table></figure>

<hr></li>
</ul>
</li>
<li><p>åˆ é™¤æ•°æ®ï¼ˆDELETEï¼‰</p>
<ul>
<li>åˆ é™¤æ•°æ®ï¼š delete from è¡¨å where [æ¡ä»¶];</li>
</ul>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>DELETEè¯­å¥çš„æ¡ä»¶å¯ä»¥æœ‰ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ï¼Œå¦‚æœæ²¡æœ‰æ¡ä»¶ï¼Œåˆ™ä¼šåˆ é™¤æ•´å¼ è¡¨çš„æ‰€æœ‰æ•°æ®ã€‚</li>
<li>DELETEè¯­å¥ä¸èƒ½åˆ é™¤æŸä¸€ä¸ªå­—æ®µçš„å€¼ï¼ˆå¦‚æœè¦åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨UPDATEï¼Œè¯¥å­—æ®µçš„å€¼ä¸ºNULLï¼‰.</li>
</ol>
</li>
</ul>
<hr>  

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206151657551.png" alt="image-20240206151657551"></p>
<h1 id="DQL-Data-query-language"><a href="#DQL-Data-query-language" class="headerlink" title="DQL(Data query language)"></a>DQL(Data query language)</h1><p>è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    å­—æ®µåˆ—è¡¨</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    è¡¨ååˆ—è¡¨</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    æ¡ä»¶åˆ—è¡¨</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">    åˆ†ç»„å­—æ®µåˆ—è¡¨</span><br><span class="line"><span class="keyword">having</span></span><br><span class="line">    åˆ†ç»„åæ¡ä»¶åˆ—è¡¨</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line">    æ’åºå­—æ®µåˆ—è¡¨</span><br><span class="line">limit</span><br><span class="line">    åˆ†é¡µå‚æ•°</span><br></pre></td></tr></table></figure>

<ul>
<li>åŸºæœ¬æŸ¥è¯¢</li>
<li>æ¡ä»¶æŸ¥è¯¢ï¼ˆwhereï¼‰</li>
<li>åˆ†ç»„æŸ¥è¯¢ï¼ˆgroup byï¼‰</li>
<li>æ’åºæŸ¥è¯¢ï¼ˆorder byï¼‰</li>
<li>åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰</li>
</ul>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206200329379.png" alt="image-20240206200329379"></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240206201404182.png" alt="image-20240206201404182"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> name,entrydate <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, username, password, name, gender, image, job, entrydate, create_time, update_time <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- (ä¸æ¨èï¼Œæ€§èƒ½ä½)</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„name, entrydate, èµ·åˆ«å</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> å§“å, entrydate <span class="keyword">as</span> å…¥èŒæ—¥æœŸ <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„name, entrydate, èµ·åˆ«å(åˆ«åæœ‰ç©ºæ ¼ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> name <span class="keyword">as</span> <span class="string">&#x27;å§“ å&#x27;</span>, entrydate <span class="keyword">as</span> å…¥èŒæ—¥æœŸ <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. æŸ¥è¯¢å·²æœ‰çš„å‘˜å·¥å…³è”äº†å“ªå‡ ç§èŒä½ï¼ˆä¸è¦é‡å¤ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> tb_emp;</span><br></pre></td></tr></table></figure>



<hr>

<ul>
<li><p>æ¡ä»¶æŸ¥è¯¢ï¼ˆwhereï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨å <span class="keyword">where</span> æ¡ä»¶åˆ—è¡¨;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>æ¯”è¾ƒè¿ç®—ç¬¦</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>&gt;</td>
<td>å¤§äº</td>
</tr>
<tr>
<td>&gt;&#x3D;</td>
<td>å¤§äºç­‰äº</td>
</tr>
<tr>
<td>&lt;</td>
<td>å°äº</td>
</tr>
<tr>
<td>&lt;&#x3D;</td>
<td>å°äºç­‰äº</td>
</tr>
<tr>
<td>&#x3D;</td>
<td>ç­‰äº</td>
</tr>
<tr>
<td>&lt;&gt; æˆ– !&#x3D;</td>
<td>ä¸ç­‰äº</td>
</tr>
<tr>
<td>between â€¦ and â€¦</td>
<td>åœ¨æŸä¸ªèŒƒå›´ä¹‹å†…ï¼ˆå«æœ€å°ï¼Œæœ€å¤§å€¼ï¼‰</td>
</tr>
<tr>
<td>in(â€¦)</td>
<td>åœ¨inä¹‹åçš„åˆ—è¡¨ä¸­çš„å€¼ï¼Œå¤šé€‰ä¸€</td>
</tr>
<tr>
<td>like å ä½ç¬¦</td>
<td>æ¨¡ç³ŠåŒ¹é…ï¼ˆ_åŒ¹é…å•ä¸ªå­—ç¬¦ï¼Œ%åŒ¹é…ä»»æ„å­—ç¬¦ï¼‰</td>
</tr>
<tr>
<td>is null</td>
<td>æ˜¯null</td>
</tr>
<tr>
<td>and æˆ– &amp;&amp;</td>
<td>å¹¶ä¸”ï¼ˆå¤šä¸ªæ¡ä»¶åŒæ—¶æˆç«‹ï¼‰</td>
</tr>
<tr>
<td>or æˆ– ||</td>
<td>æˆ–è€…ï¼ˆå¤šä¸ªæ¡ä»¶ä»»æ„ä¸€ä¸ªæˆç«‹ï¼‰</td>
</tr>
<tr>
<td>not æˆ– ||</td>
<td>éï¼Œä¸æ˜¯</td>
</tr>
</tbody></table>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1. æŸ¥è¯¢å§“åä¸ºé‡‘åº¸çš„å‘˜å·¥</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;é‡‘åº¸&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. æŸ¥è¯¢idå°äºç­‰äº5çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> id <span class="operator">&lt;=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢æ²¡æœ‰åˆ†é…èŒä½çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> job <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. æŸ¥è¯¢æœ‰èŒä½çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> job <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5. æŸ¥è¯¢å¯†ç ä¸ç­‰äºâ€˜123456â€™çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> password <span class="operator">!=</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> password <span class="operator">&lt;&gt;</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. æŸ¥è¯¢å…¥èŒæ—¥åœ¨&#x27;2000-01-01&#x27;ï¼ˆåŒ…å«ï¼‰åˆ°&#x27;2020-01-01&#x27;(åŒ…å«ï¼‰ä¹‹é—´çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="keyword">between</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2010-01-01&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;=</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> entrydate <span class="operator">&lt;=</span> <span class="string">&#x27;2010-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 7. æŸ¥è¯¢å…¥èŒæ—¶é—´åœ¨&#x27;2000-01-01&#x27;ï¼ˆåŒ…å«ï¼‰åˆ°&#x27;2010-01-01&#x27;ï¼ˆåŒ…å«ï¼‰ä¹‹é—´ä¸”æ€§åˆ«ä¸ºå¥³çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="keyword">between</span> <span class="string">&#x27;2000-01-01&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;2010-01-01&#x27;</span> <span class="keyword">and</span> gender <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 8. æŸ¥è¯¢èŒä½æ˜¯2ï¼ˆè®²å¸ˆï¼‰ï¼Œ3ï¼ˆå­¦å·¥ä¸»ç®¡ï¼‰ï¼Œ4ï¼ˆæ•™ç ”ä¸»ç®¡ï¼‰çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> job <span class="operator">=</span> <span class="number">2</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="number">3</span> <span class="keyword">or</span> job <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> job <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 9. æŸ¥è¯¢å§“åä¸ºä¸¤ä¸ªå­—çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;__&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 10. æŸ¥è¯¢å§“â€˜å¼ â€™çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;å¼ %&#x27;</span>;</span><br></pre></td></tr></table></figure>



  <hr>

<ul>
<li><p>åˆ†ç»„æŸ¥è¯¢ï¼ˆgroup byï¼‰</p>
<p>èšåˆå‡½æ•°ï¼šå°†ä¸€åˆ—æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡Œçºµå‘è¿ç®—ã€‚</p>
<p>èšåˆæŸ¥è¯¢è¯­æ³•ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> èšåˆå‡½æ•°ï¼ˆå­—æ®µåˆ—è¡¨ï¼‰ <span class="keyword">from</span> è¡¨åï¼›</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody><tr>
<td>count</td>
<td>ç»Ÿè®¡æ•°é‡</td>
</tr>
<tr>
<td>max</td>
<td>æœ€å¤§å€¼</td>
</tr>
<tr>
<td>min</td>
<td>æœ€å°å€¼</td>
</tr>
<tr>
<td>avg</td>
<td>å¹³å‡å€¼</td>
</tr>
<tr>
<td>sum</td>
<td>æ±‚å’Œ</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹è¯´æ˜ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1ã€ç»Ÿè®¡è¯¥ä¼ä¸šçš„å‘˜å·¥æ•°é‡ -- count</span></span><br><span class="line"><span class="comment">-- A. count(å­—æ®µï¼‰</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="keyword">from</span> tb_emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(job) <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- B. count(å¸¸é‡)</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">0</span>) <span class="keyword">from</span> tb_emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> tb_emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- C. count(*)</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. ç»Ÿè®¡è¯¥ä¼ä¸šæœ€æ—©å…¥èŒçš„å‘˜å·¥ --min</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(entrydate) <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. ç»Ÿè®¡è¯¥ä¼ä¸šæœ€æ™šå…¥èŒçš„å‘˜å·¥ --max</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(entrydate) <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. ç»Ÿè®¡è¯¥ä¼ä¸šå‘˜å·¥IDçš„å¹³å‡å€¼ --avg</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(id) <span class="keyword">from</span> tb_emp;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ul>
<li>nullå€¼ä¸å‚ä¸æ‰€æœ‰èšåˆå‡½æ•°è¿ç®—</li>
<li>ç»Ÿè®¡æ•°é‡å¯ä»¥ä½¿ç”¨ï¼šcount(*) count(å­—æ®µ) count(å¸¸é‡)ï¼Œæ¨èä½¿ç”¨count(*)ã€‚</li>
</ul>
<hr>

<p>åˆ†ç»„æŸ¥è¯¢ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨å [<span class="keyword">where</span> æ¡ä»¶] <span class="keyword">group</span> <span class="keyword">by</span> åˆ†ç»„å­—æ®µå [<span class="keyword">having</span> åˆ†ç»„è¿‡æ»¤æ¡ä»¶];</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1. æ ¹æ®æ€§åˆ«åˆ†ç»„ï¼Œç»Ÿè®¡ç”·æ€§å’Œå¥³æ€§å‘˜å·¥çš„æ•°é‡ count(*)</span></span><br><span class="line"><span class="keyword">select</span> gender,<span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tb_emp <span class="keyword">group</span> <span class="keyword">by</span> gender;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. å…ˆæŸ¥è¯¢å…¥èŒæ—¶é—´åœ¨ â€™2015-01-01â€™(åŒ…å«ï¼‰ä»¥å‰çš„å‘˜å·¥ï¼Œå¹¶å¯¹ç»“æœæ ¹æ®èŒä½åˆ†ç»„ï¼Œè·å–å‘˜å·¥æ•°é‡å¤§äºç­‰äº2çš„èŒä½</span></span><br><span class="line"><span class="keyword">select</span> job, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&lt;=</span> <span class="string">&#x27;2015-01-01&#x27;</span> <span class="keyword">group</span> <span class="keyword">by</span> job <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>whereå’Œhavingçš„åŒºåˆ«</p>
<ol>
<li>æ‰§è¡Œæ—¶æœºä¸åŒï¼šwhereæ˜¯åˆ†ç»„ä¹‹å‰è¿›è¡Œè¿‡æ»¤ï¼Œä¸æ»¡è¶³whereæ¡ä»¶ï¼Œä¸å‚ä¸åˆ†ç»„ï¼›è€Œhavingæ˜¯åˆ†ç»„ä¹‹åå¯¹ç»“æœè¿›è¡Œè¿‡æ»¤ã€‚</li>
<li>åˆ¤æ–­æ¡ä»¶ä¸åŒï¼š<font color="red">whereä¸èƒ½å¯¹èšåˆå‡½æ•°åˆ¤æ–­ï¼Œè€Œhavingå¯ä»¥ã€‚</font></li>
</ol>
</li>
<li><p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li><font color="red">åˆ†ç»„ä¹‹åï¼ŒæŸ¥è¯¢çš„å­—æ®µä¸€èˆ¬ä¸ºèšåˆèšåˆå‡½æ•°å’Œåˆ†ç»„å­—æ®µï¼ŒæŸ¥è¯¢å…¶ä»–å­—æ®µæ— ä»»ä½•æ„ä¹‰ã€‚</font></li>
<li>æ‰§è¡Œé¡ºåºï¼šwhere &gt; èšåˆå‡½æ•° &gt; havingã€‚</li>
</ul>
</li>
</ul>
<hr>
</li>
<li><p>æ’åºæŸ¥è¯¢ï¼ˆorder byï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨å [<span class="keyword">where</span> æ¡ä»¶] <span class="keyword">group</span> <span class="keyword">by</span> åˆ†ç»„å­—æ®µå [<span class="keyword">having</span> åˆ†ç»„è¿‡æ»¤æ¡ä»¶] <span class="keyword">order</span> <span class="keyword">by</span> å­—æ®µ<span class="number">1</span> æ’åºæ–¹å¼<span class="number">1</span>, å­—æ®µ<span class="number">2</span> æ’åºæ–¹å¼<span class="number">2</span>, ...;</span><br></pre></td></tr></table></figure>

<p>æ’åºæ–¹å¼</p>
<ul>
<li>ASCï¼šå‡åºæ’åºï¼ˆé»˜è®¤ï¼‰</li>
<li>DESCï¼šé™åºæ’åº</li>
</ul>
<p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1. æ ¹æ®å…¥èŒæ—¶é—´ï¼Œå¯¹å‘˜å·¥è¿›è¡Œå‡åºæ’åº --asc</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">order</span> <span class="keyword">by</span> entrydate <span class="keyword">asc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. æ ¹æ®å…¥èŒæ—¶é—´ï¼Œå¯¹å‘˜å·¥è¿›è¡Œé™åºæ’åº --desc</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">order</span> <span class="keyword">by</span> entrydate <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. æ ¹æ®å…¥èŒæ—¶é—´ï¼Œå¯¹å‘˜å·¥è¿›è¡Œå‡åºæ’åºï¼Œå…¥èŒæ—¶é—´ç›¸åŒï¼Œå†æ ¹æ®æ›´æ–°äº‹ä»¶è¿›è¡Œé™åºæ’åº --asc</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">order</span> <span class="keyword">by</span> entrydate, update_time <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<hr>
</li>
<li><p>åˆ†é¡µæŸ¥è¯¢ï¼ˆlimitï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨å limit èµ·å§‹ç´¢å¼•,æŸ¥è¯¢è®°å½•æ•°ï¼›</span><br></pre></td></tr></table></figure>

<p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 1. ä»èµ·å§‹ç´¢å¼•0å¼€å§‹æŸ¥è¯¢å‘˜å·¥æ•°æ®ï¼Œæ¯é¡µå±•ç¤º5æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp limit <span class="number">0</span>, <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. æŸ¥è¯¢ç¬¬1é¡µå‘˜å·¥æ•°æ®ï¼Œæ¯é¡µå±•ç¤º5æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp limit <span class="number">0</span>, <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢ç¬¬2é¡µå‘˜å·¥æ•°æ®ï¼Œæ¯é¡µå±•ç¤º5æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp limit <span class="number">5</span>, <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢ç¬¬3é¡µå‘˜å·¥æ•°æ®ï¼Œæ¯é¡µå±•ç¤º5æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp limit <span class="number">10</span>, <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<ol>
<li>èµ·å§‹ç´¢å¼•ä»0å¼€å§‹ï¼Œèµ·å§‹ç´¢å¼•&#x3D;ï¼ˆæŸ¥è¯¢é¡µç  - 1ï¼‰* æ¯é¡µæ˜¾ç¤ºè®°å½•æ•°ã€‚</li>
<li>åˆ†é¡µæŸ¥è¯¢æ˜¯æ•°æ®åº“çš„æ–¹è¨€ï¼Œä¸åŒæ•°æ®åº“æœ‰ä¸åŒçš„å®ç°ï¼ŒMySQLæ˜¯LIMITã€‚</li>
<li>å¦‚æœæŸ¥è¯¢çš„æ˜¯ç¬¬ä¸€é¡µçš„æ•°æ®ï¼Œå…¶å®ç´¢å¼•å¯ä»¥çœç•¥ï¼Œå¯ä»¥ç®€å†™ä¸ºlimit 10ã€‚</li>
</ol>
</li>
</ul>
<h1 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- æ¡ˆä¾‹2-1ï¼šæ ¹æ®éœ€æ±‚ï¼Œå®Œæˆå‘˜å·¥æ€§åˆ«ä¿¡æ¯çš„ç»Ÿè®¡</span></span><br><span class="line"><span class="comment">-- å°†1è½¬åŒ–ä¸ºç”·æ€§å‘˜å·¥ï¼Œ2è½¬æ¢ä¸ºå¥³æ€§å‘˜å·¥</span></span><br><span class="line"><span class="comment">-- if(æ¡ä»¶è¡¨è¾¾å¼, trueå–å€¼, falseå–å€¼)</span></span><br><span class="line"><span class="keyword">select</span> if(gender<span class="operator">=</span> <span class="number">1</span>,<span class="string">&#x27;ç”·æ€§å‘˜å·¥&#x27;</span>,<span class="string">&#x27;å¥³æ€§å‘˜å·¥&#x27;</span>) æ€§åˆ«, <span class="built_in">count</span>(gender) æ•°é‡ <span class="keyword">from</span> tb_emp <span class="keyword">group</span> <span class="keyword">by</span> (gender);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¡ˆä¾‹2-2ï¼šæ ¹æ®éœ€æ±‚ï¼Œå®Œæˆå‘˜å·¥èŒä½ä¿¡æ¯çš„ç»Ÿè®¡</span></span><br><span class="line"><span class="comment">-- case è¡¨è¾¾å¼ when å€¼1 then ç»“æœ1 when å€¼2 then ç»“æœ2 ... else ... end</span></span><br><span class="line"><span class="keyword">select</span> (<span class="keyword">case</span> job <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;ç­ä¸»ä»»&#x27;</span> <span class="keyword">when</span> <span class="number">2</span> <span class="keyword">then</span> <span class="string">&#x27;è®²å¸ˆ&#x27;</span> <span class="keyword">when</span> <span class="number">3</span> <span class="keyword">then</span> <span class="string">&#x27;å­¦å·¥ä¸»ç®¡&#x27;</span> <span class="keyword">when</span> <span class="number">4</span> <span class="keyword">then</span> <span class="string">&#x27;æ•™ç ”ä¸»ç®¡&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;æœªåˆ†é…èŒä½&#x27;</span> <span class="keyword">end</span>) èŒä½, <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> tb_emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ï¼š</p>
<ul>
<li>if(è¡¨è¾¾å¼,tvalue,fvalue):å½“è¡¨è¾¾å¼ä¸ºtrueæ—¶ï¼Œå–å€¼tvalueï¼›å½“è¡¨è¾¾å¼ä¸ºfalseæ—¶ï¼Œå–å€¼fvalue;</li>
<li>case expr when value1 then result1 [when value2 then result2 â€¦][else result] end</li>
</ul>
<h1 id="åˆ«å"><a href="#åˆ«å" class="headerlink" title="åˆ«å"></a>åˆ«å</h1><ul>
<li>å­—æ®µ1 [as] åˆ«å1ï¼Œå­—æ®µ2 [as] åˆ«å2ï¼Œâ€¦</li>
</ul>
<h1 id="å¤šè¡¨æ¨¡å¼"><a href="#å¤šè¡¨æ¨¡å¼" class="headerlink" title="å¤šè¡¨æ¨¡å¼"></a>å¤šè¡¨æ¨¡å¼</h1><ul>
<li><p>ä¸€å¯¹å¤šï¼ˆå¤šå¯¹ä¸€ï¼‰</p>
<p>å¤–é”®ï¼šç»™Aä¸­çš„æŸä¸ªå­—æ®µåŠ å¤–é”®ï¼ˆBä¸­æŸä¸ªå­—æ®µï¼‰ï¼Œæ„å‘³ç€Aä¸­è¯¥å­—æ®µçš„å€¼è¦åœ¨Bä¸­è¯¥å­—æ®µèŒƒå›´å†…å–å€¼ã€‚</p>
<p>å®ç°ç»†èŠ‚ï¼šåœ¨æ•°æ®åº“è¡¨ä¸­å¤šçš„ä¸€æ–¹ï¼Œæ·»åŠ å­—æ®µï¼Œæ¥å…³è”ä¸€æ–¹çš„ä¸»é”®ã€‚ï¼ˆä½¿ç”¨å¤–é”®çº¦æŸå»ºç«‹è¡¨è”ç³»ï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºè¡¨æ—¶çš„æŒ‡å®šæ–¹å¼</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> è¡¨å(</span><br><span class="line">    å­—æ®µå æ•°æ®ç±»å‹,</span><br><span class="line">    ...</span><br><span class="line">    [<span class="keyword">constraint</span>][å¤–é”®åç§°] <span class="keyword">foreign</span> key(å¤–é”®å­—æ®µå) <span class="keyword">references</span> ä¸»è¡¨ï¼ˆå­—æ®µåï¼‰</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å»ºå®Œè¡¨åçš„æ‰§è¡Œæ–¹å¼ï¼Œæ·»åŠ å¤–é”®</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> è¡¨å <span class="keyword">add</span> <span class="keyword">constraint</span> å¤–é”®åç§° <span class="keyword">foreign</span> key(å¤–é”®å­—æ®µå) <span class="keyword">references</span> ä¸»è¡¨ï¼ˆå­—æ®µåï¼‰;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240207164619163.png" alt="image-20240207164619163"></p>
<p><strong>ç‰©ç†å¤–é”®</strong></p>
<p>æ¦‚å¿µï¼šä½¿ç”¨foreign  keyå®šä¹‰å¤–é”®å…³è”å¦å¤–ä¸€å¼ è¡¨</p>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å½±å“å¢ã€åˆ ã€æ”¹çš„æ•ˆç‡ï¼ˆéœ€è¦æ£€æŸ¥å¤–é”®å…³ç³»ï¼‰ã€‚</li>
<li>ä»…ç”¨äºå•èŠ‚ç‚¹æ•°æ®åº“ ï¼Œä¸é€‚ç”¨ä¸åˆ†å¸ƒå¼ã€é›†ç¾¤åœºæ™¯ã€‚</li>
<li>å®¹æ˜“å¼•å‘æ•°æ®åº“çš„æ­»é”é—®é¢˜ï¼Œæ¶ˆè€—æ€§èƒ½ã€‚</li>
</ul>
<p><strong>é€»è¾‘å¤–é”®ï¼ˆæ¨èï¼‰</strong></p>
<p>æ¦‚å¿µï¼šåœ¨ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œè§£å†³å¤–é”®å…³è”ã€‚</p>
<p>é€šè¿‡é€»è¾‘å¤–é”®ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
</li>
<li><p>ä¸€å¯¹ä¸€</p>
<p>æ¡ˆä¾‹ï¼šç”¨æˆ·ä¸èº«ä»½è¯ä¿¡æ¯çš„å…³ç³»</p>
<p>å…³ç³»ï¼šä¸€å¯¹ä¸€å…³ç³»ï¼Œå¤šç”¨äºå•è¡¨æ‹†åˆ†ï¼Œå°†ä¸€å¼ è¡¨çš„åŸºç¡€å­—æ®µæ”¾åœ¨ä¸€å¼ è¡¨ä¸­ï¼Œå…¶ä»–å­—æ®µæ”¾åœ¨å¦ä¸€å¼ è¡¨ä¸­ï¼Œä»¥æå‡æ“ä½œæ•ˆç‡</p>
</li>
</ul>
<p>â€‹		å®ç°ï¼š<font color="red">åœ¨ä»»æ„ä¸€æ–¹åŠ å…¥å¤–é”®ï¼Œå…³è”å¦å¤–ä¸€æ–¹çš„ä¸»é”®ï¼Œå¹¶ä¸”è®¾ç½®å¤–é”®ä¸ºå”¯ä¸€çš„ï¼ˆUNIQUEï¼‰</font></p>
<ul>
<li><p>å¤šå¯¹å¤š</p>
<p>æ¡ˆä¾‹ï¼šå­¦ç”Ÿä¸è¯¾ç¨‹çš„å…³ç³»</p>
<p>å…³ç³»ï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰ä¿®å¤šé—¨è¯¾ç¨‹ï¼Œä¸€é—¨è¯¾ç¨‹ä¹Ÿå¯ä»¥ä¾›å¤šä¸ªå­¦ç”Ÿé€‰æ‹©</p>
<p>å®ç°ï¼šå»ºç«‹ç¬¬ä¸‰å¼ ä¸­é—´è¡¨ï¼Œä¸­é—´è¡¨ä¸­è‡³å°‘åŒ…å«ä¸¤ä¸ªå¤–é”®ï¼Œåˆ†åˆ«å…³è”ä¸¤æ–¹ä¸»é”®</p>
</li>
</ul>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240207174539789.png" alt="image-20240207174539789"></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240207175403377.png" alt="image-20240207175403377"></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240207181108591.png" alt="image-20240207181108591"></p>
<h1 id="å¤šè¡¨æŸ¥è¯¢"><a href="#å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢"></a>å¤šè¡¨æŸ¥è¯¢</h1><ul>
<li><p>å¤šè¡¨æŸ¥è¯¢ï¼šæŒ‡ä»å¤šå¼ è¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚</p>
</li>
<li><p>ç¬›å¡å°”ç§¯ï¼šç¬›å¡å°”ä¹˜ç§¯æ˜¯æŒ‡æ•°å­¦ä¸­ï¼Œä¸¤ä¸ªé›†åˆçš„æ‰€æœ‰ç»„åˆæƒ…å†µã€‚</p>
</li>
<li><p>åˆ†ç±»</p>
<ul>
<li><p>å†…è¿æ¥ï¼šç›¸å½“äºæŸ¥è¯¢Aã€Bäº¤é›†éƒ¨åˆ†æ•°æ®</p>
<p>è¯­æ³•ï¼š</p>
<ul>
<li><p>éšå¼å†…è¿æ¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨<span class="number">1</span>ï¼Œè¡¨<span class="number">2</span> <span class="keyword">where</span> æ¡ä»¶ ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å®ä¾‹</span></span><br><span class="line"><span class="comment">-- A. æŸ¥è¯¢å‘˜å·¥çš„å§“åï¼ŒåŠæ‰€å±çš„éƒ¨é—¨åç§°ï¼ˆéšå¼å†…è¿æ¥å®ç°ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> tb_dept.name,tb_emp.name <span class="keyword">from</span> tb_emp, tb_dept <span class="keyword">where</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- èµ·åˆ«å</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp e, tb_dept d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ˜¾å¼å†…è¿æ¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨<span class="number">1</span> [<span class="keyword">inner</span>] <span class="keyword">join</span> è¡¨<span class="number">2</span> <span class="keyword">on</span> è¿æ¥æ¡ä»¶ ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å®ä¾‹</span></span><br><span class="line"><span class="comment">-- B. æŸ¥è¯¢å‘˜å·¥çš„å§“åï¼ŒåŠæ‰€å±çš„éƒ¨é—¨åç§°ï¼ˆæ˜¾å¼å†…è¿æ¥å®ç°ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> tb_emp.name,tb_dept.name <span class="keyword">from</span> tb_emp <span class="keyword">inner</span> <span class="keyword">join</span> tb_dept <span class="keyword">on</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å¤–è¿æ¥ï¼š</p>
<ul>
<li><p>å·¦å¤–è¿æ¥ï¼šæŸ¥è¯¢å·¦è¡¨æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬ä¸¤å¼ è¡¨äº¤é›†éƒ¨åˆ†çš„æ•°æ®ï¼‰(ç»å¸¸ä½¿ç”¨)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨<span class="number">1</span> <span class="keyword">left</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> è¡¨<span class="number">2</span> <span class="keyword">on</span> è¿æ¥æ¡ä»¶ ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- A. æŸ¥è¯¢å‘˜å·¥è¡¨æ‰€æœ‰å‘˜å·¥çš„å§“åï¼Œç›¸å¯¹åº”çš„éƒ¨é—¨åç§°ï¼ˆå·¦å¤–è¿æ¥ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> e.name, d.name <span class="keyword">from</span> tb_emp e <span class="keyword">left</span> <span class="keyword">join</span> tb_dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å³å¤–è¿æ¥ï¼šæŸ¥è¯¢å³è¡¨æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬ä¸¤å¼ è¡¨äº¤é›†éƒ¨åˆ†çš„æ•°æ®ï¼‰</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> å­—æ®µåˆ—è¡¨ <span class="keyword">from</span> è¡¨<span class="number">1</span> <span class="keyword">right</span> [<span class="keyword">outer</span>] <span class="keyword">join</span> è¡¨<span class="number">2</span> <span class="keyword">on</span> è¿æ¥æ¡ä»¶ ...;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- B. æŸ¥è¯¢éƒ¨é—¨è¡¨æ‰€æœ‰éƒ¨é—¨çš„åç§°ï¼Œå’Œå¯¹åº”çš„å‘˜å·¥åç§°ï¼ˆå³å¤–è¿æ¥ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> e.name,d.name <span class="keyword">from</span> tb_emp e <span class="keyword">right</span> <span class="keyword">join</span> tb_dept d <span class="keyword">on</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å­æŸ¥è¯¢</p>
<ul>
<li><p>SQLè¯­å¥ä¸­åµŒå¥—selectè¯­å¥ï¼Œç§°ä¸ºåµŒå¥—æŸ¥è¯¢ï¼Œåˆç§°å­æŸ¥è¯¢ã€‚</p>
</li>
<li><p>å½¢å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1 <span class="keyword">where</span> column1 <span class="operator">=</span> (<span class="keyword">select</span> column1 <span class="keyword">from</span> t2 ... );</span><br></pre></td></tr></table></figure>
</li>
<li><p>å­æŸ¥è¯¢å¤–éƒ¨çš„è¯­å¥å¯ä»¥æ˜¯ insert&#x2F;update&#x2F;delete&#x2F;selectä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œæœ€å¸¸è§çš„æ˜¯selectã€‚</p>
</li>
<li><p>åˆ†ç±»</p>
<ul>
<li><p>æ ‡é‡å­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢è¿”å›çš„ç»“æœä¸ºå•ä¸ªå€¼</p>
<ul>
<li><p>å­æŸ¥è¯¢è¿”å›çš„ç»“æœæ˜¯å•ä¸ªå€¼ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€æ—¥æœŸç­‰ï¼‰ï¼Œæœ€ç®€å•çš„å½¢å¼</p>
</li>
<li><p>æœ€å¸¸è§çš„æ“ä½œç¬¦ï¼š &#x3D;   &lt;&gt;   &gt;   &gt;&#x3D;   &lt;   &lt;&#x3D;</p>
<p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- A. æŸ¥è¯¢ â€œæ•™ç ”éƒ¨â€çš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="comment">-- a. æŸ¥è¯¢æ•™ç ”éƒ¨çš„ID - tb_deptï¼ˆæ ‡é‡å­æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="keyword">select</span>  id  <span class="keyword">from</span> tb_dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. æŸ¥è¯¢æ•™ç ”éƒ¨IDä¸‹çš„å‘˜å·¥ä¿¡æ¯ tb_emp</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span>  dept_id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span>  dept_id <span class="operator">=</span> (<span class="keyword">select</span>  id  <span class="keyword">from</span> tb_dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- B. æŸ¥è¯¢åœ¨â€æ–¹ä¸œç™½â€œå…¥èŒä¹‹å‰çš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="comment">-- a. æŸ¥è¯¢æ–¹ä¸œç™½çš„å…¥èŒæ—¶é—´ï¼ˆå•è¡Œå•åˆ—å€¼ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> entrydate <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. æŸ¥è¯¢åœ¨â€œæ–¹ä¸œç™½â€å…¥èŒä¹‹åçš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2012-11-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> (<span class="keyword">select</span> entrydate <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>åˆ—å­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢è¿”å›çš„ç»“æœä¸ºä¸€åˆ—</p>
<ul>
<li><p>å­æŸ¥è¯¢è¿”å›çš„ç»“æœæ˜¯ä¸€åˆ—ï¼ˆå¯ä»¥æ˜¯å¤šè¡Œ ï¼‰</p>
</li>
<li><p>å¸¸ç”¨çš„æ“ä½œç¬¦ï¼šinã€not inç­‰</p>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ—å­æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">-- A. æŸ¥è¯¢â€æ•™ç ”éƒ¨â€œå’Œâ€å’¨è¯¢éƒ¨â€œçš„æ‰€æœ‰å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="comment">-- a. æŸ¥è¯¢æ•™ç ”éƒ¨å’Œå’¨è¯¢éƒ¨çš„ID</span></span><br><span class="line"><span class="keyword">select</span> id  <span class="keyword">from</span> tb_dept <span class="keyword">where</span> name <span class="operator">=</span><span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span> <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. æ ¹æ®éƒ¨é—¨IDï¼ŒæŸ¥è¯¢è¯¥éƒ¨é—¨ä¸‹çš„å‘˜å·¥ä¿¡æ¯ tb_emp</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> dept_id <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> dept_id <span class="keyword">in</span> (</span><br><span class="line">    <span class="keyword">select</span> id  <span class="keyword">from</span> tb_dept <span class="keyword">where</span> name <span class="operator">=</span><span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span> <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span></span><br><span class="line">    );</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>è¡Œå­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢è¿”å›çš„ç»“æœä¸ºä¸€è¡Œ</p>
<ul>
<li><p>å­æŸ¥è¯¢è¿”å›çš„ç»“æœæ˜¯ä¸€è¡Œï¼ˆå¯ä»¥æ˜¯å¤šåˆ—ï¼‰</p>
</li>
<li><p>å¸¸ç”¨çš„æ“ä½œç¬¦ï¼š &#x3D;ã€&lt;&gt;ã€innot in</p>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- A. æŸ¥è¯¢ä¸â€œéŸ¦ä¸€ç¬‘â€çš„å…¥èŒæ—¥æœŸåŠå€¼ä¸ºéƒ½ç›¸åŒçš„å‘˜å·¥ä¿¡æ¯ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- a. æŸ¥è¯¢â€œéŸ¦ä¸€ç¬‘â€çš„å…¥èŒæ—¥æœŸåŠèŒä½</span></span><br><span class="line"><span class="keyword">select</span> entrydate,job <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b. æŸ¥è¯¢ä¸å…¶å…¥èŒæ—¥æœŸåŠèŒä½éƒ½ç›¸åŒçš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> (entrydate,job) <span class="operator">=</span> (<span class="keyword">select</span> entrydate,job <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>è¡¨å­æŸ¥è¯¢ï¼šå­æŸ¥è¯¢è¿”å›çš„ç»“æœä¸ºå¤šè¡Œå¤šåˆ—</p>
<ul>
<li><p>å­æŸ¥è¯¢è¿”å›çš„ç»“æœæ˜¯å¤šè¡Œå¤šåˆ—ï¼Œå¸¸ä½œä¸ºä¸´æ—¶è¡¨</p>
</li>
<li><p>å¸¸ç”¨çš„æ“ä½œç¬¦ï¼šin</p>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- è¡¨å­æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">-- A. æŸ¥è¯¢å…¥èŒæ—¥æœŸæ˜¯â€œ2006-01-01â€ä¹‹åçš„å‘˜å·¥ä¿¡æ¯ï¼ŒåŠå…¶éƒ¨é—¨åç§°</span></span><br><span class="line"><span class="comment">-- a.æŸ¥è¯¢å…¥èŒæ—¥æœŸæ˜¯â€2006-01-01â€œä¹‹åçš„å‘˜å·¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- b.æŸ¥è¯¢è¿™éƒ¨åˆ†å‘˜å·¥ä¿¡æ¯åŠå…¶éƒ¨é—¨åç§° - tb_dept</span></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>,d.name <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>) e, tb_dept d <span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>å®æ“</strong></p>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240208165030152.png" alt="image-20240208165030152"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- éƒ¨é—¨ç®¡ç†</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_dept</span><br><span class="line">(</span><br><span class="line">    id          <span class="type">int</span> unsigned <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;ä¸»é”®ID&#x27;</span>,</span><br><span class="line">    name        <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;éƒ¨é—¨åç§°&#x27;</span>,</span><br><span class="line">    create_time datetime    <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    update_time datetime    <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;éƒ¨é—¨è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_dept (id, name, create_time, update_time)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;å­¦å·¥éƒ¨&#x27;</span>, now(), now()),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>, now(), now()),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span>, now(), now()),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;å°±ä¸šéƒ¨&#x27;</span>, now(), now()),</span><br><span class="line">       (<span class="number">5</span>, <span class="string">&#x27;äººäº‹éƒ¨&#x27;</span>, now(), now());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å‘˜å·¥ç®¡ç†</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_emp</span><br><span class="line">(</span><br><span class="line">    id          <span class="type">int</span> unsigned <span class="keyword">primary</span> key auto_increment comment <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    username    <span class="type">varchar</span>(<span class="number">20</span>)      <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span> comment <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">    password    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">default</span> <span class="string">&#x27;123456&#x27;</span> comment <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">    name        <span class="type">varchar</span>(<span class="number">10</span>)      <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">    gender      tinyint unsigned <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ€§åˆ«, è¯´æ˜: 1 ç”·, 2 å¥³&#x27;</span>,</span><br><span class="line">    image       <span class="type">varchar</span>(<span class="number">300</span>) comment <span class="string">&#x27;å›¾åƒ&#x27;</span>,</span><br><span class="line">    job         tinyint unsigned comment <span class="string">&#x27;èŒä½, è¯´æ˜: 1 ç­ä¸»ä»»,2 è®²å¸ˆ, 3 å­¦å·¥ä¸»ç®¡, 4 æ•™ç ”ä¸»ç®¡, 5 å’¨è¯¢å¸ˆ&#x27;</span>,</span><br><span class="line">    entrydate   <span class="type">date</span> comment <span class="string">&#x27;å…¥èŒæ—¶é—´&#x27;</span>,</span><br><span class="line">    dept_id     <span class="type">int</span> unsigned comment <span class="string">&#x27;éƒ¨é—¨ID&#x27;</span>,</span><br><span class="line">    create_time datetime         <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    update_time datetime         <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;å‘˜å·¥è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tb_emp</span><br><span class="line">(id, username, password, name, gender, image, job, entrydate, dept_id, create_time, update_time)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;jinyong&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;é‡‘åº¸&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;1.jpg&#x27;</span>, <span class="number">4</span>, <span class="string">&#x27;2000-01-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;zhangwuji&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å¼ æ— å¿Œ&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;2.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2015-01-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;yangxiao&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;æ¨é€&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;3.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2008-05-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;weiyixiao&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;4.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2007-01-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">5</span>, <span class="string">&#x27;changyuchun&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å¸¸é‡æ˜¥&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;5.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2012-12-05&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">6</span>, <span class="string">&#x27;xiaozhao&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å°æ˜­&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;6.jpg&#x27;</span>, <span class="number">3</span>, <span class="string">&#x27;2013-09-05&#x27;</span>, <span class="number">1</span>, now(), now()),</span><br><span class="line">       (<span class="number">7</span>, <span class="string">&#x27;jixiaofu&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;çºªæ™“èŠ™&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;7.jpg&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;2005-08-01&#x27;</span>, <span class="number">1</span>, now(), now()),</span><br><span class="line">       (<span class="number">8</span>, <span class="string">&#x27;zhouzhiruo&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å‘¨èŠ·è‹¥&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;8.jpg&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;2014-11-09&#x27;</span>, <span class="number">1</span>, now(), now()),</span><br><span class="line">       (<span class="number">9</span>, <span class="string">&#x27;dingminjun&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;ä¸æ•å›&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;9.jpg&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;2011-03-11&#x27;</span>, <span class="number">1</span>, now(), now()),</span><br><span class="line">       (<span class="number">10</span>, <span class="string">&#x27;zhaomin&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;èµµæ•&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;10.jpg&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;2013-09-05&#x27;</span>, <span class="number">1</span>, now(), now()),</span><br><span class="line">       (<span class="number">11</span>, <span class="string">&#x27;luzhangke&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;é¹¿æ–å®¢&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;11.jpg&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;2007-02-01&#x27;</span>, <span class="number">3</span>, now(), now()),</span><br><span class="line">       (<span class="number">12</span>, <span class="string">&#x27;hebiweng&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;é¹¤ç¬”ç¿&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;12.jpg&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;2008-08-18&#x27;</span>, <span class="number">3</span>, now(), now()),</span><br><span class="line">       (<span class="number">13</span>, <span class="string">&#x27;fangdongbai&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;13.jpg&#x27;</span>, <span class="number">5</span>, <span class="string">&#x27;2012-11-01&#x27;</span>, <span class="number">3</span>, now(), now()),</span><br><span class="line">       (<span class="number">14</span>, <span class="string">&#x27;zhangsanfeng&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å¼ ä¸‰ä¸°&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;14.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2002-08-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">15</span>, <span class="string">&#x27;yulianzhou&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;ä¿è²èˆŸ&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;15.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2011-05-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">16</span>, <span class="string">&#x27;songyuanqiao&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;å®‹è¿œæ¡¥&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;16.jpg&#x27;</span>, <span class="number">2</span>, <span class="string">&#x27;2007-01-01&#x27;</span>, <span class="number">2</span>, now(), now()),</span><br><span class="line">       (<span class="number">17</span>, <span class="string">&#x27;chenyouliang&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;é™ˆå‹è°…&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;17.jpg&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;2015-03-21&#x27;</span>, <span class="keyword">NULL</span>, now(), now());</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp,</span><br><span class="line">     tb_dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_emp.name, tb_dept.name</span><br><span class="line"><span class="keyword">from</span> tb_emp,</span><br><span class="line">     tb_dept</span><br><span class="line"><span class="keyword">where</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_emp.name, tb_dept.name</span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line">         <span class="keyword">join</span> tb_dept <span class="keyword">on</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_emp.name, tb_dept.name</span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line">         <span class="keyword">left</span> <span class="keyword">join</span> tb_dept <span class="keyword">on</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_emp.name, tb_dept.name</span><br><span class="line"><span class="keyword">from</span> tb_dept</span><br><span class="line">         <span class="keyword">left</span> <span class="keyword">join</span> tb_emp <span class="keyword">on</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_emp.name, tb_dept.name</span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line">         <span class="keyword">right</span> <span class="keyword">join</span> tb_dept <span class="keyword">on</span> tb_emp.dept_id <span class="operator">=</span> tb_dept.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb_dept.id</span><br><span class="line"><span class="keyword">from</span> tb_dept</span><br><span class="line"><span class="keyword">where</span> tb_dept.name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> dept_id <span class="operator">=</span> (<span class="keyword">select</span> tb_dept.id <span class="keyword">from</span> tb_dept <span class="keyword">where</span> tb_dept.name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> entrydate</span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> entrydate <span class="operator">&gt;=</span> (<span class="keyword">select</span> entrydate <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ–¹ä¸œç™½&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id</span><br><span class="line"><span class="keyword">from</span> tb_dept</span><br><span class="line"><span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span></span><br><span class="line">   <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> dept_id <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">from</span> tb_dept <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;æ•™ç ”éƒ¨&#x27;</span> <span class="keyword">or</span> name <span class="operator">=</span> <span class="string">&#x27;å’¨è¯¢éƒ¨&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> entrydate, job</span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> (entrydate, job) <span class="operator">=</span> (<span class="keyword">select</span> entrydate, job <span class="keyword">from</span> tb_emp <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;éŸ¦ä¸€ç¬‘&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> tb_emp</span><br><span class="line"><span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.name</span><br><span class="line"><span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> entrydate <span class="operator">&gt;</span> <span class="string">&#x27;2006-01-01&#x27;</span>) e,</span><br><span class="line">     tb_dept d</span><br><span class="line"><span class="keyword">where</span> e.dept_id <span class="operator">=</span> d.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1. æŸ¥è¯¢ä»·æ ¼ä½äº10å…ƒçš„èœå“çš„åç§°ã€ä»·æ ¼åŠå…¶èœå“çš„åˆ†ç±»åç§°ã€‚</span></span><br><span class="line"><span class="keyword">select</span> d.name, d.price, c.name</span><br><span class="line"><span class="keyword">from</span> dish d,</span><br><span class="line">     category c</span><br><span class="line"><span class="keyword">where</span> d.category_id <span class="operator">=</span> c.id</span><br><span class="line">  <span class="keyword">and</span> d.price <span class="operator">&lt;</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. æŸ¥è¯¢æ‰€æœ‰ä»·æ ¼åœ¨10å…ƒï¼ˆå«ï¼‰åˆ°50å…ƒï¼ˆå«ï¼‰ä¹‹é—´ä¸”çŠ¶æ€ä¸ºèµ·å”®çš„èœå“ï¼Œå±•ç¤ºå‡ºèœå“çš„åç§°ã€ä»·æ ¼åŠå…¶èœå“çš„åˆ†ç±»åç§°ï¼ˆåŠæ—¶èœå“æ²¡æœ‰åˆ†ç±»ï¼Œä¹Ÿéœ€è¦å°†èœå“æŸ¥è¯¢å‡ºæ¥ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> d.name, d.price, c.name</span><br><span class="line"><span class="keyword">from</span> dish d</span><br><span class="line">         <span class="keyword">left</span> <span class="keyword">join</span> category c <span class="keyword">on</span> d.price <span class="keyword">between</span> <span class="number">10</span> <span class="keyword">and</span> <span class="number">50</span> <span class="keyword">and</span> d.status <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> c.id <span class="operator">=</span> d.category_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. æŸ¥è¯¢æ¯ä¸ªåˆ†ç±»ä¸‹æœ€è´µçš„èœå“ï¼Œå±•ç¤ºå‡ºåˆ†ç±»çš„åç§°ã€æœ€è´µçš„èœå“çš„ä»·æ ¼ã€‚</span></span><br><span class="line"><span class="keyword">select</span> c.name, <span class="built_in">max</span>(d.price)</span><br><span class="line"><span class="keyword">from</span> dish d,</span><br><span class="line">     category c</span><br><span class="line"><span class="keyword">where</span> d.category_id <span class="operator">=</span> c.id</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c.name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4.æŸ¥è¯¢å„ä¸ªåˆ†ç±»ä¸‹ï¼Œèœå“çŠ¶æ€ä¸ºâ€œèµ·å”®â€,å¹¶ä¸”è¯¥åˆ†ç±»ä¸‹èœå“æ€»æ•°é‡å¤§äºç­‰äº3çš„åˆ†ç±»åç§°ã€‚</span></span><br><span class="line"><span class="keyword">select</span> c.name, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">from</span> category c,</span><br><span class="line">     dish d</span><br><span class="line"><span class="keyword">where</span> c.id <span class="operator">=</span> d.category_id</span><br><span class="line">  <span class="keyword">and</span> d.status <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c.name</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 5.æŸ¥è¯¢&quot;å•†åŠ¡å¥—é¤A&quot;ä¸­åŒ…å«äº†å“ªäº›èœå“ï¼ˆå±•ç¤ºå‡ºå¥—é¤åç§°ã€ä»·æ ¼ã€åŒ…å«çš„èœå“åç§°ã€ä»·æ ¼ã€ä»½æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> s.name, s.price, d.name, d.price, sd.copies</span><br><span class="line"><span class="keyword">from</span> setmeal s,</span><br><span class="line">     setmeal_dish sd,</span><br><span class="line">     dish d</span><br><span class="line"><span class="keyword">where</span> s.id <span class="operator">=</span> sd.setmeal_id</span><br><span class="line">  <span class="keyword">and</span> d.id <span class="operator">=</span> sd.dish_id</span><br><span class="line">  <span class="keyword">and</span> s.name <span class="operator">=</span> <span class="string">&#x27;å•†åŠ¡å¥—é¤A&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 6. æŸ¥è¯¢å‡ºä½äºèœå“å¹³å‡ä»·æ ¼çš„èœå“ä¿¡æ¯ï¼ˆå±•ç¤ºå‡ºèœå“åç§°ã€èœå“ä»·æ ¼ï¼‰</span></span><br><span class="line"><span class="keyword">select</span> d.name, d.price</span><br><span class="line"><span class="keyword">from</span> dish d</span><br><span class="line"><span class="keyword">where</span> d.price <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(d.price) <span class="keyword">from</span> dish d);</span><br></pre></td></tr></table></figure>



<h1 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h1><ul>
<li><p>æ¦‚å¿µ</p>
<p>äº‹åŠ¡æ˜¯ä¸€ç»„æ“ä½œçš„é›†åˆï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¼šæŠŠæ‰€æœ‰æ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“ä¸€èµ·å‘ç³»ç»Ÿæäº¤æˆ–æ’¤é”€æ“ä½œè¯·æ±‚ï¼Œå³è¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</p>
<blockquote>
<p>æ³¨æ„äº‹é¡¹ï¼Œé»˜è®¤MySQLçš„äº‹åŠ¡æ˜¯è‡ªåŠ¨æäº¤çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ‰§è¡Œä¸€æ¡DMLè¯­å¥ï¼ŒMySQLä¼šç«‹å³éšå¼çš„æäº¤äº‹åŠ¡ã€‚</p>
</blockquote>
</li>
<li><p>äº‹åŠ¡æ§åˆ¶</p>
<ul>
<li>å¼€å¯äº‹åŠ¡ï¼šstart transaction; &#x2F; beginï¼›</li>
<li>æäº¤äº‹åŠ¡ï¼šcommitï¼›</li>
<li>å›æ»šäº‹åŠ¡ï¼šrollbackï¼›</li>
</ul>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- å¼€å¯äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">start</span> transaction ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤å­¦å·¥éƒ¨</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb_dept <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤éƒ¨é—¨ä¸‹çš„å‘˜å·¥</span></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb_emp <span class="keyword">where</span> dept_id <span class="operator">=</span><span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">commit</span> ;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç‰¹æ€§</p>
<ul>
<li>åŸå­æ€§ï¼šäº‹åŠ¡æ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸ ï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</li>
<li>ä¸€è‡´æ€§ï¼šäº‹åŠ¡å®Œæˆæ—¶ï¼Œå¿…é¡»ä½¿æ‰€æœ‰çš„æ•°æ®éƒ½ä¿æŒä¸€è‡´çŠ¶æ€</li>
<li>éš”ç¦»æ€§ï¼šæ•°æ®åº“ç³»ç»Ÿæä¾›çš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„ç‹¬ç«‹ç¯å¢ƒä¸‹è¿è¡Œ</li>
<li>æŒä¹…æ€§ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤æˆ–å›æ»šï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®æ”¹å˜å°±æ˜¯æ°¸ä¹…çš„</li>
</ul>
</li>
</ul>
<h1 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h1><ul>
<li><p>æ¦‚å¿µï¼šç´¢å¼•ä½¿å¸®åŠ©æ•°æ®åº“é«˜æ ¡è·å–æ•°æ®çš„æ•°æ®ç»“æ„ã€‚</p>
</li>
<li><p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li><p>æå‡æ•°æ®åº“æŸ¥è¯¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬</p>
</li>
<li><p>é€šè¿‡ç´¢å¼•å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½CPUæ¶ˆè€—</p>
</li>
</ul>
</li>
<li><p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç´¢å¼•ä¼šå ç”¨å­˜å‚¨ç©ºé—´ã€‚ï¼ˆå­˜å‚¨ç©ºé—´é—®é¢˜ä¸å¤§ï¼‰</li>
<li>ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†insertï¼Œupdateï¼Œdeleteçš„æ•ˆç‡ã€‚ï¼ˆæŸ¥è¯¢å æ®90%ä»¥ä¸Šçš„å·¥ä½œé‡ï¼‰</li>
</ul>
</li>
<li><p>ç»“æ„ï¼š</p>
<p>MySQLæ•°æ®åº“æ”¯æŒçš„ç´¢å¼•ç»“æ„æœ‰å¾ˆå¤šï¼Œå¦‚ï¼šHashç´¢å¼•ï¼ŒB+Treeç´¢å¼•ï¼ŒFull-Textç´¢å¼•ç­‰ã€‚æˆ‘ä»¬å¹³å¸¸è¯´çš„ç´¢å¼•ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜ ï¼Œéƒ½æ˜¯æŒ‡é»˜è®¤çš„B+Treeç»“æ„ç»„ç»‡çš„ç´¢å¼•ã€‚</p>
<blockquote>
<p>é‡‡ç”¨äºŒå‰æœç´¢æ ‘æˆ–çº¢é»‘æ ‘ï¼Œä¼šå¯¼è‡´å¤§æ•°æ®é‡æƒ…å†µä¸‹ï¼Œå±‚çº§æ·±ï¼Œæ£€ç´¢é€Ÿåº¦æ…¢ã€‚</p>
</blockquote>
<ul>
<li><p>B+ Tree(å¤šè·¯å¹³è¡¡æœç´¢æ ‘)</p>
<ul>
<li>æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªkey(æœ‰nä¸ªkeyï¼Œå°±æœ‰nä¸ªæŒ‡é’ˆ)ã€‚</li>
<li>æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œéå¶å­èŠ‚ç‚¹ä»…ç”¨äºç´¢å¼•æ•°æ®ã€‚</li>
<li>å¶å­èŠ‚ç‚¹å½¢æˆä¸€é¢—åŒå‘é“¾è¡¨ï¼Œä¾¿äºæ•°æ®çš„æ’åºåŠåŒºé—´èŒƒå›´æŸ¥è¯¢ã€‚</li>
</ul>
<p><img src="/2024/02/06/javaweb-day03-mysql/image-20240208173844570.png" alt="image-20240208173844570"></p>
</li>
</ul>
</li>
<li><p>è¯­æ³•</p>
<ul>
<li><p>åˆ›å»ºç´¢å¼•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> [<span class="keyword">unique</span>] index ç´¢å¼•å <span class="keyword">on</span> è¡¨å(å­—æ®µå,...)ï¼›</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹ç´¢å¼•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> è¡¨å;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ é™¤ç´¢å¼•</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> index ç´¢å¼•å <span class="keyword">on</span> è¡¨å;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å®ä¾‹</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºï¼šä¸º tb_empè¡¨çš„nameå­—æ®µå»ºç«‹ä¸€ä¸ªç´¢å¼•</span></span><br><span class="line"><span class="keyword">create</span> index idx_emp_name <span class="keyword">on</span> tb_emp(name);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ï¼šæŸ¥è¯¢tb_empè¡¨çš„ç´¢å¼•ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tb_emp;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ï¼šåˆ é™¤tb_empè¡¨ä¸­nameå­—æ®µçš„ç´¢å¼•</span></span><br><span class="line"><span class="keyword">drop</span> index idx_emp_name <span class="keyword">on</span> tb_emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>ä¸»é”®å­—æ®µï¼Œåœ¨å»ºè¡¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸»é”®ç´¢å¼•ã€‚</li>
<li>æ·»åŠ å”¯ä¸€çº¦æŸæ—¶ï¼Œæ•°æ®åº“å®é™…ä¸Šä¼šæ·»åŠ å”¯ä¸€ç´¢å¼•ã€‚</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb-day02-springbootwebè¯·æ±‚å“åº”</title>
    <url>/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/</url>
    <content><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205175737760.png" alt="image-20240205175737760"></p>
<ol>
<li><p>é€šè¿‡æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨ï¼Œè¯·æ±‚ç»“æŸåè¿”å›å“åº”ç»“æœ</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205175907200.png" alt="image-20240205175907200"></p>
<p>ä¹‹å‰ç¼–å†™çš„Controlleråªæ˜¯ç®€å•çš„javaç±»ï¼Œæ²¡æœ‰å®ç°ä»»ä½•çš„æ¥å£æˆ–è€…ç»§æ‰¿ä»»ä½•ç±»ï¼Œè¿™ä¸ªç±»Tomcatæ˜¯ä¸è¯†åˆ«çš„ï¼Œä¹Ÿä¸èƒ½ç›´æ¥è¿è¡Œï¼ŒTomcatè™½ç„¶ä¸è¯†åˆ«è‡ªå·±ç¼–å†™çš„Controllerï¼Œä½†æ˜¯è¯†åˆ«Servletå®¹å™¨ã€‚</p>
<p>å‰æ®µæµè§ˆå™¨å‘èµ·çš„è¯·æ±‚éƒ½ä¼šç»è¿‡DispatcherServletï¼Œå®ƒä¼šè½¬ç»™å„ä¸ªControllerï¼Œç”±Controllerå¤„ç†è¯·æ±‚ï¼Œå°†è¯·æ±‚å¤„ç†åçš„ç»“æœè¿”å›ç»™DispatcherServletï¼Œç”±äºå®ƒçš„é‡è¦æ€§ï¼Œæˆ‘ä»¬å°†å…¶ç§°ä¸ºå‰ç«¯æ§åˆ¶å™¨ã€‚</p>
<ul>
<li>WebæœåŠ¡å™¨å°†æµè§ˆå™¨å‘æ¥çš„æ•°æ®è¿›è¡Œè§£æï¼Œå¾—åˆ°HttpServletRequest</li>
<li>å°†è§£æçš„å¤„ç†ç»“æœå¤„ç†ä¸ºHttpServltResponseè¿”å›ç»™æµè§ˆå™¨</li>
</ul>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205180637734.png" alt="image-20240205180637734"></p>
</li>
<li><p>å®¢æˆ·ç«¯é€šè¿‡HTTPåè®®ä¸æµè§ˆå™¨è¿›è¡Œäº¤æµ</p>
</li>
</ol>
<h1 id="è¯·æ±‚"><a href="#è¯·æ±‚" class="headerlink" title="è¯·æ±‚"></a>è¯·æ±‚</h1><h2 id="è¯·æ±‚å·¥å…·"><a href="#è¯·æ±‚å·¥å…·" class="headerlink" title="è¯·æ±‚å·¥å…·"></a>è¯·æ±‚å·¥å…·</h2><p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205181106830.png" alt="image-20240205181106830"></p>
<p><strong>postman</strong></p>
<p>postmanæ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ç½‘é¡µè°ƒè¯•ä¸å‘é€ç½‘é¡µHTPPè¯·æ±‚çš„Chromeæ’ä»¶ã€‚</p>
<p>ä½œç”¨ï¼šå¸¸ç”¨äºè¿›è¡Œæ¥å£æµ‹è¯•ã€‚</p>
<h2 id="ç®€å•å‚æ•°"><a href="#ç®€å•å‚æ•°" class="headerlink" title="ç®€å•å‚æ•°"></a>ç®€å•å‚æ•°</h2><ul>
<li><p>åŸå§‹æ–¹å¼</p>
<p>åœ¨åŸå§‹çš„webç¨‹åºä¸­ï¼Œè·å–è¯·æ±‚å‚æ•°ï¼Œéœ€è¦é€šè¿‡HttpServletRequestå¯¹è±¡æ‰‹åŠ¨è·å–ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205181550921.png" alt="image-20240205181550921"></p>
</li>
</ul>
<p>â€‹		ç¼ºç‚¹ï¼šæ“ä½œæ–¹å¼æ¯”è¾ƒç¹çï¼Œéœ€è¦å°†HttpServletRequestè¿›è¡Œç±»å‹è½¬æ¢</p>
<ul>
<li><p>Springbootæ–¹å¼ï¼ˆä¸‹é¢å·¦ä¾§é»„è‰²éƒ¨åˆ†æ˜¯sprinbootæ¥å—ç®€å•å‚æ•°çš„å‡½æ•°ç¼–å†™æ–¹å¼ï¼Œå³ä¾§æ˜¯postmanåˆ†åˆ«ä½¿ç”¨getå’Œpostè¯·æ±‚æ–¹å¼çš„å‘é€æ•ˆæœï¼‰ï¼Œ<font color="red">åªè¦å½¢å‚åå’Œå‘é€å‚æ•°åä¸€è‡´å°±å¯è‡ªåŠ¨æ¥æ”¶æˆåŠŸã€‚</font></p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205183539465.png" alt="image-20240205183539465"></p>
</li>
</ul>
<p>â€‹	å¦‚æœæ–¹æ³•å½¢å‚åç§°ä¸è¯·æ±‚å‚æ•°åç§°ä¸åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨@RequestParamå®Œæˆæ˜ å°„ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205184136093.png" alt="image-20240205184136093"></p>
<p>æ³¨æ„äº‹é¡¹ï¼š@RequestParamä¸­çš„requiredå±æ€§é»˜è®¤ä¸ºTrueï¼Œä»£è¡¨è¯¥è¯·æ±‚å‚æ•°å¿…é¡»ä¼ é€’ï¼Œå¦‚æœä¸ä¼ é€’å°†æŠ¥é”™ã€‚å¦‚æœè¯¥å‚æ•°æ˜¯å¯ä»¥é€‰æ‹©çš„ï¼Œå¯ä»¥å°†requiredçš„å±æ€§è®¾ç½®ä¸ºfalseã€‚</p>
<p>æ€»ç»“ï¼š</p>
<ol>
<li><p>åŸå§‹æ–¹æ³•è·å–è¯·æ±‚å‚æ•°</p>
<ul>
<li>Controlleræ–¹æ³•å½¢å‚ä¸­å£°æ˜HttpServletRequestå¯¹è±¡</li>
<li>è°ƒç”¨å¯¹è±¡çš„getParameter(å‚æ•°å)</li>
</ul>
</li>
<li><p>SpringBootä¸­æ¥å—ç®€å•å‚æ•°</p>
<ul>
<li>è¯·æ±‚å‚æ•°åä¸æ–¹æ³•å½¢å‚å˜é‡åç›¸åŒ</li>
<li>ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢</li>
</ul>
</li>
<li><p>@RequestParamæ³¨è§£</p>
<ul>
<li>æ–¹æ³•å½¢å‚åç§°ä¸è¯·æ±‚å‚æ•°åç§°ä¸åŒ¹é…</li>
<li>è¯¥æ³¨è§£çš„requiredå±æ€§é»˜è®¤æ˜¯trueï¼Œä»£è¡¨è¯·æ±‚å‚æ•°å¿…é¡»ä¼ é€’</li>
</ul>
</li>
</ol>
<h2 id="å®ä½“å‚æ•°ï¼ˆåº”å¯¹ç®€å•å‚æ•°æ•°é‡è¿‡å¤šçš„æƒ…å†µï¼‰"><a href="#å®ä½“å‚æ•°ï¼ˆåº”å¯¹ç®€å•å‚æ•°æ•°é‡è¿‡å¤šçš„æƒ…å†µï¼‰" class="headerlink" title="å®ä½“å‚æ•°ï¼ˆåº”å¯¹ç®€å•å‚æ•°æ•°é‡è¿‡å¤šçš„æƒ…å†µï¼‰"></a>å®ä½“å‚æ•°ï¼ˆåº”å¯¹ç®€å•å‚æ•°æ•°é‡è¿‡å¤šçš„æƒ…å†µï¼‰</h2><ul>
<li><p>ç®€å•å®ä½“å¯¹è±¡ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å¯¹è±¡å±æ€§åç›¸åŒï¼Œå®šä¹‰POJOæ¥å—å³å¯ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205185118298.png" alt="image-20240205185118298"></p>
</li>
</ul>
<h2 id="å¤æ‚å®ä½“å‚æ•°ï¼ˆåº”å¯¹å‚æ•°éç®€å•ç±»å‹çš„æƒ…å†µï¼‰"><a href="#å¤æ‚å®ä½“å‚æ•°ï¼ˆåº”å¯¹å‚æ•°éç®€å•ç±»å‹çš„æƒ…å†µï¼‰" class="headerlink" title="å¤æ‚å®ä½“å‚æ•°ï¼ˆåº”å¯¹å‚æ•°éç®€å•ç±»å‹çš„æƒ…å†µï¼‰"></a>å¤æ‚å®ä½“å‚æ•°ï¼ˆåº”å¯¹å‚æ•°éç®€å•ç±»å‹çš„æƒ…å†µï¼‰</h2><ul>
<li><p>å¤æ‚å®ä½“å¯¹è±¡ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚å¯¹è±¡å±æ€§åç›¸åŒï¼ŒæŒ‰ç…§å¯¹è±¡å±‚æ¬¡ç»“æ„å…³ç³»å³å¯æ¥æ”¶åµŒå¥—POJOå±æ€§å‚æ•°ã€‚ï¼ˆ<font color="red">ä¸ç®€å•å®ä½“å‚æ•°ä¸€è‡´ï¼Œåªè¦ä¿è¯å¯¹åº”çš„åµŒå¥—å…³ç³»ä¸å‘ç”Ÿå˜åŒ–å³å¯</font>ï¼‰</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205190319798.png" alt="image-20240205190319798"></p>
</li>
</ul>
<h2 id="æ•°ç»„é›†åˆå‚æ•°ï¼ˆå½¢å‚å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…é›†åˆï¼‰"><a href="#æ•°ç»„é›†åˆå‚æ•°ï¼ˆå½¢å‚å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…é›†åˆï¼‰" class="headerlink" title="æ•°ç»„é›†åˆå‚æ•°ï¼ˆå½¢å‚å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…é›†åˆï¼‰"></a>æ•°ç»„é›†åˆå‚æ•°ï¼ˆå½¢å‚å¯ä»¥æ˜¯æ•°ç»„æˆ–è€…é›†åˆï¼‰</h2><ul>
<li><p>æ•°ç»„å‚æ•°ï¼šè¯·æ±‚å‚æ•°ä¸å½¢å‚æ•°ç»„åç§°ç›¸åŒä¸”è¯·æ±‚å‚æ•°ä¸ºå¤šä¸ªï¼Œå®šä¹‰æ•°ç»„ç±»å‹å½¢å‚å³å¯æ¥æ”¶å‚æ•°</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205190631950.png" alt="image-20240205190631950"></p>
</li>
<li><p>é›†åˆå‚æ•°ï¼šè¯·æ±‚å‚æ•°åä¸å½¢å‚é›†åˆåç§°ç›¸åŒä¸”è¯·æ±‚å‚æ•°ä¸ºå¤šä¸ªï¼Œ@RequestParamç»‘å®šå‚æ•°å…³ç³»ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205191132398.png" alt="image-20240205191132398"></p>
</li>
</ul>
<h2 id="æ—¥æœŸå‚æ•°"><a href="#æ—¥æœŸå‚æ•°" class="headerlink" title="æ—¥æœŸå‚æ•°"></a>æ—¥æœŸå‚æ•°</h2><ul>
<li><p>æ—¥æœŸå‚æ•°ï¼šä½¿ç”¨@DateTimeFormatæ³¨è§£å®Œæˆæ—¥æœŸå‚æ•°æ ¼å¼è½¬æ¢</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205191314005.png" alt="image-20240205191314005"></p>
</li>
</ul>
<h2 id="Jsonå‚æ•°"><a href="#Jsonå‚æ•°" class="headerlink" title="Jsonå‚æ•°"></a>Jsonå‚æ•°</h2><ul>
<li><p>JSONå‚æ•°ï¼šJSONæ•°æ®é”®åä¸å½¢å‚å¯¹è±¡å±æ€§åç›¸åŒï¼Œå®šä¹‰POJOç±»å‹å½¢å‚å³å¯æ¥æ”¶å‚æ•°ï¼Œéœ€è¦ä½¿ç”¨@RequestBodyæ ‡è¯†</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205192029505.png" alt="image-20240205192029505"></p>
</li>
</ul>
<h2 id="è·¯å¾„å‚æ•°"><a href="#è·¯å¾„å‚æ•°" class="headerlink" title="è·¯å¾„å‚æ•°"></a>è·¯å¾„å‚æ•°</h2><ul>
<li><p>è·¯å¾„å‚æ•°ï¼šé€šè¿‡è¯·æ±‚URLç›´æ¥ä¼ é€’å‚æ•°ï¼Œä½¿ç”¨{â€¦}æ¥è¡¨ç¤ºè¯¥è·¯å¾„å‚æ•°ï¼Œéœ€è¦ä½¿ç”¨@PathVariableè·å–è·¯å¾„å‚æ•°</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205192557467.png" alt="image-20240205192557467"></p>
</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205192747492.png" alt="image-20240205192747492"></p>
<h1 id="å“åº”æ•°æ®-å…è®¸è¿”å›å„ç§ç±»å‹çš„æ•°æ®"><a href="#å“åº”æ•°æ®-å…è®¸è¿”å›å„ç§ç±»å‹çš„æ•°æ®" class="headerlink" title="å“åº”æ•°æ®(å…è®¸è¿”å›å„ç§ç±»å‹çš„æ•°æ®)"></a>å“åº”æ•°æ®(å…è®¸è¿”å›å„ç§ç±»å‹çš„æ•°æ®)</h1><p>æµè§ˆå™¨å‘èµ·è¯·æ±‚åæœåŠ¡å™¨å“åº”ä¼šè¿”å›å“åº”çš„æ•°æ®ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205193201481.png" alt="image-20240205193201481"></p>
<p>@ResponseBodyï¼ˆå°†æ–¹æ³•çš„è¿”å›å€¼ç›´æ¥ä½œä¸ºå“åº”æ•°æ®å“åº”ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ï¼‰</p>
<ul>
<li>ç±»å‹ï¼šæ–¹æ³•æ³¨è§£ã€ç±»æ³¨è§£</li>
<li>ä½ç½®ï¼šControlleræ–¹æ³•ä¸Š&#x2F;ç±»ä¸Š</li>
<li>ä½œç”¨ï¼šå°†æ–¹æ³•è¿”å›å€¼ç›´æ¥å“åº”ï¼Œ<font color="red">å¦‚æœè¿”å›å€¼ç±»å‹æ˜¯å®ä½“å¯¹è±¡&#x2F;é›†åˆï¼Œå°†ä¼šè½¬åŒ–ä¸ºJSONæ ¼å¼å“åº”</font></li>
<li>è¯´æ˜ï¼š@RestController&#x3D;@Controller+@ResponseBody</li>
</ul>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205194650624.png" alt="image-20240205194650624"></p>
<p>ç”±äºä¸åŒé¡µé¢çš„è§£æç»“æœä¸åŒï¼Œä¸ºäº†ä¾¿äºç®¡ç†ï¼Œæå‡ºäº†ä»¥ä¸‹çš„ç»Ÿä¸€å“åº”ç»“æœ</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205194823402.png" alt="image-20240205194823402"></p>
<p><strong>æ€»ç»“</strong></p>
<ol>
<li><p>@ResponseBody</p>
<p>ä½ç½®ï¼šControllerç±»ä¸Š&#x2F;æ–¹æ³•ä¸Š</p>
<p>ä½œç”¨ï¼šå°†æ–¹æ³•è¿”å›å€¼ç›´æ¥å“åº”ï¼Œè‹¥è¿”å›å€¼ç±»å‹æ˜¯å®ä½“å¯¹è±¡&#x2F;é›†åˆï¼Œè½¬JSONæ ¼å¼å“åº”</p>
</li>
<li><p>ç»Ÿä¸€å“åº”ç»“æœ</p>
<p>Result(code, msg, data)</p>
</li>
</ol>
<p><strong>æ¡ˆä¾‹</strong></p>
<p>è·å–å‘˜å·¥æ•°æ®ï¼Œè¿”å›ç»Ÿä¸€å“åº”ç»“æœï¼Œåœ¨é¡µé¢æ¸²æŸ“å±•ç¤º</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205195526399.png" alt="image-20240205195526399"></p>
<p>æ­¥éª¤</p>
<ol>
<li>åœ¨pom.xmlæ–‡ä»¶ä¸­å¼•å…¥dom4jçš„ä¾èµ–ï¼Œç”¨äºè§£æXMLæ–‡ä»¶</li>
<li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„è§£æXMLçš„å·¥å…·ç±»XMLParserUtilsï¼Œå¯¹åº”çš„å®ä½“ç±»Empï¼ŒXMLæ–‡ä»¶emp.xml</li>
<li>å¼•å…¥èµ„æ–™ä¸­æä¾›çš„é™æ€é¡µé¢æ–‡ä»¶ï¼Œæ”¾åˆ°resourcesä¸‹çš„staticç›®å½•ä¸‹</li>
<li>ç¼–å†™Controllerç¨‹åºï¼Œå¤„ç†è¯·æ±‚ï¼Œå“åº”æ•°æ®</li>
</ol>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205200314718.png" alt="image-20240205200314718"></p>
<h1 id="åˆ†å±‚è§£è€¦"><a href="#åˆ†å±‚è§£è€¦" class="headerlink" title="åˆ†å±‚è§£è€¦"></a>åˆ†å±‚è§£è€¦</h1><h2 id="ä¸‰å±‚æ¶æ„"><a href="#ä¸‰å±‚æ¶æ„" class="headerlink" title="ä¸‰å±‚æ¶æ„"></a>ä¸‰å±‚æ¶æ„</h2><p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205220155037.png" alt="image-20240205220155037"></p>
<p>ä¸‰å±‚æ¶æ„</p>
<ul>
<li><p>controllerï¼šæ§åˆ¶å±‚ï¼Œæ¥æ”¶å‰ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå¹¶å“åº”æ•°æ®</p>
</li>
<li><p>serviceï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
</li>
<li><p>daoï¼šæ•°æ®è®¿é—®å±‚ï¼ˆData Access Objectï¼‰ï¼ˆæŒä¹…å±‚ï¼‰ï¼Œè´Ÿè´£æ•°æ®è®¿é—®æ“ä½œï¼ŒåŒ…æ‹¬æ•°æ®çš„å¢åˆ æ”¹æŸ¥ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205220322441.png" alt="image-20240205220322441"></p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205221510610.png" alt="image-20240205221510610"></p>
</li>
</ul>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205221614917.png" alt="image-20240205221614917"></p>
<h2 id="åˆ†å±‚è§£è€¦-1"><a href="#åˆ†å±‚è§£è€¦-1" class="headerlink" title="åˆ†å±‚è§£è€¦"></a>åˆ†å±‚è§£è€¦</h2><ul>
<li>å†…èšï¼šè½¯ä»¶ä¸­å„ä¸ªåŠŸèƒ½æ¨¡å—å†…éƒ¨çš„åŠŸèƒ½è”ç³»ã€‚</li>
<li>è€¦åˆï¼šè¡¡é‡è½¯ä»¶ä¸­å„ä¸ªå±‚&#x2F;æ¨¡å—ä¹‹é—´çš„ä¾èµ–ã€å…³è”ç¨‹åº¦ã€‚</li>
<li>è½¯ä»¶è®¾è®¡åŸåˆ™ï¼šé«˜å†…èšä½è€¦åˆã€‚</li>
</ul>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205222503596.png" alt="image-20240205222503596"></p>
<p><font color="red">ç›®å‰çš„controllerå±‚å’Œserviceå±‚æ˜¯è€¦åˆçš„ï¼Œserviceå±‚å‘ç”Ÿå˜åŠ¨ä¼šå¯¼è‡´controllerå±‚çš„ä»£ç ä¹Ÿè¦åšå‡ºç›¸åº”çš„è°ƒæ•´ã€‚</font></p>
<p><font color="red">äºæ˜¯springbootå‡ºç°äº†å®¹å™¨çš„æ¦‚å¿µï¼Œå®¹å™¨å­˜æ”¾åˆ›å»ºçš„å¯¹è±¡ï¼Œcontrolleréœ€è¦ä»€ä¹ˆæ ·çš„serviceå¯¹è±¡å°±ä»å®¹å™¨ä¸­æå–ã€‚è¦å®ç°è¿™ä¸€æ­¥ï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚ä½•å°†serviceå±‚çš„å¯¹è±¡è£…å…¥å®¹å™¨ä¸­ï¼Œå¦‚ä½•ä»controllerå±‚è¯»å–å®¹å™¨çš„å†…å®¹ã€‚åˆ†åˆ«å¯¹åº”äº†ä¸¤ä¸ªé—®é¢˜ï¼Œæ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥ã€‚</font></p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205223108844.png" alt="image-20240205223108844"></p>
<p>æ§åˆ¶åè½¬ï¼šInversion Of Controlï¼Œç®€ç§°<font color="red">IOC</font>ã€‚å¯¹è±¡çš„åˆ›å»ºæ§åˆ¶æƒæ˜¯ç”±ç¨‹åºè‡ªèº«è½¬ç§»åˆ°å¤–éƒ¨ï¼ˆå®¹å™¨ï¼‰è¿™ç§æ€æƒ³ç§°ä¸ºæ§åˆ¶åè½¬ã€‚</p>
<p>ä¾èµ–æ³¨å…¥ï¼šDependency Injectionï¼Œç®€ç§°<font color="red">DI</font>ã€‚å®¹å™¨ä¸ºåº”ç”¨ç¨‹åºæä¾›è¿è¡Œæ—¶ï¼Œæ‰€ä¾èµ–çš„èµ„æºï¼Œç§°ä¸ºä¾èµ–æ³¨å…¥ã€‚</p>
<p>Beanå¯¹è±¡ï¼šIOCå®¹å™¨ä¸­åˆ›å»ºã€ç®¡ç†çš„å¯¹è±¡ï¼Œç§°ä¹‹ä¸º<font color="red">bean</font>ã€‚</p>
<h2 id="IOC-DI-å…¥é—¨"><a href="#IOC-DI-å…¥é—¨" class="headerlink" title="IOC &amp;  DI å…¥é—¨"></a>IOC &amp;  DI å…¥é—¨</h2><ol>
<li>Serviceå±‚åŠDaoå±‚çš„å®ç°ç±»ï¼Œäº¤ç»™IOCå®¹å™¨ç®¡ç†ã€‚</li>
<li>ä¸ºControlleråŠServiceæ³¨å…¥è¿è¡Œæ—¶ï¼Œä¾èµ–çš„å¯¹è±¡ã€‚</li>
<li>è¿è¡Œæµ‹è¯•ã€‚</li>
</ol>
<p>å®ç°æœºåˆ¶</p>
<p>ç»™EmpServerå±‚å’ŒEmpDaoå±‚å¯¹åº”çš„ç±»åŠ ä¸Šæ³¨é‡Š@Componentï¼Œè¡¨ç¤ºå°†å½“å‰ç±»äº¤ç»™IOCå®¹å™¨ç®¡ç†ï¼Œç§°ä¸ºIOCå®¹å™¨çº¢çš„Beanå¯¹è±¡ã€‚å®Œæˆäº†æ§åˆ¶åè½¬ã€‚</p>
<p>ç»™Controllerå±‚çš„serviceå˜é‡å’ŒEmpServiceå±‚çš„daoå¯¹è±¡åŠ ä¸Š@Autowiredæ³¨é‡Šï¼Œè¡¨ç¤ºè¿è¡Œæ—¶ï¼ŒIOCå®¹å™¨ä¼šæä¾›è¯¥ç±»å‹çš„Beanå¯¹è±¡ï¼Œå¹¶èµ‹å€¼ç»™è¯¥å˜é‡ï¼Œå®Œæˆäº†ä¾èµ–æ³¨å…¥ã€‚</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205224114750.png" alt="image-20240205224114750"></p>
<h2 id="IOCè¯¦è§£ï¼ˆæ§åˆ¶åè½¬ï¼‰"><a href="#IOCè¯¦è§£ï¼ˆæ§åˆ¶åè½¬ï¼‰" class="headerlink" title="IOCè¯¦è§£ï¼ˆæ§åˆ¶åè½¬ï¼‰"></a>IOCè¯¦è§£ï¼ˆæ§åˆ¶åè½¬ï¼‰</h2><p>Beançš„å£°æ˜</p>
<p>è¦æŠŠæŸä¸ªå¯¹è±¡äº¤ç»™IOCå®¹å™¨ç®¡ç†ï¼Œéœ€è¦åœ¨å¯¹åº”çš„ç±»ä¸ŠåŠ ä¸Šå¦‚ä¸‹çš„æ³¨é‡Šä¹‹ä¸€ï¼š</p>
<table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>è¯´æ˜</th>
<th>ä½ç½®</th>
</tr>
</thead>
<tbody><tr>
<td>@Component</td>
<td>å£°æ˜beançš„åŸºç¡€æ³¨è§£</td>
<td>ä¸å±äºä»¥ä¸‹ä¸‰ç±»æ—¶ï¼Œç”¨æ­¤æ³¨è§£</td>
</tr>
<tr>
<td>@Controller</td>
<td>@Componentçš„è¡ç”Ÿæ³¨è§£</td>
<td>æ ‡æ³¨åœ¨æ§åˆ¶å™¨ç±»ä¸Š</td>
</tr>
<tr>
<td>@Service</td>
<td>@Componentçš„è¡ç”Ÿæ³¨è§£</td>
<td>æ ‡æ³¨åœ¨ä¸šåŠ¡ç±»ä¸Š</td>
</tr>
<tr>
<td>@Repository</td>
<td>@Componentçš„è¡ç”Ÿæ³¨è§£</td>
<td>æ ‡æ³¨åœ¨æ•°æ®è®¿é—®ç±»ä¸Šï¼ˆç”±äºä¸mybatisæ•´åˆï¼Œç”¨çš„è¾ƒå°‘ï¼‰</td>
</tr>
</tbody></table>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205230749072.png" alt="image-20240205230749072"></p>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>å£°æ˜Beançš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡valueå±æ€§æŒ‡å®šBeançš„åå­—ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™ã€‚</li>
<li>ä½¿ç”¨ä»¥ä¸Šå››ä¸ªæ³¨é‡Šéƒ½å¯ä»¥å£°æ˜beanï¼Œä½†æ˜¯åœ¨springbootç»§æ‰¿webå¼€å‘ä¸­ï¼ŒControllerå±‚å£°æ˜çš„beanåªèƒ½ç”¨Controlleræ³¨é‡Šã€‚</li>
</ul>
<p><strong>Beanç»„ä»¶æ‰«æ</strong></p>
<ul>
<li><p>å‰é¢å£°æ˜beançš„å››å¤§æ³¨è§£ï¼Œè¦æƒ³ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦è¢«ç»„ä»¶æ‰«ææ³¨è§£@ComponentScanæ‰«æã€‚</p>
</li>
<li><p>@ComponentScanæ³¨è§£è™½ç„¶æ²¡æœ‰æ˜¾å¼é…ç½®ï¼Œä½†æ˜¯å®é™…ä¸Šå·²ç»åŒ…å«åœ¨äº†å¯åŠ¨ç±»å£°æ˜æ³¨è§£@SpringBootApplicationä¸­ï¼Œé»˜è®¤æ‰«æçš„èŒƒå›´æ—¶å¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ã€‚</p>
<p>æ˜¾å¼æŒ‡å®šæ‰«æèŒƒå›´çš„ç¤ºä¾‹</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205231744806.png" alt="image-20240205231744806"></p>
</li>
</ul>
<h2 id="DIè¯¦è§£ï¼ˆå‡ºç°å¤šä¸ªåŒç±»å‹çš„Beanå¯¹è±¡æ—¶è¯¥å¦‚ä½•åŠï¼‰"><a href="#DIè¯¦è§£ï¼ˆå‡ºç°å¤šä¸ªåŒç±»å‹çš„Beanå¯¹è±¡æ—¶è¯¥å¦‚ä½•åŠï¼‰" class="headerlink" title="DIè¯¦è§£ï¼ˆå‡ºç°å¤šä¸ªåŒç±»å‹çš„Beanå¯¹è±¡æ—¶è¯¥å¦‚ä½•åŠï¼‰"></a>DIè¯¦è§£ï¼ˆå‡ºç°å¤šä¸ªåŒç±»å‹çš„Beanå¯¹è±¡æ—¶è¯¥å¦‚ä½•åŠï¼‰</h2><p>Beanæ³¨å…¥</p>
<ul>
<li><p>Autowiredæ³¨è§£ï¼Œé»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹è¿›è¡Œï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªç›¸åŒç±»å‹çš„beanï¼Œå°†ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205232248743.png" alt="image-20240205232248743"></p>
</li>
<li><p>è§£å†³æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ul>
<li><p>@Primaryï¼ˆåŠ åœ¨ä¸¤ä¸ªç«äº‰çš„å°ç±»ä¸Šæ–¹ï¼‰</p>
</li>
<li><p>@Qualifierï¼ˆåŠ åœ¨å¤§ç±»çš„å˜é‡ä¸Šæ–¹ï¼‰ï¼ˆæƒé™æœ€é«˜ï¼Œæ¯”primaryçš„æƒé™é«˜ï¼‰</p>
</li>
<li><p>@Resourceï¼ˆå»æ‰autowiredï¼ŒåŠ åœ¨å¤§ç±»çš„å˜é‡ä¸Šæ–¹ï¼‰</p>
<p><img src="/2024/02/05/javaweb-day02-springbootweb%E8%AF%B7%E6%B1%82%E5%93%8D%E5%BA%94/image-20240205233023664.png" alt="image-20240205233023664"></p>
</li>
</ul>
</li>
</ul>
<h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>ä¾èµ–æ³¨å…¥çš„æ³¨è§£<ul>
<li>Autowiredï¼šé»˜è®¤æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…ã€‚</li>
<li>å¦‚æœåŒç±»å‹çš„beanå­˜åœ¨å¤šä¸ªï¼š<ul>
<li>@Primary</li>
<li>@Autowired + @Qualified(â€œbeançš„åç§°â€)</li>
<li>@Resource(name &#x3D; â€œbeançš„åç§°â€)</li>
</ul>
</li>
</ul>
</li>
<li>@Resourceå’Œ@Autowiredçš„åŒºåˆ«<ul>
<li>@Autowiredæ˜¯springæ¡†æ¶æä¾›çš„æ³¨è§£ï¼Œè€Œ@Resourceæ˜¯JDKæä¾›çš„æ³¨è§£ã€‚</li>
<li>@Autowiredé»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹æ³¨å…¥ï¼Œè€Œ@Resourceæ˜¯é»˜è®¤æŒ‰ç…§åç§°æ³¨å…¥ï¼Œåç§°æœªæŒ‡å®šçš„è¯é»˜è®¤æ˜¯é¦–å­—æ¯å°å†™çš„ç±»å</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>javaweb_day01_maven_springbootwebå…¥é—¨</title>
    <url>/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/</url>
    <content><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯maven"><a href="#ä»€ä¹ˆæ˜¯maven" class="headerlink" title="ä»€ä¹ˆæ˜¯maven?"></a>ä»€ä¹ˆæ˜¯maven?</h1><p>mavenæ˜¯apacheæ——ä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæ˜¯ä¸€æ¬¾ç”¨äºç®¡ç†å’Œæ„å»ºjavaé¡¹ç›®çš„å·¥å…·ã€‚</p>
<h1 id="mavençš„ä½œç”¨"><a href="#mavençš„ä½œç”¨" class="headerlink" title="mavençš„ä½œç”¨"></a>mavençš„ä½œç”¨</h1><ul>
<li><p>ä¾èµ–ç®¡ç†</p>
<p>æ–¹ä¾¿å¿«æ·çš„ç®¡ç†é¡¹ç›®ä¾èµ–çš„èµ„æºï¼ˆjaråŒ…ï¼‰ï¼Œé¿å…ç‰ˆæœ¬å†²çªé—®é¢˜</p>
<p>åˆ›å»ºmavené¡¹ç›®åï¼Œè¦ä½¿ç”¨ä»€ä¹ˆjaråŒ…ï¼Œä¸ç”¨å†å•ç‹¬å¯¼å…¥ï¼Œåªè¦åœ¨pom.xmlæ–‡ä»¶çš„dependenciesä¸‹å¼•å…¥å³å¯ã€‚</p>
</li>
<li><p>ç»Ÿä¸€é¡¹ç›®ç»“æ„</p>
<p>  æä¾›æ ‡å‡†ã€ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„</p>
<blockquote>
<p>eclipseã€myeclipseã€intellij ideaå„ä¸ªjavaç¼–è¯‘å™¨äº§ç”Ÿçš„javaé¡¹ç›®æ˜¯ä¸èƒ½ç›´æ¥äº’ç›¸å¯¼å…¥çš„ï¼Œé€šè¿‡mavenå¯ä»¥æä¾›æ ‡å‡†ã€ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116155606951.png" alt="image-20240116155606951"></p>
</blockquote>
<p>  é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤º</p>
</li>
<li><p>é¡¹ç›®æ„å»º</p>
<p>  æ ‡å‡†è·¨å¹³å°ï¼ˆLinuxã€Windowsã€MacOSï¼‰çš„è‡ªåŠ¨åŒ–é¡¹ç›®æ„å»ºæ–¹å¼</p>
<p>  <img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116155754884.png" alt="image-20240116155754884"></p>
</li>
</ul>
<h1 id="Mavenæ¦‚è¿°"><a href="#Mavenæ¦‚è¿°" class="headerlink" title="Mavenæ¦‚è¿°"></a>Mavenæ¦‚è¿°</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><ul>
<li>Apache Mavenæ˜¯ä¸€ä¸ªé¡¹ç›®ç®¡ç†å’Œæ„å»ºå·¥å…·ï¼Œå®ƒåŸºäºé¡¹ç›®å¯¹è±¡æ¨¡å‹ï¼ˆPOMï¼‰çš„æ¦‚å¿µï¼Œé€šè¿‡ä¸€å°æ®µæè¿°ä¿¡æ¯æ¥ç®¡ç†é¡¹ç›®çš„æ„å»ºã€‚(POMï¼šproject object model)</li>
<li>ä½œç”¨<ul>
<li>æ–¹ä¾¿çš„ä¾èµ–ç®¡ç†</li>
<li>ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„</li>
<li>æ ‡å‡†çš„é¡¹ç›®æ„å»ºæµç¨‹</li>
</ul>
</li>
<li>å®˜ç½‘ï¼š<a href="http://maven.apache.org/">http://maven.apache.org/</a></li>
</ul>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116161041259.png" alt="image-20240116161041259"></p>
<p>ä»“åº“ï¼šç”¨äºå­˜å‚¨èµ„æºï¼Œç®¡ç†å„ç§jiaråŒ…ã€‚</p>
<ul>
<li>æœ¬åœ°ä»“åº“ï¼šè‡ªå·±è®¡ç®—æœºä¸Šçš„ä¸€ä¸ªç›®å½•ã€‚</li>
<li>ä¸­å¤®ä»“åº“ï¼šç”±mavenå›¢é˜Ÿç»´æŠ¤çš„å…¨çƒå”¯ä¸€çš„ã€‚ä»“åº“åœ°å€ï¼š<a href="https://repo1/maven.org/maven2/">https://repo1/maven.org/maven2/</a></li>
<li>è¿œç¨‹ä»“åº“ï¼ˆç§æœï¼‰ï¼šä¸€èˆ¬ç”±å…¬å¸å›¢é˜Ÿæ­å»ºçš„ç§æœ‰ä»“åº“ã€‚</li>
</ul>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul>
<li><p>å®‰è£…æ­¥éª¤</p>
<ol>
<li><p>è§£å‹apche-maven-3.6.1-bin.zip</p>
</li>
<li><p>é…ç½®æœ¬åœ°ä»“åº“ï¼šä¿®æ”¹conf&#x2F;settings.xmlä¸­çš„&lt;localRepository&gt;ä¸ºä¸€ä¸ªæŒ‡å®šç›®å½•ï¼Œ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">localRepository</span>&gt;</span>E:\module\apache-maven-3.6.1-bin\apache-maven-3.6.1\mvn_repo<span class="tag">&lt;/<span class="name">localRepository</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®é˜¿é‡Œäº‘ç§æœï¼šä¿®æ”¹conf&#x2F;settings.xmlä¸­çš„&lt;mirrors&gt;æ ‡ç­¾ï¼Œä¸ºå…¶æ·»åŠ å¦‚ä¸‹å­æ ‡ç­¾ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/group/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®ç¯å¢ƒå˜é‡ï¼šMAVEN_HOMEä¸ºmavençš„è§£å‹ç›®å½•ï¼Œå¹¶å°†å…¶binç›®å½•åŠ å…¥åˆ°PATHç¯å¢ƒå˜é‡ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116162338034.png" alt="image-20240116162338034"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116162402754.png" alt="image-20240116162402754"></p>
</li>
</ol>
</li>
<li><p>æµ‹è¯•</p>
<figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240116162547523.png" alt="image-20240116162547523"></p>
</li>
</ul>
<h1 id="IDEAç»§æ‰¿MAVEN"><a href="#IDEAç»§æ‰¿MAVEN" class="headerlink" title="IDEAç»§æ‰¿MAVEN"></a>IDEAç»§æ‰¿MAVEN</h1><h2 id="å…¨å±€é…ç½®Mavenç¯å¢ƒ"><a href="#å…¨å±€é…ç½®Mavenç¯å¢ƒ" class="headerlink" title="å…¨å±€é…ç½®Mavenç¯å¢ƒ"></a>å…¨å±€é…ç½®Mavenç¯å¢ƒ</h2><ol>
<li>è¿›å…¥å…¨å±€è®¾ç½®</li>
</ol>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143305873.png" alt="image-20240117143305873"></p>
<ol start="2">
<li><p>é…ç½®mavenä¸‰ä»¶å¥—ï¼ˆæœ¬åœ°ç›®å½•ï¼Œsettings.xmlï¼Œæœ¬åœ°ä»“åº“ï¼‰</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143430051.png" alt="image-20240117143430051"></p>
</li>
<li><p>é…ç½®JREç‰ˆæœ¬</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143458156.png" alt="image-20240117143458156"></p>
</li>
<li><p>é…ç½®å­—èŠ‚ç æ–‡ä»¶ç‰ˆæœ¬</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143512837.png" alt="image-20240117143512837"></p>
</li>
</ol>
<h2 id="æœ¬åœ°é…ç½®Mavenç¯å¢ƒ"><a href="#æœ¬åœ°é…ç½®Mavenç¯å¢ƒ" class="headerlink" title="æœ¬åœ°é…ç½®Mavenç¯å¢ƒ"></a>æœ¬åœ°é…ç½®Mavenç¯å¢ƒ</h2><ul>
<li><p>é€‰æ‹©IDEAä¸­Fileâ€“&gt;Settingsâ€“&gt;Buildï¼ŒExecution,Deploymentâ€“&gt;Build Toolsâ€“&gt;Maven</p>
</li>
<li><p>è®¾ç½®IDEAä½¿ç”¨æœ¬åœ°å®‰è£…çš„Mavenï¼Œå¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶åŠæœ¬åœ°ä»“åº“è·¯å¾„</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117141244693.png" alt="image-20240117141244693"></p>
</li>
<li><p>é…ç½®Runnerï¼Œç¡®ä¿JREæ˜¯å¯¹åº”çš„ç‰ˆæœ¬</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117141340811.png" alt="image-20240117141340811"></p>
</li>
<li><p>é…ç½®JAVAè¯­è¨€çš„å­—èŠ‚ç ç‰ˆæœ¬ä¸ºç‰¹å®šç‰ˆæœ¬Fileâ€“&gt;Settingsâ€“&gt;Buildï¼ŒExecution,Deploymentâ€“&gt;Complierâ€“&gt;Java Complier</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143111362.png" alt="image-20240117143111362"></p>
</li>
</ul>
<h2 id="æœ¬åœ°ä»0å¼€å§‹åˆ›å»ºMavené¡¹ç›®"><a href="#æœ¬åœ°ä»0å¼€å§‹åˆ›å»ºMavené¡¹ç›®" class="headerlink" title="æœ¬åœ°ä»0å¼€å§‹åˆ›å»ºMavené¡¹ç›®"></a>æœ¬åœ°ä»0å¼€å§‹åˆ›å»ºMavené¡¹ç›®</h2><ol>
<li><p>åˆ›å»ºé¡¹ç›®ç›®å½•</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117142650306.png" alt="image-20240117142650306"></p>
</li>
<li><p>åˆ›å»ºé¡¹ç›®</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117142733138.png" alt="image-20240117142733138"></p>
</li>
<li><p>è®¾ç½®mavenä»“åº“Fileâ€“&gt;Settingsâ€“&gt;Buildï¼ŒExecution,Deploymentâ€“&gt;Build Toolsâ€“&gt;Maven</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117142851099.png" alt="image-20240117142851099"></p>
</li>
<li><p>é…ç½®Runnerï¼Œç¡®å®šJREçš„ç‰ˆæœ¬</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143024667.png" alt="image-20240117143024667"></p>
</li>
<li><p>é…ç½®JAVAè¯­è¨€çš„å­—èŠ‚ç ç‰ˆæœ¬ä¸ºç‰¹å®šç‰ˆæœ¬Fileâ€“&gt;Settingsâ€“&gt;Buildï¼ŒExecution,Deploymentâ€“&gt;Complierâ€“&gt;Java Complier</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117143111362.png" alt="image-20240117143111362"></p>
</li>
</ol>
<h2 id="ç»è¿‡å…¨å±€é…ç½®åé€šè¿‡æ¨¡å—åˆ›å»ºé¡¹ç›®"><a href="#ç»è¿‡å…¨å±€é…ç½®åé€šè¿‡æ¨¡å—åˆ›å»ºé¡¹ç›®" class="headerlink" title="ç»è¿‡å…¨å±€é…ç½®åé€šè¿‡æ¨¡å—åˆ›å»ºé¡¹ç›®"></a>ç»è¿‡å…¨å±€é…ç½®åé€šè¿‡æ¨¡å—åˆ›å»ºé¡¹ç›®</h2><ol>
<li><p>åˆ›å»ºæ¨¡å—ï¼Œé€‰æ‹©Mavenï¼Œç‚¹å‡»Next</p>
</li>
<li><p>å¡«å†™æ¨¡å—åç§°ï¼Œåæ ‡ä¿¡æ¯ï¼Œç‚¹å‡»finishï¼Œåˆ›å»ºå®Œæˆ</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117144720513.png" alt="image-20240117144720513"></p>
</li>
<li><p>è§‚å¯Ÿç”Ÿæˆçš„é¡¹ç›®ç»“æ„</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117145350061.png" alt="image-20240117145350061"></p>
<p>æ³¨æ„ï¼Œmainç›®å½•ä¸‹å­˜æ”¾çš„é¡¹ç›®çš„èµ„æºï¼Œtestç›®å½•ä¸‹å­˜æ”¾çš„æ˜¯æµ‹è¯•çš„ç›¸å…³èµ„æºï¼ŒäºŒè€…åº”è¯¥æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œä½†æ˜¯åˆšç”Ÿæˆçš„testç›®å½•ä¸‹æ²¡æœ‰resources,è¿™ä¸ªæ—¶å€™é€‰ä¸­testï¼Œå³é”®new directoryï¼Œå®ƒä¼šæç¤ºä½ åˆ›å»ºresoucesã€‚ï¼ˆä¸Šé¢çš„å›¾ç¤ºå°±æ˜¯åˆ›å»ºå¥½çš„ç»“æœï¼‰</p>
<ul>
<li>javaç›®å½•å­˜æ”¾äº†è¿è¡Œä»£ç ã€‚</li>
<li>resourcesç›®å½•ä¸‹å­˜æ”¾äº†é…ç½®ä¿¡æ¯ã€‚</li>
</ul>
</li>
<li><p>ç¼–å†™HelloWorldï¼ŒFileâ€“&gt;Newâ€“&gt;Java Classâ€“&gt;com.ithema.HelloWorld</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117145910982.png" alt="image-20240117145910982"></p>
</li>
<li><p>è¿è¡Œåäº§ç”Ÿtargetç›®å½•ï¼Œå®ƒæ˜¯Javaç¼–è¯‘åäº§ç”Ÿçš„å­—èŠ‚ç æ–‡ä»¶</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117150126244.png" alt="image-20240117150126244"></p>
</li>
</ol>
<h2 id="Mavenåæ ‡"><a href="#Mavenåæ ‡" class="headerlink" title="Mavenåæ ‡"></a>Mavenåæ ‡</h2><ul>
<li><p>ä»€ä¹ˆæ˜¯åæ ‡ï¼Ÿ</p>
<ul>
<li>Mavenä¸­çš„åæ ‡æ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯†ï¼Œé€šè¿‡è¯¥åæ ‡å¯ä»¥ä¸ºä¸€å®šä¸ºèµ„æºä½ç½®ã€‚</li>
<li>ä½¿ç”¨åæ ‡æ¥å®šä¹‰é¡¹ç›®æˆ–å¼•å…¥é¡¹ç›®ä¸­éœ€è¦çš„ä¾èµ–ã€‚ï¼ˆåœ¨porn.xmlä¸­æ·»åŠ åæ ‡ï¼Œç›¸å½“äºå¯¼åŒ…æ“ä½œï¼‰</li>
</ul>
</li>
<li><p>Mavenåæ ‡ä¸»è¦ç»„æˆ</p>
<ul>
<li><p>groupId:å®šä¹‰å½“å‰Mavené¡¹ç›®éš¶å±ç»„ç»‡åç§°ï¼ˆé€šå¸¸æ˜¯åŸŸååå†™ï¼Œä¾‹å¦‚com.itheimaï¼‰</p>
</li>
<li><p>artifactIdï¼šå®šä¹‰å½“å‰Mavené¡¹ç›®åç§°ï¼ˆé€šå¸¸æ˜¯æ¨¡å—åç§°ï¼Œä¾‹å¦‚order-serviceã€good-serviceï¼‰</p>
</li>
<li><p>versionï¼šå®šä¹‰å½“å‰é¡¹ç›®ç‰ˆæœ¬å·</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-project01<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="å¯¼å…¥Mavené¡¹ç›®"><a href="#å¯¼å…¥Mavené¡¹ç›®" class="headerlink" title="å¯¼å…¥Mavené¡¹ç›®"></a>å¯¼å…¥Mavené¡¹ç›®</h2><p>æ–¹å¼ä¸€ï¼šæ‰“å¼€IDEAï¼Œé€‰æ‹©å³ä¾§Mavené¢æ¿ï¼Œç‚¹å‡»+å·ï¼Œé€‰ä¸­å¯¹åº”é¡¹ç›®çš„pom.xmlæ–‡ä»¶ï¼ŒåŒå‡»å³å¯ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117152800780.png" alt="image-20240117152800780"></p>
<p>æ–¹æ³•äºŒï¼šæ‰“å¼€IDEAï¼ŒFileâ€“&gt;Project Structureï¼Œé€‰ä¸­Modulesï¼Œé€‰ä¸­å¯¹åº”é¡¹ç›®çš„pom.xmlæ–‡ä»¶ï¼ŒåŒå‡»å³å¯</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117155211325.png" alt="image-20240117155211325"></p>
<h2 id="ç§»é™¤Mavené¡¹ç›®"><a href="#ç§»é™¤Mavené¡¹ç›®" class="headerlink" title="ç§»é™¤Mavené¡¹ç›®"></a>ç§»é™¤Mavené¡¹ç›®</h2><p>æ–¹æ³•ä¸€ï¼šå³é”®-unlink maven projects</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117153019917.png" alt="image-20240117153019917"></p>
<p>æ–¹æ³•äºŒï¼šé€‰ä¸­ï¼Œå³é”®ï¼Œremove module</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240117153148909.png" alt="image-20240117153148909"></p>
<h1 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h1><h2 id="ä¾èµ–é…ç½®"><a href="#ä¾èµ–é…ç½®" class="headerlink" title="ä¾èµ–é…ç½®"></a>ä¾èµ–é…ç½®</h2><ul>
<li><p>ä¾èµ–ï¼šæŒ‡å½“å‰é¡¹ç›®è¿è¡Œæ‰€éœ€è¦çš„jaråŒ…ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­å¯ä»¥å¼•å…¥å¤šä¸ªä¾èµ–ã€‚</p>
</li>
<li><p>é…ç½®ï¼š</p>
<ol>
<li><p>åœ¨pom.xmlä¸­ç¼–å†™<code>&lt;dependencies&gt;</code>æ ‡ç­¾</p>
</li>
<li><p>åœ¨<code>&lt;dependices&gt;</code>æ ‡ç­¾ä¸­ï¼Œä½¿ç”¨<code>&lt;dependency&gt;</code>å¼•å…¥åæ ‡</p>
</li>
<li><p>å®šä¹‰åæ ‡çš„groupIdï¼ŒartifactIdï¼Œversion</p>
</li>
<li><p>ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œå¼•å…¥æœ€æ–°åŠ å…¥çš„åæ ‡</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119152117196.png" alt="image-20240119152117196"></p>
</li>
</ol>
</li>
</ul>
<p>æ³¨æ„äº‹é¡¹</p>
<ul>
<li>å¦‚æœå¼•å…¥çš„ä¾èµ–ï¼Œåœ¨æœ¬åœ°ä»“åº“ä¸å­˜åœ¨ï¼Œå°†ä¼šé“¾æ¥è¿œç¨‹ä»“åº“&#x2F;ä¸­å¤®ä»“åº“ï¼Œç„¶åä¸‹è½½ä¾èµ–ã€‚</li>
<li>å¦‚æœä¸çŸ¥é“ä¾èµ–çš„åæ ‡ä¿¡æ¯ï¼Œå¯ä»¥åˆ°<a href="https://mvnreposotory.com/%E4%B8%AD%E6%90%9C%E7%B4%A2%E3%80%82">https://mvnreposotory.com/ä¸­æœç´¢ã€‚</a></li>
</ul>
<h2 id="ä¾èµ–ä¼ é€’"><a href="#ä¾èµ–ä¼ é€’" class="headerlink" title="ä¾èµ–ä¼ é€’"></a>ä¾èµ–ä¼ é€’</h2><ul>
<li><p>ä¾èµ–å…·æœ‰ä¼ é€’æ€§</p>
<ul>
<li><p>ç›´æ¥ä¾èµ–ï¼šåœ¨å½“å‰é¡¹ç›®ä¸­é€šè¿‡ä¾èµ–é…ç½®å»ºç«‹çš„ä¾èµ–å…³ç³»</p>
</li>
<li><p>é—´æ¥ä¾èµ–ï¼šè¢«ä¾èµ–çš„èµ„æºå¦‚æœä¾èµ–å…¶ä»–èµ„æºï¼Œå½“å‰é¡¹ç›®é—´æ¥ä¾èµ–å…¶ä»–èµ„æº</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119153259194.png" alt="image-20240119153259194"></p>
</li>
</ul>
</li>
<li><p>æ’é™¤ä¾èµ–</p>
<p>æ’é™¤ä¾èµ–æŒ‡ä¸»åŠ¨æ–­å¼€ä¾èµ–çš„èµ„æºï¼Œè¢«æ’é™¤çš„èµ„æºæ— éœ€æŒ‡å®šç‰ˆæœ¬ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119154036910.png" alt="image-20240119154036910"></p>
</li>
</ul>
<h2 id="ä¾èµ–èŒƒå›´"><a href="#ä¾èµ–èŒƒå›´" class="headerlink" title="ä¾èµ–èŒƒå›´"></a>ä¾èµ–èŒƒå›´</h2><p>ä¾èµ–çš„jaråŒ…ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚å¯ä»¥ä½¿ç”¨<code>&lt;scope&gt;...&lt;/scope&gt;</code>è®¾ç½®å…¶ä½œç”¨èŒƒå›´ã€‚</p>
<p>ä½œç”¨èŒƒå›´ï¼š</p>
<ul>
<li>ä¸»ç¨‹åºèŒƒå›´æœ‰æ•ˆã€‚ï¼ˆmainæ–‡ä»¶å¤¹èŒƒå›´å†…ï¼‰</li>
<li>æµ‹è¯•ç¨‹åºèŒƒå›´æœ‰æ•ˆã€‚ï¼ˆtestæ–‡ä»¶å¤¹èŒƒå›´å†…ï¼‰</li>
<li>æ˜¯å¦å‚ä¸æ‰“åŒ…è¿è¡Œã€‚ï¼ˆpackageæŒ‡ä»¤èŒƒå›´å†…ï¼‰</li>
</ul>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119154350199.png" alt="image-20240119154350199"></p>
<h2 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h2><p>Mavençš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä¸ºäº†å¯¹æ‰€æœ‰çš„mavené¡¹ç›®æ„å»ºè¿‡ç¨‹è¿›è¡ŒæŠ½è±¡å’Œç»Ÿä¸€ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119155450407.png" alt="image-20240119155450407"></p>
<p>Mavenæœ‰3å¥—ç›¸äº’ç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸï¼š</p>
<ul>
<li>cleanï¼šæ¸…ç†å·¥ä½œã€‚</li>
<li>defaultï¼šæ ¸å¿ƒå·¥ä½œï¼Œå¦‚ï¼šç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ã€å®‰è£…ã€éƒ¨ç½²ç­‰ã€‚</li>
<li>siteï¼šç”ŸæˆæŠ¥å‘Šã€å‘å¸ƒç«™ç‚¹ç­‰ã€‚</li>
</ul>
<p>æ¯å¥—ç”Ÿå‘½å‘¨æœŸåŒ…å«ä¸€äº›é˜¶æ®µï¼ˆphaseï¼‰,é˜¶æ®µæ˜¯æœ‰é¡ºåºçš„ï¼Œåé¢çš„é˜¶æ®µä¾èµ–äºå‰é¢çš„é˜¶æ®µã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119155612088.png" alt="image-20240119155612088"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119160354799.png" alt="image-20240119160354799"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240119160447967.png" alt="image-20240119160447967"></p>
<h1 id="SpringBootWebå…¥é—¨"><a href="#SpringBootWebå…¥é—¨" class="headerlink" title="SpringBootWebå…¥é—¨"></a>SpringBootWebå…¥é—¨</h1><ul>
<li><p>Springå‘å±•åˆ°ä»Šå¤©å·²ç»å½¢æˆäº†ä¸€ç§å¼€å‘ç”Ÿæ€åœˆï¼ŒSpringæä¾›äº†è‹¥å¹²å­é¡¹ç›®ï¼Œæ¯ä¸ªé¡¹ç›®ç”¨äºå®Œæˆç‰¹å®šçš„åŠŸèƒ½ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120130721110.png" alt="image-20240120130721110"></p>
</li>
<li><p>Spring Frameworkæ˜¯æ‰€æœ‰é¡¹ç›®çš„åŸºç¡€æ¡†æ¶ï¼Œå®ƒæœ‰ä¸¤å¤§ç¼ºç‚¹ï¼Œä¸Šæ‰‹éš¾åº¦å¤§ï¼Œé…ç½®ç¹çï¼Œå› è€Œå‡ºç°äº†spring bootè¿™æ ·çš„ç®€ä»‹é…ç½®çš„åŸºç¡€æ¡†æ¶ã€‚</p>
</li>
<li><p>Spring Bootå¯ä»¥å¸®åŠ©æˆ‘ä»¬éå¸¸å¿«é€Ÿçš„æ„å»ºåº”ç”¨ç¨‹åºï¼Œç®€åŒ–å¼€å‘ï¼Œç›´æ¥ä¸Šæ‰‹ã€‚</p>
</li>
</ul>
<p><strong>éœ€æ±‚ï¼šä½¿ç”¨SPringBootå¼€å‘ä¸€ä¸ªwebåº”ç”¨ï¼Œæµè§ˆå™¨å‘èµ·è¯·æ±‚&#x2F;helloåï¼Œç»™æµè§ˆå™¨è¿”å›å­—ç¬¦ä¸²â€œHello World ~â€</strong></p>
<ol>
<li><p>åˆ›å»ºspringbootå·¥ç¨‹ï¼Œå¹¶å‹¾é€‰webå¼€å‘ç›¸å…³ä¾èµ–ã€‚</p>
</li>
<li><p>å®šä¹‰HelloControllerç±»ï¼Œæ·»åŠ æ–¹æ³•helloï¼Œå¹¶æ·»åŠ æ³¨é‡Šã€‚</p>
</li>
<li><p>è¿è¡Œæµ‹è¯•ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120132028164.png" alt="image-20240120132028164"></p>
<p>æ·»åŠ ä¾èµ–</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120132128021.png" alt="image-20240120132128021"></p>
<p>åˆ›å»ºå®Œé¡¹ç›®ååˆ é™¤æ— å…³çš„åŒ…</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120133542924.png" alt="image-20240120133542924"></p>
<p>é¡¹ç›®åœ¨main&#x2F;java&#x2F;com&#x2F;exampleç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆäº†å¯åŠ¨ç±»</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120133951516.png" alt="image-20240120133951516"></p>
<p>ç¼–å†™è¯·æ±‚ç±»ï¼ˆæµè§ˆå™¨è¯·æ±‚&#x2F;helloé¡µé¢ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•ï¼‰</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240120135516970.png" alt="image-20240120135516970"></p>
<p>å¯åŠ¨ç¨‹åº<br>è¿è¡Œmainæ–¹æ³•å³å¯ï¼ˆè®¿é—®localhost:8080&#x2F;helloæˆ–è€…127.0.0.1:8080&#x2F;helloå³å¯)</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125151520066.png" alt="image-20240125151520066"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125151747850.png" alt="image-20240125151747850"></p>
</li>
</ol>
<h1 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h1><h2 id="HTTP-æ¦‚è¿°"><a href="#HTTP-æ¦‚è¿°" class="headerlink" title="HTTP-æ¦‚è¿°"></a>HTTP-æ¦‚è¿°</h2><ul>
<li><p>æ¦‚å¿µï¼šHyper Text Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œè§„å®šäº†æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®çš„è§„åˆ™ã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125152407065.png" alt="image-20240125152407065"></p>
</li>
<li><p>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>åŸºäºTCPåè®®ï¼šï¼Œé¢å‘è¿æ¥ã€‚å®‰å…¨ã€‚</li>
<li>åŸºäºè¯·æ±‚-å“åº”æ¨¡å‹çš„ï¼šä¸€æ¬¡è¯·æ±‚å¯¹åº”ä¸€æ¬¡å“åº”ã€‚</li>
<li>HTTPåè®®æ˜¯æ— çŠ¶æ€çš„åè®®ï¼šå¯¹äºäº‹åŠ¡æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ï¼Œæ¯æ¬¡è¯·æ±‚-ç›¸åº”éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚<ul>
<li>ç¼ºç‚¹ï¼šå¤šæ¬¡è¯·æ±‚é—´ä¸èƒ½å…±äº«æ•°æ®ã€‚</li>
<li>ä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ã€‚</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="HTTP-è¯·æ±‚åè®®ï¼ˆè¯·æ±‚æ•°æ®çš„æ ¼å¼ï¼‰"><a href="#HTTP-è¯·æ±‚åè®®ï¼ˆè¯·æ±‚æ•°æ®çš„æ ¼å¼ï¼‰" class="headerlink" title="HTTP-è¯·æ±‚åè®®ï¼ˆè¯·æ±‚æ•°æ®çš„æ ¼å¼ï¼‰"></a>HTTP-è¯·æ±‚åè®®ï¼ˆè¯·æ±‚æ•°æ®çš„æ ¼å¼ï¼‰</h2><p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125153407721.png" alt="image-20240125153407721"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125153322567.png" alt="image-20240125153322567"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125153911088.png" alt="image-20240125153911088"></p>
<h2 id="HTTP-å“åº”åè®®"><a href="#HTTP-å“åº”åè®®" class="headerlink" title="HTTP-å“åº”åè®®"></a>HTTP-å“åº”åè®®</h2><p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125154148318.png" alt="image-20240125154148318"></p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125154206959.png" alt="image-20240125154206959"></p>
<h2 id="HTTP-åè®®è§£æ"><a href="#HTTP-åè®®è§£æ" class="headerlink" title="HTTP-åè®®è§£æ"></a>HTTP-åè®®è§£æ</h2><p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125164522319.png" alt="image-20240125164522319"></p>
<p>æœåŠ¡å™¨è‡ªåŠ¨æŠŠè¦ä¼ è¾“çš„åè®®è§£æè¿‡ç¨‹å°è£…ï¼Œæ¯”è¾ƒè‘—åçš„æœ‰jetty:&#x2F;&#x2F;ï¼Œweblogic,websphere</p>
<p>å…¶ä¸­æœ€è‘—åçš„å½“å±apache tomcatã€‚</p>
<h2 id="WebæœåŠ¡å™¨"><a href="#WebæœåŠ¡å™¨" class="headerlink" title="WebæœåŠ¡å™¨"></a>WebæœåŠ¡å™¨</h2><p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125164749729.png" alt="image-20240125164749729"></p>
<p>å¯åŠ¨æœåŠ¡å™¨ï¼Œå°±å¯ä»¥æ‰“å¼€æµè§ˆå™¨ï¼Œç›´æ¥è®¿é—®éƒ¨ç½²åœ¨æœåŠ¡å™¨çš„é¡µé¢ã€‚</p>
<p>WebæœåŠ¡å™¨</p>
<ul>
<li>å¯¹HTPåè®®æ“ä½œè¿›è¡Œå°è£…ã€‚ç®€åŒ–webç¨‹åºå¼€å‘ã€‚</li>
<li>éƒ¨ç½²webé¡¹ç›®ï¼Œå¯¹å¤–æä¾›ç½‘ä¸Šä¿¡æ¯æµè§ˆæœåŠ¡ã€‚</li>
</ul>
<p>Tomcat</p>
<ul>
<li>ä¸€ä¸ªè½»é‡çº§çš„WebæœåŠ¡å™¨ï¼Œæ”¯æŒservlet,jspç­‰å°‘é‡javaEEè§„èŒƒã€‚</li>
<li>ä¹Ÿè¢«ç§°ä¸ºwebå®¹å™¨ï¼Œservletå®¹å™¨ã€‚</li>
</ul>
<p>å°†ç½‘é¡µéƒ¨ç½²åˆ°tomcatæœåŠ¡å™¨çš„å…·ä½“æ“ä½œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li><p>ä¸‹è½½å¹¶å®‰è£…tomcat</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125165029068.png" alt="image-20240125165029068"></p>
</li>
<li><p>å°†å·²ç»å†™å¥½çš„å‰ç«¯æ–‡ä»¶æ”¾åˆ°å¯¹åº”çš„tomcatå®‰è£…ç›®å½•çš„webappsç›®å½•ä¸­</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240125165206796.png" alt="image-20240125165206796"></p>
</li>
<li><p>åŒå‡»bin\startup.batï¼Œå¯åŠ¨tomcatã€‚</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126145251580.png" alt="image-20240126145251580"></p>
</li>
<li><p>è¿›å…¥æµè§ˆå™¨ï¼Œè¾“å…¥localhost:8080&#x2F;demo&#x2F;index.html</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126145329204.png" alt="image-20240126145329204"></p>
</li>
</ol>
<h1 id="WebæœåŠ¡å™¨-Tomcat"><a href="#WebæœåŠ¡å™¨-Tomcat" class="headerlink" title="WebæœåŠ¡å™¨-Tomcat"></a>WebæœåŠ¡å™¨-Tomcat</h1><ul>
<li><p>ç®€ä»‹</p>
<ul>
<li><p>æ¦‚å¿µï¼šTomcatæ˜¯Apacheè½¯ä»¶åŸºé‡‘ä¼šä¸€ä¸ªæ ¸å¿ƒé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªå¼€æºå…è´¹çš„è½»é‡çº§WebæœåŠ¡å™¨ã€‚æ”¯æŒå°‘é‡Servletã€JSPå°‘é‡JavaEEè§„èŒƒã€‚</p>
</li>
<li><p>JavaEEï¼šJava Enterprise Editionï¼ŒJavaä¼ä¸šç‰ˆã€‚æŒ‡Javaä¼ä¸šçº§å¼€å‘çš„æŠ€æœ¯è§„èŒƒæ€»å’Œã€‚åŒ…å«13é¡¹æŠ€æœ¯è§„èŒƒï¼šJDBCï¼ŒJNDIï¼ŒEJBï¼ˆè¢«Springæ›¿ä»£ï¼‰ï¼ŒRMIï¼ŒJSPï¼ŒServletï¼ˆè¢«åŸºäºServletçš„æ¡†æ¶æ›¿ä»£ï¼‰ï¼ŒXMLï¼ŒJMSï¼ŒJava IDLï¼ŒJTSï¼ŒJTAï¼ŒJavaMailï¼ŒJAFã€‚</p>
</li>
<li><p>Tomcatä¹Ÿè¢«ç§°ä¸ºWebå®¹å™¨ï¼ŒServletå®¹å™¨ã€‚Servletç¨‹åºéœ€è¦ä¾èµ–äºTomcatæ‰èƒ½è¿è¡Œã€‚</p>
</li>
</ul>
</li>
<li><p>åŸºæœ¬ä½¿ç”¨</p>
<ul>
<li><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126143712623.png" alt="image-20240126143712623"></li>
<li><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126144304052.png" alt="image-20240126144304052"></li>
<li><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126144410282.png" alt="image-20240126144410282"></li>
</ul>
</li>
<li><p>å…¥é—¨ç¨‹åºè§£æ</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126144954387.png" alt="image-20240126144954387"></p>
<p>springbootwebåœ¨å¯åŠ¨æ—¶å›å¯åŠ¨å†…ç½®çš„tomcatæœåŠ¡å™¨ï¼ˆä»¥åç”¨çš„åŸºæœ¬æ˜¯springbootå†…ç½®çš„tomcatæœåŠ¡å™¨ï¼‰</p>
<p><img src="/2024/01/16/javaweb-day01-web%E5%BC%80%E5%8F%91/image-20240126150234575.png" alt="image-20240126150234575"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>javaweb</category>
      </categories>
  </entry>
  <entry>
    <title>2. githubè¿œç¨‹éƒ¨ç½²hexo</title>
    <url>/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/</url>
    <content><![CDATA[<h2 id="1-æ­å»ºç¯å¢ƒ"><a href="#1-æ­å»ºç¯å¢ƒ" class="headerlink" title="1. æ­å»ºç¯å¢ƒ"></a>1. æ­å»ºç¯å¢ƒ</h2><p>Hexo åŸºäº Node.jsï¼Œæ­å»ºè¿‡ç¨‹ä¸­è¿˜éœ€è¦ä½¿ç”¨ npmï¼ˆNode.js å·²å¸¦ï¼‰ å’Œ gitï¼Œå› æ­¤å…ˆæ­å»ºæœ¬åœ°æ“ä½œç¯å¢ƒï¼Œå®‰è£… Node.js å’Œ Gitã€‚</p>
<ul>
<li>Node.jsï¼š<a href="https://link.zhihu.com/?target=https://nodejs.org/zh-cn">https://nodejs.org/zh-cn</a></li>
<li>Gitï¼š<a href="https://link.zhihu.com/?target=https://git-scm.com/downloads">https://git-scm.com/downloads</a></li>
</ul>
<p>ä¸‹è½½ Node.js å’Œ Git ç¨‹åºå¹¶å®‰è£…ï¼Œä¸€è·¯ç‚¹ â€œä¸‹ä¸€æ­¥â€ æŒ‰é»˜è®¤é…ç½®å®Œæˆå®‰è£…ã€‚</p>
<p>å®‰è£…å®Œæˆåï¼ŒWin+R è¾“å…¥ cmd å¹¶æ‰“å¼€ï¼Œä¾æ¬¡è¾“å…¥ <code>node -v</code>ã€<code>npm -v</code> å’Œ <code>git --version</code> å¹¶å›è½¦ï¼Œå¦‚ä¸‹å›¾å‡ºç°ç¨‹åºç‰ˆæœ¬å·å³å¯ã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115151405964.png" alt="image-20240115151405964"></p>
<h2 id="2-è¿æ¥github"><a href="#2-è¿æ¥github" class="headerlink" title="2. è¿æ¥github"></a>2. è¿æ¥github</h2><p>ä½¿ç”¨é‚®ç®±æ³¨å†Œ <a href="https://link.zhihu.com/?target=https://github.com/">GitHub</a> è´¦æˆ·ï¼Œé€‰æ‹©å…è´¹è´¦æˆ·ï¼ˆFreeï¼‰ï¼Œå¹¶å®Œæˆé‚®ä»¶éªŒè¯ã€‚</p>
<p>å³é”® -&gt; Git Bash Hereï¼Œ<strong>è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±</strong>ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;GitHub ç”¨æˆ·å&quot;</span><br><span class="line">git config --global user.email &quot;GitHub é‚®ç®±&quot;</span><br></pre></td></tr></table></figure>

<p><strong>æŸ¥çœ‹æœ¬åœ°å·²ç»è®¾ç½®å¥½çš„ç”¨æˆ·åå’Œé‚®ç®±</strong></p>
<ol>
<li><p>æŸ¥çœ‹å…¨å±€ç”¨æˆ·åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‘½ä»¤ä¼šæ˜¾ç¤ºä½ è®¾ç½®çš„å…¨å±€ç”¨æˆ·åã€‚</p>
</li>
<li><p>æŸ¥çœ‹å…¨å±€é‚®ç®±ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.email</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>åˆ›å»º SSH å¯†åŒ™</strong>ï¼š</p>
<p>è¾“å…¥ <code>ssh-keygen -t rsa -C &quot;GitHub é‚®ç®±&quot;</code>ï¼Œç„¶åä¸€è·¯å›è½¦ã€‚</p>
<p><strong>æ·»åŠ å¯†åŒ™ï¼š</strong></p>
<p>è¿›å…¥ [C:\Users\ç”¨æˆ·å.ssh] ç›®å½•ï¼ˆè¦å‹¾é€‰æ˜¾ç¤ºâ€œéšè—çš„é¡¹ç›®â€ï¼‰ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å…¬é’¥ id_rsa.pub æ–‡ä»¶å¹¶å¤åˆ¶é‡Œé¢çš„å†…å®¹ã€‚</p>
<p>ç™»é™† GitHub ï¼Œè¿›å…¥ Settings é¡µé¢ï¼Œé€‰æ‹©å·¦è¾¹æ çš„ SSH and GPG keysï¼Œç‚¹å‡» New SSH keyã€‚</p>
<p>Title éšä¾¿å–ä¸ªåå­—ï¼Œç²˜è´´å¤åˆ¶çš„ id_rsa.pub å†…å®¹åˆ° Key ä¸­ï¼Œç‚¹å‡» Add SSH key å®Œæˆæ·»åŠ ã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115153151771.png" alt="image-20240115153151771"></p>
<p><strong>éªŒè¯è¿æ¥ï¼š</strong></p>
<p>æ‰“å¼€ Git Bashï¼Œè¾“å…¥ <code>ssh -T git@github.com</code> å‡ºç° â€œAre you sureâ€¦â€¦â€ï¼Œè¾“å…¥ yes å›è½¦ç¡®è®¤ã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115153218063.png" alt="image-20240115153218063"></p>
<p>æ˜¾ç¤º â€œHi xxx! Youâ€™ve successfullyâ€¦â€¦â€ å³è¿æ¥æˆåŠŸã€‚</p>
<h2 id="3-åˆ›å»º-Github-Pages-ä»“åº“"><a href="#3-åˆ›å»º-Github-Pages-ä»“åº“" class="headerlink" title="3. åˆ›å»º Github Pages ä»“åº“"></a>3. åˆ›å»º Github Pages ä»“åº“</h2><p>GitHub ä¸»é¡µå³ä¸Šè§’åŠ å· -&gt; New repositoryï¼š</p>
<ul>
<li>Repository name ä¸­è¾“å…¥ <code>ç”¨æˆ·å.github.io</code></li>
<li>å‹¾é€‰ â€œInitialize this repository with a READMEâ€</li>
<li>Description é€‰å¡«</li>
</ul>
<p>å¡«å¥½åç‚¹å‡» Create repository åˆ›å»ºã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115153305115.png" alt="image-20240115153305115"></p>
<p>åˆ›å»ºåé»˜è®¤è‡ªåŠ¨å¯ç”¨ HTTPSï¼Œåšå®¢åœ°å€ä¸ºï¼š<code>https://ç”¨æˆ·å.github.io</code></p>
<h2 id="4-æœ¬åœ°å®‰è£…-Hexo-åšå®¢ç¨‹åº"><a href="#4-æœ¬åœ°å®‰è£…-Hexo-åšå®¢ç¨‹åº" class="headerlink" title="4. æœ¬åœ°å®‰è£… Hexo åšå®¢ç¨‹åº"></a>4. æœ¬åœ°å®‰è£… Hexo åšå®¢ç¨‹åº</h2><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾ Hexo çš„ç¨‹åºæ–‡ä»¶ï¼Œå¦‚ Hexo-Blogã€‚æ‰“å¼€è¯¥æ–‡ä»¶å¤¹ï¼Œå³é”® -&gt; Git Bash Hereã€‚</p>
<h3 id="4-1-å®‰è£…-Hexo"><a href="#4-1-å®‰è£…-Hexo" class="headerlink" title="4.1 å®‰è£… Hexo"></a>4.1 å®‰è£… Hexo</h3><p>ä½¿ç”¨ npm ä¸€é”®å®‰è£… Hexo åšå®¢ç¨‹åºï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>Mac ç”¨æˆ·éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆsudoï¼‰ï¼Œè¿è¡Œè¿™æ¡å‘½ä»¤ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">sudo npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æ—¶é—´æœ‰ç‚¹ä¹…ï¼ˆçœŸçš„å¾ˆæ…¢ï¼ï¼‰ï¼Œç•Œé¢ä¹Ÿæ²¡ä»»ä½•ååº”ï¼Œ<strong>è€å¿ƒç­‰å¾…</strong>ï¼Œå®‰è£…å®Œæˆåå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115153349039.png" alt="image-20240115153349039"></p>
<h3 id="4-2-Hexo-åˆå§‹åŒ–å’Œæœ¬åœ°é¢„è§ˆ"><a href="#4-2-Hexo-åˆå§‹åŒ–å’Œæœ¬åœ°é¢„è§ˆ" class="headerlink" title="# 4.2 Hexo åˆå§‹åŒ–å’Œæœ¬åœ°é¢„è§ˆ"></a><strong># 4.2 Hexo åˆå§‹åŒ–å’Œæœ¬åœ°é¢„è§ˆ</strong></h3><p><strong>åˆå§‹åŒ–å¹¶å®‰è£…æ‰€éœ€ç»„ä»¶ï¼š</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">hexo init      # åˆå§‹åŒ–</span><br><span class="line">npm install    # å®‰è£…ç»„ä»¶</span><br></pre></td></tr></table></figure>

<p>å®Œæˆåä¾æ¬¡è¾“å…¥ä¸‹é¢å‘½ä»¤ï¼Œ<strong>å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨è¿›è¡Œé¢„è§ˆ</strong>ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">hexo g   # ç”Ÿæˆé¡µé¢</span><br><span class="line">hexo s   # å¯åŠ¨é¢„è§ˆ</span><br></pre></td></tr></table></figure>

<p><strong>è®¿é—®</strong> <code>http://localhost:4000</code><strong>ï¼Œå‡ºç° Hexo é»˜è®¤é¡µé¢ï¼Œæœ¬åœ°åšå®¢å®‰è£…æˆåŠŸï¼</strong></p>
<h2 id="5-éƒ¨ç½²-Hexo-åˆ°-GitHub-Pages"><a href="#5-éƒ¨ç½²-Hexo-åˆ°-GitHub-Pages" class="headerlink" title="5. éƒ¨ç½² Hexo åˆ° GitHub Pages"></a>5. éƒ¨ç½² Hexo åˆ° GitHub Pages</h2><p>æœ¬åœ°åšå®¢æµ‹è¯•æˆåŠŸåï¼Œå°±æ˜¯ä¸Šä¼ åˆ° GitHub è¿›è¡Œéƒ¨ç½²ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨ç½‘ç»œä¸Šè®¿é—®ã€‚</p>
<p>é¦–å…ˆ<strong>å®‰è£… hexo-deployer-git</strong>ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>ç„¶å<strong>ä¿®æ”¹ _config.yml</strong> æ–‡ä»¶æœ«å°¾çš„ Deployment éƒ¨åˆ†ï¼Œä¿®æ”¹æˆå¦‚ä¸‹ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:ç”¨æˆ·å/ç”¨æˆ·å.github.io.git</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure>

<p>å®Œæˆåè¿è¡Œ <code>hexo d</code> å°†ç½‘ç«™ä¸Šä¼ éƒ¨ç½²åˆ° GitHub Pagesã€‚</p>
<p>å®Œæˆï¼è¿™æ—¶è®¿é—®æˆ‘ä»¬çš„ GitHub åŸŸå <code>https://ç”¨æˆ·å.github.io</code> å°±å¯ä»¥çœ‹åˆ° Hexo ç½‘ç«™äº†ã€‚</p>
<h2 id="6-ç»‘å®šåŸŸåï¼ˆå¯é€‰ï¼‰"><a href="#6-ç»‘å®šåŸŸåï¼ˆå¯é€‰ï¼‰" class="headerlink" title="6. ç»‘å®šåŸŸåï¼ˆå¯é€‰ï¼‰"></a>6. ç»‘å®šåŸŸåï¼ˆå¯é€‰ï¼‰</h2><p>åšå®¢æ­å»ºå®Œæˆä½¿ç”¨çš„æ˜¯ GitHub çš„å­åŸŸåï¼ˆç”¨æˆ·å.<a href="https://link.zhihu.com/?target=http://github.io">http://github.io</a>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º Hexo åšå®¢ç»‘å®šè‡ªå·±çš„åŸŸåæ›¿æ¢ GitHub åŸŸåï¼Œæ›´åŠ ä¸ªæ€§åŒ–å’Œä¸“ä¸šï¼Œä¹Ÿåˆ©äº SEOã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <a href="https://link.zhihu.com/?target=https://www.namesilo.com/?rid=d27fa32do">Namesilo</a> è¿›è¡Œæ³¨å†Œï¼Œä¾¿å®œå¥½ç”¨æ²¡å•¥å¥—è·¯ï¼Œä½¿ç”¨ä¼˜æƒ ç  <code>okoff</code> ä¼˜æƒ ä¸€ç¾å…ƒï¼Œcom åŸŸåå¤§æ¦‚ 50 å—ä¸€å¹´ã€‚</p>
<h3 id="6-1-åŸŸåæ³¨å†Œå’Œè§£æ"><a href="#6-1-åŸŸåæ³¨å†Œå’Œè§£æ" class="headerlink" title="6.1 åŸŸåæ³¨å†Œå’Œè§£æ"></a>6.1 åŸŸåæ³¨å†Œå’Œè§£æ</h3><ul>
<li>åŸŸåæ³¨å†Œå’Œè§£ææ•™ç¨‹ï¼š<a href="https://zhuanlan.zhihu.com/p/33921436">Namesilo åŸŸåè´­ä¹°åŠä½¿ç”¨æ•™ç¨‹</a></li>
</ul>
<p>æŒ‰ä¸Šé¢æ•™ç¨‹æ³¨å†Œå¹¶è§£æåŸŸåï¼Œåœ¨ DNS è®¾ç½®éƒ¨åˆ†ï¼Œåˆ é™¤è‡ªå¸¦çš„è®°å½•ï¼Œç„¶åæ·»åŠ  CNAME è®°å½•å°† www åŸŸåè§£ææŒ‡å‘ <code>ç”¨æˆ·å.github.io</code>ã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115154525174.png" alt="image-20240115154525174"></p>
<h3 id="6-2-ç»‘å®šåŸŸååˆ°-Hexo-åšå®¢"><a href="#6-2-ç»‘å®šåŸŸååˆ°-Hexo-åšå®¢" class="headerlink" title="6.2 ç»‘å®šåŸŸååˆ° Hexo åšå®¢"></a>6.2 ç»‘å®šåŸŸååˆ° Hexo åšå®¢</h3><p>è¿›å…¥æœ¬åœ°åšå®¢æ–‡ä»¶å¤¹çš„ source ç›®å½•ï¼Œæ‰“å¼€è®°äº‹æœ¬ï¼Œé‡Œé¢è¾“å…¥è‡ªå·±çš„åŸŸåï¼Œå¦‚ <a href="http://www.example.com,ä¿å­˜åç§°ä¸º/">http://www.example.comï¼Œä¿å­˜åç§°ä¸º</a> â€œCNAMEâ€ï¼Œæ ¼å¼ä¸º â€œæ‰€æœ‰æ–‡ä»¶â€ï¼ˆæ—  .txt åç¼€ï¼‰ã€‚</p>
<p>æ¸…é™¤ç¼“å­˜ç­‰æ–‡ä»¶å¹¶é‡æ–°å‘å¸ƒç½‘ç«™ï¼š</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">hexo clean   # æ¸…é™¤ç¼“å­˜æ–‡ä»¶ç­‰</span><br><span class="line">hexo g       # ç”Ÿæˆé¡µé¢</span><br><span class="line">hexo s       # å¯åŠ¨é¢„è§ˆ</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å°±å¯ä»¥ä½¿ç”¨è‡ªå·±çš„åŸŸåè®¿é—® Hexo åšå®¢äº†ã€‚</p>
<h3 id="6-3-å¼€å¯-HTTPS"><a href="#6-3-å¼€å¯-HTTPS" class="headerlink" title="6.3 å¼€å¯ HTTPS"></a>6.3 å¼€å¯ HTTPS</h3><p>é…ç½®è‡ªå·±çš„åŸŸååï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å¼€å¯ HTTPSã€‚æ‰“å¼€åšå®¢æ‰€åœ¨ GitHub ä»“åº“ï¼ŒSettings -&gt; ä¸‹æ‹‰æ‰¾åˆ° GitHub Pages -&gt; å‹¾é€‰ Enforce HTTPSã€‚</p>
<p><img src="/2024/01/15/github%E8%BF%9C%E7%A8%8B%E9%83%A8%E7%BD%B2hexo/image-20240115154742811.png" alt="image-20240115154742811"></p>
<p>HTTPS è¯ä¹¦éƒ¨ç½²æˆåŠŸéœ€è¦ä¸€å®šæ—¶é—´ï¼Œç­‰å¤§æ¦‚å‡ åˆ†é’Ÿå†è®¿é—®åŸŸåï¼Œå°±å¯ä»¥çœ‹åˆ°åŸŸåå‰é¢çš„å°ç»¿é”äº†ï¼ŒHTTPS é…ç½®å®Œæˆï¼</p>
<h2 id="7-è‡³æ­¤ï¼Œå®Œæˆhexo-github"><a href="#7-è‡³æ­¤ï¼Œå®Œæˆhexo-github" class="headerlink" title="7.è‡³æ­¤ï¼Œå®Œæˆhexo + github!"></a>7.è‡³æ­¤ï¼Œå®Œæˆhexo + github!</h2>]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
  </entry>
  <entry>
    <title>hexoä¸­æ’å…¥å›¾ç‰‡æ•™ç¨‹</title>
    <url>/2024/01/15/hexo%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<h2 id="1-è§£å†³æ–¹æ¡ˆ"><a href="#1-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="1. è§£å†³æ–¹æ¡ˆ"></a>1. è§£å†³æ–¹æ¡ˆ</h2><h3 id="1-1-åˆ›å»ºå›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹"><a href="#1-1-åˆ›å»ºå›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹" class="headerlink" title="1.1 åˆ›å»ºå›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹"></a>1.1 åˆ›å»ºå›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹</h3><p>ç½‘ä¸Šæœ‰å…³çš„è§£å†³æ–¹å¼å‡ ä¹å¾ˆå¤§ä¸€éƒ¨åˆ†ä¼šæåˆ°è¿™ä¸€ç‚¹ï¼šå°†_config.yml æ–‡ä»¶ä¸­çš„post_asset_folder é€‰é¡¹è®¾ä¸º true æ¥æ‰“å¼€ã€‚äº‹å®ä¸Šè¿™æ­£æ˜¯hexoå®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ä¸­çš„ä¸€ä¸ªæ­¥éª¤ã€‚ä»”ç»†é˜…è¯»åä¼šå‘ç°å¦‚ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li><p>è¯¥æ“ä½œçš„ä½œç”¨å°±æ˜¯åœ¨ä½¿ç”¨hexo new xxxæŒ‡ä»¤æ–°å»ºåšæ–‡æ—¶ï¼Œåœ¨ç›¸åŒè·¯å¾„ä¸‹åŒæ­¥åˆ›å»ºä¸€ä¸ªxxxæ–‡ä»¶å¤¹ï¼Œè€Œxxxæ–‡ä»¶å¤¹çš„ä½œç”¨å°±æ˜¯ç”¨æ¥å­˜æ”¾å›¾ç‰‡èµ„æºï¼›</p>
</li>
<li><p>å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘åå¥½äºç›´æ¥åœ¨source_postsæ–‡ä»¶å¤¹ä¸‹æ–°å»ºmdæ–‡ä»¶ï¼Œè€Œä¸æ˜¯é€šè¿‡hexo new xxxæŒ‡ä»¤ï¼›</p>
</li>
<li><p>é‚£ä¹ˆç›´æ¥æ–°å»ºxxx.mdå†æ–°å»ºxxxæ–‡ä»¶å¤¹ï¼Œè¿™ç§æ“ä½œçš„æœ€ç»ˆæ•ˆæœå’Œä½¿ç”¨hexo new xxxæŒ‡ä»¤æ–°å»ºåšæ–‡çš„æ•ˆæœä¸€æ ·å—ï¼Ÿç»è¿‡å®æµ‹ï¼Œæ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
</ol>
<p>åŸºäºä»¥ä¸Š3ç‚¹ï¼Œå‘Šè¯‰å¤§å®¶å‡ ä¸ªç»“è®ºï¼š</p>
<ol>
<li>æ–°å»ºåšæ–‡å¯ä»¥ä¸ç”¨hexo new xxxæŒ‡ä»¤ï¼Œæˆ‘è¾ƒä¸ºæ¨èç›´æ¥æ–°å»ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„æ–¹å¼ï¼Œåªè¦è¾¾åˆ°ä¸€ä¸ªmdæ–‡ä»¶ï¼Œä¸€ä¸ªåŒåæ–‡ä»¶å¤¹çš„æ•ˆæœå³å¯ï¼›</li>
<li>ã€å°†_config.yml æ–‡ä»¶ä¸­çš„post_asset_folder é€‰é¡¹è®¾ä¸º true ã€‘æ˜¯å¿…é¡»çš„ï¼ç†è®ºä¸Šæ—¢ç„¶æ²¡ç”¨hexo new xxxæŒ‡ä»¤ï¼Œæ–‡ä»¶å¤¹ä¹Ÿæ˜¯æˆ‘è‡ªå·±æ–°å»ºçš„ï¼Œè¿™ä¸€æ­¥è®¾ç½®çš„æ„ä¹‰ä¼¼ä¹å¹¶ä¸å­˜åœ¨ï¼Œä½†æ˜¯åæ–‡ä»‹ç»çš„æ’ä»¶å¿…é¡»åœ¨post_asset_folder é€‰é¡¹è®¾ä¸º trueçš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆâ€”â€”æœ¬äººäº²æµ‹ï¼Œå¤§å®¶è®°ä½è¿™ä¹ˆè®¾ç½®å³å¯ï¼</li>
</ol>
<h3 id="1-2-typoraä¸­å›¾åƒè®¾ç½®"><a href="#1-2-typoraä¸­å›¾åƒè®¾ç½®" class="headerlink" title="1.2 typoraä¸­å›¾åƒè®¾ç½®"></a>1.2 typoraä¸­å›¾åƒè®¾ç½®</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¤§å®¶ä¼šç°åœ¨typoraé‡Œå†™å¥½mdæ ¼å¼çš„åšå®¢ï¼Œç„¶åé€šè¿‡hexo cleanã€hexo gã€hexo sè¿›è¡Œä¸€ä¸‹æœ¬åœ°æµ‹è¯•ï¼Œç¡®è®¤æ— è¯¯åå†å‘å¸ƒåˆ°è¿œç«¯ã€‚</p>
<p>æš‚ä¸”ä¸è¯´hexoåšå®¢çš„å›¾ç‰‡æ’å…¥æ˜¯ä¸ªé—®é¢˜ï¼Œæˆ‘ç›¸ä¿¡å½“åˆå•çº¯åˆ©ç”¨typoraåšç¬”è®°æ—¶ï¼Œå›¾ç‰‡æ–‡ä»¶çš„ç®¡ç†å°±è®©å¾ˆå¤šäººå¤´ç–¼è¿‡ï¼Œtyporaå®˜æ–¹ä¼¼ä¹ä¹Ÿæ„è¯†åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥åå¥½è®¾ç½®ä¸­å›¾åƒæ˜¯ä¸“é—¨çš„ä¸€é¡¹ï¼Œæä¾›äº†å¾ˆå¤šé€‰æ‹©ã€‚</p>
<p><img src="/2024/01/15/hexo%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%95%99%E7%A8%8B/image-20240115143136972.png" alt="image-20240115143136972"></p>
<p>æˆ‘ç›¸ä¿¡å¤§å¤šæ•°åŒå­¦å†™mdæ—¶çš„å›¾ç‰‡å¾ˆå¤šå¯èƒ½æ˜¯ç›´æ¥æˆªå›¾æˆ–è€…åœ¨å…¶ä»–åœ°æ–¹copyçš„ï¼Œç„¶ååœ¨typoraä¸­ç›´æ¥ç²˜è´´å°±okäº†ã€‚ä½†æ˜¯è¿™ä¹ˆåšä¹‹å‰æœ€å¥½æŠŠtyporaæ’å…¥å›¾ç‰‡æ—¶é‡‡å–ä½•ç§æ“ä½œé…ç½®å¥½ï¼Œå¦åˆ™mdæ–‡ä»¶å’Œå›¾ç‰‡ç›¸éš”åä¸‡å…«åƒé‡Œï¼Œåç»­ä¸€æ—¦ç§»åŠ¨mdæ–‡ä»¶å›¾ç‰‡å°±è¯†åˆ«ä¸å‡ºæ¥ï¼Œç›¸ä¿¡å¤§å®¶ç”¨è¿‡typoraéƒ½æ·±æœ‰ä½“ä¼šã€‚</p>
<p>æ‰€ä»¥æ¥ä¸‹æ¥è®²ä¸€ä¸‹typoraå¦‚ä½•è®¾ç½®ã€‚ç›´æ¥ç»™ç»“è®ºï¼š</p>
<p><img src="/2024/01/15/hexo%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%95%99%E7%A8%8B/image-20240115143150050.png" alt="image-20240115143150050"></p>
<p>çš„è·¯å¾„æ˜¯ï¼š<code>./$&#123;filename&#125;</code>ã€‚<code>./</code>è¡¨ç¤ºå½“å‰æ–‡ä»¶å¤¹ï¼Œ<code>$&#123;filename&#125;</code>è¡¨ç¤ºå½“å‰æ–‡ä»¶åã€‚è¿™ä¹ˆè®¾ç½®çš„å¥½å¤„ï¼š</p>
<ol>
<li>å›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹æœ‰äº†ï¼›</li>
<li>è€Œä¸”æ˜¯åŒåæ–‡ä»¶å¤¹ï¼ï¼ˆ2.1ä¸­çš„æ–‡ä»¶å¤¹å…¶å®ä¸ç”¨æ‰‹åŠ¨æ·»åŠ äº†ï¼‰</li>
</ol>
<p>è¿™ä¹ˆè®¾ç½®çš„ç»“æœå°±æ˜¯ï¼šæƒ³å†™ç¯‡åšå®¢ï¼Œåœ¨<code>source\_posts</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»º<code>xxx.md</code>æ–‡ä»¶ï¼Œå†™ç€å†™ç€éœ€è¦æ’ä¸€å¼ å›¾ï¼Œä»åˆ«å¤„å¤åˆ¶ï¼Œç„¶ååœ¨typoraä¸­ç›´æ¥ç²˜è´´ï¼Œ<code>bling!</code>å›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹è‡ªåŠ¨æå®šï¼Œå¹¶ä¸ç”¨å…³å¿ƒä»€ä¹ˆæ–‡ä»¶å¤¹ï¼Œåªç®¡ä¸“æ³¨äº<code>md</code>æ–‡ä»¶å³å¯ã€‚</p>
<h3 id="1-3-æ’ä»¶ä¸‹è½½"><a href="#1-3-æ’ä»¶ä¸‹è½½" class="headerlink" title="1.3 æ’ä»¶ä¸‹è½½"></a>1.3 æ’ä»¶ä¸‹è½½</h3><p>è¿™ä¸ªå¾ˆå¤šåšå®¢ä¹Ÿæœ‰æåˆ°ï¼Œæ’ä»¶çš„åå­—å«<code>hexo-asset-image</code>ï¼Œç›¸ä¿¡åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€æ³¢è§£å†³æ–¹æ¡ˆçš„åŒå­¦ä¸€å®šå¯¹è¿™ä¸ªåå­—ä¸é™Œç”Ÿã€‚</p>
<p>è¿™ä¸ªæ’ä»¶çš„ä¸åŒç‰ˆæœ¬å¯èƒ½ä¼šæœ‰ä¸åŒçš„å½±å“ï¼Œæˆ‘æœ€ç»ˆæˆåŠŸè§£å†³é—®é¢˜çš„ç‰ˆæœ¬æ˜¯ç”¨å¦‚ä¸‹å‘½ä»¤ä¸‹è½½çš„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆæ’ä»¶å‘¢ï¼Ÿ</p>
<p>å› ä¸ºæˆ‘ä»¬è™½ç„¶åœ¨<code>source\_posts</code>æ–‡ä»¶å¤¹ä¸‹å†™äº†mdæ–‡ä»¶ï¼Œä¹Ÿæœ‰äº†å›¾ç‰‡èµ„æºæ–‡ä»¶å¤¹å­˜äº†å›¾ç‰‡ï¼Œä½†ä»æˆ‘ä»¬å‰é¢typoraä¸­çš„è®¾ç½®ä¸éš¾çŸ¥é“ï¼Œå®é™…ä¸Šmdæ–‡ä»¶ä¸­çš„å›¾ç‰‡è·¯å¾„éƒ½æ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆ<code>./$&#123;filename&#125;</code>ï¼‰ã€‚è€Œå®é™…ç½‘ä¸Šçœ‹åˆ°çš„åšæ–‡æ˜¾ç„¶ä¸æ˜¯mdæ–‡ä»¶ï¼Œè€Œæ˜¯htmlæ–‡ä»¶ï¼Œä»mdåˆ°htmlçš„è½¬å˜å°±æ˜¯hexoå¸®æˆ‘ä»¬åšçš„ï¼Œè¿˜è®°å¾—<code>hexo g</code>å‘½ä»¤å—ï¼Ÿå°±æ˜¯å¹²è¿™ä¸ªçš„ã€‚è½¬æ¢åçš„htmlæ–‡ä»¶åœ¨<code>public</code>ç›®å½•ä¸‹ï¼Œè·¯å¾„æ˜¯é€šè¿‡æ—¥æœŸæŒ‡ç¤ºçš„ã€‚</p>
<p>ä¸‹é¢ç¬¬ä¸€å¼ å›¾æ˜¯å­˜æ”¾mdæ–‡ä»¶çš„åœ°æ–¹ï¼Œå›¾ç‰‡å°±åœ¨å›¾ä¸­çš„jiangzhouæ–‡ä»¶å¤¹ä¸­ï¼›ç¬¬äºŒå¼ å›¾æ˜¯generateä¹‹åå­˜åœ¨htmlå’Œå›¾ç‰‡èµ„æºçš„åœ°æ–¹ã€‚</p>
<p><img src="/2024/01/15/hexo%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%95%99%E7%A8%8B/image-20240115145940757.png" alt="image-20240115145940757"></p>
<p><img src="/2024/01/15/hexo%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87%E6%95%99%E7%A8%8B/image-20240115145902744.png" alt="image-20240115145902744"></p>
<h2 id="1-4-å®Œæˆéƒ¨ç½²"><a href="#1-4-å®Œæˆéƒ¨ç½²" class="headerlink" title="1.4 å®Œæˆéƒ¨ç½²"></a>1.4 å®Œæˆéƒ¨ç½²</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä»¥ä¸Šä¸‰æ­¥ï¼Œåœ¨æœ¬åœ°ç›®å½•publicç›®å½•ä¸‹å°±ä¼šæ ¹æ®æ—¥æœŸäº§ç”Ÿå¯¹åº”çš„ç½‘é¡µï¼Œç½‘é¡µä¸­å›¾ç‰‡çš„è·¯å¾„ç»è¿‡æ’ä»¶<code>https://github.com/CodeFalling/hexo-asset-image</code>ä¹‹åå·²ç»æ­£ç¡®è½¬æ¢ä¸ºå¯¹åº”çš„è·¯å¾„ã€‚</p>
]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
  </entry>
  <entry>
    <title>junit-reflex-proxy</title>
    <url>/2023/11/17/junit-reflex-proxy/</url>
    <content><![CDATA[<h1 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h1><h2 id="æ¦‚è¿°ã€Junitæ¡†æ¶å¿«é€Ÿå…¥é—¨"><a href="#æ¦‚è¿°ã€Junitæ¡†æ¶å¿«é€Ÿå…¥é—¨" class="headerlink" title="æ¦‚è¿°ã€Junitæ¡†æ¶å¿«é€Ÿå…¥é—¨"></a>æ¦‚è¿°ã€Junitæ¡†æ¶å¿«é€Ÿå…¥é—¨</h2><ul>
<li><p>é’ˆå¯¹æœ€å°çš„åŠŸèƒ½å•å…ƒï¼ˆæ–¹æ³•ï¼‰ï¼Œç¼–å†™æµ‹è¯•ä»£ç è¿›è¡Œæ­£ç¡®æ€§æµ‹è¯•</p>
</li>
<li><p><strong>å…·ä½“æ­¥éª¤</strong></p>
<ol>
<li><p>å°†junitæ¡†æ¶çš„jaråŒ…å¯¼å…¥åˆ°é¡¹ç›®ä¸­ï¼ˆæ³¨æ„ï¼šIDEAå·²ç»é›†æˆäº†Junitæ¡†æ¶ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨å¯¼å…¥äº†ï¼‰</p>
</li>
<li><p>ä¸ºéœ€è¦æµ‹è¯•çš„ä¸šåŠ¡ç±»ï¼Œå®šä¹‰å¯¹åº”çš„æµ‹è¯•ç±»ï¼Œå¹¶ä¸ºæ¯ä¸ªä¸šåŠ¡æ–¹æ³•ï¼Œç¼–å†™å¯¹åº”çš„æµ‹è¯•æ–¹æ³•ï¼ˆ<strong>å¿…é¡»ï¼šå…¬å…±ã€æ— å‚ã€æ— è¿”å›å€¼</strong>ï¼‰</p>
</li>
<li><p>æµ‹è¯•æ–¹æ³•ä¸Šå¿…é¡»å£°æ˜@Testæ³¨è§£ï¼Œç„¶ååœ¨æµ‹è¯•æ–¹æ³•ä¸­ï¼Œç¼–å†™ä»£ç è°ƒç”¨è¢«æµ‹è¯•çš„ä¸šåŠ¡æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼›</p>
</li>
<li><p>å¼€å§‹æµ‹è¯•ï¼šé€‰ä¸­æµ‹è¯•æ–¹æ³•ï¼Œå³é”®é€‰æ‹©â€œJUnitâ€è¿è¡Œï¼Œå¦‚æœæµ‹è¯•é€šè¿‡åˆ™æ˜¯ç»¿è‰²ï¼›å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œåˆ™æ˜¯çº¢è‰²</p>
<p><strong>1. ç¼–å†™ä¸šåŠ¡ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.d1_junit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printNumber</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(name == <span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;åå­—é•¿åº¦æ˜¯&quot;</span> + name.length());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getMaxIndex</span><span class="params">(String data)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(data == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data.length();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. ç¼–å†™æµ‹è¯•ç±»ï¼ˆæµ‹è¯•ç±»å’Œä¸šåŠ¡ç±»æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.d1_junit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtilTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPrintNumber</span><span class="params">()</span> &#123;</span><br><span class="line">        StringUtil.printNumber(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        StringUtil.printNumber(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetMaxIndex</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="string">&quot;3&quot;</span>));</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="literal">null</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3. æ–­è¨€æœºåˆ¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.d1_junit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Assert;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtilTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPrintNumber</span><span class="params">()</span> &#123;</span><br><span class="line">        StringUtil.printNumber(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        StringUtil.printNumber(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetMaxIndex</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="string">&quot;3&quot;</span>));</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="literal">null</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> StringUtil.getMaxIndex(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">//æ–­è¨€æœºåˆ¶ï¼šç¨‹åºå‘˜å¯ä»¥é€šè¿‡é¢„æµ‹ä¸šåŠ¡æ–¹æ³•çš„ç»“æœ</span></span><br><span class="line">        Assert.assertEquals(<span class="string">&quot;æ–¹æ³•å†…éƒ¨æœ‰bug!&quot;</span>,<span class="number">4</span>,index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Junitæ¡†æ¶çš„å¸¸è§æ³¨è§£"><a href="#Junitæ¡†æ¶çš„å¸¸è§æ³¨è§£" class="headerlink" title="Junitæ¡†æ¶çš„å¸¸è§æ³¨è§£"></a>Junitæ¡†æ¶çš„å¸¸è§æ³¨è§£</h2></li>
</ul>
<p><strong>Junitå•å…ƒæµ‹è¯•æ¡†æ¶çš„å¸¸ç”¨æ³¨è§£ï¼ˆJunit 4.xxxxç‰ˆæœ¬ï¼‰</strong></p>
<table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>@Test</td>
<td>æµ‹è¯•ç±»ä¸­çš„æ–¹æ³•å¿…é¡»ç”¨å®ƒä¿®é¥°æ‰èƒ½æˆä¸ºæµ‹è¯•æ–¹æ³•ï¼Œæ‰èƒ½å¯åŠ¨æ‰§è¡Œã€‚</td>
</tr>
<tr>
<td>@Before</td>
<td>ç”¨æ¥ä¿®é¥°ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡ã€‚</td>
</tr>
<tr>
<td>@After</td>
<td>ç”¨æ¥ä¿®é¥°ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡ã€‚</td>
</tr>
<tr>
<td>@BeforeClass</td>
<td>ç”¨æ¥ä¿®é¥°ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹å‰æ‰§è¡Œä¸€æ¬¡ã€‚</td>
</tr>
<tr>
<td>@AfterClass</td>
<td>ç”¨æ¥ä¿®é¥°ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•ä¹‹åæ‰§è¡Œä¸€æ¬¡ã€‚</td>
</tr>
</tbody></table>
<ul>
<li>åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¸¸ç”¨äºï¼šåˆå§‹åŒ–èµ„æºã€‚</li>
<li>åœ¨æµ‹è¯•æ–¹æ³•æ‰§è¡Œå®Œä¹‹åå†æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¸¸ç”¨äºï¼šé‡Šæ”¾èµ„æºã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.d1_junit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StringUtilTest</span> &#123;</span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----&gt; test1 Beforeæ‰§è¡Œäº†--------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----&gt;test2 Afteræ‰§è¡Œäº†--------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeClass</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----&gt;Before CLassæ‰§è¡Œäº†---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterClass</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test4</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----&gt;After Classæ‰§è¡Œäº†---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPrintNumber</span><span class="params">()</span> &#123;</span><br><span class="line">        StringUtil.printNumber(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        StringUtil.printNumber(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetMaxIndex</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="string">&quot;3&quot;</span>));</span><br><span class="line">        System.out.println(StringUtil.getMaxIndex(<span class="literal">null</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> StringUtil.getMaxIndex(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">//æ–­è¨€æœºåˆ¶ï¼šç¨‹åºå‘˜å¯ä»¥é€šè¿‡é¢„æµ‹ä¸šåŠ¡æ–¹æ³•çš„ç»“æœ</span></span><br><span class="line">        Assert.assertEquals(<span class="string">&quot;æ–¹æ³•å†…éƒ¨æœ‰bug!&quot;</span>, <span class="number">5</span>, index);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</span><br><span class="line">----&gt;Before CLassæ‰§è¡Œäº†---------</span><br><span class="line">----&gt; test1 Beforeæ‰§è¡Œäº†--------</span><br><span class="line">åå­—é•¿åº¦æ˜¯<span class="number">5</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line">----&gt;test2 Afteræ‰§è¡Œäº†--------</span><br><span class="line">----&gt; test1 Beforeæ‰§è¡Œäº†--------</span><br><span class="line"><span class="number">1</span></span><br><span class="line">-<span class="number">1</span></span><br><span class="line">----&gt;test2 Afteræ‰§è¡Œäº†--------</span><br><span class="line">----&gt;After Classæ‰§è¡Œäº†---------</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></table></figure>



<h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><h2 id="è®¤è¯†åå°„ã€è·å–ç±»"><a href="#è®¤è¯†åå°„ã€è·å–ç±»" class="headerlink" title="è®¤è¯†åå°„ã€è·å–ç±»"></a>è®¤è¯†åå°„ã€è·å–ç±»</h2><ul>
<li>æ¦‚å¿µ&#x2F;æ˜¯ä»€ä¹ˆï¼šåŠ è½½ç±»ï¼Œå¹¶å…è®¸ä»¥ç¼–ç¨‹çš„æ–¹å¼è§£å‰–ç±»ä¸­çš„å„ç§æˆåˆ†ï¼ˆæˆå‘˜å˜é‡ã€æ–¹æ³•ã€æ„é€ å™¨ç­‰ï¼‰ã€‚</li>
</ul>
<p>â€‹		ç±»æ˜¯ç”±æˆå‘˜å˜é‡ã€æ„é€ å™¨ã€æˆå‘˜æ–¹æ³•ç»„æˆçš„ã€‚<strong>æˆ‘ä»¬å­¦ä¹ åå°„ï¼Œå°±æ˜¯å­¦ä¹ è·å–ç±»çš„ä¿¡æ¯ï¼Œæ“ä½œå®ƒä»¬ã€‚</strong></p>
<h2 id="è·å–ç±»çš„æ„é€ å™¨"><a href="#è·å–ç±»çš„æ„é€ å™¨" class="headerlink" title="è·å–ç±»çš„æ„é€ å™¨"></a>è·å–ç±»çš„æ„é€ å™¨</h2><p><strong>1ã€ åå°„ç¬¬ä¸€æ­¥ï¼šåŠ è½½ç±»ï¼Œè·å–ç±»çš„å­—èŠ‚ç ï¼šClasså¯¹è±¡ï¼ˆä¸‡ç‰©çš†å¯¹è±¡ï¼Œç±»çš„å­—èŠ‚ç åœ¨Javaä¸­è¿˜æ˜¯Classå¯¹è±¡ï¼‰</strong></p>
<p>Student.javaâ€”â€”&gt;Student.classâ€”â€”&gt;å­—èŠ‚ç æ–‡ä»¶â€”â€”&gt;å†…å­˜</p>
<p>è·å–Classå¯¹è±¡çš„ä¸‰ç§æ–¹å¼</p>
<ul>
<li>Class c1 &#x3D; ç±»å.class</li>
<li>è°ƒç”¨Classæä¾›æ–¹æ³•ï¼špublic static Class forName(String package);</li>
<li>Objectæä¾›çš„æ–¹æ³•ï¼špublic Class getClass(); Class c3 &#x3D; å¯¹è±¡.getClass();</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.d2_reliect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test1Class</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç§æ–¹å¼</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c1</span> <span class="operator">=</span> Student.class;</span><br><span class="line">        System.out.println(c1.getName()); <span class="comment">// å…¨ç±»å</span></span><br><span class="line">        System.out.println(c1.getSimpleName());  <span class="comment">//ç®€åï¼šStudent</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬äºŒç§æ–¹å¼</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c2</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.itheima.d2_reliect.Student&quot;</span>);</span><br><span class="line">        System.out.println(c1 == c2);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰ç§æ–¹å¼</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c3</span> <span class="operator">=</span> s.getClass();</span><br><span class="line">        System.out.println(c3 == c1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2ã€è·å–ç±»çš„æ„é€ å™¨ï¼šConstructorå¯¹è±¡</strong></p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Constructor&lt;?&gt;[] getConstructors()</td>
<td>è·å–å…¨éƒ¨æ„é€ å™¨ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>Constructor&lt;?&gt;[] getDeclaredConstructors()</td>
<td>è·å–å…¨éƒ¨æ„é€ å™¨ï¼ˆåªè¦å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
<tr>
<td>Constructor&lt;?&gt;[] getConstructor(Class&lt;?&gt;â€¦ parameterTypes)</td>
<td>è·å–æŸä¸ªæ„é€ å™¨ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>Constructor&lt;?&gt;[] getDeclaredConstructor(Class&lt;?&gt;â€¦ parameterTypes)</td>
<td>è·å–æŸä¸ªæ„é€ å™¨ï¼ˆåªè¦å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
</tbody></table>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGetConstructor2</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException &#123;</span><br><span class="line">        <span class="comment">// 1ã€åå°„ç¬¬ä¸€æ­¥ï¼šå¿…é¡»å…ˆå¾—åˆ°è¿™ä¸ªç±»çš„Classå¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Cat.class;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€è·å–æŸä¸ªæ„é€ å™¨ï¼Œæ— å‚æ•°æ„é€ å™¨</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor();</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        System.out.println(constructor.getName() + <span class="string">&quot;===&gt;&quot;</span> + constructor.getParameterCount());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.1 é€šè¿‡æ— å‚æ„é€ å™¨åˆå§‹åŒ–å®ä¾‹</span></span><br><span class="line">        <span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> (Cat) constructor.newInstance();</span><br><span class="line">        System.out.println(cat);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€è·å–æŸä¸ªæ„é€ å™¨ï¼Œæœ‰å‚æ•°æ„é€ å™¨</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor1</span> <span class="operator">=</span> c.getDeclaredConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">        System.out.println(constructor1.getName() + <span class="string">&quot;===&gt;&quot;</span> + constructor1.getParameterCount());</span><br><span class="line">        <span class="comment">// 3.1 é€šè¿‡æœ‰å‚æ„é€ å™¨åˆå§‹åŒ–å®ä¾‹</span></span><br><span class="line">        <span class="type">Cat</span> <span class="variable">cat2</span> <span class="operator">=</span> (Cat) constructor1.newInstance(<span class="string">&quot;é˜¿æ¾å¤§&quot;</span>,<span class="number">33</span>);</span><br><span class="line">        System.out.println(cat2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.1ã€è·å–ç±»æ„é€ å™¨çš„ä½œç”¨ï¼šåˆå§‹åŒ–ç±»å¯¹è±¡</strong></p>
<table>
<thead>
<tr>
<th>Constructoræä¾›çš„æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>T newInstance(Object â€¦ initargs)</td>
<td>è°ƒç”¨æ­¤æ„é€ å™¨å¯¹è±¡è¡¨ç¤ºçš„æ„é€ å™¨ï¼Œå¹¶ä¼ å…¥å‚æ•°ï¼Œå®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–å¹¶è¿”å›</td>
</tr>
<tr>
<td>public void setAccessible(boolean flag)</td>
<td>è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºç¦æ­¢æ£€æŸ¥è®¿é—®æ§åˆ¶ï¼ˆæš´åŠ›åå°„ï¼‰</td>
</tr>
</tbody></table>
<p><strong>å®ä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1ã€è·å–ç±»çš„classå¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Cat.class;</span><br><span class="line"><span class="type">Constructor</span> <span class="variable">constructor1</span> <span class="operator">=</span> c.getDeclaredConstructor();</span><br><span class="line">System.out.println(constructor1.getName() + <span class="string">&quot;---&gt;&quot;</span> + constructor1.getParameterCount());</span><br><span class="line"><span class="comment">//è®¾ç½®è®¿é—®æƒé™ç¦æ­¢æ£€æŸ¥</span></span><br><span class="line">constructor1.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">// ç›´æ¥ç”¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºCatç±»çš„æ— å‚æ„é€ å‡½æ•°æ˜¯privateçš„ï¼Œé»˜è®¤æ˜¯æ— æ³•è®¿é—®çš„</span></span><br><span class="line"><span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> (Cat) constructor1.newInstance();</span><br><span class="line">System.out.println(cat);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–æœ‰å‚æ•°æ„é€ å™¨</span></span><br><span class="line"><span class="type">Constructor</span> <span class="variable">constructor2</span> <span class="operator">=</span> c.getDeclaredConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">System.out.println(constructor2.getName() + <span class="string">&quot;---&gt;&quot;</span> + constructor2.getParameterCount());</span><br><span class="line"><span class="type">Cat</span> <span class="variable">cat2</span> <span class="operator">=</span> (Cat) constructor2.newInstance(<span class="string">&quot;å®å½“çŒ«&quot;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(cat2);</span><br></pre></td></tr></table></figure>

<p><strong>3ã€è·å–ç±»çš„æˆå‘˜å˜é‡ï¼šFieldå¯¹è±¡</strong></p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>public Field[] getFields()</td>
<td>è·å–ç±»çš„å…¨éƒ¨æˆå‘˜å˜é‡ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>public Field[] getDeclaredFields()</td>
<td>è·å–ç±»çš„å…¨éƒ¨æˆå‘˜å˜é‡ï¼ˆåªèƒ½å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
<tr>
<td>public Field[] getField(String name)</td>
<td>è·å–ç±»çš„æŸä¸ªæˆå‘˜å˜é‡ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>public Field[] getDeclaredField(String name)</td>
<td>è·å–ç±»çš„æŸä¸ªæˆå‘˜å˜é‡ï¼ˆåªèƒ½å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
</tbody></table>
<p><strong>å®ä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1ã€è·å–ç±»çš„classå¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Cat.class;</span><br><span class="line"><span class="comment">// 2ã€è·å–ç±»çš„å…¨éƒ¨æˆå‘˜å˜é‡</span></span><br><span class="line">Field[] declaredFields = c.getDeclaredFields();</span><br><span class="line"><span class="comment">// 3ã€éå†è¿™ä¸ªæˆå‘˜å˜é‡æ•°ç»„</span></span><br><span class="line"><span class="keyword">for</span> (Field declaredField : declaredFields) &#123;</span><br><span class="line">    System.out.println(declaredField);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 4ã€å®šä½æŸä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">fName</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">System.out.println(fName.getName() + <span class="string">&quot;---&gt;&quot;</span> + fName.getType());</span><br><span class="line"></span><br><span class="line"><span class="type">Field</span> <span class="variable">fAge</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">System.out.println(fAge.getName() + <span class="string">&quot;---&gt;&quot;</span> + fAge.getType());</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>void set(Object obj, Object value)</td>
<td>èµ‹å€¼</td>
</tr>
<tr>
<td>Object get(Object obj)</td>
<td>å–å€¼</td>
</tr>
<tr>
<td>public void setAccessible(boolean flag)</td>
<td>è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºç¦æ­¢æ£€æŸ¥è®¿é—®æ§åˆ¶ï¼ˆæš´åŠ›åå°„ï¼‰</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//èµ‹å€¼</span></span><br><span class="line"><span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line"><span class="comment">//å®šä½æŸä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">fName</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">System.out.println(fName.getName() + <span class="string">&quot;---&gt;&quot;</span> + fName.getType());</span><br><span class="line"><span class="comment">//æš´åŠ›åå°„</span></span><br><span class="line">fName.setAccessible(<span class="literal">true</span>);</span><br><span class="line">fName.set(cat,<span class="string">&quot;åŠ è²çŒ«&quot;</span>);</span><br><span class="line">System.out.println(cat);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å–å€¼</span></span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> (String)fName.get(cat);</span><br><span class="line">System.out.println(name);</span><br></pre></td></tr></table></figure>

<p><strong>4ã€è·å–ç±»çš„æˆå‘˜æ–¹æ³•ï¼šMethodå¯¹è±¡</strong></p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Method[] getMethods()</td>
<td>è·å–ç±»çš„å…¨éƒ¨æˆå‘˜æ–¹æ³•ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>Method[] getDeclaredMethods()</td>
<td>è·å–ç±»çš„å…¨éƒ¨æˆå‘˜æ–¹æ³•ï¼ˆåªè¦å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
<tr>
<td>Method getMethod(String name, Class&lt;?&gt;â€¦ parameterTypes)</td>
<td>è·å–ç±»çš„æŸä¸ªæˆå‘˜æ–¹æ³•ï¼ˆåªèƒ½è·å–publicä¿®é¥°çš„ï¼‰</td>
</tr>
<tr>
<td>Method getDeclaredMethod(String name, Class&lt;?&gt;â€¦ parameterTypes)</td>
<td>è·å–ç±»çš„æŸä¸ªæˆå‘˜æ–¹æ³•ï¼ˆåªè¦å­˜åœ¨å°±èƒ½æ‹¿åˆ°ï¼‰</td>
</tr>
</tbody></table>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// 1ã€åå°„ç¬¬ä¸€æ­¥ï¼Œå…ˆå¾—åˆ°ç±»çš„CLasså¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Cat.class;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2ã€è·å–ç±»çš„å…¨éƒ¨æˆå‘˜æ–¹æ³•</span></span><br><span class="line">Method[] declaredMethods = c.getDeclaredMethods();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3ã€éå†æ•°ç»„ä¸­çš„æ¯ä¸ªæ–¹æ³•å¯¹è±¡</span></span><br><span class="line"><span class="keyword">for</span> (Method declaredMethod : declaredMethods) &#123;</span><br><span class="line">    System.out.println(declaredMethod.getName() + <span class="string">&quot;---&gt;&quot;</span></span><br><span class="line">                       + declaredMethod.getParameterCount() + <span class="string">&quot;---&gt;&quot;</span></span><br><span class="line">                       + declaredMethod.getReturnType());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4ã€è·å–æŸä¸ªæ–¹æ³•å¯¹è±¡</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">eat</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">System.out.println(eat.getName() + <span class="string">&quot;---&gt;&quot;</span> + eat.getParameterCount() + <span class="string">&quot;---&gt;&quot;</span> + eat.getReturnType());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4ã€è·å–æŸä¸ªæ–¹æ³•å¯¹è±¡</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">eat2</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>, String.class);</span><br><span class="line">System.out.println(eat2.getName() + <span class="string">&quot;---&gt;&quot;</span> + eat2.getParameterCount() + <span class="string">&quot;---&gt;&quot;</span> + eat2.getReturnType());</span><br></pre></td></tr></table></figure>

<p><strong>4.2ã€æ‰§è¡Œç±»çš„æˆå‘˜æ–¹æ³•</strong></p>
<table>
<thead>
<tr>
<th>Methodæä¾›çš„æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>public Object invoke(Object obj, Objectâ€¦ args)</td>
<td>è§¦å‘æŸä¸ªå¯¹è±¡çš„è¯¥æ–¹æ³•æ‰§è¡Œ</td>
</tr>
<tr>
<td>public void setAccessible(boolean flag)</td>
<td>è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºç¦æ­¢æ£€æŸ¥è®¿é—®æ§åˆ¶ï¼ˆæš´åŠ›åå°„ï¼‰</td>
</tr>
</tbody></table>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1ã€åå°„ç¬¬ä¸€æ­¥ï¼Œå…ˆå¾—åˆ°ç±»çš„CLasså¯¹è±¡</span></span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Cat.class;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2ã€è·å–æŸä¸ªæ–¹æ³•å¯¹è±¡</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">eat</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">System.out.println(eat.getName() + <span class="string">&quot;---&gt;&quot;</span> + eat.getParameterCount() + <span class="string">&quot;---&gt;&quot;</span> + eat.getReturnType());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3ã€è·å–æŸä¸ªæ–¹æ³•å¯¹è±¡</span></span><br><span class="line"><span class="type">Method</span> <span class="variable">eat2</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>, String.class);</span><br><span class="line">System.out.println(eat2.getName() + <span class="string">&quot;---&gt;&quot;</span> + eat2.getParameterCount() + <span class="string">&quot;---&gt;&quot;</span> + eat2.getReturnType());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4ã€å‡ºå‘runæ–¹æ³•æ‰§è¡Œ</span></span><br><span class="line"><span class="type">Cat</span> <span class="variable">cat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Cat</span>();</span><br><span class="line">eat2.setAccessible(<span class="literal">true</span>);  <span class="comment">// ç¦æ­¢æ£€æŸ¥è®¿é—®æƒé™</span></span><br><span class="line"><span class="type">String</span> <span class="variable">rs</span> <span class="operator">=</span> eat2.invoke(cat, <span class="string">&quot;shit&quot;</span>); <span class="comment">// è°ƒç”¨æ— å‚æ•°çš„runæ–¹æ³•ï¼Œç”¨catå¯¹è±¡è§¦å‘è°ƒç”¨çš„ã€‚</span></span><br><span class="line">System.out.println(rs);</span><br></pre></td></tr></table></figure>

<p><strong>5ã€åå°„çš„ä½œç”¨å’Œåº”ç”¨åœºæ™¯</strong></p>
<p>åå°„çš„ä½œç”¨</p>
<ul>
<li><p>åŸºæœ¬ä½œç”¨ï¼šå¯ä»¥å¾—åˆ°ä¸€ä¸ªç±»çš„å…¨éƒ¨æˆåˆ†ç„¶åæ“ä½œã€‚</p>
</li>
<li><p>å¯ä»¥ç ´åå°è£…æ€§ã€‚</p>
</li>
<li><p>æœ€é‡è¦çš„ç”¨é€”æ˜¯ï¼šé€‚åˆåšJavaçš„æ¡†æ¶ï¼ŒåŸºæœ¬ä¸Šï¼Œä¸»æµçš„æ¡†æ¶éƒ½ä¼šåŸºäºåå°„è®¾è®¡å‡ºä¸€äº›é€šç”¨çš„åŠŸèƒ½ã€‚</p>
</li>
</ul>
<p>åº”ç”¨åœºæ™¯</p>
<p>éœ€æ±‚ï¼š å¯¹ä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥æ¡†æ¶éƒ½å¯ä»¥æŠŠå¯¹è±¡çš„å­—æ®µåå’Œå¯¹åº”çš„å€¼ï¼Œä¿å­˜åˆ°æ–‡ä»¶ä¸­å»ã€‚</p>
<p>å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ¥å—ä»»æ„å¯¹è±¡</li>
<li>æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹è±¡åï¼Œä½¿ç”¨åå°„è·å–è¯¥å¯¹è±¡çš„Classå¯¹è±¡ï¼Œç„¶åè·å–å…¨éƒ¨çš„æˆå‘˜å˜é‡ã€‚</li>
<li>éå†æˆå‘˜å˜é‡ï¼Œç„¶åæå–æˆå‘˜å˜é‡åœ¨è¯¥å¯¹è±¡ä¸­çš„å…·ä½“å€¼ã€‚</li>
<li>æŠŠæˆå‘˜å˜é‡åï¼Œå’Œå…¶å€¼ï¼Œå†™åˆ°æ–‡ä»¶ä¸­å³å¯ã€‚</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectFrame</span> &#123;</span><br><span class="line">    <span class="comment">// ç›®æ ‡ï¼šä¿å­˜ä»»æ„å¯¹è±¡çš„å­—æ®µåŠå…¶æ•°æ®åˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">saveObject</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IllegalAccessException, FileNotFoundException &#123;</span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;src\\data.txt&quot;</span>, <span class="literal">true</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1ã€objæ˜¯ä»»æ„å¯¹è±¡ï¼Œåˆ°åº•æœ‰å¤šå°‘ä¸ªå­—æ®µè¦ä¿å­˜ã€‚</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> obj.getClass();</span><br><span class="line">        <span class="type">String</span> <span class="variable">cName</span> <span class="operator">=</span> c.getSimpleName();</span><br><span class="line">        ps.println(<span class="string">&quot;------------------------------------&quot;</span> + cName + <span class="string">&quot;---------------------------&quot;</span>);</span><br><span class="line">        <span class="comment">// 2ã€ä»ç±»ä¸­æå–å®ƒçš„å…¨éƒ¨æˆå‘˜å˜é‡ã€‚</span></span><br><span class="line">        Field[] fields = c.getDeclaredFields();</span><br><span class="line">        <span class="comment">// 3ã€éå†æ¯ä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="comment">// 4ã€æ‹¿åˆ°æˆå‘˜å˜é‡çš„åå­—</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> field.getName();</span><br><span class="line">            <span class="comment">// 5ã€æ‹¿åˆ°è¿™ä¸ªæˆå‘˜å˜é‡åœ¨å¯¹è±¡ä¸­çš„æ•°æ®</span></span><br><span class="line">            field.setAccessible(<span class="literal">true</span>); <span class="comment">// ç¦æ­¢æ£€æŸ¥è®¿é—®æ§åˆ¶</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> field.get(obj) + <span class="string">&quot;&quot;</span>;</span><br><span class="line">            ps.println(name + <span class="string">&quot;=&quot;</span> + value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="æ³¨è§£ï¼ˆAnnotationï¼‰"><a href="#æ³¨è§£ï¼ˆAnnotationï¼‰" class="headerlink" title="æ³¨è§£ï¼ˆAnnotationï¼‰"></a>æ³¨è§£ï¼ˆAnnotationï¼‰</h1><h2 id="æ¦‚è¿°ã€è‡ªå®šä¹‰æ³¨è§£"><a href="#æ¦‚è¿°ã€è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="æ¦‚è¿°ã€è‡ªå®šä¹‰æ³¨è§£"></a>æ¦‚è¿°ã€è‡ªå®šä¹‰æ³¨è§£</h2><ul>
<li><p>å°±æ˜¯Javaä»£ç ä¸­çš„ç‰¹æ®Šæ ‡è®°ï¼Œæ¯”å¦‚ï¼š@Overrideï¼Œ@Testç­‰ï¼Œä½œç”¨æ˜¯ï¼šè®©å…¶ä»–ç¨‹åºæ ¹æ®æ³¨è§£ä¿¡æ¯æ¥å†³å®šæ€ä¹ˆæ‰§è¡Œç¨‹åºã€‚</p>
</li>
<li><p>æ³¨æ„ï¼šæ³¨è§£å¯ä»¥ç”¨åœ¨ç±»ä¸Šã€æ„é€ å™¨ä¸Šã€æ–¹æ³•ä¸Šã€æˆå‘˜å˜é‡ä¸Šã€å‚æ•°ä¸Šã€ç­‰ä½ç½®å¤„ã€‚</p>
</li>
<li><p>è‡ªå®šä¹‰æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> æ³¨è§£åç§°&#123;</span><br><span class="line">    <span class="keyword">public</span> å±æ€§ç±»å‹ å±æ€§å() <span class="keyword">default</span> é»˜è®¤å€¼;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç‰¹æ®Šå±æ€§åï¼švalue</p>
<ul>
<li>å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ªvalueå±æ€§ï¼Œä½¿ç”¨æ³¨é‡Šæ—¶ï¼Œvalueåç§°å¯ä»¥ä¸å†™ï¼ï¼</li>
</ul>
<p>ç¤ºä¾‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*AnnotationTest1.java*/</span></span><br><span class="line"><span class="meta">@MyTest1(aaa = &quot;ç‰›é­”ç‹&quot;, ccc = &#123;&quot;html&quot;,&quot;java&quot;&#125;)</span></span><br><span class="line"><span class="comment">//@MyTest2(value=&quot;å­™æ‚Ÿç©º&quot;)</span></span><br><span class="line"><span class="meta">@MyTest2(&quot;å­™æ‚Ÿç©º&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest1</span> &#123;</span><br><span class="line">    <span class="meta">@MyTest1(aaa = &quot;é“æ‰‡å…¬ä¸»&quot;, bbb = false, ccc = &#123;&quot;python&quot;,&quot;å‰ç«¯&quot;,&quot;java&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*Mytest1.java*/</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰æ³¨è§£</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest1 &#123;</span><br><span class="line">    String <span class="title function_">aaa</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">bbb</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">    String[] ccc();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*Mytest2.java*/</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest2 &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>; <span class="comment">//ç‰¹æ®Šå±æ€§</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨è§£çš„åŸç†</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest1 &#123;</span><br><span class="line">    String <span class="title function_">aaa</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">bbb</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">    String[] ccc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œmainå‡½æ•°å¾—åˆ°ç¼–è¯‘æ–‡ä»¶ï¼Œä½¿ç”¨xjadåç¼–è¯‘æ–‡ä»¶ï¼Œå¾—åˆ°ç»“æœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MyTest1</span> extend Annotation&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title function_">aaa</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">bbb</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> String[] ccc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨è§£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ¥å£ï¼ŒJavaä¸­æ‰€æœ‰æ³¨è§£éƒ½æ˜¯ç»§æ‰¿Annotationæ¥å£çš„ã€‚</li>
<li>@æ³¨è§£(â€¦)ï¼šå…¶å®å°±æ˜¯ä¸€ä¸ªå®ç°ç±»å¯¹è±¡ï¼Œå®ç°äº†è¯¥æ³¨è§£ä»¥åŠAnnotationæ¥å£ã€‚</li>
</ul>
</li>
</ul>
<h2 id="å…ƒæ³¨è§£"><a href="#å…ƒæ³¨è§£" class="headerlink" title="å…ƒæ³¨è§£"></a>å…ƒæ³¨è§£</h2><ul>
<li><p>æŒ‡çš„æ˜¯ï¼šä¿®é¥°æ³¨è§£çš„æ³¨è§£ã€‚</p>
</li>
<li><p><strong>å…ƒæ³¨è§£ä¸€</strong></p>
<p>ä½œç”¨ï¼šå£°æ˜è¢«ä¿®é¥°çš„æ³¨è§£åªèƒ½åœ¨å“ªäº›ä½ç½®ä½¿ç”¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="number">1.</span> TYPEï¼Œç±»ï¼Œæ¥å£</span><br><span class="line"><span class="number">2.</span> FIELDï¼Œæˆå‘˜å˜é‡</span><br><span class="line"><span class="number">3.</span> METHOD, æˆå‘˜æ–¹æ³•</span><br><span class="line"><span class="number">4.</span> PARAMETER, æ–¹æ³•å‚æ•°</span><br><span class="line"><span class="number">5.</span> CONSTRUCTOR, æ„é€ å™¨</span><br><span class="line"><span class="number">6.</span> LOCAL_VARIABLE, å±€éƒ¨å˜é‡</span><br></pre></td></tr></table></figure>




<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>ä½œç”¨èŒƒå›´</th>
</tr>
</thead>
<tbody><tr>
<td>TYPE</td>
<td>ç±»ï¼Œæ¥å£</td>
</tr>
<tr>
<td>FIELD</td>
<td>æˆå‘˜å˜é‡</td>
</tr>
<tr>
<td>METHOD</td>
<td>æˆå‘˜æ–¹æ³•</td>
</tr>
<tr>
<td>PARAMETER</td>
<td>æ–¹æ³•å‚æ•°</td>
</tr>
<tr>
<td>CONSTRUCTOR</td>
<td>æ„é€ å™¨</td>
</tr>
<tr>
<td>LOCAL_VARIABLE</td>
<td>å±€éƒ¨å˜é‡</td>
</tr>
</tbody></table>
</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest3 &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>å…ƒæ³¨è§£äºŒ</strong></p>
<p>ä½œç”¨ï¼šå£°æ˜æ³¨è§£çš„ä¿ç•™å‘¨æœŸ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy,RUNTIME)</span></span><br><span class="line"><span class="number">1.</span> SOURCE</span><br><span class="line">    åªä½œç”¨åœ¨æºç é˜¶æ®µï¼Œå­—èŠ‚ç æ–‡ä»¶ä¸­ä¸å­˜åœ¨</span><br><span class="line"><span class="number">2.</span> CLASSï¼ˆé»˜è®¤å€¼ï¼‰</span><br><span class="line">    ä¿ç•™åˆ°å­—èŠ‚ç æ–‡ä»¶å§é˜¶æ®µï¼Œè¿è¡Œé˜¶æ®µä¸å­˜åœ¨</span><br><span class="line"><span class="number">3.</span> RUNTIMEï¼ˆå¼€å‘å¸¸ç”¨ï¼‰</span><br><span class="line">    ä¸€ç›´ä¿å­˜åˆ°è¿è¡Œé˜¶æ®µ</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="æ³¨è§£çš„è§£æ"><a href="#æ³¨è§£çš„è§£æ" class="headerlink" title="æ³¨è§£çš„è§£æ"></a>æ³¨è§£çš„è§£æ</h2><ul>
<li><p>å°±æ˜¯åˆ¤æ–­ç±»ä¸Šé¢ï¼Œæ–¹æ³•ä¸Šï¼Œæˆå‘˜å˜é‡ä¸Šæ˜¯å¦å­˜åœ¨æ³¨è§£ï¼Œå¹¶æŠŠæ³¨è§£é‡Œçš„å†…å®¹è§£æå‡ºæ¥</p>
</li>
<li><p>å¦‚ä½•è§£ææ³¨è§£ï¼Ÿ</p>
<ul>
<li><p>æŒ‡å¯¼æ€æƒ³ï¼šè¦è§£æè°ä¸Šé¢çš„æ³¨è§£ï¼Œå°±åº”è¯¥å…ˆæ‹¿åˆ°è°ã€‚</p>
</li>
<li><p>æ¯”å¦‚è¦è§£æç±»ä¸Šé¢çš„æ³¨è§£ï¼Œåˆ™åº”è¯¥å…ˆè·å–è¯¥ç±»çš„å¯¹è±¡ï¼Œå†é€šè¿‡Classå¯¹è±¡è§£æå…¶ä¸Šé¢çš„æ³¨è§£ã€‚</p>
</li>
<li><p>æ¯”å¦‚è¦è§£ææˆå‘˜æ–¹æ³•ä¸Šé¢çš„æ³¨è§£ï¼Œåˆ™åº”è¯¥å…ˆè·å–è¯¥æˆå‘˜æ–¹æ³•çš„Methodå¯¹è±¡ï¼Œå†é€šè¿‡Methodå¯¹è±¡è§£æå…¶ä¸Šé¢çš„æ³¨è§£ã€‚</p>
</li>
<li><p>Classã€Methodã€Fieldã€Constructoréƒ½å®ç°äº†AnnotatedElementæ¥å£ï¼Œå®ƒä»¬éƒ½æ‹¥æœ‰è§£ææ³¨è§£çš„èƒ½åŠ›ã€‚</p>
<table>
<thead>
<tr>
<th>AnnotatedElementæ¥å£æä¾›äº†è§£ææ³¨è§£çš„æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>public Annotation[] getDeclaredAnnotations()</td>
<td>è·å–å½“å‰å¯¹è±¡ä¸Šé¢çš„æ³¨è§£</td>
</tr>
<tr>
<td>public T getDeclaredAnnotation(Class&lt;\T&gt; annotationClass)</td>
<td>è·å–æŒ‡å®šçš„æ³¨è§£å¯¹è±¡</td>
</tr>
<tr>
<td>public boolean isAnnotationPresent(Class&lt;Annotation&gt; annotationClass)</td>
<td>åˆ¤æ–­å½“å‰å¯¹è±¡ä¸Šæ˜¯å¦å­˜åœ¨æŸä¸ªæ³¨è§£</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>è§£ææ³¨è§£çš„æ¡ˆä¾‹</p>
<p>å®šä¹‰æ³¨è§£MyTest4,è¦æ±‚å¦‚ä¸‹æ‰€ç¤º</p>
<ol>
<li>åŒ…å«å±æ€§ï¼šString value()</li>
<li>åŒ…å«å±æ€§ï¼šdouble aaa()ï¼Œé»˜è®¤å€¼æ˜¯100</li>
<li>åŒ…å«å±æ€§ï¼šString[] bbb()</li>
<li>é™åˆ¶æ³¨è§£ä½¿ç”¨çš„ä½ç½®ï¼šç±»å’Œæˆå‘˜æ–¹æ³•ä¸Š</li>
<li>é™åˆ¶æ³¨è§£çš„æœ‰æ•ˆèŒƒå›´ï¼šä¸€ç›´åˆ°è¿è¡Œæ—¶</li>
</ol>
<p>å®šä¹‰ä¸€ä¸ªç±»ï¼šDemoï¼Œåœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªtest1æ–¹æ³•ï¼Œå¹¶åœ¨è¯¥ç±»å’Œå…¶æ–¹æ³•ä¸Šä½¿ç”¨MyTest4æ³¨è§£</p>
<p>å®šä¹‰ä¸€ä¸ªAnnotationTest3æµ‹è¯•ç±»ï¼Œè§£æDemoç±»ä¸­çš„å…¨éƒ¨æ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// -------------------MyTest4.java-----------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest4 &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">aaa</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">100</span>;</span><br><span class="line">    String[] bbb();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------------Demo.java-------------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@MyTest4(value = &quot;èœ˜è››ç²¾&quot;, aaa = 99.5, bbb = &#123;&quot;è‡³å°Šå®&quot;, &quot;é»‘é©¬&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="meta">@MyTest4(value = &quot;è‡³å°Šå®&quot;, aaa = 199.5, bbb = &#123;&quot;ç´«éœ&quot;, &quot;ç‰›å¤«äºº&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --------------AnnotationTest3.java-----------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest3</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">parseClass</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException &#123;</span><br><span class="line">        <span class="comment">// 1ã€å…ˆå¾—åˆ°Classå¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Demo.class;</span><br><span class="line">        <span class="comment">// 2ã€è§£æç±»ä¸Šçš„æ³¨è§£</span></span><br><span class="line">        <span class="comment">// åˆ¤æ–­ç±»ä¸Šæ˜¯å¦åŒ…å«äº†æŸä¸ªæ³¨è§£</span></span><br><span class="line">        <span class="keyword">if</span>(c.isAnnotationPresent(MyTest4.class)) &#123;</span><br><span class="line">            <span class="type">MyTest4</span> <span class="variable">myTest4</span> <span class="operator">=</span> (MyTest4) c.getDeclaredAnnotation(MyTest4.class);</span><br><span class="line">            System.out.println(myTest4.value());</span><br><span class="line">            System.out.println(myTest4.aaa());</span><br><span class="line">            System.out.println(Arrays.toString(myTest4.bbb()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">parseMethod</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException &#123;</span><br><span class="line">        <span class="comment">// 1ã€å…ˆå¾—åˆ°Classå¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Demo.class;</span><br><span class="line">        <span class="comment">// 2ã€è·å–æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> c.getDeclaredMethod(<span class="string">&quot;test1&quot;</span>);</span><br><span class="line">        <span class="comment">// 3ã€åˆ¤æ–­æ–¹æ³•å¯¹è±¡ä¸Šæ˜¯å¦åŒ…å«äº†æŸä¸ªæ³¨é‡Š</span></span><br><span class="line">        <span class="keyword">if</span>(m.isAnnotationPresent(MyTest4.class))&#123;</span><br><span class="line">            <span class="type">MyTest4</span> <span class="variable">myTest4</span> <span class="operator">=</span> (MyTest4) m.getDeclaredAnnotation(MyTest4.class);</span><br><span class="line">            System.out.println(myTest4.value());</span><br><span class="line">            System.out.println(myTest4.aaa());</span><br><span class="line">            System.out.println(Arrays.toString(myTest4.bbb()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><ul>
<li><p>æ¨¡æ‹ŸJunitæ¡†æ¶</p>
<p><strong>éœ€æ±‚</strong>ï¼šå®šä¹‰è‹¥å¹²ä¸ªæ–¹æ³•ï¼Œåªè¦åŠ äº†MyTestæ³¨è§£ï¼Œå°±ä¼šè§¦å‘è¯¥æ–¹æ³•çš„æ‰§è¡Œã€‚</p>
<p><strong>åˆ†æ</strong></p>
<ol>
<li>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£MyTestï¼Œåªèƒ½æ³¨è§£æ–¹æ³•ï¼Œå­˜æ´»èŒƒå›´æ˜¯ä¸€ç›´éƒ½åœ¨ã€‚</li>
<li>å®šä¹‰è‹¥å¹²ä¸ªæ–¹æ³•ï¼Œéƒ¨åˆ†æ–¹æ³•åŠ ä¸Š@MyTestä¿®é¥°ï¼Œéƒ¨åˆ†æ–¹æ³•ä¸åŠ ã€‚</li>
<li>æ¨¡æ‹Ÿä¸€ä¸ªJunitç¨‹åºï¼Œå¯ä»¥è§¦å‘åŠ äº†@MyTestæ³¨è§£çš„æ–¹æ³•æ‰§è¡Œã€‚</li>
</ol>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ---------------AnnotationTest4.java----------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationTest4</span> &#123;</span><br><span class="line">    <span class="meta">@MyTest</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----test1----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@MyTest</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----test2----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----test3----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@MyTest</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test4</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----test4----&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">AnnotationTest4</span> <span class="variable">a</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationTest4</span>();</span><br><span class="line">        <span class="comment">//å¯åŠ¨ç¨‹åºï¼</span></span><br><span class="line">        <span class="comment">// 1ã€å¾—åˆ°classå¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> AnnotationTest4.class;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2ã€æå–è¿™ä¸ªç±»çš„å…¨éƒ¨æˆå‘˜æ–¹æ³•</span></span><br><span class="line">        Method[] methods = c.getDeclaredMethods();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">            <span class="comment">//3ã€éå†è¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸ªæ–¹æ³•ï¼Œçœ‹æ–¹æ³•æ˜¯å¦è¢«@MyTestæ³¨é‡Š</span></span><br><span class="line">            <span class="keyword">if</span>(method.isAnnotationPresent(MyTest.class))&#123;</span><br><span class="line">                <span class="comment">//è¯´æ˜å½“å‰æ–¹æ³•æ˜¯å­˜åœ¨@MyTestï¼Œè§¦å‘æ–¹æ³•æ‰§è¡Œ</span></span><br><span class="line">                method.invoke(a);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------MyTest4.java----------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d3_annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE,ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> MyTest4 &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">aaa</span><span class="params">()</span> <span class="keyword">default</span> <span class="number">100</span>;</span><br><span class="line">    String[] bbb();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h1><ul>
<li><p>æ¦‚è¿°ã€å¿«é€Ÿå…¥é—¨</p>
<p>å¯¹è±¡å¦‚æœå«Œèº«ä¸Šå¹²çš„äº‹æƒ…å¤ªå¤šçš„è¯ï¼Œå¯ä»¥é€šè¿‡ä»£ç†è½¬ç§»éƒ¨åˆ†èŒè´£ã€‚</p>
<p>å¯¹è±¡æœ‰ä»€ä¹ˆæ–¹æ³•æƒ³è¢«ä»£ç†ï¼Œä»£ç†å°±ä¸€å®šè¦æœ‰å¯¹åº”çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>åº”ç”¨æ¡ˆä¾‹ã€ä½¿ç”¨ä»£ç†çš„å¥½å¤„</p>
<p>è½¬ç§»å¯¹è±¡çš„æ–¹æ³•ï¼Œä¼˜åŒ–ç±»çš„é€»è¾‘ç»“æ„</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ----------------------UserService.java------------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d5_proxy2;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  ç”¨æˆ·ä¸šåŠ¡æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="comment">// ç™»å½•åŠŸèƒ½</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String loginName,String passWord)</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">    <span class="comment">// åˆ é™¤ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUsers</span><span class="params">()</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ç”¨æˆ·ï¼Œè¿”å›æ•°ç»„çš„å½¢å¼ã€‚</span></span><br><span class="line">    String[] selectUsers() <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------------UserServceImpl.java-----------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d5_proxy2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ä¸šåŠ¡å®ç°ç±»ï¼ˆé¢å‘æ¥å£ç¼–ç¨‹ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String loginName, String passWord)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;admin&quot;</span>.equals(loginName) &amp;&amp; <span class="string">&quot;123456&quot;</span>.equals(passWord))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‚¨ç™»å½•æˆåŠŸï¼Œæ¬¢è¿å…‰ä¸´æœ¬ç³»ç»Ÿ~&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ‚¨ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUsers</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆåŠŸåˆ é™¤äº†1ä¸‡ä¸ªç”¨æˆ·~&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">1500</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] selectUsers() <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥è¯¢å‡ºäº†3ä¸ªç”¨æˆ·&quot;</span>);</span><br><span class="line">        String[] names = &#123;<span class="string">&quot;å¼ å…¨è›‹&quot;</span>, <span class="string">&quot;æäºŒç‹—&quot;</span>, <span class="string">&quot;ç‰›çˆ±èŠ±&quot;</span>&#125;;</span><br><span class="line">        Thread.sleep(<span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> names;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ------------------------ProxyUtil.java------------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d5_proxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyUtil</span> &#123;</span><br><span class="line"><span class="comment">//    public static UserService createProxy(UserService userService)&#123;</span></span><br><span class="line"><span class="comment">//        UserService userServiceProxy = (UserService) Proxy.newProxyInstance(ProxyUtil.class.getClassLoader(),</span></span><br><span class="line"><span class="comment">//                new Class[]&#123;UserService.class&#125;, new InvocationHandler() &#123;</span></span><br><span class="line"><span class="comment">//                    @Override</span></span><br><span class="line"><span class="comment">//                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                        if(method.getName().equals(&quot;login&quot;) || method.getName().equals(&quot;deleteUsers&quot;)||</span></span><br><span class="line"><span class="comment">//                               method.getName().equals(&quot;selectUsers&quot;))&#123;</span></span><br><span class="line"><span class="comment">//                            long startTime = System.currentTimeMillis();</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                            Object rs = method.invoke(userService, args);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//                            long endTime = System.currentTimeMillis();</span></span><br><span class="line"><span class="comment">//                            System.out.println(method.getName() + &quot;æ–¹æ³•æ‰§è¡Œè€—æ—¶ï¼š&quot; + (endTime - startTime)/ 1000.0 + &quot;s&quot;);</span></span><br><span class="line"><span class="comment">//                            return rs;</span></span><br><span class="line"><span class="comment">//                        &#125;else &#123;</span></span><br><span class="line"><span class="comment">//                            Object rs = method.invoke(userService, args);</span></span><br><span class="line"><span class="comment">//                            return rs;</span></span><br><span class="line"><span class="comment">//                        &#125;</span></span><br><span class="line"><span class="comment">//                    &#125;</span></span><br><span class="line"><span class="comment">//                &#125;);</span></span><br><span class="line"><span class="comment">//        return userServiceProxy;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> UserService <span class="title function_">createProxy</span><span class="params">(UserService userService)</span>&#123;</span><br><span class="line">        <span class="comment">//1ã€ä½¿ç”¨Proxyç±»è°ƒç”¨é™æ€æ–¹æ³•newProxyInstanceåˆ›å»ºä»£ç†ï¼Œä»£ç†è¦å¼ºè½¬ä¸ºUserServiceç±»å‹</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userServiceProxy</span> <span class="operator">=</span> (UserService) Proxy.newProxyInstance(ProxyUtil.class.getClassLoader(),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;UserService.class&#125;, <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                    <span class="keyword">if</span>(method.getName().equals(<span class="string">&quot;login&quot;</span>) || method.getName().equals(<span class="string">&quot;deleteUsers&quot;</span>) || method.getName().equals(<span class="string">&quot;selectUsers&quot;</span>))&#123;</span><br><span class="line">                        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">                        <span class="type">Object</span> <span class="variable">rs</span> <span class="operator">=</span> method.invoke(userService, args);</span><br><span class="line">                        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">                        System.out.println(method.getName() + <span class="string">&quot;æ–¹æ³•æ‰§è¡Œè€—æ—¶ï¼š&quot;</span> + (endTime - startTime) / <span class="number">1000.0</span> + <span class="string">&quot;s&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span> rs;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="type">Object</span> <span class="variable">rs</span> <span class="operator">=</span> method.invoke(userService, args);</span><br><span class="line">                        <span class="keyword">return</span> rs;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userServiceProxy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -----------------------------Test.java----------------------------</span></span><br><span class="line"><span class="keyword">package</span> com.itheima.d5_proxy2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç›®æ ‡ï¼šä½¿ç”¨åŠ¨æ€ä»£ç†è§£å†³å®é™…é—®é¢˜ï¼Œå¹¶æŒæ¡ä½¿ç”¨ä»£ç†çš„å¥½å¤„ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 1ã€åˆ›å»ºç”¨æˆ·ä¸šåŠ¡å¯¹è±¡ã€‚</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> ProxyUtil.createProxy(<span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2ã€è°ƒç”¨ç”¨æˆ·ä¸šåŠ¡çš„åŠŸèƒ½ã€‚</span></span><br><span class="line">        userService.login(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userService.deleteUsers();</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        String[] names = userService.selectUsers();</span><br><span class="line">        System.out.println(<span class="string">&quot;æŸ¥è¯¢åˆ°çš„ç”¨æˆ·æ˜¯ï¼š&quot;</span> + Arrays.toString(names));</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









]]></content>
      <categories>
        <category>javase</category>
      </categories>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2023/10/27/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
</search>
